!function(b){"use strict";function W(){}function c(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(o.apply(null,t))}}function l(t){return t}var G=function(t){return function(){return t}};function d(o){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=r.concat(t);return o.apply(null,e)}}function p(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,t)}}function i(t){return function(){throw new Error(t)}}var u=G(!1),a=G(!0),t=tinymce.util.Tools.resolve("tinymce.ThemeManager"),E=function(){return(E=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function f(t,n){var e={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]]);return e}function g(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;for(var o=Array(t),r=0,n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var n=function(){return s},s=(La=function(t){return t.isNone()},La={fold:function(t,n){return t()},is:u,isSome:u,isNone:a,getOr:o,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:G(null),getOrUndefined:G(void 0),or:o,orThunk:e,map:n,each:W,bind:n,exists:u,forall:a,filter:n,equals:La,equals_:La,toArray:function(){return[]},toString:G("none()")},Object.freeze&&Object.freeze(La),La);function e(t){return t()}function o(t){return t}function m(t,n){if(ot(t)){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e]))return!1;return!0}return!1}function r(t,n){return ct.call(t,n)}function h(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1}function v(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=at.call(t,o,o+n);e.push(r)}return e}function y(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o}function x(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e}function w(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e)}(t,function(t){e=n(e,t)}),e}function S(t,n,e){return ft(t,function(t){e=n(e,t)}),e}function k(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];if(n(r,e))return $.some(r)}return $.none()}function C(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return $.some(e);return $.none()}function T(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!ot(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);st.apply(n,t[e])}return n}function O(t,n){return n=y(t,n),T(n)}function D(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0}function B(t){return(t=at.call(t,0)).reverse(),t}function A(t,n){return x(t,function(t){return!lt(n,t)})}function _(t){return[t]}function M(t){return 0===t.length?$.none():$.some(t[t.length-1])}function F(t,e){return vt(t,function(t,n){return{k:n,v:e(t,n)}})}function I(t,n){for(var e=gt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return $.some(u)}return $.none()}function R(t){return bt(t,function(t){return t})}function V(t,n){return yt(t,n)?$.from(t[n]):$.none()}function H(e){var o,r=!1;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r||(r=!0,o=e.apply(null,t)),o}}function N(t){return Ct.defaultedThunk(G(t))}function P(n){return function(t){return yt(t,n)?$.from(t[n]):$.none()}}function z(t,n){return P(n)(t)}function L(t,n){var e={};return e[t]=n,e}function j(t,n){return e=n,o={},ht(t,function(t,n){lt(e,n)||(o[n]=t)}),o;var e,o}function U(t,n){return e=t,o=n,function(t){return yt(t,e)?t[e]:o};var e,o}function X(t){return n={},ft(t,function(t){n[t.key]=t.value}),n;var n}function Y(t,n){var e,o,r;return 0<(r=(e=[],o=[],ft(t,function(t){t.fold(function(t){e.push(t)},function(t){o.push(t)})}),{errors:e,values:o})).errors.length?(t=r.errors,tt.error(T(t))):(n=n,0===(r=r.values).length?tt.value(n):tt.value(St(n,kt.apply(void 0,r))))}function q(t,n){return yt(t=t,n=n)&&void 0!==t[n]&&null!==t[n]}var K,J=function(e){function t(){return r}function n(t){return t(e)}var o=G(e),r={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:a,isNone:u,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:t,orThunk:t,map:function(t){return J(t(e))},each:function(t){t(e)},bind:n,exists:n,forall:n,filter:function(t){return t(e)?r:s},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(u,function(t){return n(e,t)})}};return r},$={some:J,none:n,from:function(t){return null==t?s:J(t)}},Q=function(e){return{is:function(t){return e===t},isValue:a,isError:u,getOr:G(e),getOrThunk:G(e),getOrDie:G(e),or:function(t){return Q(e)},orThunk:function(t){return Q(e)},fold:function(t,n){return n(e)},map:function(t){return Q(t(e))},mapError:function(t){return Q(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return $.some(e)}}},Z=function(e){return{is:u,isValue:u,isError:a,getOr:l,getOrThunk:function(t){return t()},getOrDie:function(){return i(String(e))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,n){return t(e)},map:function(t){return Z(e)},mapError:function(t){return Z(t(e))},each:W,bind:function(t){return Z(e)},exists:u,forall:a,toOption:$.none}},tt={value:Q,error:Z,fromOption:function(t,n){return t.fold(function(){return Z(n)},Q)}},nt=(Ua=function(n){return function(t){return function(t){if(null===t)return"null";var n=typeof t;return"object"==n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(t)===n}})("string"),et=Ua("object"),ot=Ua("array"),rt=Ua("boolean"),it=Ua("function"),ut=Ua("number"),at=Array.prototype.slice,ct=Array.prototype.indexOf,st=Array.prototype.push,lt=function(t,n){return-1<r(t,n)},ft=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},dt=function(t){return 0===t.length?$.none():$.some(t[0])},mt=it(Array.from)?Array.from:function(t){return at.call(t)},gt=Object.keys,pt=Object.hasOwnProperty,ht=function(t,n){for(var e=gt(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},vt=function(t,e){var o={};return ht(t,function(t,n){n=e(t,n);o[n.k]=n.v}),o},bt=function(t,e){var o=[];return ht(t,function(t,n){o.push(e(t,n))}),o},yt=function(t,n){return pt.call(t,n)},xt=function(u){if(!ot(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],e={};return ft(u,function(t,o){var n=gt(t);if(1!==n.length)throw new Error("one and only one name per case");var r=n[0],i=t[r];if(void 0!==e[r])throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!ot(i))throw new Error("case arguments must be an array");a.push(r),e[r]=function(){var t=arguments.length;if(t!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=arguments[n];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[o].apply(null,e)},match:function(t){var n=gt(t);if(a.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+n.join(","));if(!D(a,function(t){return lt(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+a.join(", "));return t[r].apply(null,e)},log:function(t){b.console.log(t,{constructors:a,constructor:r,params:e})}}}}),e},wt=Object.prototype.hasOwnProperty,St=(Ga=function(u){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<t.length;o++){var r,i=t[o];for(r in i)wt.call(i,r)&&(e[r]=u(e[r],i[r]))}return e}})(function(t,n){return et(t)&&et(n)?St(t,n):n}),kt=Ga(function(t,n){return n}),Ct=xt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Ot=Ct.strict,Et=Ct.asOption,Tt=Ct.defaultedThunk,Dt=Ct.mergeWithThunk,Bt=(xt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),P),At=z,_t=L;function Mt(t,n,e){return t.stype===K.Error?n(t.serror):e(t.svalue)}function Ft(t){return{stype:K.Value,svalue:t}}function It(t){return{stype:K.Error,serror:t}}function Rt(t){return c(_n,T)(t)}function Vt(t){return et(t)&&100<gt(t).length?" removed due to size":JSON.stringify(t,null,2)}function Ht(t,n){return _n([{path:t,getErrorInfo:n}])}function Nt(e,o,r){return z(o,r).fold(function(){return t=r,n=o,Ht(e,function(){return'Could not find valid *strict* value for "'+t+'" in '+Vt(n)});var t,n},Bn)}function Pt(t,n,e){return n=z(t,n).fold(function(){return e(t)},l),Bn(n)}function zt(u,a,t,c){return t.fold(function(e,n,t,o){function r(t){return t=o.extract(u.concat([e]),c,t),In(t,function(t){return L(n,c(t))})}function i(t){return t.fold(function(){var t=L(n,c($.none()));return Bn(t)},function(t){t=o.extract(u.concat([e]),c,t);return In(t,function(t){return L(n,c($.some(t)))})})}return t.fold(function(){return Mn(Nt(u,a,e),r)},function(t){return Mn(Pt(a,e,t),r)},function(){return Mn(Bn(z(a,e)),i)},function(t){return Mn(function(n,t,e){t=z(n,t).map(function(t){return!0===t?e(n):t});return Bn(t)}(a,e,t),i)},function(t){var n=t(a),t=In(Pt(a,e,G({})),function(t){return St(n,t)});return Mn(t,r)})},function(t,n){n=n(a);return Bn(L(t,c(n)))})}function Lt(o){return{extract:function(e,t,n){return Fn(o(n,t),function(t){return n=t,Ht(e,function(){return n});var n})},toString:function(){return"val"},toDsl:function(){return Nn.itemOf(o)}}}function jt(t){var u=Ln(t),a=w(t,function(n,t){return t.fold(function(t){return St(n,_t(t,!0))},G(n))},{});return{extract:function(t,n,e){var o,r,i=rt(e)?[]:(i=gt(o=e),x(i,function(t){return q(o,t)})),i=x(i,function(t){return!q(a,t)});return 0===i.length?u.extract(t,n,e):(r=i,Ht(t,function(){return"There are unsupported fields: ["+r.join(", ")+"] specified"}))},toString:u.toString,toDsl:u.toDsl}}function Ut(r){return{extract:function(e,o,t){t=y(t,function(t,n){return r.extract(e.concat(["["+n+"]"]),o,t)});return Hn(t)},toString:function(){return"array("+r.toString()+")"},toDsl:function(){return Nn.arrOf(r)}}}function Wt(i,u){return{extract:function(n,e,o){var t,r=gt(o),r=(t=n,r=r,Ut(Lt(i)).extract(t,l,r));return Mn(r,function(t){t=y(t,function(t){return zn.field(t,t,Ot(),u)});return Ln(t).extract(n,e,o)})},toString:function(){return"setOf("+u.toString()+")"},toDsl:function(){return Nn.setOf(i,u)}}}function Gt(e,n,o,r,i){return At(r,i).fold(function(){return t=r,n=i,Ht(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+Vt(t)});var t,n},function(t){return t.extract(e.concat(["branch: "+i]),n,o)})}function Xt(r,i){return{extract:function(n,e,o){return At(o,r).fold(function(){return t=r,Ht(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(t){return Gt(n,e,o,i,t)})},toString:function(){return"chooseOn("+r+"). Possible values: "+gt(i)},toDsl:function(){return Nn.choiceOf(r,i)}}}function Yt(n){return Lt(function(t){return n(t).fold(_n,Bn)})}function qt(t,n,e){return Dn(function(t,n,e,o){e=n.extract([t],e,o);return Rn(e,function(t){return{input:o,errors:t}})}(t,n,l,e))}function Kt(t){return t.fold(function(t){throw new Error(Kn(t))},l)}function Jt(t,n,e){return Kt(qt(t,n,e))}function $t(t,n){return Xt(t,F(n,Ln))}function Qt(n){return Yt(function(t){return lt(n,t)?tt.value(t):tt.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')})}function Zt(t){return Gn(t,t,Ot(),jn())}function tn(t,n){return Gn(t,t,Ot(),n)}function nn(t){return tn(t,Zn)}function en(t,n){return Gn(t,t,Ot(),Qt(n))}function on(t,n){return Gn(t,t,Ot(),Ln(n))}function rn(t,n){return Gn(t,t,Ot(),Ut(n))}function un(t){return Gn(t,t,Et(),jn())}function an(t,n){return Gn(t,t,Et(),n)}function cn(t){return an(t,Qn)}function sn(t){return an(t,Zn)}function ln(t,n){return an(t,Ln(n))}function fn(t,n){return Gn(t,t,N(n),jn())}function dn(t,n,e){return Gn(t,t,N(n),e)}function mn(t,n){return dn(t,n,Zn)}function gn(t,n,e){return dn(t,n,Ln(e))}function pn(t,n){return Wn(t,n)}function hn(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)}function vn(t,n){return function(){return n===t}}function bn(t,n){return function(){return n===t}}function yn(t,n){var e=String(n).toLowerCase();return k(t,function(t){return t.search(e)})}function xn(t,n){return-1!==t.indexOf(n)}function wn(){return Me.get()}function Sn(t,n){if((t=t.dom()).nodeType!==Ve)return!1;if(void 0!==t.matches)return t.matches(n);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(n);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(n);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function kn(t){return t.nodeType!==Ve&&t.nodeType!==He||0===t.childElementCount}function Cn(t,n){return n=void 0===n?b.document:n.dom(),kn(n)?[]:y(n.querySelectorAll(t),me.fromDom)}function On(t,n){return t.dom()===n.dom()}function En(t,n){return On(t.element(),n.event().target())}(Ka=K=K||{})[Ka.Error=0]="Error",Ka[Ka.Value=1]="Value";var Tn=function(t){return t.fold(It,Ft)},Dn=function(t){return Mt(t,tt.error,tt.value)},Bn=Ft,An=function(t){var n=[],e=[];return ft(t,function(t){Mt(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},_n=It,Mn=function(t,n){return t.stype===K.Value?n(t.svalue):t},Fn=function(t,n){return t.stype===K.Error?n(t.serror):t},In=function(t,n){return t.stype===K.Value?{stype:K.Value,svalue:n(t.svalue)}:t},Rn=function(t,n){return t.stype===K.Error?{stype:K.Error,serror:n(t.serror)}:t},Vn=function(t,n){t=An(t);return 0<t.errors.length?Rt(t.errors):(t=t.values,n=n,0<t.length?Bn(St(n,kt.apply(void 0,t))):Bn(n))},Hn=function(t){t=An(t);return 0<t.errors.length?Rt(t.errors):Bn(t.values)},Nn=xt([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),Pn=xt([{field:["name","presence","type"]},{state:["name"]}]),zn=xt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Ln=function(o){return{extract:function(t,n,e){return function(n,e,t,o){t=y(t,function(t){return zt(n,e,t,o)});return Vn(t,{})}(t,e,o,n)},toString:function(){return"obj{\n"+y(o,function(t){return t.fold(function(t,n,e,o){return t+" -> "+o.toString()},function(t,n){return"state("+t+")"})}).join("\n")+"}"},toDsl:function(){return Nn.objOf(y(o,function(t){return t.fold(function(t,n,e,o){return Pn.field(t,e,o)},function(t,n){return Pn.state(t)})}))}}},jn=G(Lt(Bn)),Un=c(Ut,Ln),Wn=zn.state,Gn=zn.field,Xn=Lt(Bn),Yn=function(o){return{extract:function(t,n,e){return o().extract(t,n,e)},toString:function(){return o().toString()},toDsl:function(){return o().toDsl()}}},qn=function(n,t){return Wt(function(t){return Tn(n(t))},t)},Kn=function(t){return"Errors: \n"+function(t){t=10<t.length?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t;return y(t,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})}(t.errors)+"\n\nInput object: "+Vt(t.input)},Jn=Xt,$n=G(Xn),Qn=(tc=function(e,o){return Lt(function(t){var n=typeof t;return e(t)?Bn(t):_n("Expected type: "+o+" but got: "+n)})})(ut,"number"),Zn=tc(nt,"string"),te=tc(rt,"boolean"),ne=tc(it,"function"),ee=function(n){function t(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0}if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every(function(t){return ee(n[t])});case"Map":return t(n.keys(),ee)&&t(n.values(),ee);case"Set":return t(n.keys(),ee);default:return!1}},oe=Lt(function(t){return ee(t)?Bn(t):_n("Expected value to be acceptable for sending via postMessage")}),re=function(t){return tn(t,ne)},ie=function(t,n){return Gn(t,t,Ot(),Un(n))},ue=function(t){return an(t,ne)},ae=function(t,n){return dn(t,n,Qn)},ce=function(t,n,e){return dn(t,n,Qt(e))},se=function(t,n){return dn(t,n,te)},le=function(t,n){return dn(t,n,ne)},fe=function(t){var n=t,t=function(){return n};return{get:t,set:function(t){n=t},clone:function(){return fe(n)}}},de=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:G(t)}},me={fromHtml:function(t,n){n=(n||b.document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||1<n.childNodes.length)throw b.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return de(n.childNodes[0])},fromTag:function(t,n){t=(n||b.document).createElement(t);return de(t)},fromText:function(t,n){t=(n||b.document).createTextNode(t);return de(t)},fromDom:de,fromPoint:function(t,n,e){t=t.dom();return $.from(t.elementFromPoint(n,e)).map(de)}},ge=function(t,n){return hn(t,n,b.Node.DOCUMENT_POSITION_CONTAINED_BY)},pe=function(){return he(0,0)},he=function(t,n){return{major:t,minor:n}},ve={nu:he,detect:function(t,n){n=String(n).toLowerCase();return 0===t.length?pe():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};t=function(t){return Number(n.replace(e,"$"+t))};return he(t(1),t(2))}(t,n)},unknown:pe},be="Firefox",ye=function(t){var n=t.current;return{current:n,version:t.version,isEdge:vn("Edge",n),isChrome:vn("Chrome",n),isIE:vn("IE",n),isOpera:vn("Opera",n),isFirefox:vn(be,n),isSafari:vn("Safari",n)}},xe={unknown:function(){return ye({current:void 0,version:ve.unknown()})},nu:ye,edge:G("Edge"),chrome:G("Chrome"),ie:G("IE"),opera:G("Opera"),firefox:G(be),safari:G("Safari")},we="Windows",Se="Android",ke="Solaris",Ce="FreeBSD",Oe=function(t){var n=t.current;return{current:n,version:t.version,isWindows:bn(we,n),isiOS:bn("iOS",n),isAndroid:bn(Se,n),isOSX:bn("OSX",n),isLinux:bn("Linux",n),isSolaris:bn(ke,n),isFreeBSD:bn(Ce,n)}},Ee={unknown:function(){return Oe({current:void 0,version:ve.unknown()})},nu:Oe,windows:G(we),ios:G("iOS"),android:G(Se),linux:G("Linux"),osx:G("OSX"),solaris:G(ke),freebsd:G(Ce)},Te=function(t,e){return yn(t,e).map(function(t){var n=ve.detect(t.versionRegexes,e);return{current:t.name,version:n}})},De=function(t,e){return yn(t,e).map(function(t){var n=ve.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Be=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return xn(t,"edge/")&&xn(t,"chrome")&&xn(t,"safari")&&xn(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,nc=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/],search:function(t){return xn(t,"chrome")&&!xn(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return xn(t,"msie")||xn(t,"trident")}},{name:"Opera",versionRegexes:[nc,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:(ec=function(n){return function(t){return xn(t,n)}})("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ec("firefox")},{name:"Safari",versionRegexes:[nc,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(xn(t,"safari")||xn(t,"mobile/"))&&xn(t,"applewebkit")}}],Ae=[{name:"Windows",search:ec("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return xn(t,"iphone")||xn(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ec("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ec("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ec("linux"),versionRegexes:[]},{name:"Solaris",search:ec("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ec("freebsd"),versionRegexes:[]}],_e={browsers:G(Be),oses:G(Ae)},Me=fe(function(t,n){var e,o,r=_e.browsers(),i=_e.oses(),u=Te(r,t).fold(xe.unknown,xe.nu),a=De(i,t).fold(Ee.unknown,Ee.nu);return{browser:u,os:a,deviceType:(e=u,o=t,r=n,u=(i=a).isiOS()&&!0===/ipad/i.test(o),t=i.isiOS()&&!u,n=i.isiOS()||i.isAndroid(),a=n||r("(pointer:coarse)"),r=u||!t&&n&&r("(min-device-width:768px)"),n=t||n&&!r,e=e.isSafari()&&i.isiOS()&&!1===/safari/i.test(o),o=!n&&!r&&!e,{isiPad:G(u),isiPhone:G(t),isTablet:G(r),isPhone:G(n),isTouch:G(a),isAndroid:i.isAndroid,isiOS:i.isiOS,isWebView:G(e),isDesktop:G(o)})}}(b.navigator.userAgent,function(t){return b.window.matchMedia(t).matches})),Fe=(b.Node.ATTRIBUTE_NODE,b.Node.CDATA_SECTION_NODE,b.Node.COMMENT_NODE,b.Node.DOCUMENT_NODE),Ie=(b.Node.DOCUMENT_TYPE_NODE,b.Node.DOCUMENT_FRAGMENT_NODE,b.Node.ELEMENT_NODE),Re=b.Node.TEXT_NODE,Ve=(b.Node.PROCESSING_INSTRUCTION_NODE,b.Node.ENTITY_REFERENCE_NODE,b.Node.ENTITY_NODE,b.Node.NOTATION_NODE,Ie),He=Fe,Ne=wn().browser.isIE()?function(t,n){return ge(t.dom(),n.dom())}:function(t,n){t=t.dom(),n=n.dom();return t!==n&&t.contains(n)};function Pe(t,n,e,o,r){return t(e,o)?$.some(e):it(r)&&r(e)?$.none():n(e,o,r)}function ze(t){return t.dom().nodeName.toLowerCase()}function Le(t){return null!=(t=kr(t)?t.dom().parentNode:t.dom())&&t.ownerDocument.body.contains(t)}function je(t,n,e){for(var o=t.dom(),r=it(e)?e:G(!1);o.parentNode;){o=o.parentNode;var i=me.fromDom(o);if(n(i))return $.some(i);if(r(i))break}return $.none()}function Ue(t,n,e){return Pe(function(t,n){return n(t)},je,t,n,e)}function We(t,o){var r=function(t){for(var n=0;n<t.childNodes.length;n++){var e=me.fromDom(t.childNodes[n]);if(o(e))return $.some(e);e=r(t.childNodes[n]);if(e.isSome())return e}return $.none()};return r(t.dom())}function Ge(t){if(!q(t,"can")&&!q(t,"abort")&&!q(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return Jt("Extracting event.handler",jt([fn("can",G(!0)),fn("abort",G(!1)),fn("run",W)]),t)}function Xe(e){var n,o,r,i,t=(o=function(t){return t.can},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S(n,function(t,n){return t&&o(n).apply(void 0,e)},!0)}),u=(r=n=e,i=function(t){return t.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S(r,function(t,n){return t||i(n).apply(void 0,e)},!1)});return Ge({can:t,abort:u,run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];ft(e,function(t){t.run.apply(void 0,n)})}})}function Ye(t,n){vi(t,t.element(),n,{})}function qe(t,n,e){vi(t,t.element(),n,e)}function Ke(t){Ye(t,Jr())}function Je(t,n,e){vi(t,n,e,{})}function $e(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event())}function Qe(t,n){return{key:t,value:Ge({abort:n})}}function Ze(t){return{key:t,value:Ge({run:function(t,n){n.event().prevent()}})}}function to(t,n){return{key:t,value:Ge({run:n})}}function no(t,e,o){return{key:t,value:Ge({run:function(t,n){e.apply(void 0,[t,n].concat(o))}})}}function eo(t){return function(e){return{key:t,value:Ge({run:function(t,n){En(t,n)&&e(t,n)}})}}}function oo(t,n,e){var o,r,e=n.partUids[e];return r=e,to(o=t,function(t,n){t.getSystem().getByUid(r).each(function(t){$e(t,t.element(),o,n)})})}function ro(t,r){return to(t,function(n,t){var e=t.event(),o=n.getSystem().getByDom(e.target()).fold(function(){return Er(e.target(),function(t){return n.getSystem().getByDom(t).toOption()},G(!1)).getOr(n)},function(t){return t});r(n,o,t)})}function io(t){return to(t,function(t,n){n.cut()})}function uo(t,n){return eo(t)(n)}function ao(t){return t.slice(0).sort()}function co(n,t){if(!ot(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");ft(t,function(t){if(!nt(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")})}function so(t){return me.fromDom(t.dom().ownerDocument)}function lo(t){return me.fromDom(t.dom().ownerDocument.documentElement)}function fo(t){return me.fromDom(t.dom().ownerDocument.defaultView)}function mo(t){return $.from(t.dom().parentNode).map(me.fromDom)}function go(t){return $.from(t.dom().offsetParent).map(me.fromDom)}function po(t){return y(t.dom().childNodes,me.fromDom)}function ho(t,n){return t=t.dom().childNodes,$.from(t[n]).map(me.fromDom)}function vo(n,e){mo(n).each(function(t){t.dom().insertBefore(e.dom(),n.dom())})}function bo(t,n){var e;(e=t,$.from(e.dom().nextSibling).map(me.fromDom)).fold(function(){mo(t).each(function(t){Ci(t,n)})},function(t){vo(t,n)})}function yo(n,e){ho(n,0).fold(function(){Ci(n,e)},function(t){n.dom().insertBefore(e.dom(),t.dom())})}function xo(n,t){ft(t,function(t){Ci(n,t)})}function wo(t){t.dom().textContent="",ft(po(t),function(t){Oi(t)})}function So(t){var n,e=po(t);0<e.length&&(n=t,ft(e,function(t){vo(n,t)})),Oi(t)}function ko(t){return t.dom().innerHTML}function Co(t,n){var e=so(t).dom(),o=me.fromDom(e.createDocumentFragment()),e=function(t,n){n=(n||b.document).createElement("div");return n.innerHTML=t,po(me.fromDom(n))}(n,e);xo(o,e),wo(t),Ci(t,o)}function Oo(t,n,e){if(!(nt(e)||rt(e)||ut(e)))throw b.console.error("Invalid call to Attr.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")}function Eo(t,n,e){Oo(t.dom(),n,e)}function To(t,n){return null===(n=t.dom().getAttribute(n))?void 0:n}function Do(t,n){return!(!(t=t.dom())||!t.hasAttribute)&&t.hasAttribute(n)}function Bo(t,n){t.dom().removeAttribute(n)}function Ao(t){return n=t,t=!1,me.fromDom(n.dom().cloneNode(t));var n}function _o(t){var n=Ao(t);return t=n,n=me.fromTag("div"),t=me.fromDom(t.dom().cloneNode(!0)),Ci(n,t),ko(n)}function Mo(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Di+String(n)}function Fo(n){function t(t){return function(){throw new Error("The component must be in a context to send: "+t+"\n"+_o(n().element())+" is not in context.")}}return{debugInfo:G("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:G(!1)}}function Io(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:Ni(i)}},t}function Ro(t){return _t(Pi,t)}function Vo(o){return t=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return o.apply(void 0,[t.getApis()].concat([t].concat(n)))},e=(n=o).toString(),r=e.indexOf(")")+1,n=e.indexOf("("),i=e.substring(n+1,r-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Ni(i.slice(1))}},t;var t,n,e,r,i}function Ho(t,r){var i={};return ht(t,function(t,o){ht(t,function(t,n){var e=U(n,[])(i);i[n]=e.concat([r(o,t)])})}),i}function No(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}}function Po(n,t,e,o){var r=E({},t);function i(t){return w(t,function(t,n){return E(E({},n.modification),t)},{})}ft(e,function(t){r[t.name()]=t.exhibit(n,o)});var u=Ho(r,function(t,n){return{name:t,modification:n}}),t=w(u.classes,function(t,n){return n.modification.concat(t)},[]),e=i(u.attributes),u=i(u.styles);return No({classes:t,attributes:e,styles:u})}function zo(t){return t.cHandler}function Lo(t,n){return{name:G(t),handler:G(n)}}function jo(t,n,e){var o,r,n=E(E({},e),(o=t,r={},ft(n,function(t){r[t.name()]=t.handlers(o)}),r));return Ho(n,Lo)}function Uo(t){var r=it(t=t)?{can:G(!0),abort:G(!1),run:t}:t;return function(t,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];t=[t,n].concat(e);r.abort.apply(void 0,t)?n.stop():r.can.apply(void 0,t)&&r.run.apply(void 0,t)}}function Wo(t,n,e){return(n=n[e])?function(r,i,t,u){var n=t.slice(0);try{var e=n.sort(function(t,n){var e=t[i](),o=n[i](),t=u.indexOf(e),n=u.indexOf(o);if(-1===t)throw new Error("The ordering for "+r+" does not have an entry for "+e+".\nOrder specified: "+JSON.stringify(u,null,2));if(-1===n)throw new Error("The ordering for "+r+" does not have an entry for "+o+".\nOrder specified: "+JSON.stringify(u,null,2));return t<n?-1:n<t?1:0});return tt.value(e)}catch(t){return tt.error([t])}}("Event: "+e,"name",t,n).map(function(t){t=y(t,function(t){return t.handler()});return Xe(t)}):(e=e,t=t,tt.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(y(t,function(t){return t.name()}),null,2)]))}function Go(t){return qt("custom.definition",Ln([Gn("dom","dom",Ot(),Ln([Zt("tag"),fn("styles",{}),fn("classes",[]),fn("attributes",{}),un("value"),un("innerHtml")])),Zt("components"),Zt("uid"),fn("events",{}),fn("apis",{}),Gn("eventOrder","eventOrder",Ct.mergeWithThunk(G({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]})),$n()),un("domModification")]),t)}function Xo(t,n){return void 0===(n=To(t,n))||""===n?[]:n.split(" ")}function Yo(t){return void 0!==t.dom().classList}function qo(t,n){return function(t,n,e){e=Xo(t,n).concat([e]);return Eo(t,n,e.join(" ")),!0}(t,"class",n)}function Ko(t,n){return o=n,0<(t=x(Xo(e=t,n="class"),function(t){return t!==o})).length?Eo(e,n,t.join(" ")):Bo(e,n),0;var e,o}function Jo(t,n){Yo(t)?t.dom().classList.add(n):qo(t,n)}function $o(t){0===(Yo(t)?t.dom().classList:Xo(t,"class")).length&&Bo(t,"class")}function Qo(t,n){Yo(t)?t.dom().classList.remove(n):Ko(t,n),$o(t)}function Zo(t,n){return Yo(t)&&t.dom().classList.contains(n)}function tr(n,t){ft(t,function(t){Jo(n,t)})}function nr(n,t){ft(t,function(t){Qo(n,t)})}function er(t){return void 0!==t.style&&it(t.style.getPropertyValue)}function or(t,n,e){if(!nt(e))throw b.console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);er(t)&&t.style.setProperty(n,e)}function rr(t,n){er(t)&&t.style.removeProperty(n)}function ir(t,n,e){t=t.dom(),or(t,n,e)}function ur(t,n){var e=t.dom();ht(n,function(t,n){or(e,n,t)})}function ar(t,n){var e=t.dom(),o=b.window.getComputedStyle(e).getPropertyValue(n);return null===(n=""!==o||Le(t)?o:Wi(e,n))?void 0:n}function cr(t,n){return t=t.dom(),n=Wi(t,n),$.from(n).filter(function(t){return 0<t.length})}function sr(t,n,e){return t=me.fromTag(t),ir(t,n,e),cr(t,n).isSome()}function lr(t,n){var e=t.dom();rr(e,n),Do(t,"style")&&""===To(t,"style").replace(/^\s+|\s+$/g,"")&&Bo(t,"style")}function fr(t){return t.dom().offsetWidth}function dr(t){return t.dom().value}function mr(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom().value=n}function gr(t){var n,e,o=me.fromTag(t.tag);n=o,r=t.attributes,e=n.dom(),ht(r,function(t,n){Oo(e,n,t)}),tr(o,t.classes),ur(o,t.styles),t.innerHtml.each(function(t){return Co(o,t)});var r=t.domChildren;return xo(o,r),t.value.each(function(t){mr(o,t)}),t.uid,Fi(o,t.uid),o}function pr(t,n){return e=t,n=y(t=n,function(t){return ln(t.name(),[Zt("config"),fn("state",zi)])}),n=qt("component.behaviours",Ln(n),e.behaviours).fold(function(t){throw new Error(Kn(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},function(t){return t}),{list:t,data:F(n,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return n}})};var e}function hr(t){var n,e=(n=U("behaviours",{})(e=t),e=x(gt(n),function(t){return void 0!==n[t]}),y(e,function(t){return n[t].me}));return pr(t,e)}function vr(t,n,e){var o,r=E(E({},(o=t).dom),{uid:o.uid,domChildren:y(o.components,function(t){return t.element()})}),t={"alloy.base.modification":o=t.domModification.fold(function(){return No({})},No)};return o=o=0<n.length?Po(e,t,n,r):o,E(E({},r=r),{attributes:E(E({},r.attributes),o.attributes),styles:E(E({},r.styles),o.styles),classes:r.classes.concat(o.classes)})}function br(t,n,e){var o={"alloy.base.behaviour":t.events};return function(t,n,e,o){o=jo(t,e,o);return Ui(o,n)}(e,t.eventOrder,n,o).getOrDie()}function yr(t){var e,n,o,r,i,u,a,c=(s=Vi(t)).events,s=function(t){t=U("components",[])(t);return y(t,Yi)}(t=f(s,["events"])),c=E(E({},t),{events:E(E({},Ti),c),components:s});return tt.value((e=c,n=fe(Hi),o=Kt(Go(e)),s=hr(e),c=s.list,r=s.data,s=vr(o,c,r),i=gr(s),c=br(o,c,r),u=fe(o.components),a={getSystem:n.get,config:function(t){var n=r;return(it(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return it(r[t.name()])},spec:G(e),readState:function(t){return r[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){n.set(t)},disconnect:function(){n.set(Fo(l))},element:G(i),syncComponents:function(){var t=po(i),t=O(t,function(t){return n.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});u.set(t)},components:u.get,events:G(c)}));function l(){return a}}function xr(t){return t=me.fromText(t),Gi({element:t})}void 0!==b.window?b.window:Function("return this;")();var wr,Sr=(Ns=function(n){return function(t){return t.dom().nodeType===n}})(Ie),kr=Ns(Re),Cr=H(function(){return Or(me.fromDom(b.document))}),Or=function(t){t=t.dom().body;if(null==t)throw new Error("Body is not available yet");return me.fromDom(t)},Er=function(t,n,e){return Ue(t,function(t){return n(t).isSome()},e).bind(n)},Tr=G("touchstart"),Dr=G("touchmove"),Br=G("touchend"),Ar=G("touchcancel"),_r=G("mousedown"),Mr=G("mousemove"),Fr=G("mouseout"),Ir=G("mouseup"),Rr=G("mouseover"),Vr=G("focusin"),Hr=G("focusout"),Nr=G("keydown"),Pr=G("keyup"),zr=G("input"),Lr=G("change"),jr=G("click"),Ur=G("transitionend"),Wr=G("selectstart"),Gr={tap:G("alloy.tap")},Xr=G("alloy.focus"),Yr=G("alloy.blur.post"),qr=G("alloy.paste.post"),Kr=G("alloy.receive"),Jr=G("alloy.execute"),$r=G("alloy.focus.item"),Qr=Gr.tap,Zr=G("alloy.longpress"),ti=G("alloy.sandbox.close"),ni=G("alloy.typeahead.cancel"),ei=G("alloy.system.init"),oi=G("alloy.system.touchmove"),ri=G("alloy.system.touchend"),ii=G("alloy.system.scroll"),ui=G("alloy.system.resize"),ai=G("alloy.system.attached"),ci=G("alloy.system.detached"),si=G("alloy.system.dismissRequested"),li=G("alloy.system.repositionRequested"),fi=G("alloy.focusmanager.shifted"),di=G("alloy.slotcontainer.visibility"),mi=G("alloy.change.tab"),gi=G("alloy.dismiss.tab"),pi=G("alloy.highlight"),hi=G("alloy.dehighlight"),vi=function(t,n,e,o){o=E({target:n},o);t.getSystem().triggerEvent(e,n,F(o,G))},bi=X,yi=eo(ai()),xi=eo(ci()),wi=eo(ei()),Si=(wr=Jr(),function(t){return to(wr,t)}),ki=function(r,i){var e,u=r.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return co("required",r),co("optional",i),e=ao(u),k(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")}),function(n){var e=gt(n);D(r,function(t){return lt(e,t)})||function(t){throw new Error("All required keys ("+ao(r).join(", ")+") were not specified. Specified keys were: "+ao(t).join(", ")+".")}(e);var t=x(e,function(t){return!lt(u,t)});0<t.length&&function(){throw new Error("Unsupported keys for object: "+ao(t).join(", "))}();var o={};return ft(r,function(t){o[t]=G(n[t])}),ft(i,function(t){o[t]=G(Object.prototype.hasOwnProperty.call(n,t)?$.some(n[t]):$.none())}),o}},Ci=((Dk=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(n.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+e.length+" arguments");var o={};return ft(n,function(t,n){o[t]=G(e[n])}),o}})("element","offset"),function(t,n){t.dom().appendChild(n.dom())}),Oi=function(t){t=t.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},Ei=bi([{key:Xr(),value:Ge({can:function(t,n){var e,o=n.event().originator(),r=n.event().target();return e=r,!(On(n=o,t.element())&&!On(n,e))||(b.console.warn(Xr()+" did not get interpreted by the desired target. \nOriginator: "+_o(o)+"\nTarget: "+_o(r)+"\nCheck the "+Xr()+" event handlers"),!1)}})}]),Ti=Object.freeze({events:Ei}),Di=0,Bi=G("alloy-id-"),Ai=G("data-alloy-id"),_i=Bi(),Mi=Ai(),Fi=function(t,n){Object.defineProperty(t.dom(),Mi,{value:n,writable:!0})},Ii=function(t){t=Sr(t)?t.dom()[Mi]:null;return $.from(t)},Ri=Mo,Vi=l,Hi=Fo(),Ni=function(t){return y(t,function(t){return o=e="/*",e=(n=n=t).length-e.length,""!==o&&(n.length<o.length||n.substr(e,e+o.length)!==o)?t:t.substring(0,t.length-"/*".length);var n,e,o})},Pi=Mo("alloy-premade"),zi={init:function(){return Li({readState:function(){return"No State required"}})}},Li=function(t){return t},ji=function(t,n){return n=d.apply(void 0,[t.handler].concat(n)),t=t.purpose(),{cHandler:n,purpose:G(t)}},Ui=function(t,r){t=bt(t,function(e,o){return(1===e.length?tt.value(e[0].handler()):Wo(e,r,o)).map(function(t){var n=Uo(t),t=1<e.length?x(r[o],function(n){return h(e,function(t){return t.name()===n})}).join(" > "):e[0].name();return _t(o,{handler:n,purpose:G(t)})})});return Y(t,{})},Wi=function(t,n){return er(t)?t.style.getPropertyValue(n):""},Gi=function(t){var n=Jt("external.component",jt([Zt("element"),un("uid")]),t),e=fe(Fo());n.uid.each(function(t){Fi(n.element,t)});var o={getSystem:e.get,config:$.none,hasConfigured:G(!1),connect:function(t){e.set(t)},disconnect:function(){e.set(Fo(function(){return o}))},getApis:function(){return{}},element:G(n.element),spec:G(t),readState:G("No state"),syncComponents:W,components:G([]),events:G({})};return Ro(o)},Xi=Ri,Yi=function(n){return At(n,Pi).fold(function(){var t=n.hasOwnProperty("uid")?n:E({uid:Xi("")},n);return yr(t).getOrDie()},function(t){return t})},qi=Ro;function Ki(e,o){function t(t){var n=o(t);if(n<=0||null===n){t=ar(t,e);return parseFloat(t)||0}return n}function r(e,t){return S(t,function(t,n){n=ar(e,n),n=void 0===n?0:parseInt(n,10);return isNaN(n)?t:t+n},0)}return{set:function(t,n){if(!ut(n)&&!n.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+n);t=t.dom();er(t)&&(t.style[e]=n+"px")},get:t,getOuter:t,aggregate:r,max:function(t,n,e){e=r(t,e);return e<n?n-e:0}}}function Ji(t){return bu.get(t)}function $i(t){return bu.getOuter(t)}function Qi(t,n){return void 0!==t?t:void 0!==n?n:0}function Zi(t){var n=(i=t.dom().ownerDocument).body,e=i.defaultView,o=i.documentElement;if(n===t.dom())return xu(n.offsetLeft,n.offsetTop);var r=Qi(e.pageYOffset,o.scrollTop),i=Qi(e.pageXOffset,o.scrollLeft),e=Qi(o.clientTop,n.clientTop),n=Qi(o.clientLeft,n.clientLeft);return wu(t).translate(i-n,r-e)}function tu(t){return Su.get(t)}function nu(t){return Su.getOuter(t)}function eu(t){var t=(n=void 0!==t?t.dom():b.document).body.scrollLeft||n.documentElement.scrollLeft,n=n.body.scrollTop||n.documentElement.scrollTop;return xu(t,n)}function ou(t,n,e,o){return{x:G(t),y:G(n),width:G(e),height:G(o),right:G(t+e),bottom:G(n+o)}}function ru(t){var n=void 0===t?b.window:t,e=n.document,t=eu(me.fromDom(e));return void 0!==(n=n.visualViewport)?ou(Math.max(n.pageLeft,t.left()),Math.max(n.pageTop,t.top()),n.width,n.height):(n=e.documentElement,e=n.clientWidth,n=n.clientHeight,ou(t.left(),t.top(),e,n))}function iu(e){var t=me.fromDom(b.document),o=eu(t);return function(t,n){t=n.owner(t),t=ku(n,t);return $.some(t)}(e,Cu).fold(d(Zi,e),function(t){var n=wu(e),t=w(t,function(t,n){n=wu(n);return{left:t.left+n.left(),top:t.top+n.top()}},{left:0,top:0});return xu(t.left+n.left()+o.left(),t.top+n.top()+o.top())})}function uu(t,n,e,o){return{x:G(t),y:G(n),width:G(e),height:G(o),right:G(t+e),bottom:G(n+o)}}function au(t){var n=Zi(t),e=nu(t),t=$i(t);return uu(n.left(),n.top(),e,t)}function cu(t){var n=iu(t),e=nu(t),t=$i(t);return uu(n.left(),n.top(),e,t)}function su(){return ru(b.window)}function lu(t,n,e){return je(t,function(t){return Sn(t,n)},e)}function fu(t,n){return function(t,n){n=void 0===n?b.document:n.dom();return kn(n)?$.none():$.from(n.querySelector(t)).map(me.fromDom)}(n,t)}function du(t,n,e){return Pe(Sn,lu,t,n,e)}function mu(){var n=Mo("aria-owns");return{id:G(n),link:function(t){Eo(t,"aria-owns",n)},unlink:function(t){Bo(t,"aria-owns")}}}function gu(n,t){return Ue(t,function(t){if(!Sr(t))return!1;t=To(t,"id");return void 0!==t&&-1<t.indexOf("aria-owns")}).bind(function(t){var n=To(t,"id"),t=so(t);return fu(t,'[aria-owns="'+n+'"]')}).exists(function(t){return Tu(n,t)})}function pu(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n}function hu(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return $.none()}var vu,bu=Ki("height",function(t){var n=t.dom();return Le(t)?n.getBoundingClientRect().height:n.offsetHeight}),yu=function(e,o){return{left:G(e),top:G(o),translate:function(t,n){return yu(e+t,o+n)}}},xu=yu,wu=function(t){var n=t.dom(),e=n.ownerDocument.body;return e===n?xu(e.offsetLeft,e.offsetTop):Le(t)?function(t){t=t.getBoundingClientRect();return xu(t.left,t.top)}(n):xu(0,0)},Su=Ki("width",function(t){return t.dom().offsetWidth}),ku=(wn().browser.isSafari(),function(e,t){return e.view(t).fold(G([]),function(t){var n=e.owner(t),n=ku(e,n);return[t].concat(n)})}),Cu=Object.freeze({view:function(t){return(t.dom()===b.document?$.none():$.from(t.dom().defaultView.frameElement)).map(me.fromDom)},owner:so}),Ou=Dk("point","width","height"),Eu=Dk("x","y","width","height"),Tu=function(n,t){return e=t,r=G(!(o=function(t){return On(t,n.element())})),Ue(e,o,r).isSome()||gu(n,t);var e,o,r},Du="unknown";function Bu(n,t,e){var o,r,i,u;switch(At(da.get(),n).orThunk(function(){var t=gt(da.get());return hu(t,function(t){return-1<n.indexOf(t)?$.some(da.get()[t]):$.none()})}).getOr(vu.NORMAL)){case vu.NORMAL:return e(ga());case vu.LOGGING:var a=(o=n,r=t,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();lt(["mousemove","mouseover","mouseout",ei()],o)||b.console.log(o,{event:o,time:t-u,target:r.dom(),sequence:y(i,function(t){return lt(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+_o(t.target)+")":t.outcome})})}}),c=e(a);return a.write(),c;case vu.STOP:return!0}}function Au(t,n,e){var o;return void 0!==(o=new Error).stack&&(o=o.stack.split("\n"),k(o,function(n){return 0<n.indexOf("alloy")&&!h(ma,function(t){return-1<n.indexOf(t)})}).getOr(Du)),Gn(n,n,e,Yt(function(e){return tt.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(void 0,t)})}))}function _u(t,n){return pn(t,G(n))}function Mu(t){return pn(t,l)}function Fu(t,n){return t.x()+t.width()/2-n.width()/2}function Iu(t,n){return t.x()+t.width()-n.width()}function Ru(t,n){return t.y()-n.height()}function Vu(t){return t.y()+t.height()}function Hu(t,n){return t.y()+t.height()/2-n.height()/2}function Nu(t,n,e){return Ea(t.x(),Vu(t),e.southeast(),Ta(),"layout-se")}function Pu(t,n,e){return Ea(Iu(t,n),Vu(t),e.southwest(),Da(),"layout-sw")}function zu(t,n,e){return Ea(t.x(),Ru(t,n),e.northeast(),Ba(),"layout-ne")}function Lu(t,n,e){return Ea(Iu(t,n),Ru(t,n),e.northwest(),Aa(),"layout-nw")}function ju(t,n,e){return Ea((o=t).x()+o.width(),Hu(t,n),e.east(),Fa(),"layout-e");var o}function Uu(t,n,e){return Ea((o=n,t.x()-o.width()),Hu(t,n),e.west(),Ia(),"layout-w");var o}function Wu(){return[Nu,Pu,zu,Lu,Va,Ra]}function Gu(){return[Pu,Nu,Lu,zu,Va,Ra]}function Xu(e,o,r){return wi(function(t,n){r(t,e,o)})}function Yu(t,n,e,o,r,i){var u=jt(t),t=ln(n,[an("config",jt(t))]);return Ha(u,t,n,e,o,r,i)}function qu(r,i,u){var t,n,e,o,a,c;return t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[e].concat(t);return e.config({name:G(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(t){var n=Array.prototype.slice.call(o,1);return i.apply(void 0,[e,t.config,t.state].concat(n))})},n=u,o=(e=i).toString(),a=o.indexOf(")")+1,e=o.indexOf("("),c=o.substring(e+1,a-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:n,parameters:Ni(c.slice(0,1).concat(c.slice(3)))}},t}function Ku(t){return{key:t,value:void 0}}function Ju(t){return t=Jt("Creating behaviour: "+t.name,Pa,t),Yu(t.fields,t.name,t.active,t.apis,t.extra,t.state)}function $u(t){t.dom().focus()}function Qu(t){return t=void 0!==t?t.dom():b.document,$.from(t.activeElement).map(me.fromDom)}function Zu(n){return Qu(so(n)).filter(function(t){return n.dom().contains(t.dom())})}function ta(t,e){var o=so(e),n=Qu(o).bind(function(n){function t(t){return On(n,t)}return t(e)?$.some(e):We(e,t)}),t=t(e);return n.each(function(n){Qu(o).filter(function(t){return On(t,n)}).fold(function(){$u(n)},W)}),t}function na(t,n,e){function r(t){return At(e,t).getOr([])}function o(t,n,e){var o=A(Xa,e);return{offset:function(){return xu(t,n)},classesOn:function(){return O(e,r)},classesOff:function(){return O(o,r)}}}return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return o(-t,n,["top","alignRight"])},innerNortheast:function(){return o(t,n,["top","alignLeft"])},innerNorth:function(){return o(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return o(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return o(t,-n,["bottom","alignLeft"])},innerSouth:function(){return o(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return o(t,-n/2,["valignCentre","right"])},innerEast:function(){return o(-t,-n/2,["valignCentre","left"])}}}function ea(){return na(0,0,{})}function oa(t,n,e,o,r,i){var u=n.x()-e,a=n.y()-o,c=r-(u+n.width()),s=i-(a+n.height()),l=$.some(u),f=$.some(a),d=$.some(c),m=$.some(s),g=$.none();return e=n.direction(),o=function(){return qa(t,l,f,g,g)},r=function(){return qa(t,g,f,d,g)},i=function(){return qa(t,l,g,g,m)},u=function(){return qa(t,g,g,d,m)},a=function(){return qa(t,l,f,g,g)},c=function(){return qa(t,l,g,g,m)},s=function(){return qa(t,l,f,g,g)},n=function(){return qa(t,g,f,d,g)},e.fold(o,r,i,u,a,c,s,n)}function ra(t,n){var e=d(iu,n),o=t.fold(e,e,function(){var t=eu();return iu(n).translate(-t.left(),-t.top())}),t=nu(n),e=$i(n);return uu(o.left(),o.top(),t,e)}function ia(n,e){return function(t){return"rtl"===Za(t)?e:n}}function ua(n,t,e,o){return e=t.layouts.map(function(t){return t.onLtr(n)}).getOr(e),o=t.layouts.map(function(t){return t.onRtl(n)}).getOr(o),ia(e,o)(n)}function aa(t,n,e){var o,r,t=t.document.createRange();return o=t,n.fold(function(t){o.setStartBefore(t.dom())},function(t,n){o.setStart(t.dom(),n)},function(t){o.setStartAfter(t.dom())}),r=t,e.fold(function(t){r.setEndBefore(t.dom())},function(t,n){r.setEnd(t.dom(),n)},function(t){r.setEndAfter(t.dom())}),t}function ca(t,n,e,o,r){return(t=t.document.createRange()).setStart(n.dom(),e),t.setEnd(o.dom(),r),t}function sa(t){return{left:G(t.left),top:G(t.top),right:G(t.right),bottom:G(t.bottom),width:G(t.width),height:G(t.height)}}function la(t,n,e){return n(me.fromDom(e.startContainer),e.startOffset,me.fromDom(e.endContainer),e.endOffset)}function fa(t,n){var r,e,n=(r=t,n.match({domRange:function(t){return{ltr:G(t),rtl:$.none}},relative:function(t,n){return{ltr:H(function(){return aa(r,t,n)}),rtl:H(function(){return $.some(aa(r,n,t))})}},exact:function(t,n,e,o){return{ltr:H(function(){return ca(r,t,n,e,o)}),rtl:H(function(){return $.some(ca(r,e,o,t,n))})}}}));return(e=(n=n).ltr()).collapsed?n.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return ac.rtl(me.fromDom(t.endContainer),t.endOffset,me.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return la(0,ac.ltr,e)}):la(0,ac.ltr,e)}(al=vu=vu||{})[al.STOP=0]="STOP",al[al.NORMAL=1]="NORMAL",al[al.LOGGING=2]="LOGGING";var da=fe({}),ma=["alloy/data/Fields","alloy/debugging/Debugging"],ga=G({logEventCut:W,logEventStopped:W,logNoParent:W,logEventNoHandlers:W,logEventResponse:W,write:W}),pa=G([Zt("menu"),Zt("selectedMenu")]),ha=G([Zt("item"),Zt("selectedItem")]),va=(G(Ln(ha().concat(pa()))),G(Ln(ha()))),ba=on("initSize",[Zt("numColumns"),Zt("numRows")]),ya=function(){return on("markers",[Zt("backgroundMenu")].concat(pa()).concat(ha()))},xa=function(t){return on("markers",y(t,Zt))},wa=function(t){return Au(0,t,N(W))},Sa=function(t){return Au(0,t,N($.none))},ka=function(t){return Au(0,t,Ot())},Ca=function(t){return Au(0,t,Ot())},Oa=G(ba),Ea=Dk("x","y","bubble","direction","label"),Ta=(cl=xt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}])).southeast,Da=cl.southwest,Ba=cl.northeast,Aa=cl.northwest,_a=cl.south,Ma=cl.north,Fa=cl.east,Ia=cl.west,Ra=function(t,n,e){return Ea(Fu(t,n),Ru(t,n),e.north(),Ma(),"layout-n")},Va=function(t,n,e){return Ea(Fu(t,n),Vu(t),e.south(),_a(),"layout-s")},Ha=function(e,t,o,r,n,i,u){function a(t){return q(t,o)?t[o]():$.none()}var n=F(n,function(t,n){return qu(o,t,n)}),i=F(i,Io),c=E(E(E({},i),n),{revoke:d(Ku,o),config:function(t){var n=Jt(o+"-config",e,t);return{key:o,value:{config:n,me:c,configAsRaw:H(function(){return Jt(o+"-config",e,t)}),initialConfig:t,state:u}}},schema:function(){return t},exhibit:function(t,e){return a(t).bind(function(n){return At(r,"exhibit").map(function(t){return t(e,n.config,n.state)})}).getOr(No({}))},name:function(){return o},handlers:function(t){return a(t).map(function(t){return U("events",function(t,n){return{}})(r)(t.config,t.state)}).getOr({})}});return c},Na=X,Pa=jt([Zt("fields"),Zt("name"),fn("active",{}),fn("apis",{}),fn("state",zi),fn("extra",{})]),za=jt([Zt("branchKey"),Zt("branches"),Zt("name"),fn("active",{}),fn("apis",{}),fn("state",zi),fn("extra",{})]),La=function(t){var n,e,o,r,i,u=Jt("Creating behaviour: "+t.name,za,t);return n=$t(u.branchKey,u.branches),e=u.name,o=u.active,r=u.apis,i=u.extra,t=u.state,n=ln(e,[an("config",u=n)]),Ha(u,n,e,o,r,i,t)},ja=G(void 0),n=Object.freeze({events:function(e){return bi([to(Kr(),function(o,r){var n,i=e.channels,t=gt(i),t=(t=t,(n=r).universal()?t:x(t,function(t){return lt(n.channels(),t)}));ft(t,function(t){var n=i[t],e=n.schema,e=Jt("channel["+t+"] data\nReceiver: "+_o(o.element()),e,r.data());n.onReceive(o,e)})})])}}),Ua=[tn("channels",qn(tt.value,jt([ka("onReceive"),fn("schema",$n())])))],Wa=Ju({fields:Ua,name:"receiving",active:n}),Ga=Object.freeze({exhibit:function(t,n){return No({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Xa=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Ya=ki(["x","y","width","height","maxHeight","maxWidth","direction","classes","label","candidateYforTest"],[]),qa=Dk("position","left","top","right","bottom"),Ka=xt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Ja=function(t,n,e){var o=xu(n,e);return t.fold(G(o),G(o),function(){var t=eu();return o.translate(-t.left(),-t.top())})},$a=Ka.relative,Qa=Ka.fixed,Za=function(t){return"rtl"===ar(t,"direction")?"rtl":"ltr"},tc=function(){return ln("layouts",[Zt("onLtr"),Zt("onRtl")])},nc=[Zt("hotspot"),un("bubble"),fn("overrides",{}),tc(),_u("placement",function(t,n,e){var o=n.hotspot,o=ra(e,o.element()),t=ua(t.element(),n,Wu(),Gu());return $.some({anchorBox:o,bubble:n.bubble.getOr(ea()),overrides:n.overrides,layouts:t,placer:$.none()})})],ec=[Zt("x"),Zt("y"),fn("height",0),fn("width",0),fn("bubble",ea()),fn("overrides",{}),tc(),_u("placement",function(t,n,e){e=Ja(e,n.x,n.y),e=uu(e.left(),e.top(),n.width,n.height),t=ua(t.element(),n,[Nu,Pu,zu,Lu,Va,Ra,ju,Uu],[Pu,Nu,Lu,zu,Va,Ra,ju,Uu]);return $.some({anchorBox:e,bubble:n.bubble,overrides:n.overrides,layouts:t,placer:$.none()})})],oc={create:Dk("start","soffset","finish","foffset")},rc=((Be=xt([{before:["element"]},{on:["element","offset"]},{after:["element"]}])).before,Be.on,Be.after,function(t){return t.fold(l,l,l)}),ic=xt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),uc={domRange:ic.domRange,relative:ic.relative,exact:ic.exact,exactFromRange:function(t){return ic.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){t=t.match({domRange:function(t){return me.fromDom(t.startContainer)},relative:function(t,n){return rc(t)},exact:function(t,n,e,o){return t}});return fo(t)},range:oc.create},ac=xt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);function cc(t){return Bs.get(t)}function sc(t){return Bs.getOption(t)}function lc(t){return sc(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf(" ")}).isSome()||lt(As,ze(t))}function fc(t){return _s(t,lc)}function dc(t,n){return Cn(n,t)}function mc(t,n,e,o){var r,i,u,a,c=(i=n,u=e,a=o,(c=so(r=t).dom().createRange()).setStart(r.dom(),i),c.setEnd(u.dom(),a),c),o=On(t,e)&&n===o;return c.collapsed&&!o}function gc(t){var n=me.fromDom(t.anchorNode),e=me.fromDom(t.focusNode);return mc(n,t.anchorOffset,e,t.focusOffset)?$.some(oc.create(n,t.anchorOffset,e,t.focusOffset)):function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),t=t.getRangeAt(t.rangeCount-1);return $.some(oc.create(me.fromDom(n.startContainer),n.startOffset,me.fromDom(t.endContainer),t.endOffset))}return $.none()}(t)}function pc(t,n){var i,t=fa(i=t,n).match({ltr:function(t,n,e,o){var r=i.document.createRange();return r.setStart(t.dom(),n),r.setEnd(e.dom(),o),r},rtl:function(t,n,e,o){var r=i.document.createRange();return r.setStart(e.dom(),o),r.setEnd(t.dom(),n),r}});return 0<(n=0<(t=(n=t).getClientRects()).length?t[0]:n.getBoundingClientRect()).width||0<n.height?$.some(n).map(sa):$.none()}function hc(t){return t.fold(function(t){return t},function(t,n,e){return t.translate(-n,-e)})}function vc(t){return t.fold(function(t){return t},function(t,n,e){return t})}function bc(t){return S(t,function(t,n){return t.translate(n.left(),n.top())},xu(0,0))}function yc(t){return t=y(t,vc),bc(t)}function xc(t,n,e){var o=so(t.element()),o=eu(o),e=function(e,t){t=fo(t.root).dom();return $.from(t.frameElement).map(me.fromDom).filter(function(t){var n=so(t),t=so(e.element());return On(n,t)}).map(Zi)}(t,e).getOr(o);return Is(e,o.left(),o.top())}function wc(t,n){return(kr(t)?Hs:function(t,n){var e=po(t);if(0===e.length)return Ms(t,n);if(n<e.length)return Ms(e[n],0);n=e[e.length-1],e=(kr(n)?cc:po)(n).length;return Ms(n,e)})(t,n)}function Sc(n,t){return t.getSelection.getOrThunk(function(){return function(){return t=n,$.from(t.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(gc);var t}})().map(function(t){var n=wc(t.start(),t.soffset()),t=wc(t.finish(),t.foffset());return uc.range(n.element(),n.offset(),t.element(),t.offset())})}function kc(t){return t.x()+t.width()}function Cc(t,n){return t.x()-n.width()}function Oc(t,n){return t.y()-n.height()+t.height()}function Ec(t,n,e){return Ea(kc(t),t.y(),e.southeast(),Ta(),"link-layout-se")}function Tc(t,n,e){return Ea(Cc(t,n),t.y(),e.southwest(),Da(),"link-layout-sw")}function Dc(t,n,e){return Ea(kc(t),Oc(t,n),e.northeast(),Ba(),"link-layout-ne")}function Bc(t,n,e){return Ea(Cc(t,n),Oc(t,n),e.northwest(),Aa(),"link-layout-nw")}function Ac(t,n,e,o){return o<(n=t+n)?e:n<e?o:n}function _c(t,n,e){return t<=n?n:e<=t?e:t}function Mc(t,n,e,o){var r,i=t.x(),u=t.y(),a=t.bubble().offset().left(),c=t.bubble().offset().top(),s=o.y(),l=o.bottom(),f=o.x(),d=o.right(),e=(u=(m=i+a,g=b=u+c,h=n,v=e,r=(p=o).x(),u=p.y(),c=p.width(),i=p.height(),a=u<=g,e=(n=r<=m)&&a,o=m+h<=r+c&&g+v<=u+i,h=Math.abs(Math.min(h,n?r+c-m:r-(m+h))),v=Math.abs(Math.min(v,a?u+i-g:u-(g+v))),{originInBounds:e,sizeInBounds:o,limitX:_c(m,p.x(),p.right()),limitY:_c(g,p.y(),p.bottom()),deltaW:h,deltaH:v})).originInBounds,o=u.sizeInBounds,m=u.limitX,g=u.limitY,p=u.deltaW,h=u.deltaH,v=G(g+h-s),u=G(l-g),l=(s=t.direction(),u=l=u,v=v,s.fold(l,l,v,v,l,v,u,u)),v=G(m+p-f),u=G(d-m),v=(f=t.direction(),u=d=u,v=v,f.fold(d,v,d,v,u,u,d,v)),b=Ya({x:m,y:g,width:p,height:h,maxHeight:l,maxWidth:v,direction:t.direction(),classes:{on:t.bubble().classesOn(),off:t.bubble().classesOff()},label:t.label(),candidateYforTest:b});return e&&o?Ls.fit(b):Ls.nofit(b,p,h)}function Fc(t,n,e,u,a){function o(t,o,r,i){return t=t(n,e,u),Mc(t,c,s,a).fold(Ls.fit,function(t,n,e){return i<e||r<n?Ls.nofit(t,n,e):Ls.nofit(o,r,i)})}var c=e.width(),s=e.height();return S(t,function(t,n){n=d(o,n);return t.fold(Ls.fit,n)},Ls.nofit(Ya({x:n.x(),y:n.y(),width:e.width(),height:e.height(),maxHeight:e.height(),maxWidth:e.width(),direction:Ta(),classes:{on:[],off:[]},label:"none",candidateYforTest:n.y()}),-1,-1)).fold(l,l)}function Ic(t,n,e,o){return lr(n,"max-height"),lr(n,"max-width"),n={width:G(nu(n=n)),height:G($i(n))},Fc(o.preference(),t,n,e,o.bounds())}function Rc(t,n,e){var r,o,i=function(t){return t+"px"},e=(e=e.origin(),r=n,e.fold(function(){return qa("absolute",$.some(r.x()),$.some(r.y()),$.none(),$.none())},function(t,n,e,o){return oa("absolute",r,t,n,e,o)},function(t,n,e,o){return oa("fixed",r,t,n,e,o)}));t=t,i={position:$.some(e.position()),left:e.left().map(i),top:e.top().map(i),right:e.right().map(i),bottom:e.bottom().map(i)},o=t.dom(),ht(i,function(t,n){t.fold(function(){rr(o,n)},function(t){or(o,n,t)})})}function Vc(t,n){t=t,n=Math.floor(n),n=bu.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),ir(t,"max-height",n+"px")}function Hc(t,n,e){return void 0===t[n]?e:t[n]}function Nc(t,n,e,o,r,i){var u,a=Hc(i,"maxHeightFunction",js()),c=Hc(i,"maxWidthFunction",W),i=t.anchorBox(),t=t.origin(),c=Ws({bounds:(u=t,r.fold(function(){return u.fold(su,su,uu)},function(e){return u.fold(e,e,function(){var t=e(),n=Ja(u,t.x(),t.y());return uu(n.left(),n.top(),t.width(),t.height())})})),origin:t,preference:o,maxHeightFunction:a,maxWidthFunction:c});Gs(i,n,e,c)}function Pc(t,n,e,o,r){var i,n=(i=e.anchorBox,zs(i,n));Nc(n,r.element(),e.bubble,e.layouts,o,e.overrides)}function zc(t,n){Ci(t.element(),n.element())}function Lc(n,t){var e,o=n.components();ft((e=n).components(),function(t){return Oi(t.element())}),wo(e.element()),e.syncComponents(),o=A(o,t),ft(o,function(t){Ks(t),n.getSystem().removeFromWorld(t)}),ft(t,function(t){t.getSystem().isConnected()?zc(n,t):(n.getSystem().addToWorld(t),zc(n,t),Le(n.element())&&Js(t)),n.syncComponents()})}function jc(t,n){$s(t,n,Ci)}function Uc(t){Ks(t),Oi(t.element()),t.getSystem().removeFromWorld(t)}function Wc(n){var t=mo(n.element()).bind(function(t){return n.getSystem().getByDom(t).toOption()});Uc(n),t.each(function(t){t.syncComponents()})}function Gc(t){var n=t.components();ft(n,Uc),wo(t.element()),t.syncComponents()}function Xc(t,n){Qs(t,n,Ci)}function Yc(n){var t=po(n.element());ft(t,function(t){n.getByDom(t).each(Ks)}),Oi(n.element())}function qc(n,t,e,o){return e.get().each(function(t){Gc(n)}),t=t.getAttachPoint(n),jc(t,n),o=n.getSystem().build(o),jc(n,o),e.set(o),o}function Kc(t,n,e,o){return o=qc(t,n,e,o),n.onOpen(t,o),o}function Jc(n,e,o){o.get().each(function(t){Gc(n),Wc(n),e.onClose(n,t),o.clear()})}function $c(t,n,e){return e.isOpen()}function Qc(t){var e=Jt("Dismissal",il,t);return(t={})[el()]={schema:jt([Zt("target")]),onReceive:function(n,t){nl.isOpen(n)&&(nl.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold(function(){return nl.close(n)},function(t){return Ye(n,t.event)}))}},t}function Zc(t){var e=Jt("Reposition",ul,t);return(t={})[ol()]={onReceive:function(n){nl.isOpen(n)&&e.fireEventInstead.fold(function(){return e.doReposition(n)},function(t){return Ye(n,t.event)})}},t}function ts(t,n,e){n.store.manager.onLoad(t,n,e)}function ns(t,n,e){n.store.manager.onUnload(t,n,e)}function es(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)}function os(t){return t.dump}function rs(t,n){return E(E({},t.dump),Na(n))}function is(t,n,e,o){return e.uiType===dl?(i=e,u=o,(r=t).exists(function(t){return t!==i.owner})?ml.single(!0,G(i)):At(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+gt(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(t){return t.replace()})):ml.single(!1,G(e));var r,i,u}function us(n,e,t,o){var r,i,u,o=F(o,function(t,n){return o=t,r=!1,{name:G(e=n),required:function(){return o.fold(function(t,n){return t},function(t,n){return t})},used:function(){return r},replace:function(){if(!0===r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r}),t=(r=n,i=e,u=o,O(t,function(t){return gl(r,i,t,u)}));return ht(o,function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))}),t}function as(t){return t.fold($.some,$.none,$.some,$.some)}function cs(t){function n(t){return t.name}return t.fold(n,n,n,n)}function ss(t,n,e,o){return St(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))}function ls(r,t){var n={};return ft(t,function(t){as(t).each(function(e){var o=wl(r,e.pname);n[e.name]=function(t){var n=Jt("Part: "+e.name+" in "+r,Ln(e.schema),t);return E(E({},o),{config:t,validated:n})}})}),n}function fs(t,n,e){return{uiType:vl(),owner:t,name:n,config:e,validated:{}}}function ds(t){return O(t,function(t){return t.fold($.none,$.some,$.none,$.none).map(function(t){return on(t.name,t.schema.concat([Mu(xl())]))}).toArray()})}function ms(t){return y(t,cs)}function gs(t,n,e){return o=n,i={},r={},ft(e,function(t){t.fold(function(o){i[o.pname]=pl(!0,function(t,n,e){return o.factory.sketch(ss(t,o,n,e))})},function(t){var n=o.parts[t.name];r[t.name]=G(t.factory.sketch(ss(o,t,n[xl()]),n))},function(o){i[o.pname]=pl(!1,function(t,n,e){return o.factory.sketch(ss(t,o,n,e))})},function(r){i[r.pname]=hl(!0,function(n,t,e){var o=n[r.name];return y(o,function(t){return r.factory.sketch(St(r.defaults(n,t,e),t,r.overrides(n,t)))})})})}),{internals:G(i),externals:G(r)};var o,i,r}function ps(t,n,e){return us($.some(t),n,n.components,e)}function hs(t,n,e){return e=n.partUids[e],t.getSystem().getByUid(e).toOption()}function vs(t,n,e){return hs(t,n,e).getOrDie("Could not find part: "+e)}function bs(t,n,e){var o={},r=n.partUids,i=t.getSystem();return ft(e,function(t){o[t]=G(i.getByUid(r[t]))}),o}function ys(t,n){var e=t.getSystem();return F(n.partUids,function(t,n){return G(e.getByUid(t))})}function xs(t){return gt(t.partUids)}function ws(t,n,e){var o={},r=n.partUids,i=t.getSystem();return ft(e,function(t){o[t]=G(i.getByUid(r[t]).getOrDie())}),o}function Ss(n,t){return t=ms(t),X(y(t,function(t){return{key:t,value:n+"-"+t}}))}function ks(n){return Gn("partUids","partUids",Dt(function(t){return Ss(t.uid,n)}),$n())}function Cs(t,n,e,o,r){return r=r,r=(0<(o=o).length?[on("parts",o)]:[]).concat([Zt("uid"),fn("dom",{}),fn("components",[]),Mu("originalSpec"),fn("debug.sketcher",{})]).concat(r),Jt(t+" [SpecSchema]",jt(r.concat(n)),e)}function Os(t,n,e,o,r){var i=Sl(r),u=ds(e),r=ks(e),r=Cs(t,n,i,u,[r]),e=gs(0,r,e);return o(r,ps(t,r,e.internals()),i,e.externals())}var Es,Ts,Ds,Bs=(Es=kr,{get:function(t){if(!Es(t))throw new Error("Can only get "+Ts+" value of a "+Ts+" node");return Ds(t).getOr("")},getOption:Ds=function(t){return Es(t)?$.from(t.dom().nodeValue):$.none()},set:function(t,n){if(!Es(t))throw new Error("Can only set raw "+Ts+" value of a "+Ts+" node");t.dom().nodeValue=n}}),As=["img","br"],_s=function(t,r){var i=function(t){for(var n=po(t),e=n.length-1;0<=e;e--){var o=n[e];if(r(o))return $.some(o);o=i(o);if(o.isSome())return o}return $.none()};return i(t)},Ms=(Ts="text",document.caretPositionFromPoint||document.caretRangeFromPoint,Dk("element","offset")),Fs=(Ae=xt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}])).screen,Is=Ae.absolute,Rs=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);i=Fs(xu(r,i));return $.some(Ou(i,u,a))},Vs=function(t,i,u,a,c){return t.map(function(t){var n,e,o=[i,t.point()],r=(n=function(){return yc(o)},e=function(){return yc(o)},r=function(){return function(t){t=y(t,hc);return bc(t)}(o)},a.fold(n,e,r)),r=Eu(r.left(),r.top(),t.width(),t.height()),t=ua(c,u,u.showAbove?[zu,Lu,Nu,Pu,Ra,Va]:[Nu,Pu,zu,Lu,Va,Va],u.showAbove?[Lu,zu,Pu,Nu,Ra,Va]:[Pu,Nu,Lu,zu,Va,Ra]);return{anchorBox:r,bubble:u.bubble.getOr(ea()),overrides:u.overrides,layouts:t,placer:$.none()}})},Hs=Dk("element","offset"),Fe=[un("getSelection"),Zt("root"),un("bubble"),tc(),fn("overrides",{}),fn("showAbove",!1),_u("placement",function(t,n,e){var o=fo(n.root).dom(),r=xc(t,0,n),i=Sc(o,n).bind(function(t){return pc(o,uc.exactFromRange(t)).orThunk(function(){var n=me.fromText("\ufeff");return vo(t.start(),n),pc(o,uc.exact(n,0,n,1)).map(function(t){return Oi(n),t})}).bind(function(t){return Rs(t.left(),t.top(),t.width(),t.height())})}),t=Sc(o,n).bind(function(t){return Sr(t.start())?$.some(t.start()):mo(t.start())}).getOr(t.element());return Vs(i,r,n,e,t)})],Ie=[Zt("node"),Zt("root"),un("bubble"),tc(),fn("overrides",{}),fn("showAbove",!1),_u("placement",function(e,o,r){var i=xc(e,0,o);return o.node.bind(function(t){var n=t.dom().getBoundingClientRect(),t=Rs(n.left,n.top,n.width,n.height),n=o.node.getOr(e.element());return Vs(t,i,o,r,n)})})],Ns=[Zt("item"),tc(),fn("overrides",{}),_u("placement",function(t,n,e){e=ra(e,n.item.element()),t=ua(t.element(),n,[Ec,Tc,Dc,Bc],[Tc,Ec,Bc,Dc]);return $.some({anchorBox:e,bubble:ea(),overrides:n.overrides,layouts:t,placer:$.none()})})],Ps=$t("anchor",{selection:Fe,node:Ie,hotspot:nc,submenu:Ns,makeshift:ec}),zs=Dk("anchorBox","origin"),Ls=xt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),js=G(function(t,n){Vc(t,n),ur(t,{"overflow-x":"hidden","overflow-y":"auto"})}),Us=G(function(t,n){Vc(t,n)}),Ws=ki(["bounds","origin","preference","maxHeightFunction","maxWidthFunction"],[]),Gs=function(t,n,e,o){var r=Ic(t,n,e,o);Rc(n,r,o),t=n,e=(e=r).classes(),nr(t,e.off),tr(t,e.on),t=n,e=r,o.maxHeightFunction()(t,e.maxHeight()),n=n,r=r,o.maxWidthFunction()(n,r.maxWidth())},Xs=function(t,n,e,o,r,i){i=i.map(au);return Ys(t,n,e,o,r,i)},Ys=function(i,u,t,n,a,c){var s=Jt("positioning anchor.info",Ps,n);ta(function(){ir(a.element(),"position","fixed");var t=cr(a.element(),"visibility");ir(a.element(),"visibility","hidden");var n,e=u.useFixed()?(n=b.document.documentElement,Qa(0,0,n.clientWidth,n.clientHeight)):(n=Zi((o=i).element()),o=o.element().dom().getBoundingClientRect(),$a(n.left(),n.top(),o.width,o.height)),o=s.placement,r=c.map(G).or(u.getBounds);o(i,s,e).each(function(t){t.placer.getOr(Pc)(i,e,t,r,a)}),t.fold(function(){lr(a.element(),"visibility")},function(t){ir(a.element(),"visibility",t)}),cr(a.element(),"left").isNone()&&cr(a.element(),"top").isNone()&&cr(a.element(),"right").isNone()&&cr(a.element(),"bottom").isNone()&&cr(a.element(),"position").is("fixed")&&lr(a.element(),"position")},a.element())},Re=Object.freeze({position:function(t,n,e,o,r){Xs(t,n,e,o,r,$.none())},positionWithin:Xs,positionWithinBounds:Ys,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),Gr=[fn("useFixed",u),un("getBounds")],qs=Ju({fields:Gr,name:"positioning",active:Ga,apis:Re}),Ks=function(t){Ye(t,ci());t=t.components();ft(t,Ks)},Js=function(t){var n=t.components();ft(n,Js),Ye(t,ai())},$s=function(t,n,e){t.getSystem().addToWorld(n),e(t.element(),n.element()),Le(t.element())&&Js(n),t.syncComponents()},Qs=function(t,n,e){e(t,n.element());t=po(n.element());ft(t,function(t){n.getByDom(t).each(Js)})},Zs=function(t,n,e){var o,r,i=n.getAttachPoint(t);ir(t.element(),"position",qs.getMode(i)),o=t,t="visibility",r=n.cloakVisibilityAttr,n="hidden",cr(o.element(),t).fold(function(){Bo(o.element(),r)},function(t){Eo(o.element(),r,t)}),ir(o.element(),t,n)},tl=function(t,n,e){var o,r;o=t.element(),h(["top","left","right","bottom"],function(t){return cr(o,t).isSome()})||lr(t.element(),"position"),r=t,t="visibility",n=n.cloakVisibilityAttr,Do(r.element(),n)?(n=To(r.element(),n),ir(r.element(),t,n)):lr(r.element(),t)},Ei=Object.freeze({cloak:Zs,decloak:tl,open:Kc,openWhileCloaked:function(t,n,e,o,r){Zs(t,n),Kc(t,n,e,o),r(),tl(t,n)},close:Jc,isOpen:$c,isPartOf:function(n,e,t,o){return $c(0,0,t)&&t.get().exists(function(t){return e.isPartOf(n,t,o)})},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map(function(){return qc(t,n,e,o)})}}),Bi=Object.freeze({events:function(e,o){return bi([to(ti(),function(t,n){Jc(t,e,o)})])}}),Ai=[wa("onOpen"),wa("onClose"),Zt("isPartOf"),Zt("getAttachPoint"),fn("cloakVisibilityAttr","data-precloak-visibility")],nl=Ju({fields:Ai,name:"sandboxing",active:Bi,apis:Ei,state:Object.freeze({init:function(){var n=fe($.none()),t=G("not-implemented");return Li({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set($.none())},set:function(t){n.set($.some(t))},get:function(t){return n.get()}})}})}),el=G("dismiss.popups"),ol=G("reposition.popups"),rl=G("mouse.released"),il=jt([fn("isExtraPart",G(!1)),ln("fireEventInstead",[fn("event",si())])]),ul=jt([fn("isExtraPart",G(!1)),ln("fireEventInstead",[fn("event",li())]),re("doReposition")]),al=Object.freeze({onLoad:ts,onUnload:ns,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),ba=Object.freeze({events:function(e,o){var t=e.resetOnDom?[yi(function(t,n){ts(t,e,o)}),xi(function(t,n){ns(t,e,o)})]:[Xu(e,o,ts)];return bi(t)}}),cl=function(){var t=fe(null);return Li({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},Ua=function(){var i=fe({}),u=fe({});return Li({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(t){return At(i.get(),t).orThunk(function(){return At(u.get(),t)})},update:function(t){var n=i.get(),e=u.get(),o={},r={};ft(t,function(n){o[n.value]=n,At(n,"meta").each(function(t){At(t,"text").each(function(t){r[t]=n})})}),i.set(E(E({},n),o)),u.set(E(E({},e),r))},clear:function(){i.set({}),u.set({})}})},n=Object.freeze({memory:cl,dataset:Ua,manual:function(){return Li({readState:function(){}})},init:function(t){return t.store.manager.state(t)}}),Ka=[un("initialValue"),Zt("getFallbackEntry"),Zt("getDataKey"),Zt("setValue"),_u("manager",{setValue:es,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(t){return t})},onLoad:function(n,e,o){e.store.initialValue.each(function(t){es(n,e,o,t)})},onUnload:function(t,n,e){e.clear()},state:Ua})],Be=[Zt("getValue"),fn("setValue",W),un("initialValue"),_u("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(n,e,t){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:W,state:zi.init})],Ae=[un("initialValue"),_u("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:cl})],tc=[dn("store",{mode:"memory"},$t("mode",{memory:Ae,manual:Be,dataset:Ka})),wa("onSetValue"),fn("resetOnDom",!1)],sl=Ju({fields:tc,name:"representing",active:ba,apis:al,extra:{setValueFrom:function(t,n){n=sl.getValue(n);sl.setValue(t,n)}},state:n}),ll=Fe=function(o,t){return gn(o,{},y(t,function(t){return n=t.name(),e="Cannot configure "+t.name()+" for "+o,Gn(n,n,Et(),Lt(function(t){return _n("The field: "+n+" is forbidden. "+e)}));var n,e}).concat([pn("dump",l)]))},fl=rs,dl="placeholder",ml=xt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),gl=function(o,r,i,u){return is(o,0,i,u).fold(function(t,n){var e=n(r,i.config,i.validated),n=At(e,"components").getOr([]),n=O(n,function(t){return gl(o,r,t,u)});return[E(E({},e),{components:n})]},function(t,n){n=n(r,i.config,i.validated);return i.validated.preprocess.getOr(l)(n)})},pl=ml.single,hl=ml.multiple,vl=G(dl),Ie=xt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),nc=fn("factory",{sketch:l}),Ns=fn("schema",[]),ec=Zt("name"),Gr=Gn("pname","pname",Tt(function(t){return"<alloy."+Mo(t.name)+">"}),$n()),Ga=Wn("schema",function(){return[un("preprocess")]}),Re=fn("defaults",G({})),Ai=fn("overrides",G({})),Bi=Ln([nc,Ns,ec,Gr,Re,Ai]),Ei=Ln([nc,Ns,ec,Re,Ai]),Ua=Ln([nc,Ns,ec,Gr,Re,Ai]),cl=Ln([nc,Ga,ec,Zt("unit"),Gr,Re,Ai]),bl=(Ae=function(n,e){return function(t){t=Jt("Converting part type",e,t);return n(t)}})(Ie.required,Bi),Be=Ae(Ie.external,Ei),yl=Ae(Ie.optional,Ua),Ka=Ae(Ie.group,cl),xl=G("entirety"),tc=Object.freeze({required:bl,external:Be,optional:yl,group:Ka,asNamedPart:as,name:cs,asCommon:function(t){return t.fold(l,l,l,l)},original:xl}),wl=function(t,n){return{uiType:vl(),owner:t,name:n}},ba=Object.freeze({generate:ls,generateOne:fs,schemas:ds,names:ms,substitutes:gs,components:ps,defaultUids:Ss,defaultUidsSchema:ks,getAllParts:ys,getAllPartNames:xs,getPart:hs,getPartOrDie:vs,getParts:bs,getPartsOrDie:ws}),Sl=function(t){return t.hasOwnProperty("uid")?t:E(E({},t),{uid:Ri("uid")})};function kl(t){var n=Jt("Sketcher for "+t.name,Ll,t),e=F(n.apis,Vo),t=F(n.extraApis,Io);return E(E({name:G(n.name),partFields:G([]),configFields:G(n.configFields),sketch:function(t){return function(t,n,e,o){o=Sl(o);return e(Cs(t,n,o,[],[]),o)}(n.name,n.configFields,n.factory,t)}},e),t)}function Cl(t){return"input"===ze(t)&&"radio"!==To(t,"type")||"textarea"===ze(t)}function Ol(e,o,t,r){var n=dc(e.element(),"."+o.highlightClass);ft(n,function(n){h(r,function(t){return t.element()===n})||(Qo(n,o.highlightClass),e.getSystem().getByDom(n).each(function(t){o.onDehighlight(e,t),Ye(t,hi())}))})}function El(t,n,e,o){Ol(t,n,0,[o]),Wl(t,n,e,o)||(Jo(o.element(),n.highlightClass),n.onHighlight(t,o),Ye(o,pi()))}function Tl(n,e,t,o){var r=dc(n.element(),"."+e.itemClass);return C(r,function(t){return Zo(t,e.highlightClass)}).bind(function(t){t=Ac(t,o,0,r.length-1);return n.getSystem().getByDom(r[t]).toOption()})}function Dl(t,n,e){var o=B(t.slice(0,n)),n=B(t.slice(n+1));return k(o.concat(n),e)}function Bl(t,n,e){return n=B(t.slice(0,n)),k(n,e)}function Al(t,n,e){var o=t.slice(0,n),n=t.slice(n+1);return k(n.concat(o),e)}function _l(t,n,e){return n=t.slice(n+1),k(n,e)}function Ml(n){return function(t){t=t.raw();return lt(n,t.which)}}function Fl(t){return function(n){return D(t,function(t){return t(n)})}}function Il(t){return!0===t.raw().shiftKey}function Rl(t){return!0===t.raw().ctrlKey}function Vl(t,n){return{matches:t,classification:n}}function Hl(t,n,e){n.exists(function(n){return e.exists(function(t){return On(t,n)})})||qe(t,fi(),{prevFocus:n,newFocus:e})}function Nl(){function o(t){return Zu(t.element())}return{get:o,set:function(t,n){var e=o(t);t.getSystem().triggerFocus(n,t.element());n=o(t);Hl(t,e,n)}}}function Pl(){function o(t){return Kl.getHighlighted(t).map(function(t){return t.element()})}return{get:o,set:function(n,t){var e=o(n);n.getSystem().getByDom(t).fold(W,function(t){Kl.highlight(n,t)});t=o(n);Hl(n,e,t)}}}var zl,Ll=jt([Zt("name"),Zt("factory"),Zt("configFields"),fn("apis",{}),fn("extraApis",{})]),jl=jt([Zt("name"),Zt("factory"),Zt("configFields"),Zt("partFields"),fn("apis",{}),fn("extraApis",{})]),al=function(t){var n=Jt("Sketcher for "+t.name,jl,t),e=ls(n.name,n.partFields),o=F(n.apis,Vo),t=F(n.extraApis,Io);return E(E({name:G(n.name),partFields:G(n.partFields),configFields:G(n.configFields),sketch:function(t){return Os(n.name,n.configFields,n.partFields,n.factory,t)},parts:G(e)},o),t)},n=Object.freeze({getCurrent:function(t,n,e){return n.find(t)}}),Ns=[Zt("find")],Ul=Ju({fields:Ns,name:"composing",apis:n}),Wl=function(t,n,e,o){return Zo(o.element(),n.highlightClass)},Gl=function(t,n,e,o){n=dc(t.element(),"."+n.itemClass);return $.from(n[o]).fold(function(){return tt.error("No element found with index "+o)},t.getSystem().getByDom)},Xl=function(n,t,e){return fu(n.element(),"."+t.itemClass).bind(function(t){return n.getSystem().getByDom(t).toOption()})},Yl=function(n,t,e){t=dc(n.element(),"."+t.itemClass);return(0<t.length?$.some(t[t.length-1]):$.none()).bind(function(t){return n.getSystem().getByDom(t).toOption()})},ql=function(n,t,e){t=dc(n.element(),"."+t.itemClass);return pu(y(t,function(t){return n.getSystem().getByDom(t).toOption()}))},nc=Object.freeze({dehighlightAll:function(t,n,e){return Ol(t,n,0,[])},dehighlight:function(t,n,e,o){Wl(t,n,e,o)&&(Qo(o.element(),n.highlightClass),n.onDehighlight(t,o),Ye(o,hi()))},highlight:El,highlightFirst:function(n,e,o){Xl(n,e).each(function(t){El(n,e,o,t)})},highlightLast:function(n,e,o){Yl(n,e).each(function(t){El(n,e,o,t)})},highlightAt:function(n,e,o,t){Gl(n,e,o,t).fold(function(t){throw new Error(t)},function(t){El(n,e,o,t)})},highlightBy:function(n,e,o,t){var r=ql(n,e);k(r,t).each(function(t){El(n,e,o,t)})},isHighlighted:Wl,getHighlighted:function(n,t,e){return fu(n.element(),"."+t.highlightClass).bind(function(t){return n.getSystem().getByDom(t).toOption()})},getFirst:Xl,getLast:Yl,getPrevious:function(t,n,e){return Tl(t,n,0,-1)},getNext:function(t,n,e){return Tl(t,n,0,1)},getCandidates:ql}),Ga=[Zt("highlightClass"),Zt("itemClass"),wa("onHighlight"),wa("onDehighlight")],Kl=Ju({fields:Ga,name:"highlighting",apis:nc}),Jl=p(Il);function $l(t,n,e,o,a){function c(n,e,t,o,r){var i;return t=t=t(n,e,o,r),i=e.event(),k(t,function(t){return t.matches(i)}).map(function(t){return t.classification}).bind(function(t){return t(n,e,o,r)})}var r={schema:function(){return t.concat([fn("focusManager",Nl()),dn("focusInside","onFocus",Yt(function(t){return lt(["onFocus","onEnterOrSpace","onApi"],t)?tt.value(t):tt.error("Invalid value for focusInside")})),_u("handler",r),_u("state",n),_u("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var t=i.focusInside!==zl.OnFocusMode?$.none():a(i).map(function(e){return to(Xr(),function(t,n){e(t,i,u),n.stop()})});return bi(t.toArray().concat([to(Nr(),function(o,r){c(o,r,e,i,u).fold(function(){var n,e,t;n=o,e=r,t=Ml([32].concat([13]))(e.event()),i.focusInside===zl.OnEnterOrSpaceMode&&t&&En(n,e)&&a(i).each(function(t){t(n,i,u),e.stop()})},function(t){r.stop()})}),to(Pr(),function(t,n){c(t,n,o,i,u).each(function(t){n.stop()})})]))}};return r}function Ql(t,n){return $.some(!0)}function Zl(t,n,e){return e.execute(t,n,t.element())}function tf(i){return function(t,n,e,o){var r=i(t.element());return ed(r,t,n,e,o)}}function nf(t,n){return n=ia(t,n),tf(n)}function ef(t,n){return t=ia(n,t),tf(t)}function of(t){return!((t=t=t.dom()).offsetWidth<=0&&t.offsetHeight<=0)}function rf(t,n,e){var o,n=d(On,n),e=dc(t,e),e=x(e,of);return C(o=e,n).map(function(t){return rd({index:t,candidates:o})})}function uf(t,n){return C(t,function(t){return On(n,t)})}function af(n,t,e,o){return o(Math.floor(t/e),t%e).bind(function(t){t=t.row()*e+t.column();return 0<=t&&t<n.length?$.some(n[t]):$.none()})}function cf(o,t,r,i,u){return af(o,t,i,function(t,n){var e=t===r-1?o.length-t*i:i,e=Ac(n,u,0,e-1);return $.some({row:G(t),column:G(e)})})}function sf(o,t,r,i,u){return af(o,t,i,function(t,n){var e=Ac(t,u,0,r-1),t=e===r-1?o.length-e*i:i,t=_c(n,0,t-1);return $.some({row:G(e),column:G(t)})})}function lf(n,e,t){fu(n.element(),e.selector).each(function(t){e.focusManager.set(n,t)})}function ff(t,n,e,r){var i=function(t,n,e){var o=Ac(n,r,0,e.length-1);return o===t?$.none():(n=e[o],"button"===ze(n)&&"disabled"===To(n,"disabled")?i(t,o,e):$.from(e[o]))};return rf(t,e,n).bind(function(t){var n=t.index(),t=t.candidates();return i(n,n,t)})}function df(n,e,o){return t=n,(r=o).focusManager.get(t).bind(function(t){return du(t,r.selector)}).bind(function(t){return o.execute(n,e,t)});var t,r}function mf(n,e){e.getInitial(n).orThunk(function(){return fu(n.element(),e.selector)}).each(function(t){e.focusManager.set(n,t)})}function gf(t,n,e){return ff(t,e.selector,n,-1)}function pf(t,n,e){return ff(t,e.selector,n,1)}function hf(o){return function(t,n,e){return o(t,n,e).bind(function(){return e.executeOnMove?df(t,n,e):$.some(!0)})}}function vf(t,n,e,o){return e.onEscape(t,n)}function bf(t,n,e){return $.from(t[n]).bind(function(t){return $.from(t[e]).map(function(t){return id({rowIndex:n,columnIndex:e,cell:t})})})}function yf(t,n,e,o){var r=t[n].length,r=Ac(e,o,0,r-1);return bf(t,n,r)}function xf(t,n,e,o){return e=Ac(e,o,0,t.length-1),o=t[e].length,o=_c(n,0,o-1),bf(t,e,o)}function wf(t,n,e,o){var r=t[n].length,r=_c(e+o,0,r-1);return bf(t,n,r)}function Sf(t,n,e,o){return e=_c(e+o,0,t.length-1),o=t[e].length,o=_c(n,0,o-1),bf(t,e,o)}function kf(n,e){e.previousSelector(n).orThunk(function(){var t=e.selectors;return fu(n.element(),t.cell)}).each(function(t){e.focusManager.set(n,t)})}function Cf(n,e){fu(n.element(),e.selector).each(function(t){e.focusManager.set(n,t)})}function Of(t,n,e){return ff(t,e.selector,n,-1)}function Ef(t,n,e){return ff(t,e.selector,n,1)}function Tf(t,n,e,o){o=t.getSystem().build(o),$s(t,o,e)}function Df(t,n,e,o){t=ad(t),k(t,function(t){return On(o.element(),t.element())}).each(Wc)}function Bf(n,t,e,r,o){var i=ad(n);return $.from(i[r]).map(function(t){return Df(n,0,0,t),o.each(function(t){Tf(n,0,function(t,n){var e,o;o=n,ho(e=t,r).fold(function(){Ci(e,o)},function(t){vo(t,o)})},t)}),t})}function Af(t,n){return{key:t,value:{config:{},me:function(t,n){n=bi(n);return Ju({fields:[Zt("enabled")],name:t,active:{events:G(n)}})}(t,n),configAsRaw:G({}),initialConfig:{},state:zi}}}function _f(t,n){n.ignore||($u(t.element()),n.onFocus(t))}function Mf(t,n,e){(n=n.aria).update(t,n,e.get())}function Ff(n,t,e){t.toggleClass.each(function(t){(e.get()?Jo:Qo)(n.element(),t)})}function If(t,n,e){ld(t,n,e,!e.get())}function Rf(t,n,e){e.set(!0),Ff(t,n,e),Mf(t,n,e)}function Vf(t,n,e){e.set(!1),Ff(t,n,e),Mf(t,n,e)}function Hf(t,n,e){ld(t,n,e,n.selected)}function Nf(){function t(t,n){n.stop(),Ke(t)}return[to(jr(),t),to(Qr(),t),io(Tr()),io(_r())]}function Pf(t){return bi(T([t.map(function(e){return Si(function(t,n){e(t),n.stop()})}).toArray(),Nf()]))}function zf(t){(Zu(t.element()).isNone()||sd.isFocused(t))&&(sd.isFocused(t)||sd.focus(t),qe(t,md,{item:t}))}function Lf(t){qe(t,gd,{item:t})}function jf(){return"item-widget"}function Uf(t,n){var e={};ht(t,function(t,n){ft(t,function(t){e[t]=n})});var o=n,r=vt(n,function(t,n){return{k:t,v:n}}),i=F(r,function(t,n){return[n].concat(wd(e,o,r,n))});return F(e,function(t){return At(i,t).getOr([t])})}function Wf(t,n,r,e,i){function u(){return t.lazySink(n)}function a(t){return 2===t.length?o:{}}var o="horizontal"===e.type?{layouts:{onLtr:Wu,onRtl:Gu}}:{};return Od.sketch({dom:{tag:"div"},data:e.data,markers:e.menu.markers,onEscape:function(){return nl.close(n),t.onEscape.map(function(t){return t(n)}),$.some(!0)},onExecute:function(){return $.some(!0)},onOpenMenu:function(t,n){qs.positionWithinBounds(u().getOrDie(),r,n,i())},onOpenSubmenu:function(t,n,e,o){var r=u().getOrDie();qs.position(r,E({anchor:"submenu",item:n},a(o)),e)},onRepositionMenu:function(t,n,e){var o=u().getOrDie();qs.positionWithinBounds(o,r,n,i()),ft(e,function(t){var n=a(t.triggeringPath);qs.position(o,E({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)})}})}function Gf(t,n){return t.x()+t.width()/2-n.width()/2}function Xf(t,n){return t.x()+t.width()-n.width()}function Yf(t,n){return t.y()+t.height()-n.height()}function qf(t,n,e){return Ea(t.x(),Yf(t,n),e.innerSoutheast(),Ta(),"layout-se")}function Kf(t,n,e){return Ea(Xf(t,n),Yf(t,n),e.innerSouthwest(),Da(),"layout-sw")}function Jf(t,n,e){return Ea(t.x(),t.y(),e.innerNortheast(),Ba(),"layout-ne")}function $f(t,n,e){return Ea(Xf(t,n),t.y(),e.innerNorthwest(),Aa(),"layout-nw")}function Qf(t){var n=void 0!==t.uid&&q(t,"uid")?t.uid:Ri("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOption()},asSpec:function(){return E(E({},t),{uid:n})}}}function Zf(t){return $.from(t()["temporary-placeholder"]).getOr("!not found!")}function td(t,n){return $.from(n()[t]).getOrThunk(function(){return Zf(n)})}(ec=zl=zl||{}).OnFocusMode="onFocus",ec.OnEnterOrSpaceMode="onEnterOrSpace",ec.OnApiMode="onApi";var nd,Re=(Gr=function(t){function i(t,n){return t=t.visibilitySelector.bind(function(t){return du(n,t)}).getOr(n),0<Ji(t)}function n(n,e){(function(t,n){t=dc(t.element(),n.selector),t=x(t,function(t){return i(n,t)});return $.from(t[n.firstTabstop])})(n,e).each(function(t){e.focusManager.set(n,t)})}function a(n,t,e,o,r){return r(t,e,function(t){return i(n=o,t=t)&&n.useTabstopAt(t);var n}).fold(function(){return o.cyclic?$.some(!0):$.none()},function(t){return o.focusManager.set(n,t),$.some(!0)})}function u(n,t,e,o){var r,i,u=dc(n.element(),e.selector);return r=n,(i=e).focusManager.get(r).bind(function(t){return du(t,i.selector)}).bind(function(t){return C(u,d(On,t)).bind(function(t){return a(n,u,t,e,o)})})}var e=[un("onEscape"),un("onEnter"),fn("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),fn("firstTabstop",0),fn("useTabstopAt",G(!0)),un("visibilitySelector")].concat([t]),o=G([Vl(Fl([Il,Ml([9])]),function(t,n,e,o){var r=e.cyclic?Dl:Bl;return u(t,0,e,r)}),Vl(Ml([9]),function(t,n,e,o){var r=e.cyclic?Al:_l;return u(t,0,e,r)}),Vl(Ml([27]),function(n,e,t,o){return t.onEscape.bind(function(t){return t(n,e)})}),Vl(Fl([Jl,Ml([13])]),function(n,e,t,o){return t.onEnter.bind(function(t){return t(n,e)})})]),t=G([]);return $l(e,zi.init,o,t,function(){return $.some(n)})})(pn("cyclic",G(!1))),Ai=Gr(pn("cyclic",G(!0))),Ei=[fn("execute",Bi=function(t,n,e){return Cl(e)&&Ml([32])(n.event())?$.none():(Je(t,e,Jr()),$.some(!0))}),fn("useSpace",!1),fn("useEnter",!0),fn("useControlEnter",!1),fn("useDown",!1)],Ua=$l(Ei,zi.init,function(t,n,e,o){var r=e.useSpace&&!Cl(t.element())?[32]:[],i=e.useEnter?[13]:[],t=e.useDown?[40]:[],t=r.concat(i).concat(t);return[Vl(Ml(t),Zl)].concat(e.useControlEnter?[Vl(Fl([Rl,Ml([13])]),Zl)]:[])},function(t,n,e,o){return e.useSpace&&!Cl(t.element())?[Vl(Ml([32]),Ql)]:[]},function(){return $.none()}),Ae=function(t){var e=fe($.none());return Li({readState:function(){return e.get().map(function(t){return{numRows:t.numRows(),numColumns:t.numColumns()}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set($.some({numRows:G(t),numColumns:G(n)}))},getNumRows:function(){return e.get().map(function(t){return t.numRows()})},getNumColumns:function(){return e.get().map(function(t){return t.numColumns()})}})},Ie=Object.freeze({flatgrid:Ae,init:function(t){return t.state(t)}}),cl=function(r){return function(t,n,e,o){return ed(r,t,n,e,o)}},ed=function(n,e,t,o,r){return o.focusManager.get(e).bind(function(t){return n(e.element(),t,o,r)}).map(function(t){return o.focusManager.set(e,t),!0})},Ns=cl,n=cl,od=cl,rd=ki(["index","candidates"],[]),Ga=[Zt("selector"),fn("execute",Bi),Sa("onEscape"),fn("captureTab",!1),Oa()],ec=function(t,n,e,o){return e.captureTab?$.some(!0):$.none()},Gr=(nc=function(r){return function(t,n,e,o){return rf(t,n,e.selector).bind(function(t){return r(t.candidates(),t.index(),o.getNumRows().getOr(e.initSize.numRows),o.getNumColumns().getOr(e.initSize.numColumns))})}})(function(t,n,e,o){return cf(t,n,e,o,-1)}),Ei=nc(function(t,n,e,o){return cf(t,n,e,o,1)}),cl=nc(function(t,n,e,o){return sf(t,n,e,o,-1)}),nc=nc(function(t,n,e,o){return sf(t,n,e,o,1)}),Gr=G([Vl(Ml([37]),nf(Gr,Ei)),Vl(Ml([39]),ef(Gr,Ei)),Vl(Ml([38]),Ns(cl)),Vl(Ml([40]),n(nc)),Vl(Fl([Il,Ml([9])]),ec),Vl(Fl([Jl,Ml([9])]),ec),Vl(Ml([27]),function(t,n,e,o){return e.onEscape(t,n)}),Vl(Ml([32].concat([13])),function(n,e,o,t){return r=n,(i=o).focusManager.get(r).bind(function(t){return du(t,i.selector)}).bind(function(t){return o.execute(n,e,t)});var r,i})]),Ei=G([Vl(Ml([32]),Ql)]),cl=$l(Ga,Ae,Gr,Ei,function(){return $.some(lf)}),nc=[Zt("selector"),fn("getInitial",$.none),fn("execute",Bi),Sa("onEscape"),fn("executeOnMove",!1),fn("allowVertical",!0)],ec=G([Vl(Ml([32]),Ql)]),Ga=$l(nc,zi.init,function(t,n,e,o){var r=[37].concat(e.allowVertical?[38]:[]),e=[39].concat(e.allowVertical?[40]:[]);return[Vl(Ml(r),hf(nf(gf,pf))),Vl(Ml(e),hf(ef(gf,pf))),Vl(Ml([13]),df),Vl(Ml([32]),df),Vl(Ml([27]),vf)]},ec,function(){return $.some(mf)}),id=ki(["rowIndex","columnIndex","cell"],[]),Ae=[on("selectors",[Zt("row"),Zt("cell")]),fn("cycles",!0),fn("previousSelector",$.none),fn("execute",Bi)],Ei=(Gr=function(t,n){return function(e,o,i){var u=i.cycles?t:n;return du(o,i.selectors.row).bind(function(t){var n=dc(t,i.selectors.cell);return uf(n,o).bind(function(o){var r=dc(e,i.selectors.row);return uf(r,t).bind(function(t){var n,e=(n=i,y(r,function(t){return dc(t,n.selectors.cell)}));return u(e,t,o).map(function(t){return t.cell()})})})})}})(function(t,n,e){return yf(t,n,e,-1)},function(t,n,e){return wf(t,n,e,-1)}),nc=Gr(function(t,n,e){return yf(t,n,e,1)},function(t,n,e){return wf(t,n,e,1)}),ec=Gr(function(t,n,e){return xf(t,e,n,-1)},function(t,n,e){return Sf(t,e,n,-1)}),Gr=Gr(function(t,n,e){return xf(t,e,n,1)},function(t,n,e){return Sf(t,e,n,1)}),n=G([Vl(Ml([37]),nf(Ei,nc)),Vl(Ml([39]),ef(Ei,nc)),Vl(Ml([38]),Ns(ec)),Vl(Ml([40]),n(Gr)),Vl(Ml([32].concat([13])),function(n,e,o){return Zu(n.element()).bind(function(t){return o.execute(n,e,t)})})]),Gr=G([Vl(Ml([32]),Ql)]),Ae=$l(Ae,zi.init,n,Gr,function(){return $.some(kf)}),n=[Zt("selector"),fn("execute",Bi),fn("moveOnTab",!1)],Gr=function(n,e,o){return o.focusManager.get(n).bind(function(t){return o.execute(n,e,t)})},Bi=G([Vl(Ml([38]),od(Of)),Vl(Ml([40]),od(Ef)),Vl(Fl([Il,Ml([9])]),function(t,n,e){return e.moveOnTab?od(Of)(t,n,e):$.none()}),Vl(Fl([Jl,Ml([9])]),function(t,n,e){return e.moveOnTab?od(Ef)(t,n,e):$.none()}),Vl(Ml([13]),Gr),Vl(Ml([32]),Gr)]),Gr=G([Vl(Ml([32]),Ql)]),Bi=$l(n,zi.init,Bi,Gr,function(){return $.some(Cf)}),Gr=[Sa("onSpace"),Sa("onEnter"),Sa("onShiftEnter"),Sa("onLeft"),Sa("onRight"),Sa("onTab"),Sa("onShiftTab"),Sa("onUp"),Sa("onDown"),Sa("onEscape"),fn("stopSpaceKeyup",!1),un("focusIn")],Gr=$l(Gr,zi.init,function(t,n,e){return[Vl(Ml([32]),e.onSpace),Vl(Fl([Jl,Ml([13])]),e.onEnter),Vl(Fl([Il,Ml([13])]),e.onShiftEnter),Vl(Fl([Il,Ml([9])]),e.onShiftTab),Vl(Fl([Jl,Ml([9])]),e.onTab),Vl(Ml([38]),e.onUp),Vl(Ml([40]),e.onDown),Vl(Ml([37]),e.onLeft),Vl(Ml([39]),e.onRight),Vl(Ml([32]),e.onSpace),Vl(Ml([27]),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[Vl(Ml([32]),Ql)]:[]},function(t){return t.focusIn}),Re=Re.schema(),Ai=Ai.schema(),Ga=Ga.schema(),cl=cl.schema(),Ae=Ae.schema(),Ua=Ua.schema(),Bi=Bi.schema(),Gr=Gr.schema(),ud=La({branchKey:"mode",branches:Object.freeze({acyclic:Re,cyclic:Ai,flow:Ga,flatgrid:cl,matrix:Ae,execution:Ua,menu:Bi,special:Gr}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(n,e,o){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element(),n.element())},function(t){t(n,e,o)})},setGridSize:function(t,n,e,o,r){q(e,"setGridSize")?e.setGridSize(o,r):b.console.error("Layout does not support setGridSize")}},state:Ie}),ad=function(t,n){return t.components()},cd=Ju({fields:[],name:"replacing",apis:Object.freeze({append:function(t,n,e,o){Tf(t,0,Ci,o)},prepend:function(t,n,e,o){Tf(t,0,yo,o)},remove:Df,replaceAt:Bf,replaceBy:function(n,t,e,o,r){var i=ad(n);return C(i,o).bind(function(t){return Bf(n,0,0,t,r)})},set:function(n,t,e,o){ta(function(){var t=y(o,n.getSystem().build);Lc(n,t)},n.element())},contents:ad})}),Re=Object.freeze({focus:_f,blur:function(t,n){n.ignore||t.element().dom().blur()},isFocused:function(t){return n=t.element(),t=so(n).dom(),n.dom()===t.activeElement;var n}}),Ai=Object.freeze({exhibit:function(t,n){n=n.ignore?{}:{attributes:{tabindex:"-1"}};return No(n)},events:function(e){return bi([to(Xr(),function(t,n){_f(t,e),n.stop()})].concat(e.stopMousedown?[to(_r(),function(t,n){n.event().prevent()})]:[]))}}),Ga=[wa("onFocus"),fn("stopMousedown",!1),fn("ignore",!1)],sd=Ju({fields:Ga,name:"focusing",active:Ai,apis:Re}),ld=function(t,n,e,o){(o?Rf:Vf)(t,n,e)},cl=Object.freeze({onLoad:Hf,toggle:If,isOn:function(t,n,e){return e.get()},on:Rf,off:Vf,set:ld}),Ae=Object.freeze({exhibit:function(t,n,e){return No({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=If,Si(function(t){r(t,e,o)})),n=Xu(t,n,Hf);return bi(T([t.toggleOnExecute?[i]:[],[n]]))}}),fd=function(t,n,e){Eo(t.element(),"aria-expanded",e)},Ua=[fn("selected",!1),un("toggleClass"),fn("toggleOnExecute",!0),dn("aria",{mode:"none"},$t("mode",{pressed:[fn("syncWithExpanded",!1),_u("update",function(t,n,e){Eo(t.element(),"aria-pressed",e),n.syncWithExpanded&&fd(t,n,e)})],checked:[_u("update",function(t,n,e){Eo(t.element(),"aria-checked",e)})],expanded:[_u("update",fd)],selected:[_u("update",function(t,n,e){Eo(t.element(),"aria-selected",e)})],none:[_u("update",W)]}))],dd=Ju({fields:Ua,name:"toggling",active:Ae,apis:cl,state:(nd=!1,{init:function(){var n=fe(nd);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(nd)},readState:function(){return n.get()}}}})}),md="alloy.item-hover",gd="alloy.item-focus",pd=G(md),hd=G(gd),Bi=[Zt("data"),Zt("components"),Zt("dom"),fn("hasSubmenu",!1),un("toggling"),ll("itemBehaviours",[dd,sd,ud,sl]),fn("ignoreFocus",!1),fn("domModification",{}),_u("builder",function(t){return{dom:t.dom,domModification:E(E({},t.domModification),{attributes:E(E(E({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:fl(t.itemBehaviours,[t.toggling.fold(dd.revoke,function(t){return dd.config(E({aria:{mode:"checked"}},t))}),sd.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Lf(t)}}),ud.config({mode:"execution"}),sl.config({store:{mode:"memory",initialValue:t.data}}),Af("item-type-events",g(Nf(),[to(Rr(),zf),to($r(),sd.focus)]))]),components:t.components,eventOrder:t.eventOrder}}),fn("eventOrder",{})],Gr=[Zt("dom"),Zt("components"),_u("builder",function(t){return{dom:t.dom,components:t.components,events:bi([(t=$r(),to(t,function(t,n){n.stop()}))])}})],vd=G([bl({name:"widget",overrides:function(n){return{behaviours:Na([sl.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),Ie=[Zt("uid"),Zt("data"),Zt("components"),Zt("dom"),fn("autofocus",!1),fn("ignoreFocus",!1),ll("widgetBehaviours",[sl,sd,ud]),fn("domModification",{}),ks(vd()),_u("builder",function(e){function o(t){return hs(t,e,"widget").map(function(t){return ud.focusIn(t),t})}var t=gs(jf(),e,vd()),n=ps(jf(),e,t.internals()),t=function(t,n){return Cl(n.event().target())||e.autofocus&&n.setSource(t.element()),$.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:bi([Si(function(t,n){o(t).each(function(t){n.stop()})}),to(Rr(),zf),to($r(),function(t,n){e.autofocus?o(t):sd.focus(t)})]),behaviours:fl(e.widgetBehaviours,[sl.config({store:{mode:"memory",initialValue:e.data}}),sd.config({ignore:e.ignoreFocus,onFocus:function(t){Lf(t)}}),ud.config({mode:"special",focusIn:e.autofocus?function(t){o(t)}:ja(),onLeft:t,onRight:t,onEscape:function(t,n){return sd.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element()),$.none()):(sd.focus(t),$.some(!0))}})])}})],bd=$t("type",{widget:Ie,item:Bi,separator:Gr}),Ga=G([Ka({factory:{sketch:function(t){t=Jt("menu.spec item",bd,t);return t.builder(t)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:E(E({},n),{uid:Ri("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Ai=G([Zt("value"),Zt("items"),Zt("dom"),Zt("components"),fn("eventOrder",{}),Fe("menuBehaviours",[Kl,sl,Ul,ud]),dn("movement",{mode:"menu",moveOnTab:!0},$t("mode",{grid:[Oa(),_u("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[_u("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),Zt("rowSelector")],menu:[fn("moveOnTab",!0),_u("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),tn("markers",va()),fn("fakeFocus",!1),fn("focusManager",Nl()),wa("onHighlight")]),yd=G("alloy.menu-focus"),xd=al({name:"Menu",configFields:Ai(),partFields:Ga(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:rs(t.menuBehaviours,[Kl.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),sl.config({store:{mode:"memory",initialValue:t.value}}),Ul.config({find:$.some}),ud.config(t.movement.config(t,t.movement))]),events:bi([to(hd(),function(n,e){var t=e.event();n.getSystem().getByDom(t.target()).each(function(t){Kl.highlight(n,t),e.stop(),qe(n,yd(),{menu:n,item:t})})}),to(pd(),function(t,n){n=n.event().item();Kl.highlight(t,n)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),wd=function(e,o,r,t){return At(r,t).bind(function(t){return At(e,t).bind(function(t){var n=wd(e,o,r,t);return $.some([t].concat(n))})}).getOr([])},Sd=function(t){return"prepared"===t.type?$.some(t.menu):$.none()},kd={init:function(){function r(t,o,r){return e(t).bind(function(n){return e=t,I(i.get(),function(t,n){return t===e}).bind(function(t){return o(t).map(function(t){return{triggeredMenu:n,triggeringItem:t,triggeringPath:r}})});var e})}var i=fe({}),u=fe({}),a=fe({}),c=fe($.none()),s=fe({}),e=function(t){return n(t).bind(Sd)},n=function(t){return At(u.get(),t)},l=function(t){return At(i.get(),t)};return{setMenuBuilt:function(t,n){var e;u.set(E(E({},u.get()),((e={})[t]={type:"prepared",menu:n},e)))},setContents:function(t,n,e,o){c.set($.some(t)),i.set(e),u.set(n),s.set(o);e=Uf(o,e);a.set(e)},expand:function(e){return At(i.get(),e).map(function(t){var n=At(a.get(),e).getOr([]);return[t].concat(n)})},refresh:function(t){return At(a.get(),t)},collapse:function(t){return At(a.get(),t).bind(function(t){return 1<t.length?$.some(t.slice(1)):$.none()})},lookupMenu:n,lookupItem:l,otherMenus:function(t){var n=s.get();return A(gt(n),t)},getPrimary:function(){return c.get().bind(e)},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),a.set({}),c.set($.none())},isClear:function(){return c.get().isNone()},getTriggeringPath:function(t,o){var n=x(l(t).toArray(),function(t){return e(t).isSome()});return At(a.get(),t).bind(function(t){var e=B(n.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return $.none();n.push(o.getOrDie())}return $.some(n)}(O(e,function(t,n){return r(t,o,e.slice(0,n+1)).fold(function(){return c.get().is(t)?[]:[$.none()]},function(t){return[$.some(t)]})}))})}}},extractPreparedMenu:Sd},Cd=G("collapse-item"),Od=kl({name:"TieredMenu",configFields:[Ca("onExecute"),Ca("onEscape"),ka("onOpenMenu"),ka("onOpenSubmenu"),ka("onRepositionMenu"),wa("onCollapseMenu"),fn("highlightImmediately",!0),on("data",[Zt("primary"),Zt("menus"),Zt("expansions")]),fn("fakeFocus",!1),wa("onHighlight"),wa("onHover"),ya(),Zt("dom"),fn("navigateOnHover",!0),fn("stayInDom",!1),Fe("tmenuBehaviours",[ud,Kl,Ul,cd]),fn("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(u,t){function e(t){var o,r,t=(o=t,r=u.data.primary,n=u.data.menus,F(n,function(t,n){function e(){return xd.sketch(E(E({dom:t.dom},t),{value:n,items:t.items,markers:u.markers,fakeFocus:u.fakeFocus,onHighlight:u.onHighlight,focusManager:(u.fakeFocus?Pl:Nl)()}))}return n===r?{type:"prepared",menu:o.getSystem().build(e())}:{type:"notbuilt",nbMenu:e}})),n=g();return m.setContents(u.data.primary,t,u.data.expansions,n),m.getPrimary()}function a(t){return sl.getValue(t).value}function i(n,t){Kl.highlight(n,t),Kl.getHighlighted(t).orThunk(function(){return Kl.getFirst(t)}).each(function(t){Je(n,t.element(),$r())})}function c(n,t){return pu(y(t,function(t){return n.lookupMenu(t).bind(function(t){return"prepared"===t.type?$.some(t.menu):$.none()})}))}function s(n,t,e){e=c(t,t.otherMenus(e)),ft(e,function(t){nr(t.element(),[u.markers.backgroundMenu]),u.stayInDom||cd.remove(n,t)})}function l(t,e){var n,t=(n=t,o.get().getOrThunk(function(){var e={},t=dc(n.element(),"."+u.markers.item),t=x(t,function(t){return"true"===To(t,"aria-haspopup")});return ft(t,function(t){n.getSystem().getByDom(t).each(function(t){var n=a(t);e[n]=t})}),o.set($.some(e)),e}));ht(t,function(t,n){n=lt(e,n);Eo(t.element(),"aria-expanded",n)})}function f(e,o,r){return $.from(r[0]).bind(function(t){return o.lookupMenu(t).bind(function(t){if("notbuilt"===t.type)return $.none();var n=t.menu,t=c(o,r.slice(1));return ft(t,function(t){Jo(t.element(),u.markers.backgroundMenu)}),Le(n.element())||cd.append(e,qi(n)),nr(n.element(),[u.markers.backgroundMenu]),i(e,n),s(e,o,r),$.some(n)})})}var d,o=fe($.none()),m=kd.init(),g=function(t){return F(u.data.menus,function(t,n){return O(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})};(b=d=d||{})[b.HighlightSubmenu=0]="HighlightSubmenu",b[b.HighlightParent=1]="HighlightParent";function r(o,r,i){void 0===i&&(i=d.HighlightSubmenu);var t=a(r);return m.expand(t).bind(function(e){return l(o,e),$.from(e[0]).bind(function(n){return m.lookupMenu(n).bind(function(t){t=function(t,n,e){if("notbuilt"!==e.type)return e.menu;e=t.getSystem().build(e.nbMenu());return m.setMenuBuilt(n,e),e}(o,n,t);return Le(t.element())||cd.append(o,qi(t)),u.onOpenSubmenu(o,r,t,B(e)),i===d.HighlightSubmenu?(Kl.highlightFirst(t),f(o,m,e)):(Kl.dehighlightAll(t),$.some(r))})})})}function p(n,e){var t=a(e);return m.collapse(t).bind(function(t){return l(n,t),f(n,m,t).map(function(t){return u.onCollapseMenu(n,e,t),t})})}function n(e){return function(n,t){return du(t.getSource(),"."+u.markers.item).bind(function(t){return n.getSystem().getByDom(t).toOption().bind(function(t){return e(n,t).map(function(){return!0})})})}}function h(t){return Kl.getHighlighted(t).bind(Kl.getHighlighted)}var v=bi([to(yd(),function(n,e){var t=e.event().item();m.lookupItem(a(t)).each(function(){var t=e.event().menu();Kl.highlight(n,t);t=a(e.event().item());m.refresh(t).each(function(t){return s(n,m,t)})})}),Si(function(n,t){t=t.event().target();n.getSystem().getByDom(t).each(function(t){0===a(t).indexOf("collapse-item")&&p(n,t),r(n,t,d.HighlightSubmenu).fold(function(){u.onExecute(n,t)},function(){})})}),yi(function(n,t){e(n).each(function(t){cd.append(n,qi(t)),u.onOpenMenu(n,t),u.highlightImmediately&&i(n,t)})})].concat(u.navigateOnHover?[to(pd(),function(t,n){var e,o=n.event().item();e=t,n=a(n=o),m.refresh(n).bind(function(t){return l(e,t),f(e,m,t)}),r(t,o,d.HighlightParent),u.onHover(t,o)})]:[])),b={collapseMenu:function(n){h(n).each(function(t){p(n,t)})},highlightPrimary:function(n){m.getPrimary().each(function(t){i(n,t)})},repositionMenus:function(e){m.getPrimary().bind(function(n){return h(e).bind(function(t){var n=a(t),t=R(m.getMenus()),e=pu(y(t,kd.extractPreparedMenu));return m.getTriggeringPath(n,function(t){return n=t,hu(e,function(t){if(!t.getSystem().isConnected())return $.none();t=Kl.getCandidates(t);return k(t,function(t){return a(t)===n})});var n})}).map(function(t){return{primary:n,triggeringPath:t}})}).fold(function(){var t;t=e,$.from(t.components()[0]).filter(function(t){return"menu"===To(t.element(),"role")}).each(function(t){u.onRepositionMenu(e,t,[])})},function(t){var n=t.primary,t=t.triggeringPath;u.onRepositionMenu(e,n,t)})}};return{uid:u.uid,dom:u.dom,markers:u.markers,behaviours:rs(u.tmenuBehaviours,[ud.config({mode:"special",onRight:n(function(t,n){return Cl(n.element())?$.none():r(t,n,d.HighlightSubmenu)}),onLeft:n(function(t,n){return Cl(n.element())?$.none():p(t,n)}),onEscape:n(function(t,n){return p(t,n).orThunk(function(){return u.onEscape(t,n).map(function(){return t})})}),focusIn:function(n,t){m.getPrimary().each(function(t){Je(n,t.element(),$r())})}}),Kl.config({highlightClass:u.markers.selectedMenu,itemClass:u.markers.menu}),Ul.config({find:function(t){return Kl.getHighlighted(t)}}),cd.config({})]),eventOrder:u.eventOrder,apis:b,events:v}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:_t(t,n),expansions:{}}},collapseItem:function(t){return{value:Mo(Cd()),meta:{text:t}}}}}),Ed=kl({name:"InlineView",configFields:[Zt("lazySink"),wa("onShow"),wa("onHide"),ue("onEscape"),Fe("inlineBehaviours",[nl,sl,Wa]),ln("fireDismissalEventInstead",[fn("event",si())]),ln("fireRepositionEventInstead",[fn("event",li())]),fn("getRelated",$.none),fn("eventOrder",$.none)],factory:function(i,t){function n(e){nl.isOpen(e)&&sl.getValue(e).each(function(t){switch(t.mode){case"menu":nl.getState(e).each(function(t){Od.repositionMenus(t)});break;case"position":var n=i.lazySink(e).getOrDie();qs.positionWithinBounds(n,t.anchor,e,t.getBounds())}})}var o=function(t,n,e,o){r(t,n,e,function(){return o.map(au)})},r=function(t,n,e,o){var r=i.lazySink(t).getOrDie();nl.openWhileCloaked(t,e,function(){return qs.positionWithinBounds(r,n,t,o())}),sl.setValue(t,$.some({mode:"position",anchor:n,getBounds:o}))},u=function(t,n,e,o){o=Wf(i,t,n,e,o);nl.open(t,o),sl.setValue(t,$.some({mode:"menu",menu:o}))},e={setContent:function(t,n){nl.setContent(t,n)},showAt:function(t,n,e){o(t,n,e,$.none())},showWithin:o,showWithinBounds:r,showMenuAt:function(t,n,e){u(t,n,e,function(){return $.none()})},showMenuWithinBounds:u,hide:function(t){sl.setValue(t,$.none()),nl.close(t)},getContent:function(t){return nl.getState(t)},reposition:n,isOpen:nl.isOpen};return{uid:i.uid,dom:i.dom,behaviours:rs(i.inlineBehaviours,[nl.config({isPartOf:function(t,n,e){return Tu(n,e)||(t=t,o=e,i.getRelated(t).exists(function(t){return Tu(t,o)}));var o},getAttachPoint:function(t){return i.lazySink(t).getOrDie()},onOpen:function(t){i.onShow(t)},onClose:function(t){i.onHide(t)}}),sl.config({store:{mode:"memory",initialValue:$.none()}}),Wa.config({channels:E(E({},Qc(E({isExtraPart:G(!1)},i.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),Zc(E(E({isExtraPart:G(!1)},i.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:n})))})]),eventOrder:i.eventOrder,apis:e}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),Td=function(t,n,e){return Ea(Gf(t,n),t.y(),e.innerNorth(),Ma(),"layout-n")},Dd=function(t,n,e){return Ea(Gf(t,n),Yf(t,n),e.innerSouth(),_a(),"layout-s")},Bd=kl({name:"Button",factory:function(t){function e(n){return At(t.dom,"attributes").bind(function(t){return At(t,n)})}var n=Pf(t.action),o=t.dom.tag;return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:fl(t.buttonBehaviours,[sd.config({}),ud.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:e("role").getOr("button")};var t=e("type").getOr("button"),n=e("role").map(function(t){return{role:t}}).getOr({});return E({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[fn("uid",void 0),Zt("dom"),fn("components",[]),ll("buttonBehaviours",[sd,ud]),un("action"),un("role"),fn("eventOrder",{})]}),Ad={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},_d=kl({name:"Notification",factory:function(n){function e(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}}function o(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}}var r,i=Qf({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:Na([cd.config({})])}),u=Qf({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:Na([cd.config({})])}),t={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){cd.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},o(n)])})},updateText:function(t,n){t.getSystem().isConnected()&&(t=i.get(t),cd.set(t,[xr(n)]))}},a=T([n.icon.toArray(),n.level.toArray(),n.level.bind(function(t){return $.from(Ad[t])}).toArray()]);return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(a=a,r=n.iconProvider,hu(a,function(t){return $.from(r()[t])}).getOrThunk(function(){return Zf(r)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[i.asSpec()],behaviours:Na([cd.config({})])}].concat(n.progress?[u.asSpec()]:[]).concat(Bd.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:td("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),apis:t}},configFields:[un("level"),Zt("progress"),Zt("icon"),Zt("onAction"),Zt("text"),Zt("iconProvider"),Zt("translationProvider")],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),Md=tinymce.util.Tools.resolve("tinymce.util.Delay");function Fd(t,i,u){var a=i.backstage;return{open:function(t,n){function e(){n(),Ed.hide(r)}var o=Yi(_d.sketch({text:t.text,level:lt(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:$.from(t.icon),onAction:e,iconProvider:a.shared.providers.icons,translationProvider:a.shared.providers.translate})),r=Yi(Ed.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:i.backstage.shared.getSink,fireDismissalEventInstead:{}}));return u.add(r),0<t.timeout&&Md.setTimeout(function(){e()},t.timeout),{close:e,moveTo:function(t,n){Ed.showAt(r,{anchor:"makeshift",x:t,y:n},qi(o))},moveRel:function(t,n){var e;"banner"!==n?(e=function(t){switch(t){case"bc-bc":return Dd;case"tc-tc":return Td;case"tc-bc":return Ra;case"bc-tc":default:return Va}}(n),t={anchor:"node",root:Cr(),node:$.some(me.fromDom(t)),layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}},Ed.showAt(r,t,qi(o))):Ed.showAt(r,i.backstage.shared.anchors.banner(),qi(o))},text:function(t){_d.updateText(o,t)},settings:t,getEl:function(){return o.element().dom()},progressBar:{value:function(t){_d.updateProgress(o,t)}}}},close:function(t){t.close()},reposition:function(t){var e;ft(t,function(t){return t.moveTo(0,0)}),0<(e=t).length&&(dt(e).each(function(t){return t.moveRel(null,"banner")}),ft(e,function(t,n){0<n&&t.moveRel(e[n-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}function Id(e,o){var r=null;return{cancel:function(){null!==r&&(b.clearTimeout(r),r=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null!==r&&b.clearTimeout(r),r=b.setTimeout(function(){e.apply(null,t),r=null},o)}}}function Rd(t,n,e,o,r){return r=new mm(n,r||t.getRoot()),hm(t,n,$.some(e),o,r.prev,$.none())}function Vd(e,n){return vm(me.fromDom(e.selection.getNode())).getOrThunk(function(){var t=me.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());return Ci(t,me.fromDom(n.extractContents())),n.insertNode(t.dom()),mo(t).each(function(t){return t.dom().normalize()}),fc(t).map(function(t){var n;e.selection.setCursorLocation(t.dom(),"img"===ze(n=t)?1:sc(n).fold(function(){return po(n).length},function(t){return t.length}))}),t})}function Hd(t,n){return t.toString().substring(n.length).replace(/\u00A0/g," ").replace(/\uFEFF/g,"")}function Nd(t,u,a,c){return void 0===c&&(c=0),(n=u).collapsed&&3===n.startContainer.nodeType?Rd(t,u.startContainer,u.startOffset,function(e,o,r,t){var i=t.getOr(r.length);return function(t,n,e,o){for(var r=n-1;0<=r;r--){var i=t.charAt(r);if(bm.test(i))return $.none();if(i===e)break}return-1===r||n-r<o?$.none():$.some(t.substring(r+1,n))}(r,i,a,1).fold(function(){return r.match(bm)?e.abort():e.kontinue()},function(t){var n=u.cloneRange();return n.setStart(o,i-t.length-1),n.setEnd(u.endContainer,u.endOffset),r.length<c?e.abort():e.finish({text:Hd(n,a),range:n,triggerChar:a})})}).fold($.none,$.none,$.some):$.none();var n}function Pd(e,t,o,n){return void 0===n&&(n=0),vm(me.fromDom(t.startContainer)).fold(function(){return Nd(e,t,o,n)},function(t){var n=e.createRng();return n.selectNode(t.dom()),$.some({range:n,text:Hd(n,o),triggerChar:o})})}function zd(t,n){return{element:t,offset:n}}function Ld(n){function e(t,n,e,o){return 0===(o=o.getOr(e.length))?t.kontinue():t.finish(/\s/.test(e.charAt(o-1)))}return function(t){t=Sm(t.startContainer,t.startOffset);return Rd(n,t.element,t.offset,e).fold(G(!0),G(!0),l)}}function jd(n,e){var o,r,t=e(),i=n.selection.getRng();return o=n.dom,r=i,hu(t.triggerChars,function(t){return Pd(o,r,t)}).bind(function(t){return km(n,e,t)})}function Ud(t){var n,e=t.ui.registry.getAll().popups,t=F(e,function(t){return qt("Autocompleter",Em,t).fold(function(t){throw new Error(Kn(t))},function(t){return t})}),e=(e=bt(t,function(t){return t.ch}),n={},ft(e,function(t){n[t]={}}),gt(n)),o=R(t);return{dataset:t,triggerChars:e,lookupByChar:function(n){return x(o,function(t){return t.ch===n})}}}function Wd(t,e,n){var o=dc(t.element(),"."+n);if(0<o.length){n=C(o,function(t){var n=t.dom().getBoundingClientRect().top,t=o[0].dom().getBoundingClientRect().top;return Math.abs(n-t)>e}).getOr(o.length);return $.some({numColumns:n,numRows:Math.ceil(o.length/n)})}return $.none()}function Gd(t,n){return Na([Af(t,n)])}function Xd(t,n,e){t.getSystem().broadcastOn([Fm],{})}function Yd(t){var n=me.fromHtml(t),e=po(n),o=function(t){t=void 0!==t.dom().attributes?t.dom().attributes:[];return S(t,function(t,n){return"class"===n.name?t:E(E({},t),((t={})[n.name]=n.value,t))},{})}(n),t=(t=n,Array.prototype.slice.call(t.dom().classList,0)),e=0===e.length?{}:{innerHtml:ko(n)};return E({tag:ze(n),classes:t,attributes:o},e)}function qd(t){return At(Lm,t).getOr(Nm)}function Kd(t){return{dom:{tag:"div",classes:[Um],innerHtml:t}}}function Jd(t){return{dom:{tag:"div",classes:[Wm]},components:[xr(Hm.translate(t))]}}function $d(t,n){return{dom:{tag:"div",classes:[Wm]},components:[{dom:{tag:t.tag,attributes:{style:t.styleAttr}},components:[xr(Hm.translate(n))]}]}}function Qd(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:qm(t)}}}function Zd(t){return{dom:{tag:"div",classes:[Um,"tox-collection__item-checkmark"],innerHtml:td("checkmark",t)}}}function tm(t,n,e,o,r){var i=e?t.checkMark.orThunk(function(){return n.or($.some("")).map(Kd)}):$.none(),e=t.ariaLabel.map(function(t){return{attributes:{title:Hm.translate(t)}}}).getOr({});return{dom:kt({tag:"div",classes:[Nm,Pm].concat(r?["tox-collection__item-icon-rtl"]:[])},e),optComponents:[i,t.htmlContent.fold(function(){return t.textContent.map(o)},function(t){return $.some({dom:{tag:"div",classes:[Wm],innerHtml:t}})}),t.shortcutContent.map(Qd),t.caret]}}function nm(t,o,n,r){void 0===r&&(r=$.none());var e,i,u,a,c,s=Hm.isRtl()&&t.iconContent.exists(function(t){return lt(Jm,t)}),l=t.iconContent.map(function(t){return Hm.isRtl()&&lt(Km,t)?t+"-rtl":t}).map(function(t){return n=t,e=o.icons,t=r,$.from(e()[n]).or(t).getOrThunk(function(){return Zf(e)});var n,e}),f=$.from(t.meta).fold(function(){return Jd},function(t){return yt(t,"style")?d($d,t.style):Jd});return"color"===t.presets?(c=t.ariaLabel,e=t.value,i=o,{dom:(u=zm,a=l.getOr(""),c=c.map(function(t){return' title="'+i.translate(t)+'"'}).getOr(""),Yd("custom"===e?'<button class="'+u+' tox-swatches__picker-btn"'+c+">"+a+"</button>":"remove"===e?'<div class="'+u+' tox-swatch--remove"'+c+">"+a+"</div>":'<div class="'+u+'" style="background-color: '+e+'" data-mce-color="'+e+'"'+c+"></div>")),optComponents:[]}):tm(t,l,n,f,s)}function em(t,n,e){n.disabled&&Qm(t,n)}function om(t,n){return!0===n.useNative&&lt($m,ze(t.element()))}function rm(t){Eo(t.element(),"disabled","disabled")}function im(t){Bo(t.element(),"disabled")}function um(t){Eo(t.element(),"aria-disabled","true")}function am(t){Eo(t.element(),"aria-disabled","false")}function cm(n,t,e){t.disableClass.each(function(t){Qo(n.element(),t)}),(om(n,t)?im:am)(n),t.onEnabled(n)}function sm(t,n){return om(t,n)?Do(t.element(),"disabled"):"true"===To(t.element(),"aria-disabled")}function lm(t,n){var e=t.getApi(n);return function(t){t(e)}}function fm(n,e){return yi(function(t){lm(n,t)(function(t){t=n.onSetup(t);null!=t&&e.set(t)})})}function dm(n,e){return xi(function(t){return lm(n,t)(e.get())})}var mm=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),gm=xt([{aborted:[]},{edge:["element"]},{success:["info"]}]),pm=xt([{abort:[]},{kontinue:[]},{finish:["info"]}]),hm=function(n,e,t,o,r,i){function u(){return i.fold(gm.aborted,gm.edge)}function a(){var t=r();return t?hm(n,t,$.none(),o,r,$.some(e)):u()}if(s=e,(c=n).isBlock(s)||lt(["BR","IMG","HR","INPUT"],s.nodeName)||"false"===c.getContentEditable(s))return u();if(e.nodeType!==b.Node.TEXT_NODE)return a();var c,s,s=e.textContent;return o(pm,e,s,t).fold(gm.aborted,a,gm.success)},vm=function(t){return du(t,"[data-mce-autocompleter]")},bm=/[\u00a0 \t\r\n]/,ym=function(e,t){t.on("keypress compositionend",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);function o(t,n){qe(t,Nr(),{raw:n})}t.on("keydown",function(n){function t(){return e.getView().bind(Kl.getHighlighted)}8===n.which&&e.onKeypress.throttle(n),e.isActive()&&(27===n.which&&e.cancelIfNecessary(),e.isMenuOpen()?13===n.which?(t().each(Ke),n.preventDefault()):40===n.which?(t().fold(function(){e.getView().each(Kl.highlightFirst)},function(t){o(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||t().each(function(t){o(t,n),n.preventDefault(),n.stopImmediatePropagation()}):13!==n.which&&38!==n.which&&40!==n.which||e.cancelIfNecessary())}),t.on("NodeChange",function(t){e.isActive()&&!e.isProcessingAction()&&vm(me.fromDom(t.element)).isNone()&&e.cancelIfNecessary()})},xm=tinymce.util.Tools.resolve("tinymce.util.Promise"),wm=function(t){if(t.nodeType===b.Node.TEXT_NODE)return zd(t,t.data.length);var n=t.childNodes;return 0<n.length?wm(n[n.length-1]):zd(t,n.length)},Sm=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?Sm(e[n],0):0<e.length&&t.nodeType===b.Node.ELEMENT_NODE&&e.length===n?wm(e[e.length-1]):zd(t,n)},km=function(n,t,e,o){void 0===o&&(o={});var t=t(),r=n.selection.getRng().startContainer.nodeValue,t=x(t.lookupByChar(e.triggerChar),function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk(function(){return Ld(n.dom)})(e.range,r,e.text)});if(0===t.length)return $.none();t=xm.all(y(t,function(n){return n.fetch(e.text,n.maxResults,o).then(function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction}})}));return $.some({lookupData:t,context:e})},Cm=Ln([nn("type"),sn("text")]),Om=Ln([Wn("type",function(){return"autocompleteitem"}),Wn("active",function(){return!1}),Wn("disabled",function(){return!1}),fn("meta",{}),nn("value"),sn("text"),sn("icon")]),Em=Ln([nn("type"),nn("ch"),ae("minChars",1),fn("columns",1),ae("maxResults",10),ue("matches"),re("fetch"),re("onAction")]),Re=[se("disabled",!1),sn("text"),sn("shortcut"),Gn("value","value",Tt(function(){return Mo("menuitem-value")}),$n()),fn("meta",{})],Tm=Ln([nn("type"),le("onSetup",function(){return W}),le("onAction",W),sn("icon")].concat(Re)),Dm=Ln([nn("type"),re("getSubmenuItems"),le("onSetup",function(){return W}),sn("icon")].concat(Re)),Bm=Ln([nn("type"),se("active",!1),le("onSetup",function(){return W}),re("onAction")].concat(Re)),Am=Ln([nn("type"),se("active",!1),sn("icon")].concat(Re)),_m=Ln([nn("type"),en("fancytype",["inserttable","colorswatch"]),le("onAction",W)]),Mm=function(t){return Gd(Mo("unnamed-events"),t)},Ua=[Zt("lazySink"),Zt("tooltipDom"),fn("exclusive",!0),fn("tooltipComponents",[]),fn("delay",300),ce("mode","normal",["normal","follow-highlight"]),fn("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:G([Va,Ra,Nu,zu,Pu,Lu]),onRtl:G([Va,Ra,Nu,zu,Pu,Lu])}}}),wa("onHide"),wa("onShow")],Ae=Object.freeze({init:function(){function e(){o.get().each(function(t){b.clearTimeout(t)})}var o=fe($.none()),n=fe($.none()),t=G("not-implemented");return Li({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set($.some(t))},clearTooltip:function(){n.set($.none())},clearTimer:e,resetTimer:function(t,n){e(),o.set($.some(b.setTimeout(function(){t()},n)))},readState:t})}}),Fm=Mo("tooltip.exclusive"),Im=Mo("tooltip.show"),Rm=Mo("tooltip.hide"),cl=Object.freeze({hideAllExclusive:Xd,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&cd.set(t,o)})}}),Vm=Ju({fields:Ua,name:"tooltipping",active:Object.freeze({events:function(r,i){function e(n){i.getTooltip().each(function(t){Wc(t),r.onHide(n,t),i.clearTooltip()}),i.clearTimer()}return bi(T([[to(Im,function(o){i.resetTimer(function(){var n,t,e;n=o,i.isShowing()||(Xd(n),t=r.lazySink(n).getOrDie(),e=n.getSystem().build({dom:r.tooltipDom,components:r.tooltipComponents,events:bi("normal"===r.mode?[to(Rr(),function(t){Ye(n,Im)}),to(Fr(),function(t){Ye(n,Rm)})]:[]),behaviours:Na([cd.config({})])}),i.setTooltip(e),jc(t,e),r.onShow(n,e),qs.position(t,r.anchor(n),e))},r.delay)}),to(Rm,function(t){i.resetTimer(function(){e(t)},r.delay)}),to(Kr(),function(t,n){lt(n.channels(),Fm)&&e(t)}),xi(function(t){e(t)})],"normal"===r.mode?[to(Vr(),function(t){Ye(t,Im)}),to(Yr(),function(t){Ye(t,Rm)}),to(Rr(),function(t){Ye(t,Im)}),to(Fr(),function(t){Ye(t,Rm)})]:[to(pi(),function(t,n){Ye(t,Im)}),to(hi(),function(t){Ye(t,Rm)})]]))}}),state:Ae,apis:cl}),Hm=tinymce.util.Tools.resolve("tinymce.util.I18n"),Nm="tox-menu-nav__js",Pm="tox-collection__item",zm="tox-swatch",Lm={normal:Nm,color:zm},jm="tox-collection__item--enabled",Um="tox-collection__item-icon",Wm="tox-collection__item-label",Gm="tox-collection__item-caret",Xm="tox-collection__item--active",Ym=tinymce.util.Tools.resolve("tinymce.Env"),qm=function(t){var e=Ym.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},t=t.split("+"),t=y(t,function(t){var n=t.toLowerCase().trim();return yt(e,n)?e[n]:t});return Ym.mac?t.join(""):t.join("+")},Km=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Jm=["list-bull-circle","list-bull-default","list-bull-square"],$m=["input","button","textarea","select"],Qm=function(n,t,e){t.disableClass.each(function(t){Jo(n.element(),t)}),(om(n,t)?rm:um)(n),t.onDisabled(n)},Ie=Object.freeze({enable:cm,disable:Qm,isDisabled:sm,onLoad:em,set:function(t,n,e,o){(o?Qm:cm)(t,n,e)}}),Bi=Object.freeze({exhibit:function(t,n,e){return No({classes:n.disabled?n.disableClass.map(_).getOr([]):[]})},events:function(e,t){return bi([Qe(Jr(),function(t,n){return sm(t,e)}),Xu(e,t,em)])}}),Gr=[fn("disabled",!1),fn("useNative",!0),un("disableClass"),wa("onDisabled"),wa("onEnabled")],Zm=Ju({fields:Gr,name:"disabling",active:Bi,apis:Ie}),tg=function(t){return Zm.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},ng=function(t){return Zm.config({disabled:t})},eg=function(t){return Zm.config({disabled:t,disableClass:"tox-tbtn--disabled"})},og=function(t){return Zm.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})};function rg(t){return O(t,function(t){return t.toArray()})}function ig(t,n,e){var o,r,i=fe(W);return{type:"item",dom:n.dom,components:rg(n.optComponents),data:t.data,eventOrder:lg,hasSubmenu:t.triggersSubmenu,itemBehaviours:Na([Af("item-events",[(o=t,r=e,Si(function(t,n){lm(o,t)(o.onAction),o.triggersSubmenu||r!==sg.CLOSE_ON_EXECUTE||(Ye(t,ti()),n.stop())})),fm(t,i),dm(t,i)]),tg(t.disabled),cd.config({})].concat(t.itemBehaviours))}}function ug(t){return{value:t.value,meta:kt({text:t.text.getOr("")},t.meta)}}function ag(t,n){if(t=t=Hm.translate(t),t=fg.DOM.encode(t),0<n.length){n=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return t.replace(n,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})}return t}function cg(n,e,t){function o(t){return qe(t,gg,{row:n,col:e})}function r(t,n){n.stop(),o(t)}var i;return Yi({dom:{tag:"div",attributes:((i={role:"button"})["aria-labelledby"]=t,i)},behaviours:Na([Af("insert-table-picker-cell",[to(Rr(),sd.focus),to(Jr(),o),to(jr(),r),to(Qr(),r)]),dd.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),sd.config({onFocus:function(t){return qe(t,mg,{row:n,col:e})}})])})}(Oa=sv=sv||{})[Oa.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",Oa[Oa.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var sg=sv,lg={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},fg=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),dg=G(ls(jf(),vd())),mg=Mo("cell-over"),gg=Mo("cell-execute");function pg(t){return{value:G(t)}}function hg(t){return Eg.test(t)||Tg.test(t)}function vg(t){return t=function(t){t=t.value().replace(Eg,function(t,n,e,o){return n+n+e+e+o+o});return{value:G(t)}}(t),null===(t=Tg.exec(t.value()))?["FFFFFF","FF","FF","FF"]:t}function bg(t){return 1===(t=t.toString(16)).length?"0"+t:t}function yg(t){return t=bg(t.red())+bg(t.green())+bg(t.blue()),pg(t)}function xg(t,n,e,o){return{red:G(t),green:G(n),blue:G(e),alpha:G(o)}}function wg(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255}function Sg(t){var n,e,o,r=(t.hue()||0)%360,i=t.saturation()/100,t=t.value()/100,i=Bg(0,Dg(i,1)),t=Bg(0,Dg(t,1));if(0===i)return n=e=o=Ag(255*t),xg(n,e,o,1);var r=r/60,u=t*i,a=u*(1-Math.abs(r%2-1)),t=t-u;switch(Math.floor(r)){case 0:n=u,e=a,o=0;break;case 1:n=a,e=u,o=0;break;case 2:n=0,e=u,o=a;break;case 3:n=0,e=a,o=u;break;case 4:n=a,e=0,o=u;break;case 5:n=u,e=0,o=a;break;default:n=e=o=0}return n=Ag(255*(n+t)),e=Ag(255*(e+t)),o=Ag(255*(o+t)),xg(n,e,o,1)}function kg(t){var n=vg(t),e=parseInt(n[1],16),t=parseInt(n[2],16),n=parseInt(n[3],16);return xg(e,t,n,1)}function Cg(t,n,e,o){return t=parseInt(t,10),n=parseInt(n,10),e=parseInt(e,10),o=parseFloat(o),xg(t,n,e,o)}function Og(t){return"rgba("+t.red()+","+t.green()+","+t.blue()+","+t.alpha()+")"}var Eg=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Tg=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Dg=Math.min,Bg=Math.max,Ag=Math.round,_g=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Mg=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Fg=G(xg(255,0,0,1)),Ig=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Rg="tinymce-custom-colors";function Vg(t){var n=[],r=b.document.createElement("canvas");r.height=1,r.width=1;for(var i=r.getContext("2d"),u=function(t,n){n/=255;return("0"+Math.round(t*n+255*(1-n)).toString(16)).slice(-2).toUpperCase()},e=0;e<t.length;e+=2)n.push({text:t[e+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();i.clearRect(0,0,r.width,r.height),i.fillStyle="#FFFFFF",i.fillStyle=t,i.fillRect(0,0,1,1);var n=i.getImageData(0,0,1,1).data,e=n[0],o=n[1],t=n[2],n=n[3];return"#"+u(e,n)+u(o,n)+u(t,n)}(t[e]),type:"choiceitem"});return n}function Hg(t){return t.getParam("color_map")}function Ng(t,n){var e;return t.dom.getParents(t.selection.getStart(),function(t){(t=t.style["forecolor"===n?"color":"background-color"])&&(e=e||t)}),e}function Pg(i){i.addCommand("mceApplyTextcolor",function(t,n){var e,o,r;o=t,r=n,(e=i).undoManager.transact(function(){e.focus(),e.formatter.apply(o,{value:r}),e.nodeChanged()})}),i.addCommand("mceRemoveTextcolor",function(t){var n,e;e=t,(n=i).undoManager.transact(function(){n.focus(),n.formatter.remove(e,{value:null},null,!0),n.nodeChanged()})})}function zg(t){return Math.max(5,Math.ceil(Math.sqrt(t)))}function Lg(t){var n=dp(t),n=zg(n.length);return lp(t,n)}function jg(n,e,t,o){"custom"===t?xp(n)(function(t){t.each(function(t){gp(t),n.execCommand("mceApplyTextcolor",e,t),o(t)})},"#000000"):"remove"===t?(o(""),n.execCommand("mceRemoveTextcolor",e)):(o(t),n.execCommand("mceApplyTextcolor",e,t))}function Ug(t,n){return t.concat(mp().concat((t={type:e="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[t,{type:e,text:"Custom color",icon:"color-picker",value:"custom"}]:[t])));var e}function Wg(n,e){return function(t){t(Ug(n,e))}}function Gg(t,n,e){n="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",e=e,t.setIconFill(n,e),t.setIconStroke(n,e)}function Xg(e,o,r,t,i){e.ui.registry.addSplitButton(o,{tooltip:t,presets:"color",icon:"forecolor"===o?"text-color":"highlight-bg-color",select:function(n){return $.from(Ng(e,r)).bind(function(t){return function(t){if("transparent"===t)return $.some(xg(0,0,0,0));var n=_g.exec(t);if(null!==n)return $.some(Cg(n[1],n[2],n[3],"1"));t=Mg.exec(t);return null!==t?$.some(Cg(t[1],t[2],t[3],t[4])):$.none()}(t).map(function(t){t=yg(t).value();return xn(n.toLowerCase(),t)})}).getOr(!1)},columns:Lg(e),fetch:Wg(dp(e),fp(e)),onAction:function(t){null!==i.get()&&jg(e,r,i.get(),function(){})},onItemAction:function(t,n){jg(e,r,n,function(t){i.set(t),yp(e,{name:o,color:t})})},onSetup:function(n){null!==i.get()&&Gg(n,o,i.get());function t(t){t.name===o&&Gg(n,t.name,t.color)}return e.on("TextColorChange",t),function(){e.off("TextColorChange",t)}}})}function Yg(n,t,e,o){n.ui.registry.addNestedMenuItem(t,{text:o,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){jg(n,e,t.value,W)}}]}})}function qg(n,e){return function(t){t=v(t,e);return y(t,function(t){return{dom:n,components:t}})}}function Kg(t,e){var o=[],r=[];return ft(t,function(t,n){e(t,n)?(0<r.length&&o.push(r),r=[],yt(t.dom,"innerHtml")&&r.push(t)):r.push(t)}),0<r.length&&o.push(r),y(o,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})}function Jg(n,e,t){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[xd.parts().items({preprocess:function(t){return"auto"!==n&&1<n?qg({tag:"div",classes:["tox-collection__group"]},n)(t):Kg(t,function(t,n){return"separator"===e[n].type})}})]}}function $g(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}}function Qg(t){var n=$g(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:qd(t)}}function Zg(t,n,e){var o=$g(e);return{dom:{tag:"div",classes:T([[o.tieredMenu]])},markers:Qg(e)}}function tp(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type}function np(t){return b.console.error(Kn(t)),b.console.log(t),$.none()}function ep(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[xd.parts().items({preprocess:function(t){return Kg(t,function(t,n){return"separator"===i[n].type})}})]});return{value:t,dom:u.dom,components:u.components,items:e}}function op(t,n,e,o,r){var i;return"color"===r?{value:t,dom:(i=(i=o,{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[xd.parts().items({preprocess:"auto"!==i?qg({tag:"div",classes:["tox-swatches__row"]},i):l})]}]})).dom,components:i.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(i=Jg(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=Jg(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=Jg(o,e)).dom,components:i.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:function(t,n,e){e=$g(e);return{tag:"div",classes:T([[e.menu,"tox-menu-"+n+"-column"],t?[e.hasIcons]:[]])}}(n,o,r),components:Sp,items:e}:{value:t,dom:(i=(o=o,{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[xd.parts().items({preprocess:qg({tag:"div",classes:["tox-collection__group"]},o)})]})).dom,components:i.components,items:e}}function rp(t,n,e,o,r,i,u,a){var c=h(n,tp),a=kp(n,e,o,"color"!==r?"normal":"color",i,u,a);return op(t,c,a,o,r)}function ip(t,n){var e=Qg(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}}var up,ap="choiceitem",cp=[{type:ap,text:"Light Green",value:"#BFEDD2"},{type:ap,text:"Light Yellow",value:"#FBEEB8"},{type:ap,text:"Light Red",value:"#F8CAC6"},{type:ap,text:"Light Purple",value:"#ECCAFA"},{type:ap,text:"Light Blue",value:"#C2E0F4"},{type:ap,text:"Green",value:"#2DC26B"},{type:ap,text:"Yellow",value:"#F1C40F"},{type:ap,text:"Red",value:"#E03E2D"},{type:ap,text:"Purple",value:"#B96AD9"},{type:ap,text:"Blue",value:"#3598DB"},{type:ap,text:"Dark Turquoise",value:"#169179"},{type:ap,text:"Orange",value:"#E67E23"},{type:ap,text:"Dark Red",value:"#BA372A"},{type:ap,text:"Dark Purple",value:"#843FA1"},{type:ap,text:"Dark Blue",value:"#236FA1"},{type:ap,text:"Light Gray",value:"#ECF0F1"},{type:ap,text:"Medium Gray",value:"#CED4D9"},{type:ap,text:"Gray",value:"#95A5A6"},{type:ap,text:"Dark Gray",value:"#7E8C8D"},{type:ap,text:"Navy Blue",value:"#34495E"},{type:ap,text:"Black",value:"#000000"},{type:ap,text:"White",value:"#ffffff"}],sp=function(n){void 0===n&&(n=10);var t=Ig.getItem(Rg),t=nt(t)?JSON.parse(t):[],e=n-(t=t).length<0?t.slice(0,n):t,o=function(t){e.splice(t,1)};return{add:function(t){(function(t,n){n=r(t,n);return-1===n?$.none():$.some(n)})(e,t).each(o),e.unshift(t),e.length>n&&e.pop(),Ig.setItem(Rg,JSON.stringify(e))},state:function(){return e.slice(0)}}}(10),lp=function(t,n){return t.getParam("color_cols",n,"number")},fp=function(t){return!1!==t.getParam("custom_colors")},dp=function(t){t=Hg(t);return void 0!==t?Vg(t):cp},mp=function(){return y(sp.state(),function(t){return{type:ap,text:t,value:t}})},gp=function(t){sp.add(t)},pp=function(t){return t.fire("SkinLoaded")},hp=function(t){return t.fire("ResizeEditor")},vp=function(t,n){return t.fire("ScrollContent",n)},bp=function(t,n){return t.fire("ResizeContent",n)},yp=function(t,n){return t.fire("TextColorChange",n)},xp=function(r){return function(t,n){var e,o={colorpicker:n},n=(e=t,function(t){var n=t.getData();e($.from(n.colorpicker)),t.close()});r.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:n,onClose:function(){},onCancel:function(){t($.none())}})}},wp={register:function(t){Pg(t);var n=fe(null),e=fe(null);Xg(t,"forecolor","forecolor","Text color",n),Xg(t,"backcolor","hilitecolor","Background color",e),Yg(t,"forecolor","forecolor","Text color"),Yg(t,"backcolor","hilitecolor","Background color")},getColors:Ug,getFetch:Wg,colorPickerDialog:xp,getCurrentColor:Ng,getColorCols:Lg,calcCols:zg},Sp=[xd.parts().items({})],kp=function(t,e,o,r,i,u,a){return pu(y(t,function(n){return"choiceitem"===n.type?qt("choicemenuitem",Am,n).fold(np,function(t){return $.some(function(n,t,e,o,r,i,u){u=nm({presets:e,textContent:t?n.text:$.none(),htmlContent:$.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:$.none(),checkMark:t?$.some(Zd(u.icons)):$.none(),caret:$.none(),value:n.value},u,!0);return St(ig({data:ug(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){dd.set(n,t)},isActive:function(){return dd.isOn(n)},isDisabled:function(){return Zm.isDisabled(n)},setDisabled:function(t){return Zm.set(n,t)}}},onAction:function(t){return o(n.value)},onSetup:function(t){return t.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},u,i),{toggling:{toggleClass:jm,toggleOnExecute:!1,selected:n.active}})}(t,1===o,r,e,u(n.value),i,a))}):$.none()}))},Cp={inserttable:function(o){var t=Mo("size-label"),r=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(cg(r,u,t));o.push(i)}return o}(t,10,10),i=Qf({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[xr("0x0")],behaviours:Na([cd.config({})])});return{type:"widget",data:{value:Mo("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[dg().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:O(r,function(t){return y(t,qi)}).concat(i.asSpec()),behaviours:Na([Af("insert-table-picker",[ro(mg,function(t,n,e){var o=e.event().row(),e=e.event().col();!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)dd.set(t[i][u],i<=n&&u<=e)}(r,o,e,10,10),cd.set(i.get(t),[xr(e+1+"x"+(o+1))])}),ro(gg,function(t,n,e){o.onAction({numRows:e.event().row()+1,numColumns:e.event().col()+1}),Ye(t,ti())})]),ud.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=wp.getColors(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),t=rp(Mo("menu-value"),e,function(t){n.onAction({value:t})},o,"color",sg.CLOSE_ON_EXECUTE,function(){return!1},t.shared.providers),o=St(E(E({},t),{markers:Qg("color"),movement:ip(o,"color")}));return{type:"widget",data:{value:Mo("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[dg().widget(xd.sketch(o))]}}},Op=function(n,e,t,o,r,i,u,a){void 0===a&&(a=!0);var c,t=nm({presets:o,textContent:$.none(),htmlContent:t?n.text.map(function(t){return ag(t,e)}):$.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:$.none(),checkMark:$.none(),caret:$.none(),value:n.value},u.providers,a,n.icon);return ig({data:ug(n),disabled:n.disabled,getApi:function(){return{}},onAction:function(t){return r(n.value,n.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:(a=n.meta,c=u,V(a,"tooltipWorker").map(function(e){return[Vm.config({lazySink:c.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:Us}}},mode:"follow-highlight",onShow:function(n,t){e(function(t){Vm.setComponents(n,[Gi({element:me.fromDom(t)})])})}})]}).getOr([]))},t,i)},Ep=function(t){t=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:E({tag:"div",classes:[Pm,"tox-collection__group-heading"]},t),components:[]}},Tp=function(t,n,e,o){void 0===o&&(o=!0);o=nm({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:$.none(),ariaLabel:t.text,caret:$.none(),checkMark:$.none(),shortcutContent:t.shortcut},e,o);return ig({data:ug(t),getApi:function(n){return{isDisabled:function(){return Zm.isDisabled(n)},setDisabled:function(t){return Zm.set(n,t)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n)},Dp=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i,i=r?(r=e.icons,{dom:{tag:"div",classes:[Gm],innerHtml:td("chevron-down",r)}}):(i=e.icons,{dom:{tag:"div",classes:[Gm],innerHtml:td("chevron-right",i)}}),o=nm({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:$.none(),ariaLabel:t.text,caret:$.some(i),checkMark:$.none(),shortcutContent:t.shortcut},e,o);return ig({data:ug(t),getApi:function(n){return{isDisabled:function(){return Zm.isDisabled(n)},setDisabled:function(t){return Zm.set(n,t)}}},disabled:t.disabled,onAction:W,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},o,n)},Bp=function(t,n,e){e=nm({iconContent:$.none(),textContent:t.text,htmlContent:$.none(),ariaLabel:t.text,checkMark:$.some(Zd(e.icons)),caret:$.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,!0);return St(ig({data:ug(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){dd.set(n,t)},isActive:function(){return dd.isOn(n)},isDisabled:function(){return Zm.isDisabled(n)},setDisabled:function(t){return Zm.set(n,t)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},e,n),{toggling:{toggleClass:jm,toggleOnExecute:!1,selected:t.active}})},Ap=function(n,e){return t=Cp,o=n.fancytype,(Object.prototype.hasOwnProperty.call(t,o)?$.some(t[o]):$.none()).map(function(t){return t(n,e)});var t,o};function _p(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type}function Mp(t){return h(t,_p)}function Fp(t,n,e,o,r){function i(t){return r?E(E({},t),{shortcut:$.none(),icon:t.text.isSome()?$.none():t.icon}):t}var u=e.shared.providers;switch(t.type){case"menuitem":return qt("menuitem",Tm,t).fold(np,function(t){return $.some(Tp(i(t),n,u,o))});case"nestedmenuitem":return qt("nestedmenuitem",Dm,t).fold(np,function(t){return $.some(Dp(i(t),n,u,o,r))});case"togglemenuitem":return qt("togglemenuitem",Bm,t).fold(np,function(t){return $.some(Bp(i(t),n,u))});case"separator":return qt("separatormenuitem",Cm,t).fold(np,function(t){return $.some(Ep(t))});case"fancymenuitem":return qt("fancymenuitem",_m,t).fold(np,function(t){return Ap(i(t),e)});default:return b.console.error("Unknown item in general menu",t),$.none()}}function Ip(t,n,e,o,r,i){var u=1===o,a=!u||Mp(t);return pu(y(t,function(t){return"separator"===t.type?qt("Autocompleter.Separator",Cm,t).fold(np,function(t){return $.some(Ep(t))}):qt("Autocompleter.Item",Om,t).fold(np,function(t){return $.some(Op(t,n,u,"normal",e,r,i,a))})}))}function Rp(t,n,e,o,r){var i=Mp(n),n=pu(y(n,function(t){function n(t){return Fp(t,e,o,(t=t,r?!t.hasOwnProperty("text"):i),r)}return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(kt(t,{disabled:!0})):n(t)}));return(r?ep:op)(t,i,n,1,"normal")}function Vp(t){return Od.singleData(t.value,t)}function Hp(t){var n,e,o,r,i,u=me.fromDom(t.target),a=c(i=function(){t.preventDefault()},r=function(){t.stopPropagation()});return n=u,e=t.clientX,o=t.clientY,u=r,r=i,i=a,a=t,{target:G(n),x:G(e),y:G(o),stop:u,prevent:r,kill:i,raw:G(a)}}function Np(t,n,e,o,r){var i,u,o=(i=e,u=o,function(t){i(t)&&u(Hp(t))});return t.dom().addEventListener(n,o,r),{unbind:d(Up,t,n,o,r)}}function Pp(t,n,e){return Np(t,n,Wp,e,!1)}function zp(t,n,e){return Np(t,n,Wp,e,!0)}function Lp(t,n,e){return du(t,n,e).isSome()}(Ai=up=up||{})[Ai.ContentFocus=0]="ContentFocus",Ai[Ai.UiFocus=1]="UiFocus";var jp=function(a,c){function e(){return o.get().isSome()}function s(){e()&&Ed.hide(d)}function l(t,n,e,o){t.matchLength=n.text.length;var r,i,u=hu(e,function(t){return $.from(t.columns)}).getOr(1);Ed.showAt(d,{anchor:"node",root:me.fromDom(a.getBody()),node:$.from(t.element)},xd.sketch((r=op("autocompleter-value",!0,o,u,"normal"),n=u,e=up.ContentFocus,t="normal",o=(e===up.ContentFocus?Pl:Nl)(),u=ip(n,t),i=Qg(t),{dom:r.dom,components:r.components,items:r.items,value:r.value,markers:{selectedItem:i.selectedItem,item:i.item},movement:u,fakeFocus:e===up.ContentFocus,focusManager:o,menuBehaviours:Mm("auto"!==n?[]:[yi(function(e,t){Wd(e,4,i.item).each(function(t){var n=t.numColumns,t=t.numRows;ud.setGridSize(e,t,n)})})])}))),Ed.getContent(d).each(Kl.highlightFirst)}var o=fe($.none()),f=fe(!1),d=Yi(Ed.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Na([Af("dismissAutocompleter",[to(si(),function(){return m()})])]),lazySink:c.getSink})),m=function(){var t;e()&&(t=o.get().map(function(t){return t.element}),vm(t.getOr(me.fromDom(a.selection.getNode()))).each(So),s(),o.set($.none()),f.set(!1))},r=H(function(){return Ud(a)}),g=function(t){var n;n=t,o.get().map(function(t){return Pd(a.dom,a.selection.getRng(),t.triggerChar).bind(function(t){return km(a,r,t,n)})}).getOrThunk(function(){return jd(a,r)}).fold(m,function(u){var t,n;t=u.context,e()||(n=Vd(a,t.range),o.set($.some({triggerChar:t.triggerChar,element:n,matchLength:t.text.length})),f.set(!1)),u.lookupData.then(function(i){o.get().map(function(t){var n,e,o,r=u.context;t.triggerChar===r.triggerChar&&(n=r.triggerChar,o=hu(e=i,function(t){return $.from(t.columns)}).getOr(1),0<(e=O(e,function(r){var t=r.items;return Ip(t,r.matchText,function(e,o){var t=a.selection.getRng();Pd(a.dom,t,n).fold(function(){return b.console.error("Lost context. Cursor probably moved")},function(t){var n=t.range,t={hide:function(){m()},reload:function(t){s(),g(t)}};f.set(!0),r.onAction(t,n,e,o),f.set(!1)})},o,sg.BUBBLE_TO_SANDBOX,c)})).length?l(t,r,i,e):(10<=r.text.length-t.matchLength?m:s)())})})})},t={onKeypress:Id(function(t){27!==t.which&&g()},50),cancelIfNecessary:m,isMenuOpen:function(){return Ed.isOpen(d)},isActive:e,isProcessingAction:f.get,getView:function(){return Ed.getContent(d)}};ym(t,a)},Up=function(t,n,e,o){t.dom().removeEventListener(n,e,o)},Wp=G(!0),Gp=Hp;function Xp(e,o){var r=null;return{cancel:function(){null!==r&&(b.clearTimeout(r),r=null)},schedule:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r=b.setTimeout(function(){e.apply(null,t),r=null},o)}}}function Yp(t){return void 0===(t=t.raw()).touches||1!==t.touches.length?$.none():$.some(t.touches[0])}function qp(e){var r=fe($.none()),o=fe(!1),i=Xp(function(t){e.triggerEvent(Zr(),t),o.set(!0)},400),u=X([{key:Tr(),value:function(n){return Yp(n).each(function(t){i.cancel();t={x:G(t.clientX),y:G(t.clientY),target:n.target};i.schedule(n),o.set(!1),r.set($.some(t))}),$.none()}},{key:Dr(),value:function(t){return i.cancel(),Yp(t).each(function(o){r.get().each(function(t){var n,e;n=o,e=t,t=Math.abs(n.clientX-e.x()),e=Math.abs(n.clientY-e.y()),(5<t||5<e)&&r.set($.none())})}),$.none()}},{key:Br(),value:function(n){i.cancel();return r.get().filter(function(t){return On(t.target(),n.target())}).map(function(t){return o.get()?(n.prevent(),!1):e.triggerEvent(Qr(),n)})}}]);return{fireIfReady:function(n,t){return At(u,t).bind(function(t){return t(n)})}}}function Kp(n,t){var e,o=Jt("Getting GUI events settings",th,t),r=qp(o),i=y(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return Pp(n,t,function(n){r.fireIfReady(n,t).each(function(t){t&&n.kill()}),o.triggerEvent(t,n)&&n.kill()})}),u=fe($.none()),a=Pp(n,"paste",function(n){r.fireIfReady(n,"paste").each(function(t){t&&n.kill()}),o.triggerEvent("paste",n)&&n.kill(),u.set($.some(b.setTimeout(function(){o.triggerEvent(qr(),n)},0)))}),c=Pp(n,"keydown",function(t){var n;o.triggerEvent("keydown",t)?t.kill():!0!==o.stopBackspace||(8!==(n=t).raw().which||lt(["input","textarea"],ze(n.target()))||Lp(n.target(),'[contenteditable="true"]'))||t.prevent()}),s=(e=n,t=function(t){o.triggerEvent("focusin",t)&&t.kill()},Zp?zp(e,"focus",t):Pp(e,"focusin",t)),l=fe($.none()),f=(e=n,t=function(t){o.triggerEvent("focusout",t)&&t.kill(),l.set($.some(b.setTimeout(function(){o.triggerEvent(Yr(),t)},0)))},Zp?zp(e,"blur",t):Pp(e,"focusout",t));return{unbind:function(){ft(i,function(t){t.unbind()}),c.unbind(),s.unbind(),f.unbind(),a.unbind(),u.get().each(b.clearTimeout),l.get().each(b.clearTimeout)}}}function Jp(t,n){return n=At(t,"target").map(function(t){return t()}).getOr(n),fe(n)}function $p(t,o,n,e,r,i){var u,a,t=t(o,e),c=(n=n,r=r,u=fe(!1),a=fe(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:G(n),setSource:r.set,getSource:r.get});return t.fold(function(){return i.logEventNoHandlers(o,e),nh.complete()},function(n){var e=n.descHandler();return zo(e)(c),c.isStopped()?(i.logEventStopped(o,n.element(),e.purpose()),nh.stopped()):c.isCut()?(i.logEventCut(o,n.element(),e.purpose()),nh.complete()):mo(n.element()).fold(function(){return i.logNoParent(o,n.element(),e.purpose()),nh.complete()},function(t){return i.logEventResponse(o,n.element(),e.purpose()),nh.resume(t)})})}function Qp(t,n,e){var o,r=(n=n,o=fe(!1),{stop:function(){o.set(!0)},cut:W,isStopped:o.get,isCut:G(!1),event:G(n),setSource:i("Cannot set source of a broadcasted event"),getSource:i("Cannot get source of a broadcasted event")});return ft(t,function(t){t=t.descHandler();zo(t)(r)}),r.isStopped()}var Zp=wn().browser.isFirefox(),th=jt([re("triggerEvent"),fn("stopBackspace",!0)]),nh=xt([{stopped:[]},{resume:["element"]},{complete:[]}]),eh=function(n,e,o,t,r,i){return $p(n,e,o,t,r,i).fold(function(){return!0},function(t){return eh(n,e,o,t,r,i)},function(){return!1})},oh=function(t,n,e,o,r){var i=Jp(e,o);return eh(t,n,e,o,i,r)},rh=Dk("element","descHandler"),ih=function(t,n){return{id:G(t),descHandler:G(n)}};function uh(){var i={};return{registerId:function(o,r,t){ht(t,function(t,n){var e=void 0!==i[n]?i[n]:{};e[r]=ji(t,o),i[n]=e})},unregisterId:function(e){ht(i,function(t,n){t.hasOwnProperty(e)&&delete t[e]})},filterByType:function(t){return At(i,t).map(function(t){return bt(t,function(t,n){return ih(n,t)})}).getOr([])},find:function(t,n,e){var o=Bt(n)(i);return Er(e,function(t){return n=o,Ii(e=t).fold(function(){return $.none()},function(t){t=Bt(t);return n.bind(t).map(function(t){return rh(e,t)})});var n,e},t)}}}function ah(){function o(t){var n=t.element();return Ii(n).fold(function(){return function(t,n){t=Mo(_i+t);return Fi(n,t),t}("uid-",t.element())},function(t){return t})}var r=uh(),i={},u=function(t){Ii(t.element()).each(function(t){delete i[t],r.unregisterId(t)})};return{find:function(t,n,e){return r.find(t,n,e)},filter:function(t){return r.filterByType(t)},register:function(t){var n=o(t);q(i,n)&&function(t,n){var e=i[n];if(e!==t)throw new Error('The tagId "'+n+'" is already used by: '+_o(e.element())+"\nCannot use it for: "+_o(t.element())+"\nThe conflicting element is"+(Le(e.element())?" ":" not ")+"already in the DOM");u(t)}(t,n);var e=[t];r.registerId(e,n,t.events()),i[n]=t},unregister:u,getById:function(t){return Bt(t)(i)}}}function ch(e){function o(n){return mo(e.element()).fold(function(){return!0},function(t){return On(n,t)})}function c(t,n){return i.find(o,t,n)}function r(n){var t=i.filter(Kr());ft(t,function(t){t=t.descHandler();zo(t)(n)})}var i=ah(),t=Kp(e.element(),{triggerEvent:function(i,u){return Bu(i,u.target(),function(t){return n=c,e=i,r=t,t=(o=u).target(),oh(n,e,o,t,r);var n,e,o,r})}}),u={debugInfo:G("real"),triggerEvent:function(n,e,o){Bu(n,e,function(t){oh(c,n,o,e,t)})},triggerFocus:function(u,a){Ii(u).fold(function(){$u(u)},function(t){Bu(Xr(),u,function(t){var n,e,o,r,i;n=c,e=Xr(),o={originator:G(a),kill:W,prevent:W,target:G(u)},i=t,t=Jp(o,r=u),$p(n,e,o,r,t,i)})})},triggerEscape:function(t,n){u.triggerEvent("keydown",t.element(),n.event())},getByUid:function(t){return g(t)},getByDom:function(t){return p(t)},build:Yi,addToGui:function(t){s(t)},removeFromGui:function(t){l(t)},addToWorld:function(t){n(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){f(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:G(!0)},n=function(t){t.connect(u),kr(t.element())||(i.register(t),ft(t.components(),n),u.triggerEvent(ei(),t.element(),{target:G(t.element())}))},a=function(t){kr(t.element())||(ft(t.components(),a),i.unregister(t)),t.disconnect()},s=function(t){jc(e,t)},l=function(t){Wc(t)},f=function(t){r({universal:G(!0),data:G(t)})},d=function(t,n){r({universal:G(!1),channels:G(t),data:G(n)})},m=function(t,n){t=i.filter(t);return Qp(t,n)},g=function(t){return i.getById(t).fold(function(){return tt.error(new Error('Could not find component with uid: "'+t+'" in system.'))},tt.value)},p=function(t){t=Ii(t).getOr("not found");return g(t)};return n(e),{root:G(e),element:e.element,destroy:function(){t.unbind(),Oi(e.element())},add:s,remove:l,getByUid:g,getByDom:p,addToWorld:n,removeFromWorld:a,broadcast:f,broadcastOn:d,broadcastEvent:m}}function sh(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))}function lh(t){return t.getParam("width",fg.DOM.getStyle(t.getElement(),"width"))}function fh(t){return $.from(t.settings.min_width).filter(ut)}function dh(t){return $.from(t.settings.min_height).filter(ut)}function mh(t){return $.from(t.getParam("max_width")).filter(ut)}function gh(t){return $.from(t.getParam("max_height")).filter(ut)}function ph(t){return!1!==t.getParam("menubar",!0,"boolean")}function hh(t){var n=!0===(o=t.getParam("toolbar",!0)),e=nt(o),o=ot(o)&&0<o.length;return!wh(t)&&(o||e||n)}function vh(n){var t=gt(n.settings),t=x(t,function(t){return/^toolbar([1-9])$/.test(t)}),t=y(t,function(t){return n.getParam(t,!1,"string")});return 0<(t=x(t,function(t){return"string"==typeof t})).length?$.some(t):$.none()}var bh,yh=kl({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,n=f(n,["attributes"]);return{uid:t.uid,dom:E({tag:"div",attributes:E({role:"presentation"},e)},n),components:t.components,behaviours:os(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[fn("components",[]),Fe("containerBehaviours",[]),fn("events",{}),fn("domModification",{}),fn("eventOrder",{})]}),xh=tinymce.util.Tools.resolve("tinymce.EditorManager"),wh=function(t){return vh(t).fold(function(){return 0<t.getParam("toolbar",[],"string[]").length},function(){return!0})};function Sh(t){return t.getParam("toolbar_drawer","","string")}function kh(t){var n=t.getParam("fixed_toolbar_container","","string");return 0<n.length&&t.inline?fu(Cr(),n):$.none()}function Ch(t){return t.inline&&kh(t).isSome()}function Oh(t){return t.inline&&!ph(t)&&!hh(t)&&!wh(t)}function Eh(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Ch(t)&&!Oh(t)}function Th(t){return void 0===t.touches||1!==t.touches.length?$.none():$.some(t.touches[0])}function Dh(t){return Na([sd.config({onFocus:!1===t.selectOnFocus?W:function(t){var n=t.element(),t=dr(n);n.dom().setSelectionRange(0,t.length)}})])}function Bh(t){return{tag:t.tag,attributes:E({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}}(Ga=bh=bh||{}).default="",Ga.floating="floating",Ga.sliding="sliding",Ga.scrolling="scrolling";var Ah,_h,Mh,Fh,Ih=function(r){var i=fe($.none()),u=fe(!1),e=Id(function(t){r.fire("longpress",E(E({},t),{type:"longpress"})),u.set(!0)},400);r.on("touchstart",function(n){Th(n).each(function(t){e.cancel();t={x:G(t.clientX),y:G(t.clientY),target:G(n.target)};e.throttle(n),u.set(!1),i.set($.some(t))})},!0),r.on("touchmove",function(t){e.cancel(),Th(t).each(function(o){i.get().each(function(t){var n,e;n=o,e=t,t=Math.abs(n.clientX-e.x()),e=Math.abs(n.clientY-e.y()),(5<t||5<e)&&(i.set($.none()),u.set(!1),r.fire("longpresscancel"))})})},!0),r.on("touchend touchcancel",function(n){e.cancel(),"touchcancel"!==n.type&&i.get().filter(function(t){return t.target().isEqualNode(n.target)}).each(function(){(u.get()||r.fire("tap",{touches:n.touches}).isDefaultPrevented())&&n.preventDefault()})},!0)},Rh=Mo("form-component-change"),Vh=Mo("form-close"),Hh=Mo("form-cancel"),Nh=Mo("form-action"),Ph=Mo("form-submit"),zh=Mo("form-block"),Lh=Mo("form-unblock"),jh=Mo("form-tabchange"),Uh=Mo("form-resize"),li=G([fn("prefix","form-field"),Fe("fieldBehaviours",[Ul,sl])]),Ua=G([yl({schema:[Zt("dom")],name:"label"}),yl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Zt("text")],name:"aria-descriptor"}),bl({factory:{sketch:function(t){var n=j(t,["factory"]);return t.factory.sketch(n)}},schema:[Zt("factory")],name:"field"})]),Wh=al({name:"FormField",configFields:li(),partFields:Ua(),factory:function(r,t,n,e){var o=rs(r.fieldBehaviours,[Ul.config({find:function(t){return hs(t,r,"field")}}),sl.config({store:{mode:"manual",getValue:function(t){return Ul.getCurrent(t).bind(sl.getValue)},setValue:function(t,n){Ul.getCurrent(t).each(function(t){sl.setValue(t,n)})}}})]),i=bi([yi(function(t,n){var o=bs(t,r,["label","field","aria-descriptor"]);o.field().each(function(e){var n=Mo(r.prefix);o.label().each(function(t){Eo(t.element(),"for",n),Eo(e.element(),"id",n)}),o["aria-descriptor"]().each(function(t){var n=Mo(r.prefix);Eo(t.element(),"id",n),Eo(e.element(),"aria-describedby",n)})})})]),u={getField:function(t){return hs(t,r,"field")},getLabel:function(t){return hs(t,r,"label")}};return{uid:r.uid,dom:r.dom,components:t,behaviours:o,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Ae=G([un("data"),fn("inputAttributes",{}),fn("inputStyles",{}),fn("tag","input"),fn("inputClasses",[]),wa("onSetValue"),fn("styles",{}),fn("eventOrder",{}),Fe("inputBehaviours",[sl,sd]),fn("selectOnFocus",!0)]),Gh=kl({name:"Input",configFields:Ae(),factory:function(t,n){return{uid:t.uid,dom:Bh(t),components:[],behaviours:E(E({},Dh(e=t)),rs(e.inputBehaviours,[sl.config({store:{mode:"manual",initialValue:e.data.getOr(void 0),getValue:function(t){return dr(t.element())},setValue:function(t,n){dr(t.element())!==n&&mr(t.element(),n)}},onSetValue:e.onSetValue})])),eventOrder:t.eventOrder};var e}});function Xh(t){b.setTimeout(function(){throw t},0)}function Yh(t){return t=ze(t),lt(av,t)}function qh(t,n){var e=n.getRoot(t).getOr(t.element());Qo(e,n.invalidClass),n.notify.each(function(n){Yh(t.element())&&Eo(t.element(),"aria-invalid",!1),n.getContainer(t).each(function(t){Co(t,n.validHtml)}),n.onValid(t)})}function Kh(n,t,e,o){var r=t.getRoot(n).getOr(n.element());Jo(r,t.invalidClass),t.notify.each(function(t){Yh(n.element())&&Eo(n.element(),"aria-invalid",!0),t.getContainer(n).each(function(t){Co(t,o)}),t.onInvalid(n,o)})}function Jh(n,t,e){return t.validator.fold(function(){return uv(tt.value(!0))},function(t){return t.validate(n)})}function $h(n,e,t){return e.notify.each(function(t){t.onValidate(n)}),Jh(n,e).map(function(t){return n.getSystem().isConnected()?t.fold(function(t){return Kh(n,e,0,t),tt.error(t)},function(t){return qh(n,e),tt.value(t)}):tt.error("No longer in system")})}function Qh(t,n,e,o){return o=fv(t,n,e,o),Wh.sketch(o)}function Zh(t,n){return Wh.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})}_h=cl={},Mh=Gr={exports:cl},Fh=Ah=void 0,function(t){"object"==typeof _h&&void 0!==Mh?Mh.exports=t():"function"==typeof Ah&&Ah.amd?Ah([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}(function(){return function o(r,i,u){function a(n,t){if(!i[n]){if(!r[n]){var e="function"==typeof Fh&&Fh;if(!t&&e)return e(n,!0);if(c)return c(n,!0);throw(e=new Error("Cannot find module '"+n+"'")).code="MODULE_NOT_FOUND",e}e=i[n]={exports:{}},r[n][0].call(e.exports,function(t){return a(r[n][1][t]||t)},e,e.exports,o,r,i,u)}return i[n].exports}for(var c="function"==typeof Fh&&Fh,t=0;t<u.length;t++)a(u[t]);return a}({1:[function(t,n,e){var o,r,n=n.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function a(n){if(o===setTimeout)return setTimeout(n,0);if((o===i||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0);try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:i}catch(t){o=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var c,s=[],l=!1,f=-1;function d(){l&&c&&(l=!1,c.length?s=c.concat(s):f=-1,s.length&&m())}function m(){if(!l){var t=a(d);l=!0;for(var n=s.length;n;){for(c=s,s=[];++f<n;)c&&c[f].run();f=-1,n=s.length}c=null,l=!1,function(n){if(r===clearTimeout)return clearTimeout(n);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(t)}}function g(t,n){this.fun=t,this.array=n}function p(){}n.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];s.push(new g(t,n)),1!==s.length||l||a(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(t,f,n){(function(n){function o(){}function i(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function r(e,o){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var t,n=1===e._state?o.onFulfilled:o.onRejected;if(null!==n){try{t=n(e._value)}catch(t){return void a(o.promise,t)}u(o.promise,t)}else(1===e._state?u:a)(o.promise,e._value)})):e._deferreds.push(o)}function u(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof i)return n._state=3,n._value=t,void c(n);if("function"==typeof e)return void l((o=e,r=t,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=t,c(n)}catch(t){a(n,t)}var o,r}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&i._immediateFn(function(){t._handled||i._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function l(t,n){var e=!1;try{t(function(t){e||(e=!0,u(n,t))},function(t){e||(e=!0,a(n,t))})}catch(t){if(e)return;e=!0,a(n,t)}}var t,e;t=this,e=setTimeout,i.prototype.catch=function(t){return this.then(null,t)},i.prototype.then=function(t,n){var e=new this.constructor(o);return r(this,new s(t,n,e)),e},i.all=function(t){var a=Array.prototype.slice.call(t);return new i(function(r,i){if(0===a.length)return r([]);var u=a.length;for(var t=0;t<a.length;t++)!function n(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if("function"==typeof o)return void o.call(t,function(t){n(e,t)},i)}a[e]=t,0==--u&&r(a)}catch(t){i(t)}}(t,a[t])})},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i(function(t){t(n)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(r){return new i(function(t,n){for(var e=0,o=r.length;e<o;e++)r[e].then(t,n)})},i._immediateFn="function"==typeof n?function(t){n(t)}:function(t){e(t,0)},i._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},i._setImmediateFn=function(t){i._immediateFn=t},i._setUnhandledRejectionFn=function(t){i._unhandledRejectionFn=t},void 0!==f&&f.exports?f.exports=i:t.Promise||(t.Promise=i)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(c,t,s){(function(t,n){var o=c("process/browser.js").nextTick,e=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function a(t,n){this._id=t,this._clearFn=n}s.setTimeout=function(){return new a(e.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(e.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},s.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},s._unrefActive=s.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},s.setImmediate="function"==typeof t?t:function(t){var n=u++,e=!(arguments.length<2)&&r.call(arguments,1);return i[n]=!0,o(function(){i[n]&&(e?t.apply(null,e):t.call(null),s.clearImmediate(n))}),n},s.clearImmediate="function"==typeof n?n:function(t){delete i[t]}}).call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),t="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:t.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});var tv,nv=Gr.exports.boltExport,ev=function(t){var e=$.none(),n=[],o=function(t){r()?u(t):n.push(t)},r=function(){return e.isSome()},i=function(t){ft(t,u)},u=function(n){e.each(function(t){b.setTimeout(function(){n(t)},0)})};return t(function(t){e=$.some(t),i(n),n=[]}),{get:o,map:function(e){return ev(function(n){o(function(t){n(e(t))})})},isReady:r}},ov={nu:ev,pure:function(n){return ev(function(t){t(n)})}},rv=function(e){function t(t){e().then(t,Xh)}return{map:function(t){return rv(function(){return e().then(t)})},bind:function(n){return rv(function(){return e().then(function(t){return n(t).toPromise()})})},anonBind:function(t){return rv(function(){return e().then(function(){return t.toPromise()})})},toLazy:function(){return ov.nu(t)},toCached:function(){var t=null;return rv(function(){return null===t&&(t=e()),t})},toPromise:e,get:t}},iv=function(t){return rv(function(){return new nv(t)})},uv=function(t){return rv(function(){return nv.resolve(t)})},av=["input","textarea"],Bi=Object.freeze({markValid:qh,markInvalid:Kh,query:Jh,run:$h,isInvalid:function(t,n){t=n.getRoot(t).getOr(t.element());return Zo(t,n.invalidClass)}}),Ie=Object.freeze({events:function(n,t){return n.validator.map(function(t){return bi([to(t.onEvent,function(t){$h(t,n).get(l)})].concat(t.validateOnLoad?[yi(function(t){$h(t,n).get(W)})]:[]))}).getOr({})}}),Oa=[Zt("invalidClass"),fn("getRoot",$.none),ln("notify",[fn("aria","alert"),fn("getContainer",$.none),fn("validHtml",""),wa("onValid"),wa("onInvalid"),wa("onValidate")]),ln("validator",[Zt("validate"),fn("onEvent","input"),fn("validateOnLoad",!0)])],cv=Ju({fields:Oa,name:"invalidating",active:Ie,apis:Bi,extra:{validation:function(n){return function(t){t=sl.getValue(t);return uv(n(t))}}}}),sv=Object.freeze({exhibit:function(t,n){return No({attributes:X([{key:n.tabAttr,value:"true"}])})}}),Ai=[fn("tabAttr","data-alloy-tabstop")],lv=Ju({fields:Ai,name:"tabstopping",active:sv}),fv=function(t,n,e,o){return{dom:dv(e),components:t.toArray().concat([n]),fieldBehaviours:Na(o)}},dv=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},Ga=Object.freeze({getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),li=[tn("others",qn(tt.value,$n()))],mv=Ju({fields:li,name:"coupling",apis:Ga,state:Object.freeze({init:function(t){var r={},n=G({});return Li({readState:n,getOrCreate:function(n,e,o){var t=gt(e.others);if(t)return At(r,o).getOrThunk(function(){var t=At(e.others,o).getOrDie("No information found for coupled component: "+o)(n),t=n.getSystem().build(t);return r[o]=t});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(t,null,2))}})}})}),gv=G("sink"),Ua=G(yl({name:gv(),overrides:G({dom:{tag:"div"},behaviours:Na([qs.config({useFixed:a})]),events:bi([io(Nr()),io(_r()),io(jr())])})}));function pv(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e,overrides:o}},function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}})}function hv(t,n,e,o,r,i,u){var a,c,s,l,f,d,m=pv(t,e);return(a=m,s=o,l=r,f=u,n=u=n,u=c=e,n=(0,(t=t).fetch)(u).map(n),d=_b(c,t),n.map(function(t){return t.bind(function(t){return $.from(Od.sketch(E(E({},l.menu()),{uid:Ri(""),data:t,highlightImmediately:f===tv.HighlightFirst,onOpenMenu:function(t,n){var e=d().getOrDie();qs.position(e,a,n),nl.decloak(s)},onOpenSubmenu:function(t,n,e){var o=d().getOrDie();qs.position(o,{anchor:"submenu",item:n},e),nl.decloak(s)},onRepositionMenu:function(t,n,e){var o=d().getOrDie();qs.position(o,a,n),ft(e,function(t){qs.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)})},onEscape:function(){return sd.focus(c),nl.close(s),$.some(!0)}})))})})).map(function(t){return t.fold(function(){nl.isOpen(o)&&nl.close(o)},function(t){nl.cloak(o),nl.open(o,t),i(o)}),o})}function vv(t,n,e,o,r,i,u){return nl.close(o),uv(o)}function bv(t,n,e,o,r,i){var u=mv.getCoupled(e,"sandbox");return(nl.isOpen(u)?vv:hv)(t,n,e,u,o,r,i)}function yv(t,n,e){n=Ul.getCurrent(n).getOr(n),t=tu(t.element()),e?ir(n.element(),"min-width",t+"px"):(n=n.element(),t=t,Su.set(n,t))}function xv(t){nl.getState(t).each(function(t){Od.repositionMenus(t)})}function wv(o,r,i){var u=mu(),t=_b(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:u.id(),role:"listbox"}},behaviours:fl(o.sandboxBehaviours,[sl.config({store:{mode:"memory",initialValue:r}}),nl.config({onOpen:function(t,n){var e=pv(o,r);u.link(r.element()),o.matchWidth&&yv(e.hotspot,n,o.useMinWidth),o.onOpen(e,t,n),void 0!==i&&void 0!==i.onOpen&&i.onOpen(t,n)},onClose:function(t,n){u.unlink(r.element()),void 0!==i&&void 0!==i.onClose&&i.onClose(t,n)},isPartOf:function(t,n,e){return Tu(n,e)||Tu(r,e)},getAttachPoint:function(){return t().getOrDie()}}),Ul.config({find:function(t){return nl.getState(t).bind(function(t){return Ul.getCurrent(t)})}}),Wa.config({channels:E(E({},Qc({isExtraPart:G(!1)})),Zc({isExtraPart:G(!1),doReposition:xv}))})])}}function Sv(t){t=mv.getCoupled(t,"sandbox"),xv(t)}function kv(e,n,o){function r(t,n){qe(t,Rb,{value:n})}var i,u,t=Wh.parts().field({factory:Gh,inputClasses:["tox-textfield"],onSetValue:function(t){return cv.run(t).get(function(){})},inputBehaviours:Na([lv.config({}),cv.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return mo(t.element())},notify:{onValid:function(t){var n=sl.getValue(t);qe(t,Ib,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=sl.getValue(t);if(0===n.length)return uv(tt.value(!0));t=me.fromTag("span");ir(t,"background-color",n);t=cr(t,"background-color").fold(function(){return tt.error("blah")},function(t){return tt.value(n)});return uv(t)}}})]),selectOnFocus:!1}),a=e.label.map(function(t){return Zh(t,n.providers)}),c=Qf((i={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:$.some({onRtl:function(){return[Nu]},onLtr:function(){return[Pu]}}),components:[],fetch:wp.getFetch(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(t,e){c.getOpt(t).each(function(n){"custom"===e?o.colorPicker(function(t){t.fold(function(){return Ye(n,Vb)},function(t){r(n,t),gp(t)})},"#ffffff"):r(n,"remove"===e?"":e)})}},u=n,Mb.sketch({dom:i.dom,components:i.components,toggleClass:"mce-active",dropdownBehaviours:Na([Fb.config({}),lv.config({})]),layouts:i.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:u.getSink,fetch:function(n){return iv(function(t){return i.fetch(t)}).map(function(t){return $.from(Vp(St(rp(Mo("menu-value"),t,function(t){i.onItemAction(n,t)},i.columns,i.presets,sg.CLOSE_ON_EXECUTE,function(){return!1},u.providers),{movement:ip(i.columns,i.presets)})))})},parts:{menu:Zg(0,0,i.presets)}})));return Wh.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:a.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[t,c.asSpec()]}]),fieldBehaviours:Na([Af("form-field-events",[to(Ib,function(t,n){c.getOpt(t).each(function(t){ir(t.element(),"background-color",n.event().color())}),qe(t,Rh,{name:e.name})}),to(Rb,function(n,e){Wh.getField(n).each(function(t){sl.setValue(t,e.event().value()),Ul.getCurrent(n).each(sd.focus)})}),to(Vb,function(n,t){Wh.getField(n).each(function(t){Ul.getCurrent(n).each(sd.focus)})})])])})}function Cv(t,n,e){return{hue:G(t),saturation:G(n),value:G(e)}}function Ov(t){return-1===(t=t.event().raw()).type.indexOf("touch")?void 0!==t.clientX?$.some(t).map(function(t){return xu(t.clientX,t.clientY)}):$.none():void 0!==t.touches&&1===t.touches.length?$.some(t.touches[0]).map(function(t){return xu(t.clientX,t.clientY)}):$.none()}function Ev(t){return t.model.minX}function Tv(t){return t.model.minY}function Dv(t){return t.model.minX-1}function Bv(t){return t.model.minY-1}function Av(t){return t.model.maxX}function _v(t){return t.model.maxY}function Mv(t){return t.model.maxX+1}function Fv(t){return t.model.maxY+1}function Iv(t,n,e){return n(t)-e(t)}function Rv(t){return Iv(t,Av,Ev)}function Vv(t){return Iv(t,_v,Tv)}function Hv(t){return Rv(t)/2}function Nv(t){return Vv(t)/2}function Pv(t){return t.stepSize}function zv(t){return t.snapToGrid}function Lv(t){return t.snapStart}function jv(t){return t.rounded}function Uv(t,n){return void 0!==t[n+"-edge"]}function Wv(t){return Uv(t,"left")}function Gv(t){return Uv(t,"right")}function Xv(t){return Uv(t,"top")}function Yv(t){return Uv(t,"bottom")}function qv(t){return t.model.value.get()}function Kv(t){return{x:G(t)}}function Jv(t){return{y:G(t)}}function $v(t,n){return{x:G(t),y:G(n)}}function Qv(t,n){qe(t,zb(),{value:n})}function Zv(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)}function tb(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)}function nb(t,n,e){return Math.max(n,Math.min(e,t))}function eb(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,t=t.screenRange,s=s?n-1:n,l=l?e+1:e;if(r<f)return s;if(d<r)return l;var m,g,p,h,f=(r=r,f=f,d=d,Math.min(d,Math.max(r,f))-f),l=nb(f/t*o+n,s,l);return u&&n<=l&&l<=e?(m=l,g=n,p=e,h=i,a.fold(function(){var t=m-g,t=Math.round(t/h)*h;return nb(g+t,g-1,p+1)},function(t){var n=(m-t)%h,e=Math.round(n/h),o=Math.floor((m-t)/h),n=Math.floor((p-t)/h),e=t+Math.min(n,o+e)*h;return Math.max(t,e)})):c?Math.round(l):l}function ob(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,t=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:t:(r-n)/o*c}function rb(t){return t.element().dom().getBoundingClientRect()}function ib(t){return rb(t)[Lb]}function ub(t){return rb(t).right}function ab(t){return rb(t).top}function cb(t){return rb(t).bottom}function sb(t){return rb(t).width}function lb(t){return rb(t).height}function fb(t,n){return t=rb(t),n=rb(n),(t[Lb]+t.right)/2-n[Lb]}function db(t,n){return t=rb(t),n=rb(n),(t.top+t.bottom)/2-n.top}function mb(t,n){qe(t,zb(),{value:n})}function gb(t){return{x:G(t)}}function pb(t,n,e){return t={min:Ev(n),max:Av(n),range:Rv(n),value:e,step:Pv(n),snap:zv(n),snapStart:Lv(n),rounded:jv(n),hasMinEdge:Wv(n),hasMaxEdge:Gv(n),minBound:ib(t),maxBound:ub(t),screenRange:sb(t)},eb(t)}function hb(t,n,e,o,r,i){var u,a,o=(a=i,i=e,e=o,o=r,r=sb(u=n),e=e.bind(function(t){return $.some(fb(t,u))}).getOr(0),o=o.bind(function(t){return $.some(fb(t,u))}).getOr(r),o={min:Ev(a),max:Av(a),range:Rv(a),value:i,hasMinEdge:Wv(a),hasMaxEdge:Gv(a),minBound:ib(u),minOffset:0,maxBound:ub(u),maxOffset:r,centerMinEdge:e,centerMaxEdge:o},ob(o));return ib(n)-ib(t)+o}function vb(t,n){qe(t,zb(),{value:n})}function bb(t){return{y:G(t)}}function yb(t,n,e){return t={min:Tv(n),max:_v(n),range:Vv(n),value:e,step:Pv(n),snap:zv(n),snapStart:Lv(n),rounded:jv(n),hasMinEdge:Xv(n),hasMaxEdge:Yv(n),minBound:ab(t),maxBound:cb(t),screenRange:lb(t)},eb(t)}function xb(t,n,e,o,r,i){var u,a,o=(a=i,i=e,e=o,o=r,r=lb(u=n),e=e.bind(function(t){return $.some(db(t,u))}).getOr(0),o=o.bind(function(t){return $.some(db(t,u))}).getOr(r),o={min:Tv(a),max:_v(a),range:Vv(a),value:i,hasMinEdge:Xv(a),hasMaxEdge:Yv(a),minBound:ab(u),minOffset:0,maxBound:cb(u),maxOffset:r,centerMinEdge:e,centerMaxEdge:o},ob(o));return ab(n)-ab(t)+o}function wb(t,n){qe(t,zb(),{value:n})}function Sb(t,n){return{x:G(t),y:G(n)}}function kb(t){return"<alloy.field."+t+">"}function Cb(t){return oy[t]}function Ob(t,n,e){return sl.config(St({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))}function Eb(t,n,e){return Ob(t,function(t){return n(t.element())},function(t,n){return e(t.element(),n)})}function Tb(o,n){function e(t,n){n.stop()}function r(t){return function(n,e){ft(t,function(t){t(n,e)})}}function i(t,n){Zm.isDisabled(t)||(n=n.event().raw(),a(t,n.dataTransfer.files))}function u(t,n){n=n.event().raw().target.files,a(t,n)}var a=function(t,n){var e;sl.setValue(t,(n=n,e=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i"),x(mt(n),function(t){return e.test(t.name)}))),qe(t,Rh,{name:o.name})},c=Qf({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Na([Af("input-file-events",[io(jr()),io(Qr())])])}),t=o.label.map(function(t){return Zh(t,n)}),s=Wh.parts().field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Na([sy([]),ty(),Zm.config({}),dd.config({toggleClass:"dragenter",toggleOnExecute:!1}),Af("dropzone-events",[to("dragenter",r([e,dd.toggle])),to("dragleave",r([e,dd.toggle])),to("dragover",e),to("drop",r([e,i])),to(Lr(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},Bd.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(t){c.get(t).element().dom().click()},buttonBehaviours:Na([lv.config({})])})]}]}}}});return Qh(t,s,["tox-form__group--stretched"],[])}function Db(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Na([sd.config({ignore:!0}),lv.config({})])}}function Bb(t,n){qe(t,Nr(),{raw:{which:9,shiftKey:n}})}function Ab(t,n){var e,o,r=py&&t.sandboxed,i=E(E({},t.label.map(function(t){return{title:t}}).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=fe(""),{getValue:function(t){return o.get()},setValue:function(t,n){e?Eo(t.element(),"srcdoc",n):(Eo(t.element(),"src","javascript:''"),(t=t.element().dom().contentWindow.document).open(),t.write(n),t.close()),o.set(n)}}),r=t.label.map(function(t){return Zh(t,n)}),t=Wh.parts().field({factory:{sketch:function(t){return gy({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:Na([lv.config({}),sd.config({}),ay($.none(),u.getValue,u.setValue)])})}}});return Qh(r,t,["tox-form__group--stretched"],[])}(cl=tv=tv||{})[cl.HighlightFirst=0]="HighlightFirst",cl[cl.HighlightNone=1]="HighlightNone";var _b=function(n,t){return n.getSystem().getByUid(t.uid+"-"+gv()).map(function(t){return function(){return tt.value(t)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return tt.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(n)}})})},Gr=function(){return[fn("sandboxClasses",[]),ll("sandboxBehaviours",[Ul,Wa,nl,sl])]},Oa=G([Zt("dom"),Zt("fetch"),wa("onOpen"),Sa("onExecute"),fn("getHotspot",$.some),fn("getAnchorOverrides",G({})),fn("layouts",$.none()),Fe("dropdownBehaviours",[dd,mv,ud,sd]),Zt("toggleClass"),fn("eventOrder",{}),un("lazySink"),fn("matchWidth",!1),fn("useMinWidth",!1),un("role")].concat(Gr())),Ie=G([Be({schema:[ya()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Ua()]),Mb=al({name:"Dropdown",configFields:Oa(),partFields:Ie(),factory:function(n,t,e,o){function r(t){nl.getState(t).each(function(t){Od.highlightPrimary(t)})}var i,u={expand:function(t){dd.isOn(t)||bv(n,function(t){return t},t,o,W,tv.HighlightNone).get(W)},open:function(t){dd.isOn(t)||bv(n,function(t){return t},t,o,W,tv.HighlightFirst).get(W)},isOpen:dd.isOn,close:function(t){dd.isOn(t)&&bv(n,function(t){return t},t,o,W,tv.HighlightFirst).get(W)},repositionMenus:function(t){dd.isOn(t)&&Sv(t)}},a=function(t,n){return Ke(t),$.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:rs(n.dropdownBehaviours,[dd.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),mv.config({others:{sandbox:function(t){return wv(n,t,{onOpen:function(){dd.on(t)},onClose:function(){dd.off(t)}})}}}),ud.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t,n){var e;return Mb.isOpen(t)?(e=mv.getCoupled(t,"sandbox"),r(e)):Mb.open(t),$.some(!0)},onEscape:function(t,n){return Mb.isOpen(t)?(Mb.close(t),$.some(!0)):$.none()}}),sd.config({})]),events:Pf($.some(function(t){bv(n,function(t){return t},t,o,r,tv.HighlightFirst).get(W)})),eventOrder:E(E({},n.eventOrder),((a={})[Jr()]=["disabling","toggling","alloy.base.behaviour"],a)),apis:u,domModification:{attributes:E(E({"aria-haspopup":"true"},n.role.fold(function(){return{}},function(t){return{role:t}})),"button"===n.dom.tag?{type:(i="type",At(n.dom,"attributes").bind(function(t){return At(t,i)}).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Fb=Ju({fields:[],name:"unselecting",active:Object.freeze({events:function(t){return bi([Qe(Wr(),G(!0))])},exhibit:function(t,n){return No({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Ib=Mo("color-input-change"),Rb=Mo("color-swatch-change"),Vb=Mo("color-picker-cancel"),Hb=G(Mo("rgb-hex-update")),Nb=G(Mo("slider-update")),Pb=G(Mo("palette-update")),Bi=yl({schema:[Zt("dom")],name:"label"}),sv=(Ai=function(n){return yl({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold(function(){return{}},function(o){return{events:bi([no(Tr(),o,[t]),no(_r(),o,[t]),no(Mr(),function(t,n,e){e.mouseIsDown.get()&&o(t,e)},[t])])}})}})})("top-left"),qn=Ai("top"),li=Ai("top-right"),Ga=Ai("right"),cl=Ai("bottom-right"),Oa=Ai("bottom"),Ie=Ai("bottom-left"),Bi=[Bi,Ai("left"),Ga,qn,Oa,sv,li,Ie,cl,bl({name:"thumb",defaults:G({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:bi([oo(Tr(),t,"spectrum"),oo(Dr(),t,"spectrum"),oo(Br(),t,"spectrum"),oo(_r(),t,"spectrum"),oo(Mr(),t,"spectrum"),oo(Ir(),t,"spectrum")])}}}),bl({schema:[Wn("mouseIsDown",function(){return fe(!1)})],name:"spectrum",overrides:function(e){function o(n,t){return r.getValueFromEvent(t).map(function(t){return r.setValueFrom(n,e,t)})}var r=e.model.manager;return{behaviours:Na([ud.config({mode:"special",onLeft:function(t){return r.onLeft(t,e)},onRight:function(t){return r.onRight(t,e)},onUp:function(t){return r.onUp(t,e)},onDown:function(t){return r.onDown(t,e)}}),sd.config({})]),events:bi([to(Tr(),o),to(Dr(),o),to(_r(),o),to(Mr(),function(t,n){e.mouseIsDown.get()&&o(t,n)})])}}})],zb=G("slider.change.value"),Lb="left",Ga=(Ai=function(e){return function(t,n){return function(t,n,e){e=(0<t?tb:Zv)(qv(e).x(),Ev(e),Av(e),Pv(e));return mb(n,gb(e)),$.some(e)}(e,t,n).map(function(){return!0})}})(-1),qn=Ai(1),Oa=$.none,sv=$.none,li={"top-left":$.none(),top:$.none(),"top-right":$.none(),right:$.some(function(t,n){Qv(t,Kv(Mv(n)))}),"bottom-right":$.none(),bottom:$.none(),"bottom-left":$.none(),left:$.some(function(t,n){Qv(t,Kv(Dv(n)))})},Ie=Object.freeze({setValueFrom:function(t,n,e){n=pb(t,n,e),e=gb(n);return mb(t,e),n},setToMin:function(t,n){n=Ev(n);mb(t,gb(n))},setToMax:function(t,n){n=Av(n);mb(t,gb(n))},findValueOfOffset:pb,getValueFromEvent:function(t){return Ov(t).map(function(t){return t.left()})},findPositionOfValue:hb,setPositionFromValue:function(t,n,e,o){var r=qv(e),t=hb(t,o.getSpectrum(t),r.x(),o.getLeftEdge(t),o.getRightEdge(t),e),e=tu(n.element())/2;ir(n.element(),"left",t-e+"px")},onLeft:Ga,onRight:qn,onUp:Oa,onDown:sv,edgeActions:li}),cl=function(e){return function(t,n){return function(t,n,e){e=(0<t?tb:Zv)(qv(e).y(),Tv(e),_v(e),Pv(e));return vb(n,bb(e)),$.some(e)}(e,t,n).map(function(){return!0})}},Ai=$.none,Ga=$.none,qn=cl(-1),Oa=cl(1),sv={"top-left":$.none(),top:$.some(function(t,n){Qv(t,Jv(Bv(n)))}),"top-right":$.none(),right:$.none(),"bottom-right":$.none(),bottom:$.some(function(t,n){Qv(t,Jv(Fv(n)))}),"bottom-left":$.none(),left:$.none()},li=Object.freeze({setValueFrom:function(t,n,e){n=yb(t,n,e),e=bb(n);return vb(t,e),n},setToMin:function(t,n){n=Tv(n);vb(t,bb(n))},setToMax:function(t,n){n=_v(n);vb(t,bb(n))},findValueOfOffset:yb,getValueFromEvent:function(t){return Ov(t).map(function(t){return t.top()})},findPositionOfValue:xb,setPositionFromValue:function(t,n,e,o){var r=qv(e),t=xb(t,o.getSpectrum(t),r.y(),o.getTopEdge(t),o.getBottomEdge(t),e),e=Ji(n.element())/2;ir(n.element(),"top",t-e+"px")},onLeft:Ai,onRight:Ga,onUp:qn,onDown:Oa,edgeActions:sv}),Ai=Ov,Ga=(cl=function(i,u){return function(t,n){return o=t,r=n,t=0<(e=i)?tb:Zv,e=(n=u)?qv(r).x():t(qv(r).x(),Ev(r),Av(r),Pv(r)),r=n?t(qv(r).y(),Tv(r),_v(r),Pv(r)):qv(r).y(),wb(o,Sb(e,r)),$.some(e).map(function(){return!0});var e,o,r}})(-1,!1),qn=cl(1,!1),Oa=cl(-1,!0),sv=cl(1,!0),cl={"top-left":$.some(function(t,n){Qv(t,$v(Dv(n),Bv(n)))}),top:$.some(function(t,n){Qv(t,$v(Hv(n),Bv(n)))}),"top-right":$.some(function(t,n){Qv(t,$v(Mv(n),Bv(n)))}),right:$.some(function(t,n){Qv(t,$v(Mv(n),Nv(n)))}),"bottom-right":$.some(function(t,n){Qv(t,$v(Mv(n),Fv(n)))}),bottom:$.some(function(t,n){Qv(t,$v(Hv(n),Fv(n)))}),"bottom-left":$.some(function(t,n){Qv(t,$v(Dv(n),Fv(n)))}),left:$.some(function(t,n){Qv(t,$v(Dv(n),Nv(n)))})},cl=Object.freeze({setValueFrom:function(t,n,e){var o=pb(t,n,e.left()),e=yb(t,n,e.top()),e=Sb(o,e);return wb(t,e),e},setToMin:function(t,n){var e=Ev(n),n=Tv(n);wb(t,Sb(e,n))},setToMax:function(t,n){var e=Av(n),n=_v(n);wb(t,Sb(e,n))},getValueFromEvent:Ai,setPositionFromValue:function(t,n,e,o){var r=qv(e),i=hb(t,o.getSpectrum(t),r.x(),o.getLeftEdge(t),o.getRightEdge(t),e),o=xb(t,o.getSpectrum(t),r.y(),o.getTopEdge(t),o.getBottomEdge(t),e),t=tu(n.element())/2,e=Ji(n.element())/2;ir(n.element(),"left",i-t+"px"),ir(n.element(),"top",o-e+"px")},onLeft:Ga,onRight:qn,onUp:Oa,onDown:sv,edgeActions:cl}),jb=al({name:"Slider",configFields:[fn("stepSize",1),fn("onChange",W),fn("onChoose",W),fn("onInit",W),fn("onDragStart",W),fn("onDragEnd",W),fn("snapToGrid",!1),fn("rounded",!0),un("snapStart"),tn("model",$t("mode",{x:[fn("minX",0),fn("maxX",100),Wn("value",function(t){return fe(t.mode.minX)}),Zt("getInitialValue"),_u("manager",Ie)],y:[fn("minY",0),fn("maxY",100),Wn("value",function(t){return fe(t.mode.minY)}),Zt("getInitialValue"),_u("manager",li)],xy:[fn("minX",0),fn("maxX",100),fn("minY",0),fn("maxY",100),Wn("value",function(t){return fe({x:G(t.mode.minX),y:G(t.mode.minY)})}),Zt("getInitialValue"),_u("manager",cl)]})),Fe("sliderBehaviours",[ud,sl]),Wn("mouseIsDown",function(){return fe(!1)})],partFields:Bi,factory:function(r,t,n,e){function i(t){return vs(t,r,"thumb")}function u(t){return vs(t,r,"spectrum")}function o(t){return hs(t,r,"left-edge")}function a(t){return hs(t,r,"right-edge")}function c(t){return hs(t,r,"top-edge")}function s(t){return hs(t,r,"bottom-edge")}function l(t,n){h.setPositionFromValue(t,n,r,{getLeftEdge:o,getRightEdge:a,getTopEdge:c,getBottomEdge:s,getSpectrum:u})}function f(t,n){p.value.set(n);var e=i(t);return l(t,e),r.onChange(t,e,n),$.some(!0)}function d(e){var t=r.mouseIsDown.get();r.mouseIsDown.set(!1),t&&hs(e,r,"thumb").each(function(t){var n=p.value.get();r.onChoose(e,t,n)})}function m(t,n){n.stop(),r.mouseIsDown.set(!0),r.onDragStart(t,i(t))}function g(t,n){n.stop(),r.onDragEnd(t,i(t)),d(t)}var p=r.model,h=p.manager;return{uid:r.uid,dom:r.dom,components:t,behaviours:rs(r.sliderBehaviours,[ud.config({mode:"special",focusIn:function(t){return hs(t,r,"spectrum").map(ud.focusIn).map(G(!0))}}),sl.config({store:{mode:"manual",getValue:function(t){return p.value.get()}}}),Wa.config({channels:((t={})[rl()]={onReceive:d},t)})]),events:bi([to(zb(),function(t,n){f(t,n.event().value())}),yi(function(t,n){var e=p.getInitialValue();p.value.set(e);var o=i(t);l(t,o);e=u(t);r.onInit(t,o,e,p.value.get())}),to(Tr(),m),to(Br(),g),to(_r(),m),to(Ir(),g)]),apis:{resetToMin:function(t){h.setToMin(t,r)},resetToMax:function(t){h.setToMax(t,r)},changeValue:f,refresh:l},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),Ub=function(t,n){var e=jb.parts().spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=jb.parts().thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return jb.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:G({y:G(0)})},components:[e,o],sliderBehaviours:Na([sd.config({})]),onChange:function(t,n,e){qe(t,Nb(),{value:e})}})},Wb=[Fe("formBehaviours",[sl])],Gb=function(o,t,n){return{uid:o.uid,dom:o.dom,components:t,behaviours:rs(o.formBehaviours,[sl.config({store:{mode:"manual",getValue:function(t){t=ys(t,o);return F(t,function(t,n){return t().bind(function(t){var n,t=Ul.getCurrent(t);return n="missing current",t.fold(function(){return tt.error(n)},tt.value)}).map(sl.getValue)})},setValue:function(e,t){ht(t,function(n,t){hs(e,o,t).each(function(t){Ul.getCurrent(t).each(function(t){sl.setValue(t,n)})})})}}})]),apis:{getField:function(t,n){return hs(t,o,n).bind(Ul.getCurrent)}}}},Xb={getField:Vo(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var e,n=(e=[],{field:function(t,n){return e.push(t),fs("form",kb(t),n)},record:function(){return e}}),t=t(n),n=n.record(),n=y(n,function(t){return bl({name:t,pname:kb(t)})});return Os("form",Wb,n,Gb,t)}},Yb=Mo("valid-input"),qb=Mo("invalid-input"),Kb=Mo("validating-input"),Jb="colorcustom.rgb.",$b=function(d,m,g,p){function h(t,n,e,o,r){var i,u,a=d(Jb+"range"),t=[Wh.parts().label({dom:{tag:"label",innerHtml:e,attributes:{"aria-label":o}}}),Wh.parts().field({data:r,factory:Gh,inputAttributes:E({type:"text"},"hex"===n?{"aria-live":"polite"}:{}),inputClasses:[m("textfield")],inputBehaviours:Na([(i=n,u=t,cv.config({invalidClass:m("invalid"),notify:{onValidate:function(t){qe(t,Kb,{type:i})},onValid:function(t){qe(t,Yb,{type:i,value:sl.getValue(t)})},onInvalid:function(t){qe(t,qb,{type:i,value:sl.getValue(t)})}},validator:{validate:function(t){t=sl.getValue(t),t=u(t)?tt.value(!0):tt.error(d("aria.input.invalid"));return uv(t)},validateOnLoad:!1}})),lv.config({})]),onSetValue:function(t){cv.isInvalid(t)&&cv.run(t).get(W)}})],a="hex"!==n?[Wh.parts()["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:t.concat(a)}}function v(t,n){var e=n.red(),o=n.green(),n=n.blue();sl.setValue(t,{red:e,green:o,blue:n})}function b(t,n){y.getOpt(t).each(function(t){ir(t.element(),"background-color","#"+n.value())})}var y=Qf({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}});return kl({factory:function(){function r(t){return u[t]().get()}function i(t,n){u[t]().set(n)}function n(t,n){"hex"!==(n=n.event()).type()?i(n.type(),$.none()):p(t)}function e(o,t,n){n=parseInt(n,10),i(t,$.some(n)),r("red").bind(function(e){return r("green").bind(function(n){return r("blue").map(function(t){return xg(e,n,t,1)})})}).each(function(t){var n,e,t=(n=o,e=yg(t),Xb.getField(n,"hex").each(function(t){sd.isFocused(t)||sl.setValue(n,{hex:e.value()})}),e);b(o,t)})}function o(t,n){"hex"===(n=n.event()).type()?function(t,n){g(t);var e=pg(n);i("hex",$.some(n)),n=kg(e),v(t,n),a(n),qe(t,Hb(),{hex:e}),b(t,e)}(t,n.value()):e(t,n.type(),n.value())}function t(t){return{label:d(Jb+t+".label"),description:d(Jb+t+".description")}}var u={red:G(fe($.some(255))),green:G(fe($.some(255))),blue:G(fe($.some(255))),hex:G(fe($.some("ffffff")))},a=function(t){var n=t.red(),e=t.green(),t=t.blue();i("red",$.some(n)),i("green",$.some(e)),i("blue",$.some(t))},c=t("red"),s=t("green"),l=t("blue"),f=t("hex");return St(Xb.sketch(function(t){return{dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":d("aria.color.picker")}},components:[t.field("red",Wh.sketch(h(wg,"red",c.label,c.description,255))),t.field("green",Wh.sketch(h(wg,"green",s.label,s.description,255))),t.field("blue",Wh.sketch(h(wg,"blue",l.label,l.description,255))),t.field("hex",Wh.sketch(h(hg,"hex",f.label,f.description,"ffffff"))),y.asSpec()],formBehaviours:Na([cv.config({invalidClass:m("form-invalid")}),Af("rgb-form-events",[to(Yb,o),to(qb,n),to(Kb,n)])])}}),{apis:{updateHex:function(t,n){var e,o;sl.setValue(t,{hex:n.value()}),e=t,o=kg(o=n),v(e,o),a(o),b(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},Qb=function(t,o){function r(t,n){var e=t.width,o=t.height;null!==(t=t.getContext("2d"))&&(t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,e,0)).addColorStop(0,"rgba(255,255,255,1)"),n.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=n,t.fillRect(0,0,e,o),(n=t.createLinearGradient(0,0,0,o)).addColorStop(0,"rgba(0,0,0,0)"),n.addColorStop(1,"rgba(0,0,0,1)"),t.fillStyle=n,t.fillRect(0,0,e,o))}var i=jb.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[o("sv-palette-spectrum")]}}),u=jb.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette-thumb")],innerHtml:"<div class="+o("sv-palette-inner-thumb")+' role="presentation"></div>'}});return kl({factory:function(t){var n=G({x:G(0),y:G(0)}),e=Na([Ul.config({find:$.some}),sd.config({})]);return jb.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[o("sv-palette")]},model:{mode:"xy",getInitialValue:n},rounded:!1,components:[i,u],onChange:function(t,n,e){qe(t,Pb(),{value:e})},onInit:function(t,n,e,o){r(e.element().dom(),Og(Fg()))},sliderBehaviours:e})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){e=e,n=(n=n).components()[0].element().dom(),r(n,Og(e))}},extraApis:{}})},Zb=function(c,d){return kl({name:"ColourPicker",configFields:[Zt("dom"),fn("onValidHex",W),fn("onInvalidHex",W)],factory:function(t){function n(t,e){u.getOpt(t).each(function(t){var n=kg(e);f.paletteRgba().set(n),i.setRgba(t,n)})}function e(t,n){a.getOpt(t).each(function(t){r.updateHex(t,n)})}function s(n,e,t){ft(t,function(t){t(n,e)})}var o,l,r=$b(c,d,t.onValidHex,t.onInvalidHex),i=Qb(c,d),f={paletteRgba:G(fe(Fg()))},u=Qf(i.sketch({})),a=Qf(r.sketch({}));return{uid:t.uid,dom:t.dom,components:[u.asSpec(),Ub(c,d),a.asSpec()],behaviours:Na([Af("colour-picker-events",[to(Pb(),(l=[e],function(t,n){var e,o,r,i,u,a=n.event().value(),c=f.paletteRgba().get(),r=(r=o=0,i=(e=c).red()/255,u=e.green()/255,n=e.blue()/255,c=Math.min(i,Math.min(u,n)),e=Math.max(i,Math.max(u,n)),c===e?Cv(0,0,100*(r=c)):(o=60*((o=i===c?3:n===c?1:5)-(i===c?u-n:n===c?i-u:n-i)/(e-c)),c=(e-c)/e,r=e,Cv(Math.round(o),Math.round(100*c),Math.round(100*r)))),a=Cv(r.hue(),a.x(),100-a.y()),a=Sg(a),a=yg(a);s(t,a,l)})),to(Nb(),(o=[n,e],function(t,n){n=function(t){t=Cv((100-t)/100*360,100,100),t=Sg(t);return yg(t)}(n.event().value().y());s(t,n,o)}))]),Ul.config({find:function(t){return a.getOpt(t)}}),ud.config({mode:"acyclic"})])}}})},ty=function(){return Ul.config({find:$.some})},ny=function(t){return Ul.config({find:t.getOpt})},ey=function(t){return Ul.config({find:function(n){return ho(n.element(),t).bind(function(t){return n.getSystem().getByDom(t).toOption()})}})},oy={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},ry=tinymce.util.Tools.resolve("tinymce.Resource"),iy=Ln([fn("preprocess",l),fn("postprocess",l)]),uy=function(e,t){var o=Jt("RepresentingConfigs.memento processors",iy,t);return sl.config({store:{mode:"manual",getValue:function(t){t=e.get(t),t=sl.getValue(t);return o.postprocess(t)},setValue:function(t,n){n=o.preprocess(n),t=e.get(t);sl.setValue(t,n)}}})},ay=Ob,cy=function(t){return Eb(t,ko,Co)},sy=function(t){return sl.config({store:{mode:"memory",initialValue:t}})},ly=Mo("alloy-fake-before-tabstop"),fy=Mo("alloy-fake-after-tabstop"),dy=function(t){return Lp(t,["."+ly,"."+fy].join(","),G(!1))},my=function(t,n){n=n.element();Zo(n,ly)?Bb(t,!0):Zo(n,fy)&&Bb(t,!1)},gy=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Db([ly]),t,Db([fy])],behaviours:Na([ey(1)])}},py=!(wn().browser.isIE()||wn().browser.isEdge());function hy(t,n){return yy(b.document.createElement("canvas"),t,n)}function vy(t){var n=hy(t.width,t.height);return by(n).drawImage(t,0,0),n}function by(t){return t.getContext("2d")}function yy(t,n,e){return t.width=n,t.height=e,t}function xy(t){return t.naturalWidth||t.width}function wy(t){return t.naturalHeight||t.height}var Sy,ky,Cy=window.Promise||(Sy=Oy.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(t){b.setTimeout(t,1)},ky=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Oy.prototype.catch=function(t){return this.then(null,t)},Oy.prototype.then=function(e,o){var r=this;return new Oy(function(t,n){Ty.call(r,new _y(e,o,t,n))})},Oy.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=Array.prototype.slice.call(1===t.length&&ky(t[0])?t[0]:t);return new Oy(function(r,i){if(0===a.length)return r([]);var u=a.length;for(var t=0;t<a.length;t++)!function n(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if("function"==typeof o)return void o.call(t,function(t){n(e,t)},i)}a[e]=t,0==--u&&r(a)}catch(t){i(t)}}(t,a[t])})},Oy.resolve=function(n){return n&&"object"==typeof n&&n.constructor===Oy?n:new Oy(function(t){t(n)})},Oy.reject=function(e){return new Oy(function(t,n){n(e)})},Oy.race=function(r){return new Oy(function(t,n){for(var e=0,o=r;e<o.length;e++)o[e].then(t,n)})},Oy);function Oy(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],My(t,Ey(Dy,this),Ey(By,this))}function Ey(t,n){return function(){return t.apply(n,arguments)}}function Ty(e){var o=this;null!==this._state?Sy(function(){var t,n=o._state?e.onFulfilled:e.onRejected;if(null!==n){try{t=n(o._value)}catch(t){return void e.reject(t)}e.resolve(t)}else(o._state?e.resolve:e.reject)(o._value)}):this._deferreds.push(e)}function Dy(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void My(Ey(n,t),Ey(Dy,this),Ey(By,this))}this._state=!0,this._value=t,Ay.call(this)}catch(t){By.call(this,t)}}function By(t){this._state=!1,this._value=t,Ay.call(this)}function Ay(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];Ty.call(this,e)}this._deferreds=[]}function _y(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function My(t,n,e){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))})}catch(t){if(o)return;o=!0,e(t)}}function Fy(e){return new Cy(function(t,n){(function(t){var n=t.split(",");if(!(t=/data:([^;]+)/.exec(n[0])))return $.none();for(var t=t[1],n=n[1],e=b.atob(n),o=e.length,r=Math.ceil(o/1024),i=new Array(r),u=0;u<r;++u){for(var a=1024*u,c=Math.min(1024+a,o),s=new Array(c-a),l=a,f=0;l<c;++f,++l)s[f]=e[l].charCodeAt(0);i[u]=new Uint8Array(s)}return $.some(new b.Blob(i,{type:t}))})(e).fold(function(){n("uri is not base64: "+e)},t)})}function Iy(t,o,r){return o=o||"image/png",b.HTMLCanvasElement.prototype.toBlob?new Cy(function(n,e){t.toBlob(function(t){t?n(t):e()},o,r)}):Fy(t.toDataURL(o,r))}function Ry(t){return a=t,new Cy(function(t,n){var e=b.URL.createObjectURL(a),o=new b.Image,r=function(){o.removeEventListener("load",i),o.removeEventListener("error",u)};function i(){r(),t(o)}function u(){r(),n("Unable to load data of type "+a.type+": "+e)}o.addEventListener("load",i),o.addEventListener("error",u),o.src=e,o.complete&&i()}).then(function(t){n=t,b.URL.revokeObjectURL(n.src);var n=hy(xy(t),wy(t));return by(n).drawImage(t,0,0),n});var a}function Vy(t,n,e){var o=n.type;function r(o,r){return t.then(function(t){return e=r,n=(n=o)||"image/png",t.toDataURL(n,e);var n,e})}return{getType:G(o),toBlob:function(){return Cy.resolve(n)},toDataURL:function(){return e},toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return Iy(t,n,e)})},toAdjustedDataURL:r,toAdjustedBase64:function(t,n){return r(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(vy)}}}function Hy(n){return e=n,new Cy(function(t){var n=new b.FileReader;n.onloadend=function(){t(n.result)},n.readAsDataURL(e)}).then(function(t){return Vy(Ry(n),n,t)});var e}function Ny(n,t){return Iy(n,t).then(function(t){return Vy(Cy.resolve(n),t,n.toDataURL())})}var Py=Hy;function zy(t,n,e){t="string"==typeof t?parseFloat(t):t;return e<t?t=e:t<n&&(t=n),t}function Ly(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var jy=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function Uy(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r}function Wy(n,e){return n.toCanvas().then(function(t){return function(t,n,e){var o=by(t);e=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],E=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+E;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(e,0,0),Ny(t,n)}(t,n.getType(),e)})}function Gy(u,a){return u.toCanvas().then(function(t){return n=t,e=u.getType(),o=a,r=by(n),i=r.getImageData(0,0,n.width,n.height),t=r.getImageData(0,0,n.width,n.height),t=function(t,n,e){function o(t,n,e){return e<t?t=e:t<n&&(t=n),t}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),v=e[p*r+h];d+=u[b]*v,m+=u[1+b]*v,g+=u[2+b]*v}var y=4*(l*c+f);a[y]=o(d,0,255),a[1+y]=o(m,0,255),a[2+y]=o(g,0,255)}return n}(i,t,o),r.putImageData(t,0,0),Ny(n,e);var n,e,o,r,i})}function Xy(e){return function(t,n){return Wy(t,e(Ly(),n))}}var Yy,qy,Ky,Jy=(Yy=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return Wy(t,Yy)}),$y=Xy(function(t,n){return Uy(t,[1,0,0,0,n=zy(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])}),Qy=Xy(function(t,n){var e;return n=zy(n,-1,1),Uy(t,[(e=(n*=100)<0?127+n/100*127:127*(e=0===(e=n%1)?jy[n]:jy[Math.floor(n)]*(1-e)+jy[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}),Zy=(qy=[0,-1,0,-1,5,-1,0,-1,0],function(t){return Gy(t,qy)}),tx=(Ky=function(t,n){return 255*Math.pow(t/255,1-n)},function(n,e){return n.toCanvas().then(function(t){return nx(t,n.getType(),e)})});function nx(t,n,e){for(var o=by(t),r=new Array(256),i=0;i<r.length;i++)r[i]=Ky(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),Ny(t,n)}function ex(t,n,e){var o=xy(t),r=wy(t),i=n/o,o=e/r,r=!1;(i<.5||2<i)&&(i=i<.5?.5:2,r=!0),(o<.5||2<o)&&(o=o<.5?.5:2,r=!0);var u,a,c,o=(u=t,a=i,c=o,new Cy(function(t){var n=xy(u),e=wy(u),o=Math.floor(n*a),r=Math.floor(e*c),i=hy(o,r);by(i).drawImage(u,0,0,n,e,0,0,o,r),t(i)}));return r?o.then(function(t){return ex(t,n,e)}):o}function ox(n,e){return n.toCanvas().then(function(t){return function(t,n,e){var o=hy(t.width,t.height),r=by(o),i=0,u=0;90!==(e=e<0?360+e:e)&&270!==e||yy(o,o.height,o.width);90!==e&&180!==e||(i=o.width);270!==e&&180!==e||(u=o.height);return r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),Ny(o,n)}(t,n.getType(),e)})}function rx(n,e){return n.toCanvas().then(function(t){return function(t,n,e){var o=hy(t.width,t.height),r=by(o);"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0));return Ny(o,n)}(t,n.getType(),e)})}function ix(n,e,o,r,i){return n.toCanvas().then(function(t){return function(t,n,e,o,r,i){i=hy(r,i);return by(i).drawImage(t,-e,-o),Ny(i,n)}(t,n.getType(),e,o,r,i)})}function ux(t){return Jy(t)}function ax(t){return Zy(t)}function cx(t,n){return tx(t,n)}function sx(t,n,e,o){return Wy(t,(t=Ly(),e=e,o=o,Uy(t,[zy(n,0,2),0,0,0,0,0,e=zy(e,0,2),0,0,0,0,0,o=zy(o,0,2),0,0,0,0,0,1,0,0,0,0,0,1])))}function lx(t,n){return $y(t,n)}function fx(t,n){return Qy(t,n)}function dx(t,n,e){return r=n,i=e,(o=t).toCanvas().then(function(t){return ex(t,r,i).then(function(t){return Ny(t,o.getType())})});var o,r,i}function mx(t,n){return E({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)}function gx(t,n){return mx(td(t,n),{})}function px(t,n){return mx(td(t,n),{behaviours:Na([cd.config({})])})}function hx(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Na([cd.config({})])}}function vx(t,n,o){function e(t,n){return t=sl.getValue(t),sd.focus(t),qe(t,"keydown",{raw:n.event().raw()}),Mb.close(t),$.some(!0)}var r=fe(W),i=t.text.map(function(t){return Qf(hx(t,n,o.providers))}),u=t.icon.map(function(t){return Qf(px(t,o.providers.icons))}),a=t.role.fold(function(){return{}},function(t){return{role:t}}),c=t.tooltip.fold(function(){return{}},function(t){t=o.providers.translate(t);return{title:t,"aria-label":t}});return Qf(Mb.sketch(E(E({},a),{dom:{tag:"button",classes:[n,n+"--select"].concat(y(t.classes,function(t){return n+"--"+t})),attributes:E({},c)},components:rg([u.map(function(t){return t.asSpec()}),i.map(function(t){return t.asSpec()}),$.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:td("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Na(g(t.dropdownBehaviours,[ng(t.disabled),Fb.config({}),cd.config({}),Af("dropdown-events",[fm(t,r),dm(t,r)]),Af("menubutton-update-display-text",[to(Wx,function(n,e){i.bind(function(t){return t.getOpt(n)}).each(function(t){cd.set(t,[xr(o.providers.translate(e.event().text()))])})}),to(Gx,function(n,e){u.bind(function(t){return t.getOpt(n)}).each(function(t){cd.set(t,[px(e.event().icon(),o.providers.icons)])})})])])),eventOrder:St(Ux,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Na([ud.config({mode:"special",onLeft:e,onRight:e})]),lazySink:o.getSink,toggleClass:n+"--active",parts:{menu:Zg(0,t.columns,t.presets)},fetch:function(){return iv(t.fetch)}}))).asSpec()}function bx(t){return"separator"===t.type}function yx(t,e){return 0<(t=S(t,function(t,n){return nt(n)?""===n?t:"|"===n?0<t.length&&!bx(t[t.length-1])?t.concat([Xx]):t:yt(e,n.toLowerCase())?t.concat([e[n.toLowerCase()]]):t:t.concat([n])},[])).length&&bx(t[t.length-1])&&t.pop(),t}function xx(t,n){return yt(t,"getSubmenuItems")?(o=n,n=(e=t).getSubmenuItems(),o=Yx(n,o),{item:e,menus:St(o.menus,_t(e.value,o.items)),expansions:St(o.expansions,_t(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o}function wx(t,e,o,n){var r=Mo("primary-menu"),i=Yx(t,o.shared.providers.menuItems());return 0===i.items.length?$.none():(t=Rp(r,i.items,e,o,n),n=F(i.menus,function(t,n){return Rp(n,t,e,o,!1)}),t=St(n,_t(r,t)),$.from(Od.tieredData(r,t,i.expansions)))}function Sx(e){return{isDisabled:function(){return Zm.isDisabled(e)},setDisabled:function(t){return Zm.set(e,t)},setActive:function(t){var n=e.element();t?(Jo(n,"tox-tbtn--enabled"),Eo(n,"aria-pressed",!0)):(Qo(n,"tox-tbtn--enabled"),Bo(n,"aria-pressed"))},isActive:function(){return Zo(e.element(),"tox-tbtn--enabled")}}}function kx(t,n,e,o){return vx({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n){t.fetch(function(t){n(wx(t,sg.CLOSE_ON_EXECUTE,e,!1))})},onSetup:t.onSetup,getApi:Sx,columns:1,presets:"normal",classes:[],dropdownBehaviours:[lv.config({})]},n,e.shared)}function Cx(n,r,i){return function(t){t(y(n,function(t){var n,e,o=t.text.fold(function(){return{}},function(t){return{text:t}});return E(E({type:t.type},o),{onAction:function(t){var n=!t.isActive();t.setActive(n),e.storage.set(n),i.shared.getSink().each(function(t){r().getOpt(t).each(function(t){$u(t.element()),qe(t,Nh,{name:e.name,value:e.storage.get()})})})},onSetup:(n=e=t,function(t){t.setActive(n.storage.get())})})}))}}function Ox(t,n,e,o,r){return void 0===e&&(e=[]),n=n.fold(function(){return{}},function(t){return{action:t}}),n=E({buttonBehaviours:Na([ng(t.disabled),lv.config({}),Af("button press",[Ze("click"),Ze("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},n),o=St(n,{dom:o}),St(o,{components:r})}function Ex(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return gx(t,e.icons)}),i=rg([i]);return Ox(t,n,o,r,i)}function Tx(t,n,e,o){return void 0===o&&(o=[]),o=Ex(t,$.some(n),e,o),Bd.sketch(o)}function Dx(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map(function(t){return gx(t,e.icons)}):$.none(),a=u.isSome()?rg([u]):[],c=u.isSome()?{}:{innerHtml:i},r=g(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),i=E(E({tag:"button",classes:r},c),{attributes:{title:i}});return Ox(t,n,o,i,a)}function Bx(t,n,e,o,r){return void 0===o&&(o=[]),void 0===r&&(r=[]),r=Dx(t,$.some(n),e,o,r),Bd.sketch(r)}function Ax(n,e){return function(t){"custom"===e?qe(t,Nh,{name:n,value:{}}):"submit"===e?Ye(t,Ph):"cancel"===e?Ye(t,Hh):b.console.error("Unknown button type: ",e)}}function _x(t,n,e){if("menu"===n){var o=t,o=E(E({},t),{fetch:Cx(o.items,function(){return r},e)}),r=Qf(kx(o,"tox-tbtn",e,$.none()));return r.asSpec()}if("custom"===(o=n)||"cancel"===o||"submit"===o){o=Ax(t.name,n),t=E(E({},t),{borderless:!1});return Bx(t,o,e.shared.providers,[])}b.console.error("Unknown footer button type: ",n)}function Mx(t,n){var e,o=Ax(t.name,"custom");return e=$.none(),n=Wh.parts().field(E({factory:Bd},Dx(t,$.some(o),n,[sy(""),ty()]))),Qh(e,n,[],[])}function Fx(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);return null===n?tt.error(t):(t=parseFloat(n[1]),n=n[2],tt.value({value:t,unit:n}))}function Ix(t,n){function e(t){return Object.prototype.hasOwnProperty.call(o,t)}var o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1};return t.unit===n?$.some(t.value):e(t.unit)&&e(n)?o[t.unit]===o[n]?$.some(t.value):$.some(t.value/o[t.unit]*o[n]):$.none()}function Rx(t){return $.none()}function Vx(t,n){var e=Fx(t).toOption(),t=Fx(n).toOption();return n=t,t=function(t,o){return Ix(t,o.unit).map(function(t){return o.value/t}).map(function(t){return n=t,e=o.unit,function(t){return Ix(t,e).map(function(t){return{value:t*n,unit:e}})};var n,e}).getOr(Rx)},((e=e).isSome()&&n.isSome()?$.some(t(e.getOrDie(),n.getOrDie())):$.none()).getOr(Rx)}function Hx(o,n){function t(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}}function e(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}}var r=Rx,i=Mo("ratio-event"),u=qx.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(o.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:td("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:td("unlock",n.icons)}}],buttonBehaviours:Na([ng(o.disabled),lv.config({})])}),a=function(e){return Wh.parts().field({factory:Gh,inputClasses:["tox-textfield"],inputBehaviours:Na([Zm.config({disabled:o.disabled}),lv.config({}),Af("size-input-events",[to(Vr(),function(t,n){qe(t,i,{isField1:e})}),to(Lr(),function(t,n){qe(t,Rh,{name:o.name})})])]),selectOnFocus:!1})},c=qx.parts().field1(t([Wh.parts().label(e("Width")),a(!0)])),a=qx.parts().field2(t([Wh.parts().label(e("Height")),a(!1)]));return qx.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,a,t([e("&nbsp;"),u])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,o,n){Fx(sl.getValue(t)).each(function(t){r(t).each(function(t){var n,e;sl.setValue(o,(e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},-1!==(t=(n=t).value.toFixed((t=n.unit)in e?e[t]:1)).indexOf(".")&&(t=t.replace(/\.?0*$/,"")),t+n.unit))})})},coupledFieldBehaviours:Na([Zm.config({disabled:o.disabled,onDisabled:function(t){qx.getField1(t).bind(Wh.getField).each(Zm.disable),qx.getField2(t).bind(Wh.getField).each(Zm.disable),qx.getLock(t).each(Zm.disable)},onEnabled:function(t){qx.getField1(t).bind(Wh.getField).each(Zm.enable),qx.getField2(t).bind(Wh.getField).each(Zm.enable),qx.getLock(t).each(Zm.enable)}}),Af("size-input-events2",[to(i,function(t,n){var e=n.event().isField1(),n=e?qx.getField1(t):qx.getField2(t),t=e?qx.getField2(t):qx.getField1(t),n=n.map(sl.getValue).getOr(""),t=t.map(sl.getValue).getOr("");r=Vx(n,t)})])])})}function Nx(o,a){function t(t,n,e,o){return Qf(Bx({name:t,text:t,disabled:e,primary:o,icon:$.none(),borderless:!1},n,a))}function n(t,n,e,o){return Qf(Tx({name:t,icon:$.some(t),tooltip:$.some(n),disabled:o,primary:!1,borderless:!1},e,a))}function u(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(Zm)&&Zm.disable(t)})}function c(t,n){t.map(function(t){t=t.get(n);t.hasConfigured(Zm)&&Zm.enable(t)})}function r(t,n,e){qe(t,n,e)}function e(t){return Ye(t,Jx.disable()),0}function i(t){return Ye(t,Jx.enable()),0}function s(t,n){e(t),r(t,Kx.transform(),{transform:n}),i(t)}function l(t){return function(){U.getOpt(t).each(function(t){cd.set(t,[j])})}}function f(t,n){e(t),r(t,Kx.transformApply(),{transform:n,swap:l(t)}),i(t)}function d(){return t("Back",function(t){return r(t,Kx.back(),{swap:l(t)})},!1,!1)}function m(){return t("Apply",function(t){return r(t,Kx.apply(),{swap:l(t)})},!0,!0)}function g(n,e){return function(t){return n(t,e)}}function p(t,n){n=n,e(t=t),r(t,Kx.tempTransform(),{transform:n}),i(t)}function h(t,n,e,o,r){var i=jb.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:a.translate(t)}}),u=jb.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),t=jb.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Qf(jb.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e,maxX:r,getInitialValue:G({x:G(o)})},components:[i,u,t],sliderBehaviours:Na([sd.config({})]),onChoose:n}))}function v(t,n,e,o,r){return[d(),(i=n,h(t,function(t,n,e){e=g(i,e.x()/100);s(t,e)},e,o,r)),m()];var i}var b={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},y=W,x=function(){return Qf({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Na([Zm.config({})])})},w=[d(),x(),t("Apply",function(t){f(t,function(t){var n=o.getRect();return zx(t,n.x,n.y,n.w,n.h)}),o.hideCrop()},!1,!0)],S=yh.sketch({dom:b,components:w.map(function(t){return t.asSpec()}),containerBehaviours:Na([Af("image-tools-crop-buttons-events",[to(Jx.disable(),function(t,n){u(w,t)}),to(Jx.enable(),function(t,n){c(w,t)})])])}),k=Qf(Hx({name:"size",label:$.none(),constrain:!0,disabled:!1},a)),C=[d(),x(),k,x(),t("Apply",function(r){k.getOpt(r).each(function(t){var n,e,o=sl.getValue(t),t=parseInt(o.width,10),o=parseInt(o.height,10),o=(n=t,e=o,function(t){return dx(t,n,e)});f(r,o)})},!1,!0)],O=yh.sketch({dom:b,components:C.map(function(t){return t.asSpec()}),containerBehaviours:Na([Af("image-tools-resize-buttons-events",[to(Jx.disable(),function(t,n){u(C,t)}),to(Jx.enable(),function(t,n){c(C,t)})])])}),E=g(Px,"h"),T=g(Px,"v"),D=g(Lx,-90),B=g(Lx,90),A=[d(),x(),n("flip-horizontally","Flip horizontally",function(t){p(t,E)},!1),n("flip-vertically","Flip vertically",function(t){p(t,T)},!1),n("rotate-left","Rotate counterclockwise",function(t){p(t,D)},!1),n("rotate-right","Rotate clockwise",function(t){p(t,B)},!1),x(),m()],_=yh.sketch({dom:b,components:A.map(function(t){return t.asSpec()}),containerBehaviours:Na([Af("image-tools-fliprotate-buttons-events",[to(Jx.disable(),function(t,n){u(A,t)}),to(Jx.enable(),function(t,n){c(A,t)})])])}),M=function(t,n,e,o,r){var i=v(t,n,e,o,r);return yh.sketch({dom:b,components:i.map(function(t){return t.asSpec()}),containerBehaviours:Na([Af("image-tools-filter-panel-buttons-events",[to(Jx.disable(),function(t,n){u(i,t)}),to(Jx.enable(),function(t,n){c(i,t)})])])})},F=[d(),x(),m()],I=yh.sketch({dom:b,components:F.map(function(t){return t.asSpec()})}),R=M("Brightness",lx,-100,0,100),V=M("Contrast",fx,-100,0,100),H=M("Gamma",cx,-100,0,100),N=(L=function(t){return h(t,function(c,t,n){var e=N.getOpt(c),o=z.getOpt(c),r=P.getOpt(c);e.each(function(a){o.each(function(u){r.each(function(t){var n,e,o,r=sl.getValue(a).x()/100,i=sl.getValue(t).x()/100,t=sl.getValue(u).x()/100,t=(n=r,e=i,o=t,function(t){return sx(t,n,e,o)});s(c,t)})})})},0,100,200)})("R"),P=L("G"),z=L("B"),x=[d(),N,P,z,m()],F=yh.sketch({dom:b,components:x.map(function(t){return t.asSpec()})}),M=function(n,e,o){return function(t){r(t,Kx.swap(),{transform:e,swap:function(){U.getOpt(t).each(function(t){cd.set(t,[n]),o(t)})}})}},L=$.some(ax),x=$.some(ux),y=[n("crop","Crop",M(S,$.none(),function(t){o.showCrop()}),!1),n("resize","Resize",M(O,$.none(),function(t){k.getOpt(t).each(function(t){var n=o.getMeasurements(),e=n.width,n=n.height;sl.setValue(t,{width:e,height:n})})}),!1),n("orientation","Orientation",M(_,$.none(),y),!1),n("brightness","Brightness",M(R,$.none(),y),!1),n("sharpen","Sharpen",M(I,L,y),!1),n("contrast","Contrast",M(V,$.none(),y),!1),n("color-levels","Color levels",M(F,$.none(),y),!1),n("gamma","Gamma",M(H,$.none(),y),!1),n("invert","Invert",M(I,x,y),!1)],j=yh.sketch({dom:b,components:y.map(function(t){return t.asSpec()})}),y=yh.sketch({dom:{tag:"div"},components:[j],containerBehaviours:Na([cd.config({})])}),U=Qf(y);return{memContainer:U,getApplyButton:function(t){return U.getOpt(t).map(function(t){t=t.components()[0];return t.components()[t.components().length-1]})}}}var Px=rx,zx=ix,Lx=ox,jx=Mo("toolbar.button.execute"),Ux={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},Wx=Mo("update-menu-text"),Gx=Mo("update-menu-icon"),Xx={type:"separator"},Yx=function(t,e){t=yx(nt(t)?t.split(" "):t,e);return w(t,function(t,n){n=function(t){if(bx(t))return t;var n=At(t,"value").getOrThunk(function(){return Mo("generated-menu-item")});return St({value:n},t)}(n),n=xx(n,e);return{menus:St(t.menus,n.menus),items:[n.item].concat(t.items),expansions:St(t.expansions,n.expansions)}},{menus:{},expansions:{},items:[]})},li=G([fn("field1Name","field1"),fn("field2Name","field2"),ka("onLockedChange"),xa(["lockClass"]),fn("locked",!1),ll("coupledFieldBehaviours",[Ul,sl])]),Bi=G([(cl=function(t,n){return bl({factory:Wh,name:t,overrides:function(o){return{fieldBehaviours:Na([Af("coupled-input-behaviour",[to(zr(),function(e){hs(e,o,n).bind(Ul.getCurrent).each(function(n){hs(e,o,"lock").each(function(t){dd.isOn(t)&&o.onLockedChange(e,n,t)})})})])])}}})})("field1","field2"),cl("field2","field1"),bl({factory:Bd,schema:[Zt("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Na([dd.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),qx=al({name:"FormCoupledInputs",configFields:li(),partFields:Bi(),factory:function(e,t,n,o){return{uid:e.uid,dom:e.dom,components:t,behaviours:fl(e.coupledFieldBehaviours,[Ul.config({find:$.some}),sl.config({store:{mode:"manual",getValue:function(t){var n=ws(t,e,["field1","field2"]),t={};return t[e.field1Name]=sl.getValue(n.field1()),t[e.field2Name]=sl.getValue(n.field2()),t},setValue:function(t,n){t=ws(t,e,["field1","field2"]);q(n,e.field1Name)&&sl.setValue(t.field1(),n[e.field1Name]),q(n,e.field2Name)&&sl.setValue(t.field2(),n[e.field2Name])}}})]),apis:{getField1:function(t){return hs(t,e,"field1")},getField2:function(t){return hs(t,e,"field2")},getLock:function(t){return hs(t,e,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),Kx={undo:G(Mo("undo")),redo:G(Mo("redo")),zoom:G(Mo("zoom")),back:G(Mo("back")),apply:G(Mo("apply")),swap:G(Mo("swap")),transform:G(Mo("transform")),tempTransform:G(Mo("temp-transform")),transformApply:G(Mo("transform-apply"))},cl=G("save-state"),li=G("disable"),Bi=G("enable"),Jx={formActionEvent:Nh,saveState:cl,disable:li,enable:Bi},$x=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Qx=tinymce.util.Tools.resolve("tinymce.geom.Rect"),Zx=tinymce.util.Tools.resolve("tinymce.util.Observable"),tw=tinymce.util.Tools.resolve("tinymce.util.Tools"),nw=tinymce.util.Tools.resolve("tinymce.util.VK");function ew(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function ow(t,s){var l,f,d,m,g=s.document||b.document;s=s||{};var p=g.getElementById(s.handle||t),t=function(t){var n,e,o,r,i,u,a,c,n=(n=g,e=Math.max,o=n.documentElement,r=n.body,i=e(o.scrollWidth,r.scrollWidth),u=e(o.clientWidth,r.clientWidth),a=e(o.offsetWidth,r.offsetWidth),c=e(o.scrollHeight,r.scrollHeight),n=e(o.clientHeight,r.clientHeight),{width:i<a?u:i,height:c<e(o.offsetHeight,r.offsetHeight)?n:c});ew(t),t.preventDefault(),f=t.button,c=p,d=t.screenX,m=t.screenY,c=b.window.getComputedStyle?b.window.getComputedStyle(c,null).getPropertyValue("cursor"):c.runtimeStyle.cursor,l=$x("<div></div>").css({position:"absolute",top:0,left:0,width:n.width,height:n.height,zIndex:2147483647,opacity:1e-4,cursor:c}).appendTo(g.body),$x(g).on("mousemove touchmove",h).on("mouseup touchend",v),s.start(t)},h=function(t){if(ew(t),t.button!==f)return v(t);t.deltaX=t.screenX-d,t.deltaY=t.screenY-m,t.preventDefault(),s.drag(t)},v=function(t){ew(t),$x(g).off("mousemove touchmove",h).off("mouseup touchend",v),l.remove(),s.stop&&s.stop(t)};this.destroy=function(){$x(p).off()},$x(p).on("mousedown touchstart",t)}function rw(n){function u(t,s){c.getOpt(t).each(function(t){var e=f.get(),o=tu(t.element()),r=Ji(t.element()),i=s.dom().naturalWidth*e,u=s.dom().naturalHeight*e,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),n={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};ur(s,n),l.getOpt(t).each(function(t){ur(t.element(),n)}),d.get().each(function(t){var n=m.get();t.setRect({x:n.x*e+a,y:n.y*e+c,w:n.w*e,h:n.h*e}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})})})}function e(t,n){var e,i=me.fromTag("img");return Eo(i,"src",n),e=i.dom(),new xm(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)}).then(function(){return c.getOpt(t).map(function(t){var n=Gi({element:i});cd.replaceAt(t,1,$.some(n));var e=a.get(),o={x:0,y:0,w:i.dom().naturalWidth,h:i.dom().naturalHeight};a.set(o);var r,n=Qx.inflate(o,-20,-20);return m.set(n),e.w===o.w&&e.h===o.h||(o=t,r=i,c.getOpt(o).each(function(t){var n=tu(t.element()),e=Ji(t.element()),o=r.dom().naturalWidth,t=r.dom().naturalHeight,t=Math.min(n/o,e/t);1<=t?f.set(1):f.set(t)})),u(t,i),i})})}var l=Qf({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),f=fe(1),d=fe($.none()),m=fe({x:0,y:0,w:1,h:1}),a=fe({x:0,y:0,w:1,h:1}),t=yh.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[l.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:Na([Af("image-panel-crop-events",[yi(function(t){c.getOpt(t).each(function(t){t=t.element().dom(),t=cw({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,function(){});t.toggleVisibility(!1),t.on("updateRect",function(t){var n=t.rect,t=f.get(),t={x:Math.round(n.x/t),y:Math.round(n.y/t),w:Math.round(n.w/t),h:Math.round(n.h/t)};m.set(t)}),d.set($.some(t))})})])])}],containerBehaviours:Na([cd.config({}),Af("image-panel-events",[yi(function(t){e(t,n)})])])}),c=Qf(t);return{memContainer:c,updateSrc:e,zoom:function(t,n){var e=f.get(),e=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);f.set(e),c.getOpt(t).each(function(t){var n=t.components()[1].element();u(t,n)})},showCrop:function(){d.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){d.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return m.get()},getMeasurements:function(){var t=a.get();return{width:t.w,height:t.h}}}}function iw(t,n,e,o,r){return Tx({name:t,icon:$.some(n),disabled:e,tooltip:$.some(t),primary:!1,borderless:!1},o,r)}function uw(t,n){n?Zm.enable(t):Zm.disable(t)}var aw=0,cw=function(a,e,c,o,r){var s,t,n="tox-",u="tox-crid-"+aw++,l=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],i=["top","right","bottom","left"],f=function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}},d=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}};function m(t,n,e,o){var r=n.x,i=n.y,u=n.w,n=n.h;r+=e*t.deltaX,i+=o*t.deltaY,(u+=e*t.deltaW)<20&&(u=20),(n+=o*t.deltaH)<20&&(n=20),t=a=Qx.clamp({x:r,y:i,w:u,h:n},c,"move"===t.name),t=d(c,t),s.fire("updateRect",{rect:t}),h(t)}function g(n){function t(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),$x("#"+u+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}tw.each(l,function(t){$x("#"+u+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})}),t("top",{x:e.x,y:e.y,w:e.w,h:n.y-e.y}),t("right",{x:n.x+n.w,y:n.y,w:e.w-n.x-n.w+e.x,h:n.h}),t("bottom",{x:e.x,y:n.y+n.h,w:e.w,h:e.h-n.y-n.h+e.y}),t("left",{x:e.x,y:n.y,w:n.x-e.x,h:n.h}),t("move",n)}function p(t){g(a=t)}function h(t){p(f(c,t))}return $x('<div id="'+u+'" class="'+n+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),tw.each(i,function(t){$x("#"+u,o).append('<div id="'+u+"-"+t+'"class="'+n+'croprect-block" style="display: none" data-mce-bogus="all">')}),tw.each(l,function(t){$x("#"+u,o).append('<div id="'+u+"-"+t.name+'" class="'+n+"croprect-handle "+n+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),t=tw.map(l,function(n){var e;return new ow(u,{document:o.ownerDocument,handle:u+"-"+n.name,start:function(){e=a},drag:function(t){m(n,e,t.deltaX,t.deltaY)}})}),g(a),$x(o).on("focusin focusout",function(t){$x(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),$x(o).on("keydown",function(n){var i;function t(t,n,e,o,r){t.stopPropagation(),t.preventDefault(),m(i,e,o,r)}switch(tw.each(l,function(t){if(n.target.id===u+"-"+t.name)return i=t,!1}),n.keyCode){case nw.LEFT:t(n,0,a,-10,0);break;case nw.RIGHT:t(n,0,a,10,0);break;case nw.UP:t(n,0,a,0,-10);break;case nw.DOWN:t(n,0,a,0,10);break;case nw.ENTER:case nw.SPACEBAR:n.preventDefault(),r()}}),s=tw.extend({toggleVisibility:function(t){var n=tw.map(l,function(t){return"#"+u+"-"+t.name}).concat(tw.map(i,function(t){return"#"+u+"-"+t})).join(",");t?$x(n,o).show():$x(n,o).hide()},setClampRect:function(t){c=t,g(a)},setRect:p,getInnerRect:function(){return d(c,a)},setInnerRect:h,setViewPortRect:function(t){e=t,g(a)},destroy:function(){tw.each(t,function(t){t.destroy()}),t=[]}},Zx)};function sw(){var e=[],o=-1;function t(){return 0<o}function n(){return-1!==o&&o<e.length-1}return{data:e,add:function(t){var n=e.splice(++o);return e.push(t),{state:t,removed:n}},undo:function(){if(0<o)return e[--o]},redo:function(){if(n())return e[++o]},canUndo:t,canRedo:n}}function lw(t){var n=fe(t),e=fe($.none()),o=sw();function r(t){n.set(t)}function i(t){b.URL.revokeObjectURL(t.url)}function u(t){var n=a(t);return r(n),t=t=o.add(n).removed,tw.each(t,i),n.url}o.add(t);var a=function(t){return{blob:t,url:b.URL.createObjectURL(t)}},c=function(){e.get().each(i),e.set($.none())};return{getBlobState:function(){return n.get()},setBlobState:r,addBlobState:u,getTempState:function(){return e.get().fold(function(){return n.get()},function(t){return t})},updateTempState:function(t){t=a(t);return c(),e.set($.some(t)),t.url},addTempState:function(t){t=a(t);return e.set($.some(t)),t.url},applyTempState:function(n){return e.get().fold(function(){},function(t){u(t.blob),n()})},destroyTempState:c,undo:function(){var t=o.undo();return r(t),t.url},redo:function(){var t=o.redo();return r(t),t.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}}function fw(t,n){function i(t){var n=l.getHistoryStates();p.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),qe(t,Jx.formActionEvent,{name:Jx.saveState(),value:n.undoEnabled})}function u(t){return t.toBlob()}function a(t){qe(t,Jx.formActionEvent,{name:Jx.disable(),value:{}})}function r(n,t,e,o,r){return a(n),Py(t).then(e).then(u).then(o).then(function(t){return d(n,t).then(function(t){return i(n),r(),f(n),t})}).catch(function(t){return b.console.log(t),f(n),t})}function c(t,n,e){var o=l.getBlobState().blob;r(t,o,n,function(t){return l.updateTempState(t)},e)}var o,s,l=lw(t.currentState),f=function(t){e.getApplyButton(t).each(function(t){Zm.enable(t)}),qe(t,Jx.formActionEvent,{name:Jx.enable(),value:{}})},d=function(t,n){return a(t),g.updateSrc(t,n)},m=function(t){var n=l.getBlobState().url;return l.destroyTempState(),i(t),n},g=rw(t.currentState.url),p=(o=Qf(iw("Undo","undo",!0,function(t){qe(t,Kx.undo(),{direction:1})},t=n)),s=Qf(iw("Redo","redo",!0,function(t){qe(t,Kx.redo(),{direction:1})},t)),{container:yh.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),s.asSpec(),iw("Zoom in","zoom-in",!1,function(t){qe(t,Kx.zoom(),{direction:1})},t),iw("Zoom out","zoom-out",!1,function(t){qe(t,Kx.zoom(),{direction:-1})},t)]}),updateButtonUndoStates:function(t,n,e){o.getOpt(t).each(function(t){uw(t,n)}),s.getOpt(t).each(function(t){uw(t,e)})}}),e=Nx(g,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[e.memContainer.asSpec(),g.memContainer.asSpec(),p.container],behaviours:Na([sl.config({store:{mode:"manual",getValue:function(){return l.getBlobState()}}}),Af("image-tools-events",[to(Kx.undo(),function(n,t){var e=l.undo();d(n,e).then(function(t){f(n),i(n)})}),to(Kx.redo(),function(n,t){var e=l.redo();d(n,e).then(function(t){f(n),i(n)})}),to(Kx.zoom(),function(t,n){n=n.event().direction();g.zoom(t,n)}),to(Kx.back(),function(t,n){var e;t=m(e=t),d(e,t).then(function(t){f(e)}),n.event().swap()(),g.hideCrop()}),to(Kx.apply(),function(t,n){l.applyTempState(function(){m(t),n.event().swap()()})}),to(Kx.transform(),function(t,n){return c(t,n.event().transform(),W)}),to(Kx.tempTransform(),function(t,n){return e=t,t=n.event().transform(),n=l.getTempState().blob,void r(e,n,t,function(t){return l.addTempState(t)},W);var e}),to(Kx.transformApply(),function(t,n){return e=t,o=n.event().transform(),t=n.event().swap(),n=l.getBlobState().blob,void r(e,n,o,function(t){t=l.addBlobState(t);return m(e),t},t);var e,o}),to(Kx.swap(),function(n,t){e=n,p.updateButtonUndoStates(e,!1,!1);var e=t.event().transform(),o=t.event().swap();e.fold(function(){o()},function(t){c(n,t,o)})})]),ty()])}}function dw(e,n){var t=e.label.map(function(t){return Zh(t,n)}),o=[Zm.config({disabled:e.disabled}),ud.config({mode:"execution",useEnter:!0!==e.multiline,useControlEnter:!0===e.multiline,execute:function(t){return Ye(t,Ph),$.some(!0)}}),Af("textfield-change",[to(zr(),function(t,n){qe(t,Rh,{name:e.name})}),to(qr(),function(t,n){qe(t,Rh,{name:e.name})})]),lv.config({})],r=e.validation.map(function(e){return cv.config({getRoot:function(t){return mo(t.element())},invalidClass:"tox-invalid",validator:{validate:function(t){var n=sl.getValue(t),t=e.validator(n);return uv(!0===t?tt.value(n):tt.error(t))},validateOnLoad:e.validateOnLoad}})}).toArray(),i=e.placeholder.fold(G({}),function(t){return{placeholder:n.translate(t)}}),u=e.inputMode.fold(G({}),function(t){return{inputmode:t}}),u=E(E({},i),u),u=Wh.parts().field({tag:!0===e.multiline?"textarea":"input",inputAttributes:u,inputClasses:[e.classname],inputBehaviours:Na(T([o,r])),selectOnFocus:!1,factory:Gh}),o=(e.flex?["tox-form__group--stretched"]:[]).concat(e.maximized?["tox-form-group--maximize"]:[]),r=[Zm.config({disabled:e.disabled,onDisabled:function(t){Wh.getField(t).each(Zm.disable)},onEnabled:function(t){Wh.getField(t).each(Zm.enable)}})];return Qh(t,u,o,r)}function mw(t,n,e){e=sl.getValue(e),sl.setValue(n,e),ek(n)}function gw(t,n){var e=t.element(),o=dr(e),t=e.dom();"number"!==To(e,"type")&&n(t,o)}function pw(t,n,o){if(t.selectsOver){var e=sl.getValue(n),r=t.getDisplayText(e),e=sl.getValue(o);return 0===t.getDisplayText(e).indexOf(r)?$.some(function(){var t,e;mw(0,n,o),t=n,e=r.length,gw(t,function(t,n){return t.setSelectionRange(e,n.length)})}):$.none()}return $.none()}function hw(t){return ik(iv(t))}function vw(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}}function bw(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:function(){}}}function yw(t,n){return e=t,n=x(n,function(t){return t.type===e}),y(n,vw);var e}function xw(t,n){var e=t.toLowerCase();return x(n,function(t){var n=(void 0!==t.meta&&void 0!==t.meta.text?t.meta:t).text;return xn(n.toLowerCase(),e)||xn(t.value.toLowerCase(),e)})}function ww(o,t,r){var i=void 0!==(t=sl.getValue(t)).meta.text?t.meta.text:t.value;return r.getLinkInformation().fold(function(){return[]},function(t){var n,e=xw(i,(n=r.getHistory(o),y(n,function(t){return bw(t,t)})));return"file"===o?(t=[e,xw(i,yw("header",t.targets)),xw(i,T([(n=t,$.from(n.anchorTop).map(function(t){return bw("<top>",t)}).toArray()),yw("anchor",t.targets),(t=t,$.from(t.anchorBottom).map(function(t){return bw("<bottom>",t)}).toArray())]))],S(t,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(ak,n)},[])):e})}function Sw(r,n,e){function i(t){t=sl.getValue(t),e.addToHistory(t.value,r.filetype)}var t,o,u,a,c=n.shared.providers,s=Wh.parts().field({factory:rk,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":ck,type:"url"},minChars:0,responseTime:0,fetch:function(t){t=ww(r.filetype,t,e),t=wx(t,sg.BUBBLE_TO_SANDBOX,n,!1);return uv(t)},getHotspot:function(t){return p.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(cv)&&cv.run(t).get(W)},typeaheadBehaviours:Na(T([e.getValidationHandler().map(function(o){return cv.config({getRoot:function(t){return mo(t.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){f.getOpt(t).each(function(t){Eo(t.element(),"title",c.translate(n))})}},validator:{validate:function(t){var n=sl.getValue(t);return uk(function(e){o({type:r.filetype,url:n.value},function(t){var n;"invalid"===t.status?(n=tt.error(t.message),e(n)):(t=tt.value(t.message),e(t))})})},validateOnLoad:!1}})}).toArray(),[Zm.config({disabled:r.disabled}),lv.config({}),Af("urlinput-events",T(["file"===r.filetype?[to(zr(),function(t){qe(t,Rh,{name:r.name})})]:[],[to(Lr(),function(t){qe(t,Rh,{name:r.name}),i(t)}),to(qr(),function(t){qe(t,Rh,{name:r.name}),i(t)})]]))]])),eventOrder:((d={})[zr()]=["streaming","urlinput-events","invalidating"],d),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Zg(0,0,"normal")},onExecute:function(t,n,e){qe(n,Ph,{})},onItemExecute:function(t,n,e,o){i(t),qe(t,Rh,{name:r.name})}}),l=r.label.map(function(t){return Zh(t,c)}),f=Qf((t="invalid",o=$.some(ck),void 0===(u="warning")&&(u=t),void 0===a&&(a=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:td(u,c.icons),attributes:E({title:c.translate(a),"aria-live":"polite"},o.fold(function(){return{}},function(t){return{id:t}}))}})),d=Qf({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),m=e.getUrlPicker(r.filetype),g=Mo("browser.url.event"),p=Qf({dom:{tag:"div",classes:["tox-control-wrap"]},components:[s,d.asSpec()],behaviours:Na([Zm.config({disabled:r.disabled})])}),h=Qf(Bx({name:r.name,icon:$.some("browse"),text:r.label.getOr(""),disabled:r.disabled,primary:!1,borderless:!0},function(t){return Ye(t,g)},c,[],["tox-browse-url"]));return Wh.sketch({dom:dv([]),components:l.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:T([[p.asSpec()],m.map(function(){return h.asSpec()}).toArray()])}]),fieldBehaviours:Na([Zm.config({disabled:r.disabled,onDisabled:function(t){Wh.getField(t).each(Zm.disable),h.getOpt(t).each(Zm.disable)},onEnabled:function(t){Wh.getField(t).each(Zm.enable),h.getOpt(t).each(Zm.enable)}}),Af("url-input-events",[to(g,function(o){Ul.getCurrent(o).each(function(n){var e=sl.getValue(n);m.each(function(t){t(e).get(function(t){sl.setValue(n,t),qe(o,Rh,{name:r.name})})})})})])])})}function kw(i,n){function o(t,n){n=y(n,function(t){var n=Hm.translate(t.text),e=1===i.columns?'<div class="tox-collection__item-label">'+n+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",r={_:" "," - ":" ","-":" "},n=n.replace(/\_| \- |\-/g,function(t){return r[t]});return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+('"'===(t=t.value)?"&quot;":t)+'" title="'+n+'" aria-label="'+n+'">'+o+e+"</div>"}),n=1<i.columns&&"auto"!==i.columns?v(n,i.columns):[n],n=y(n,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}),Co(t.element(),n.join(""))}var t,e=i.label.map(function(t){return Zh(t,n)}),r=(t=function(o){return function(n,e){du(e.event().target(),"[data-collection-item-value]").each(function(t){o(n,e,t,To(t,"data-collection-item-value"))})}})(function(t,n,e,o){n.stop(),qe(t,Nh,{name:i.name,value:o})}),u=[to(Rr(),t(function(t,n,e){$u(e)})),to(jr(),r),to(Qr(),r),to(Vr(),t(function(t,n,e){fu(t.element(),"."+Xm).each(function(t){Qo(t,Xm)}),Jo(e,Xm)})),to(Hr(),t(function(t){fu(t.element(),"."+Xm).each(function(t){Qo(t,Xm)})})),Si(t(function(t,n,e,o){qe(t,Nh,{name:i.name,value:o})}))],u=Wh.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==i.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:l},behaviours:Na([cd.config({}),sl.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,t){o(e,t),"auto"===i.columns&&Wd(e,5,"tox-collection__item").each(function(t){var n=t.numRows,t=t.numColumns;ud.setGridSize(e,n,t)}),Ye(e,Uh)}}),lv.config({}),ud.config((r=i.columns,t="normal",1===r?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===r?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?"."+zm:"."+Pm}})),Af("collection-events",u)])});return Qh(e,u,["tox-form__group--collection"],[])}function Cw(t,n){function e(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}}function o(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}}function r(t){return{dom:{tag:"tr"},components:y(t,o)}}var i;return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=t.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:y(i,e)}]}),(t=t.cells,{dom:{tag:"tbody"},components:y(t,r)})],behaviours:Na([lv.config({}),sd.config({})])}}function Ow(r){return function(n,e,o){return At(e,"name").fold(function(){return r(e,o)},function(t){return n.field(t,r(e,o))})}}function Ew(n,t,e){var o=St(e,{shared:{interpreter:function(t){return fk(n,t,o)}}});return fk(n,t,o)}function Tw(t){return{colorPicker:function(t,n){wp.colorPickerDialog(r)(t,n)},hasCustomColors:function(){return fp(o)},getColors:function(){return dp(e)},getColorCols:(n=e=o=r=t,function(){return wp.getColorCols(n)})};var n,e,o,r}function Dw(n,t){function e(t){ft(t,function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)})}var o=hk(t);return n.formatter?e(o.customFormats):n.on("init",function(){e(o.customFormats)}),o.formats}function Bw(n){return t=n,$.from(t.getParam("style_formats")).filter(ot).map(function(t){t=Dw(n,t);return n.getParam("style_formats_merge",!1,"boolean")?pk.concat(t):t}).getOr(pk);var t}function Aw(t,n,e){return e={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)},St(t,e)}function _w(i,t,u,a){var c=function(t){return y(t,function(t){var n,e,o=gt(t);if(q(t,"items")){var r=c(t.items);return St((n=t,e={type:"submenu",isSelected:G(!1),getStylePreview:function(){return $.none()}},St(n,e)),{getStyleItems:function(){return r}})}return q(t,"format")?Aw(t,u,a):1===o.length&&lt(o,"title")?St(t,{type:"separator"}):(o=Mo((e=t).title),t={type:"formatter",format:o,isSelected:u(o),getStylePreview:a(o)},t=St(e,t),i.formatter.register(o,t),t)})};return c(t)}function Mw(e){function o(t){return function(){return e.formatter.match(t)}}function r(n){return function(){var t=e.formatter.get(n);return void 0!==t?$.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styleAttr:e.formatter.getCssText(n)}):$.none()}}var i=function(t){var n=t.items;return void 0!==n&&0<n.length?O(n,i):[t.format]},u=fe([]),a=fe([]),c=fe([]),s=fe([]),l=fe(!1);return e.on("init",function(){var t=Bw(e),t=_w(e,t,o,r);u.set(t),a.set(O(t,i))}),e.on("addStyleModifications",function(t){var n=_w(e,t.items,o,r);c.set(n),l.set(t.replace),s.set(O(n,i))}),{getData:function(){var t=l.get()?[]:u.get(),n=c.get();return t.concat(n)},getFlattenedKeys:function(){var t=l.get()?[]:a.get(),n=s.get();return t.concat(n)}}}function Fw(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}}function Iw(t){return t.innerText||t.textContent}function Rw(t){return(n=t)&&"A"===n.nodeName&&void 0!==(n.id||n.name)&&xk(t);var n}function Vw(t){return t&&/^(H[1-6])$/.test(t.nodeName)}function Hw(t){return Vw(t)&&xk(t)}function Nw(t){var n,e=t.id||Mo("h");return Fw("header",Iw(t),"#"+e,Vw(n=t)?parseInt(n.nodeName.substr(1),10):0,function(){t.id=e})}function Pw(t){var n=t.id||t.name,t=Iw(t);return Fw("anchor",t||"#"+n,"#"+n,0,W)}function zw(t){var n;return n="h1,h2,h3,h4,h5,h6,a:not([href])",t=t,y(dc(me.fromDom(t),n),function(t){return t.dom()})}function Lw(t){return 0<vk(t.title).length}function jw(t){return nt(t)&&/^https?/.test(t)}function Uw(t){return et(t)&&I(t,function(t){return!(ot(t=t)&&t.length<=5&&D(t,jw))}).isNone()}function Ww(){var t,n=b.localStorage.getItem(Sk);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return b.console.log("Local storage "+Sk+" was not valid JSON",t),{};throw t}return Uw(t)?t:(b.console.log("Local storage "+Sk+" was not valid format",t),{})}function Gw(t){var n=Ww();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]}function Xw(n,t){var e,o;jw(n)&&(e=Ww(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],o=x(o,function(t){return t!==n}),e[t]=[n].concat(o).slice(0,5),function(t){if(!Uw(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));b.localStorage.setItem(Sk,JSON.stringify(t))}(e))}function Yw(t){return!!t}function qw(t){return F(tw.makeMap(t,/[, ]/),Yw)}function Kw(t,n,e){return t=t,n=n,e=(kk.call(t,n)?$.some(t[n]):$.none()).getOr(e),nt(e)?$.some(e):$.none()}function Jw(t){return $.some(t.file_picker_callback).filter(it)}function $w(t,n){var e,o,r,i=(i=t,e=$.some(i.file_picker_types).filter(Yw),o=$.some(i.file_browser_callback_types).filter(Yw),r=e.or(o).map(qw),Jw(i).fold(function(){return!1},function(t){return r.fold(function(){return!0},function(t){return 0<gt(t).length&&t})}));return rt(i)?i?Jw(t):$.none():i[n]?Jw(t):$.none()}function Qw(n){return{getHistory:Gw,addToHistory:Xw,getLinkInformation:function(){return!1===(t=n).settings.typeahead_urls?$.none():$.some({targets:wk(t.getBody()),anchorTop:Kw(t.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:Kw(t.settings,"anchor_bottom","#bottom").getOrUndefined()});var t},getValidationHandler:function(){return t=n,$.from(t.settings.file_picker_validator_handler).filter(it).orThunk(function(){return $.from(t.settings.filepicker_validator_handler).filter(it)});var t},getUrlPicker:function(t){return i=t,$w((r=n).settings,i).map(function(o){return function(n){return iv(function(e){var t=tw.extend({filetype:i},$.from(n.meta).getOr({}));o.call(r,function(t,n){if(!nt(t))throw new Error("Expected value to be string");if(void 0!==n&&!et(n))throw new Error("Expected meta to be a object");e({value:t,meta:n})},n.value,t)})}});var r,i}}}function Zw(t,n,e,o){var r,i=fe(!1),u={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Hm.translate},interpreter:function(t){return fk(lk,t,u)},anchors:gk(n,e,o),getSink:function(){return tt.value(t)}},urlinput:Qw(n),styleselect:Mw(n),colorinput:Tw(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return u}function tS(t,n,o){var e,r=(e=function(t,n){var e=o(t);return $.some({element:G(t),start:G(n),finish:G(n+e),width:G(e)})},S(t,function(n,t){return e(t,n.len).fold(G(n),function(t){return{len:t.finish(),list:n.list.concat([t])}})},{len:0,list:[]}).list),i=x(r,function(t){return t.finish()<=n}),t=w(i,function(t,n){return t+n.width()},0),r=r.slice(i.length);return{within:G(i),extra:G(r),withinWidth:G(t)}}function nS(t){return y(t,function(t){return t.element()})}function eS(t,n,e,o){var r=(u=function(t,n,e){e=tS(n,t,e);return 0===e.extra().length?$.some(e):$.none()}(t,n,e).getOrThunk(function(){return tS(n,t-e(o),e)})).within(),i=u.extra(),u=u.withinWidth();return 1===i.length&&i[0].width()<=e(o)?function(t,n,e){n=nS(t.concat(n));return Ek(n,[],e)}(r,i,u):1<=i.length?function(t,n,e,o){e=nS(t).concat([e]);return Ek(e,nS(n),o)}(r,i,o,u):(u=u,Ek(nS(r),[],u))}function oS(t,n){n=y(n,function(t){return qi(t)}),Ok.setGroups(t,n)}function rS(t,n,e,o){var r=vs(t,n,"primary"),i=hs(t,n,"overflow-button"),u=mv.getCoupled(t,"overflowGroup");ir(r.element(),"visibility","hidden");var a,c=(a=i,e.bind(function(n){return Zu(n.element()).bind(function(t){return n.getSystem().getByDom(t).toOption()})}).orThunk(function(){return a.filter(sd.isFocused)}));e.each(function(t){Ok.setGroups(t,[])}),t=n.builtGroups.get(),oS(r,t.concat([u]));var n=tu(r.element()),s=eS(n,t,function(t){return tu(t.element())},u);0===s.extra().length?(cd.remove(r,u),e.each(function(t){Ok.setGroups(t,[])})):(oS(r,s.within()),e.each(function(t){oS(t,s.extra())})),lr(r.element(),"visibility"),fr(r.element()),e.each(function(n){i.each(function(t){return dd.set(t,o(n))}),c.each(sd.focus)})}function iS(e,t,n,o,r){var i="alloy.toolbar.toggle";return{uid:e.uid,dom:e.dom,components:t,behaviours:rs(e.splitToolbarBehaviours,[mv.config({others:E(E({},r.coupling),{overflowGroup:function(n){return Tk.sketch(E(E({},o["overflow-group"]()),{items:[Bd.sketch(E(E({},o["overflow-button"]()),{action:function(t){Ye(n,i)}}))]}))}})}),Af("toolbar-toggle-events",[to(i,function(t){r.apis.toggle(t)})])]),apis:E({setGroups:function(t,n){n=y(n,(n=t).getSystem().build),e.builtGroups.set(n),r.apis.refresh(t)},getMoreButton:function(t){return hs(t,e,"overflow-button")}},r.apis),domModification:{attributes:{role:"group"}}}}function uS(t){return t.getSystem().isConnected()}function aS(t,n,e){var o=n.lazySink(t).getOrDie(),t=n.getAnchor(t),n=n.getOverflowBounds.map(function(t){return t()});qs.positionWithinBounds(o,t,e,n)}function cS(n,e){var t=nl.getState(mv.getCoupled(n,"sandbox"));rS(n,e,t,uS),t.each(function(t){return aS(n,e,t)})}function sS(n,e){nl.getState(mv.getCoupled(n,"sandbox")).each(function(t){return aS(n,e,t)})}function lS(n,t){return t.getAnimationRoot.fold(function(){return n.element()},function(t){return t(n)})}function fS(t){return t.dimension.property}function dS(t,n){return t.dimension.getDimension(n)}function mS(t,n){t=lS(t,n),nr(t,[n.shrinkingClass,n.growingClass])}function gS(t,n){Qo(t.element(),n.openClass),Jo(t.element(),n.closedClass),ir(t.element(),fS(n),"0px"),fr(t.element())}function pS(t,n){Qo(t.element(),n.closedClass),Jo(t.element(),n.openClass),lr(t.element(),fS(n))}function hS(t,n,e,o){e.setCollapsed(),ir(t.element(),fS(n),dS(n,t.element())),fr(t.element()),mS(t,n),gS(t,n),n.onStartShrink(t),n.onShrunk(t)}function vS(t,n,e,o){o=o.getOrThunk(function(){return dS(n,t.element())}),e.setCollapsed(),ir(t.element(),fS(n),o),fr(t.element()),o=lS(t,n),Qo(o,n.growingClass),Jo(o,n.shrinkingClass),gS(t,n),n.onStartShrink(t)}function bS(t,n,e){var o=dS(n,t.element());("0px"===o?hS:vS)(t,n,e,$.some(o))}function yS(t,n,e){var o=lS(t,n),r=Zo(o,n.shrinkingClass),i=dS(n,t.element());pS(t,n);var u=dS(n,t.element());(r?function(){ir(t.element(),fS(n),i),fr(t.element())}:function(){gS(t,n)})(),Qo(o,n.shrinkingClass),Jo(o,n.growingClass),pS(t,n),ir(t.element(),fS(n),u),e.setExpanded(),n.onStartGrow(t)}function xS(t,n,e){return t=lS(t,n),!0===Zo(t,n.growingClass)}function wS(t,n,e){return t=lS(t,n),!0===Zo(t,n.shrinkingClass)}function SS(t){return Ak.hasGrown(t)}function kS(t,n){var e,o,r=t.outerContainer;o=n,t=(e=t).outerContainer.element(),o&&(e.mothership.broadcastOn([el()],{target:t}),e.uiMothership.broadcastOn([el()],{target:t})),e.mothership.broadcastOn([Ik],{readonly:o}),e.uiMothership.broadcastOn([Ik],{readonly:o}),Cn("*",r.element()).forEach(function(t){r.getSystem().getByDom(t).each(function(t){t.hasConfigured(Zm)&&Zm.set(t,n)})})}function CS(t,n){t.on("init",function(){t.readonly&&kS(n,!0)}),t.on("SwitchMode",function(){return kS(n,t.readonly)}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")}function OS(n){var t;return Wa.config({channels:((t={})[Ik]={schema:Rk,onReceive:function(t,o){n(t).each(function(t){var n,e;n=t,e=o.readonly,Cn("*",n.element()).forEach(function(t){n.getSystem().getByDom(t).each(function(t){t.hasConfigured(Zm)&&Zm.set(t,e)})})})}},t)})}function ES(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:E({tag:"div",classes:["tox-toolbar__group"]},n),components:[Tk.parts().items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Na([lv.config({}),sd.config({})])}}function TS(t){return Tk.sketch(ES(t))}function DS(e,t,n){var o=yi(function(t){var n=y(e.initGroups,TS);Ok.setGroups(t,n)});return Na([ud.config({mode:t,onEscape:e.onEscape,selector:".tox-toolbar__group"}),Af("toolbar-events",[o]),OS(n)])}function BS(t,n){var e=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":ES({title:$.none(),items:[]}),"overflow-button":Ex({name:"more",icon:$.some("more-drawer"),disabled:!1,tooltip:$.some("More..."),primary:!1,borderless:!1},$.none(),t.backstage.shared.providers)},splitToolbarBehaviours:DS(t,e,n)}}function AS(e){var t=BS(e,Bk.getOverflow),n=Bk.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return Bk.sketch(E(E({},t),{lazySink:e.getSink,getAnchor:function(){return e.backstage.shared.anchors.toolbarOverflow()},getOverflowBounds:function(){var t=e.moreDrawerData.lazyHeader().element(),n=cu(t),t=lo(t),t=cu(t);return uu(n.x()+4,t.y(),n.width()-8,t.height())},parts:E(E({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"]}}}),components:[n],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))}function _S(t){var n=Mk.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=Mk.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),t=BS(t,Mk.getOverflow);return Mk.sketch(E(E({},t),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([Fk()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([Fk()],{type:"closed"})}}))}function MS(t){var n=t.cyclicKeying?"cyclic":"acyclic";return Ok.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===bh.scrolling?["tox-toolbar--scrolling"]:[])},components:[Ok.parts().groups({})],toolbarBehaviours:DS(t,n,G($.none()))})}function FS(t){return qt("toolbarbutton",Vk,t)}function IS(t){return qt("menubutton",Hk,t)}function RS(t){return qt("ToggleButton",Pk,t)}function VS(n){return{isDisabled:function(){return Zm.isDisabled(n)},setDisabled:function(t){return Zm.set(n,t)}}}function HS(n){return{setActive:function(t){dd.set(n,t)},isActive:function(){return dd.isOn(n)},isDisabled:function(){return Zm.isDisabled(n)},setDisabled:function(t){return Zm.set(n,t)}}}function NS(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})}function PS(n,e,t,o,r,i){function u(t){return Hm.isRtl()&&lt(Gk,t)?t+"-rtl":t}var a=Hm.isRtl()&&n.exists(function(t){return lt(Xk,t)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(e.isSome()?["tox-tbtn--select"]:[]).concat(a?["tox-tbtn__icon-rtl"]:[]),attributes:NS(t,i)},components:rg([n.map(function(t){return gx(u(t),i.icons)}),e.map(function(t){return hx(t,"tox-tbtn",i)})]),eventOrder:((t={})[_r()]=["focusing","alloy.base.behaviour","common-button-display-events"],t),buttonBehaviours:Na([Af("common-button-display-events",[to(_r(),function(t,n){n.event().prevent(),Ye(t,Wk)})])].concat(o.map(function(t){return jk.config({channel:t,initialData:{icon:n,text:e},renderComponents:function(t,n){return rg([t.icon.map(function(t){return gx(u(t),i.icons)}),t.text.map(function(t){return hx(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}}function zS(t,n,e){var o,r=fe(W),e=PS(t.icon,t.text,t.tooltip,$.none(),$.none(),e);return Bd.sketch({dom:e.dom,components:e.components,eventOrder:Ux,buttonBehaviours:Na([Af("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Si(function(n,t){lm(o,n)(function(t){qe(n,jx,{buttonApi:t}),o.onAction(t)})})),fm(n,r),dm(n,r)]),og(t.disabled)].concat(n.toolbarButtonBehaviours))})}function LS(n,r){function e(o){return{isDisabled:function(){return Zm.isDisabled(o)},setDisabled:function(t){return Zm.set(o,t)},setIconFill:function(t,n){fu(o.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){Eo(t,"fill",n)})},setIconStroke:function(t,n){fu(o.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){Eo(t,"stroke",n)})},setActive:function(n){Eo(o.element(),"aria-pressed",n),fu(o.element(),"span").each(function(t){o.getSystem().getByDom(t).each(function(t){return dd.set(t,n)})})},setIcon:function(e){fu(o.element(),"span").each(function(t){o.getSystem().getByDom(t).each(function(t){let n=t.element().dom().querySelector(".tox-icon");n&&(n.innerHTML=px(e,r.providers.icons).dom.innerHtml)})})},isActive:function(){return fu(o.element(),"span").exists(function(t){return o.getSystem().getByDom(t).exists(dd.isOn)})}}}var o,i,u,t=Mo("channel-update-split-dropdown-display"),a=fe(W),c={getApi:e,onSetup:n.onSetup};return Uk.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:kt({"aria-pressed":!1},NS(n.tooltip,r.providers))},onExecute:function(t){n.onAction(e(t))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:Na([eg(!1),Af("split-dropdown-events",[to(Wk,sd.focus),fm(c,a),dm(c,a)]),Fb.config({})]),eventOrder:((a={})[ai()]=["alloy.base.behaviour","split-dropdown-events"],a),toggleClass:"tox-tbtn--enabled",lazySink:r.getSink,fetch:(o=e,i=n,u=r.providers,function(n){return iv(function(t){return i.fetch(t)}).map(function(t){return $.from(Vp(St(rp(Mo("menu-value"),t,function(t){i.onItemAction(o(n),t)},i.columns,i.presets,sg.CLOSE_ON_EXECUTE,i.select.getOr(function(){return!1}),u),{movement:ip(i.columns,i.presets),menuBehaviours:Mm("auto"!==i.columns?[]:[yi(function(e,t){Wd(e,4,qd(i.presets)).each(function(t){var n=t.numRows,t=t.numColumns;ud.setGridSize(e,n,t)})})])})))})}),parts:{menu:Zg(0,n.columns,n.presets)},components:[Uk.parts().button(PS(n.icon,n.text,$.none(),$.some(t),$.some([dd.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),r.providers)),Uk.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:td("chevron-down",r.providers.icons)}}),Uk.parts()["aria-descriptor"]({text:r.providers.translate("To open the popup, press Shift+Enter")})]})}function jS(o,r){return to(jx,function(t,n){var e,t=o.get(t),t=(e=t,{hide:function(){return Ye(e,ti())},getValue:function(){return sl.getValue(e)}});r.onAction(t,n.event().buttonApi())})}function US(t,n,e){var o,r,i,u={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?(o=t,i=u,(e=(r=n).original).primary,e=f(e,["primary"]),e=Kt(RS(E(E({},e),{type:"togglebutton",onAction:function(){}}))),qk(e,i.backstage.shared.providers,[jS(o,r)])):(r=t,t=u,(n=(u=n).original).primary,n=f(n,["primary"]),n=Kt(FS(E(E({},n),{type:"button",onAction:function(){}}))),Yk(n,t.backstage.shared.providers,[jS(r,u)]))}function WS(t,n){var e=Math.max(n.x(),t.x()),t=t.right()-e,n=n.width()-(e-n.x());return{x:e,width:Math.min(t,n)}}function GS(t){var n,e,o,r=ph(t)||hh(t)||wh(t),i=ru(b.window),u=au(me.fromDom(t.getContentAreaContainer()));return t.inline&&!r?(n=(o=WS(n=u,e=i)).x,o=o.width,uu(n,e.y(),o,e.height())):t.inline?function(t,n,e){var o=WS(n,e),r=o.x,i=o.width,o=me.fromDom(t.getContainer()),t=fu(o,".tox-editor-header").getOr(o),o=au(t),t=e.height(),e=e.y();if(o.y()>=n.bottom()){n=Math.min(t+e,o.y());return uu(r,e,i,n-e)}o=Math.max(e,o.bottom());return uu(r,o,i,t-(o-e))}(t,u,i):(n=t,t=WS(o=u,e=i),u=t.x,i=t.width,t=me.fromDom(n.getContainer()),n=fu(t,".tox-editor-header").getOr(t),t=au(t),n=au(n),n=Math.max(e.y(),o.y(),n.bottom()),t=t.bottom()-n,e=e.height()-(n-e.y()),e=Math.min(t,e),uu(u,n,i,e))}function XS(n,t){return hu(t,function(t){return t.predicate(n.dom())?$.some({toolbarApi:t,elem:n}):$.none()})}function YS(o,r){return function(n){function t(){n.setActive(o.formatter.match(r));var t=o.formatter.formatChanged(r,n.setActive).unbind;e.set($.some(t))}var e=fe($.none());return o.initialized?t():o.on("init",t),function(){return e.get().each(function(t){return t()})}}}function qS(n){return function(t){return function(){n.undoManager.transact(function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)})}}}function KS(t,i,u){function r(t,n,e,o){var r=i.shared.providers.translate(t.title);return"separator"===t.type?$.some({type:"separator",text:r}):"submenu"!==t.type?$.some(E({type:"togglemenuitem",text:r,active:t.isSelected(o),disabled:e,onAction:u.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}}))):(e=O(t.getStyleItems(),function(t){return c(t,n,o)}),0===n&&e.length<=0?$.none():$.some({type:"nestedmenuitem",text:r,disabled:e.length<=0,getSubmenuItems:function(){return O(t.getStyleItems(),function(t){return c(t,n,o)})}}))}function a(t){var n=u.getCurrentValue(),e=u.shouldHide?0:1;return O(t,function(t){return c(t,e,n)})}var c=function(t,n,e){var o="formatter"===t.type&&u.isInvalid(t);return 0===n?o?[]:r(t,n,!1,e).toArray():r(t,n,o,e).toArray()};return{validateItems:a,getFetch:function(e,o){return function(t){var n=o(),n=a(n);t(wx(n,sg.CLOSE_ON_EXECUTE,e,!1))}}}}function JS(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return y(o.data,function(t){return Aw(t,e.isSelectedFor,e.getPreviewFor)})}:o.getData;return{items:KS(0,n,e),getStyleItems:r}}function $S(o,t,n){var e=(r=JS(0,t,n)).items,r=r.getStyleItems;return vx({text:n.icon.isSome()?$.none():$.some(""),icon:n.icon,tooltip:$.from(n.tooltip),role:$.none(),fetch:e.getFetch(t,r),onSetup:function(e){return n.setInitialValue.each(function(t){return t(e.getComponent())}),n.nodeChangeHandler.map(function(t){var n=t(e.getComponent());return o.on("NodeChange",n),function(){o.off("NodeChange",n)}}).getOr(W)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:n.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)}var QS,ZS,tk=kl({name:"HtmlSelect",configFields:[Zt("options"),Fe("selectBehaviours",[sd,sl]),fn("selectClasses",[]),fn("selectAttributes",{}),un("data")],factory:function(e,t){var n=y(e.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),o=e.data.map(function(t){return _t("initialValue",t)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:n,behaviours:rs(e.selectBehaviours,[sd.config({}),sl.config({store:E({mode:"manual",getValue:function(t){return dr(t.element())},setValue:function(t,n){k(e.options,function(t){return t.value===n}).isSome()&&mr(t.element(),n)}},o)})])}}}),cl=Object.freeze({events:function(t,n){var e=t.stream.streams.setup(t,n);return bi([to(t.event,e),xi(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[to(t,function(){return n.cancel()})]}).getOr([])))}}),li=function(t){var n=fe(null);return Li({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},Bi=Object.freeze({throttle:li,init:function(t){return t.stream.streams.state(t)}}),li=[tn("stream",$t("mode",{throttle:[Zt("delay"),fn("stopEvent",!0),_u("streams",{setup:function(t,n){var e=t.stream,o=Id(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:li})]})),fn("event","input"),un("cancelEvent"),ka("onStream")],nk=Ju({fields:li,name:"streaming",active:cl,state:Bi}),ek=function(t){gw(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},ok=G("alloy.typeahead.itemexecute"),li=G([un("lazySink"),Zt("fetch"),fn("minChars",5),fn("responseTime",1e3),wa("onOpen"),fn("getHotspot",$.some),fn("getAnchorOverrides",G({})),fn("layouts",$.none()),fn("eventOrder",{}),gn("model",{},[fn("getDisplayText",function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value}),fn("selectsOver",!0),fn("populateFromBrowse",!0)]),wa("onSetValue"),Sa("onExecute"),wa("onItemExecute"),fn("inputClasses",[]),fn("inputAttributes",{}),fn("inputStyles",{}),fn("matchWidth",!0),fn("useMinWidth",!1),fn("dismissOnBlur",!0),xa(["openClass"]),un("initialData"),Fe("typeaheadBehaviours",[sd,sl,nk,ud,dd,mv]),Wn("previewing",function(){return fe(!0)})].concat(Ae()).concat(Gr())),cl=G([Be({schema:[ya()],name:"menu",overrides:function(o){return{fakeFocus:!0,onHighlight:function(n,e){o.previewing.get()?n.getSystem().getByUid(o.uid).each(function(t){pw(o.model,t,e).fold(function(){return Kl.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&mw(o.model,t,e)}),o.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(o.uid).toOption().map(function(t){return qe(t,ok(),{item:n}),!0})},onHover:function(t,n){o.previewing.set(!1),t.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&mw(o.model,t,n)})}}}})]),rk=al({name:"Typeahead",configFields:li(),partFields:cl(),factory:function(r,t,n,i){function e(t,n,e){r.previewing.set(!1);var o=mv.getCoupled(t,"sandbox");nl.isOpen(o)?Ul.getCurrent(o).each(function(t){Kl.getHighlighted(t).fold(function(){e(t)},function(){$e(o,t.element(),"keydown",n)})}):hv(r,u(t),t,o,i,function(t){Ul.getCurrent(t).each(e)},tv.HighlightFirst).get(W)}var o=Dh(r),u=function(e){return function(t){return t.map(function(t){var n=R(t.menus),n=O(n,function(t){return x(t.items,function(t){return"item"===t.type})});return sl.getState(e).update(y(n,function(t){return t.data})),t})}},a=[sd.config({}),sl.config({onSetValue:r.onSetValue,store:E({mode:"dataset",getDataKey:function(t){return dr(t.element())},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,n){mr(t.element(),r.model.getDisplayText(n))}},r.initialData.map(function(t){return _t("initialValue",t)}).getOr({}))}),nk.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(t,n){var e,o=mv.getCoupled(t,"sandbox");sd.isFocused(t)&&dr(t.element()).length>=r.minChars&&(e=Ul.getCurrent(o).bind(function(t){return Kl.getHighlighted(t).map(sl.getValue)}),r.previewing.set(!0),hv(r,u(t),t,o,i,function(t){Ul.getCurrent(o).each(function(t){e.fold(function(){r.model.selectsOver&&Kl.highlightFirst(t)},function(n){Kl.highlightBy(t,function(t){return sl.getValue(t).value===n.value}),Kl.getHighlighted(t).orThunk(function(){return Kl.highlightFirst(t),$.none()})})})},tv.HighlightFirst).get(W))},cancelEvent:ni()}),ud.config({mode:"special",onDown:function(t,n){return e(t,n,Kl.highlightFirst),$.some(!0)},onEscape:function(t){t=mv.getCoupled(t,"sandbox");return nl.isOpen(t)?(nl.close(t),$.some(!0)):$.none()},onUp:function(t,n){return e(t,n,Kl.highlightLast),$.some(!0)},onEnter:function(n){var t=mv.getCoupled(n,"sandbox"),e=nl.isOpen(t);if(e&&!r.previewing.get())return Ul.getCurrent(t).bind(function(t){return Kl.getHighlighted(t)}).map(function(t){return qe(n,ok(),{item:t}),!0});var o=sl.getValue(n);return Ye(n,ni()),r.onExecute(t,n,o),e&&nl.close(t),$.some(!0)}}),dd.config({toggleClass:r.markers.openClass,aria:{mode:"expanded"}}),mv.config({others:{sandbox:function(t){return wv(r,t,{onOpen:function(){return dd.on(t)},onClose:function(){return dd.off(t)}})}}}),Af("typeaheadevents",[Si(function(t){var n=W;bv(r,u(t),t,i,n,tv.HighlightFirst).get(W)}),to(ok(),function(t,n){var e=mv.getCoupled(t,"sandbox");mw(r.model,t,n.event().item()),Ye(t,ni()),r.onItemExecute(t,e,n.event().item(),sl.getValue(t)),nl.close(e),ek(t)})].concat(r.dismissOnBlur?[to(Yr(),function(t){t=mv.getCoupled(t,"sandbox");Zu(t.element()).isNone()&&nl.close(t)})]:[]))];return{uid:r.uid,dom:Bh(St(r,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:E(E({},o),rs(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),ik=function(i){return E(E({},i),{toCached:function(){return ik(i.toCached())},bindFuture:function(n){return ik(i.bind(function(t){return t.fold(function(t){return uv(tt.error(t))},function(t){return n(t)})}))},bindResult:function(n){return ik(i.map(function(t){return t.bind(n)}))},mapResult:function(n){return ik(i.map(function(t){return t.map(n)}))},mapError:function(n){return ik(i.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return i.map(function(t){return t.fold(n,e)})},withTimeout:function(t,r){return ik(iv(function(n){var e=!1,o=b.setTimeout(function(){e=!0,n(tt.error(r()))},t);i.get(function(t){e||(b.clearTimeout(o),n(t))})}))}})},Bi=function(t){return ik(uv(tt.value(t)))},uk=hw,ak={type:"separator"},ck=Mo("aria-invalid"),sk={bar:Ow(function(t,n){return t=t,n=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:y(t.items,n.interpreter)}}),collection:Ow(function(t,n){return kw(t,n.shared.providers)}),alertbanner:Ow(function(t,n){return e=t,n=n.shared.providers,yh.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Bd.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:td(e.icon,n.icons),attributes:{title:n.translate(e.iconTooltip)}},action:function(t){qe(t,Nh,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(e.text)}}]});var e}),input:Ow(function(t,n){return t=t,n=n.shared.providers,dw({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:$.none(),maximized:t.maximized},n)}),textarea:Ow(function(t,n){return t=t,n=n.shared.providers,dw({name:t.name,multiline:!0,label:t.label,inputMode:$.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:$.none(),maximized:t.maximized},n)}),label:Ow(function(t,n){return e=t,t=n.shared,n={dom:{tag:"label",innerHtml:t.providers.translate(e.label),classes:["tox-label"]}},t=y(e.items,t.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[n].concat(t),behaviours:Na([ty(),cd.config({}),cy($.none()),ud.config({mode:"acyclic"})])};var e}),iframe:(QS=function(t,n){return Ab(t,n.shared.providers)},function(t,n,e){n=St(n,{source:"dynamic"});return Ow(QS)(t,n,e)}),button:Ow(function(t,n){return Mx(t,n.shared.providers)}),checkbox:Ow(function(t,n){return e=t,o=n.shared.providers,r=sl.config({store:{mode:"manual",getValue:function(t){return t.element().dom().checked},setValue:function(t,n){t.element().dom().checked=n}}}),t=function(t){return t.element().dom().click(),$.some(!0)},n=Wh.parts().field({factory:{sketch:l},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Na([ty(),Zm.config({disabled:e.disabled}),lv.config({}),sd.config({}),r,ud.config({mode:"special",onEnter:t,onSpace:t,stopSpaceKeyup:!0}),Af("checkbox-events",[to(Lr(),function(t,n){qe(t,Rh,{name:e.name})})])])}),r=Wh.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:Na([Fb.config({})])}),t=Qf({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(t=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:td("checked"===t?"selected":"unselected",o.icons)}}})("checked"),t("unchecked")]}),Wh.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[n,t.asSpec(),r],fieldBehaviours:Na([Zm.config({disabled:e.disabled,disableClass:"tox-checkbox--disabled",onDisabled:function(t){Wh.getField(t).each(Zm.disable)},onEnabled:function(t){Wh.getField(t).each(Zm.enable)}})])});var e,o,r}),colorinput:Ow(function(t,n){return kv(t,n.shared,n.colorinput)}),colorpicker:Ow(function(t){var n=function(t){return"tox-"+t},n=Zb(Cb,n),o=Qf(n.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){qe(t,Nh,{name:"hex-valid",value:!0})},onInvalidHex:function(t){qe(t,Nh,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:Na([sl.config({store:{mode:"manual",getValue:function(t){t=o.get(t);return Ul.getCurrent(t).bind(function(t){return sl.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),t=o.get(t);Ul.getCurrent(t).fold(function(){b.console.log("Can not find form")},function(t){sl.setValue(t,{hex:$.from(e[1]).getOr("")}),Xb.getField(t,"hex").each(function(t){Ye(t,zr())})})}}}),ty()])}}),dropzone:Ow(function(t,n){return Tb(t,n.shared.providers)}),grid:Ow(function(t,n){return t=t,n=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:y(t.items,n.interpreter)}}),selectbox:Ow(function(t,n){return e=t,o=n.shared.providers,r=y(e.items,function(t){return{text:o.translate(t.text),value:t.value}}),t=e.label.map(function(t){return Zh(t,o)}),n=Wh.parts().field({dom:{},selectAttributes:{size:e.size},options:r,factory:tk,selectBehaviours:Na([Zm.config({disabled:e.disabled}),lv.config({}),Af("selectbox-change",[to(Lr(),function(t,n){qe(t,Rh,{name:e.name})})])])}),r=1<e.size?$.none():$.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:td("chevron-down",o.icons)}}),r={dom:{tag:"div",classes:["tox-selectfield"]},components:T([[n],r.toArray()])},Wh.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:T([t.toArray(),[r]]),fieldBehaviours:Na([Zm.config({disabled:e.disabled,onDisabled:function(t){Wh.getField(t).each(Zm.disable)},onEnabled:function(t){Wh.getField(t).each(Zm.enable)}})])});var e,o,r}),sizeinput:Ow(function(t,n){return Hx(t,n.shared.providers)}),urlinput:Ow(function(t,n){return Sw(t,n,n.urlinput)}),customeditor:Ow(function(e){var o=fe($.none()),n=Qf({dom:{tag:e.tag}}),r=fe($.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Na([Af("editor-foo-events",[yi(function(t){n.getOpt(t).each(function(n){var t;t=e,(Object.prototype.hasOwnProperty.call(t,"init")?e.init(n.element().dom()):ry.load(e.scriptId,e.scriptUrl).then(function(t){return t(n.element().dom(),e.settings)})).then(function(n){r.get().each(function(t){n.setValue(t)}),r.set($.none()),o.set($.some(n))})})})]),sl.config({store:{mode:"manual",getValue:function(){return o.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,n){o.get().fold(function(){r.set($.some(n))},function(t){return t.setValue(n)})}}}),ty()]),components:[n.asSpec()]}}),htmlpanel:Ow(function(t){return"presentation"===t.presets?yh.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):yh.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Na([lv.config({}),sd.config({})])})}),imagetools:Ow(function(t,n){return fw(t,n.shared.providers)}),table:Ow(function(t,n){return Cw(t,n.shared.providers)}),panel:Ow(function(t,n){return n=n,{dom:{tag:"div",classes:(t=t).classes},components:y(t.items,n.shared.interpreter)}})},lk={field:function(t,n){return n}},fk=function(n,e,o){return At(sk,e.type).fold(function(){return b.console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e},function(t){return t(n,e,o)})},dk=G(function(t,n){t=t,n=Math.floor(n),n=Su.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),ir(t,"max-width",n+"px")}),mk={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},gk=function(t,n,e){function o(){return me.fromDom(t.getBody())}var r,i,u,a,c,s,l,f,d=Ch(t);return{toolbar:d?function(){return{anchor:"node",root:l(),node:$.from(l()),bubble:na(-12,-12,mk),layouts:{onRtl:function(){return[Jf]},onLtr:function(){return[$f]}},overrides:{maxHeightFunction:Us()}}}:function(){return{anchor:"hotspot",hotspot:f(),bubble:na(-12,12,mk),layouts:{onRtl:function(){return[Nu]},onLtr:function(){return[Pu]}},overrides:{maxHeightFunction:Us()}}},toolbarOverflow:(s=e,function(){return{anchor:"hotspot",hotspot:s(),overrides:{maxWidthFunction:dk()},layouts:{onRtl:function(){return[Nu,Pu]},onLtr:function(){return[Pu,Nu]}}}}),banner:(c=f=n,d?function(){return{anchor:"node",root:a(),node:$.from(a()),layouts:{onRtl:function(){return[Td]},onLtr:function(){return[Td]}}}}:function(){return{anchor:"hotspot",hotspot:c(),layouts:{onRtl:function(){return[Va]},onLtr:function(){return[Va]}}}}),cursor:(i=t,function(){return{anchor:"selection",root:u(),getSelection:function(){var t=i.selection.getRng();return $.some(uc.range(me.fromDom(t.startContainer),t.startOffset,me.fromDom(t.endContainer),t.endOffset))}}}),node:(r=u=a=l=o,function(t){return{anchor:"node",root:r(),node:t}})}},pk=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],hk=function(t){return S(t,function(t,n){if(yt(n,"items")){var e=hk(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(yt(n,"inline")||yt(n,"block")||yt(n,"selector")){e="custom-"+n.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:e,format:n}]),formats:t.formats.concat([{title:n.title,format:e,icon:n.icon}])}}return E(E({},t),{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},vk=tw.trim,bk=(Ae=function(n){return function(t){if(t&&1===t.nodeType){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}})("true"),yk=Ae("false"),xk=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return bk(t)}return!1}(t)&&!yk(t)},wk=function(t){t=zw(t);return x(y(x(t,Hw),Nw).concat(y(x(t,Rw),Pw)),Lw)},Sk="tinymce-url-history",kk=Object.prototype.hasOwnProperty,Ck="contexttoolbar-hide",li=G([Zt("dom"),fn("shell",!0),Fe("toolbarBehaviours",[cd])]),cl=G([yl({name:"groups",overrides:function(t){return{behaviours:Na([cd.config({})])}}})]),Ok=al({name:"Toolbar",configFields:li(),partFields:cl(),factory:function(n,t,e,o){var r=function(t){return n.shell?$.some(t):hs(t,n,"groups")},t=n.shell?{behaviours:[cd.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:t.components,behaviours:rs(n.toolbarBehaviours,t.behaviours),apis:{setGroups:function(t,n){r(t).fold(function(){throw b.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){cd.set(t,n)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),Ek=Dk("within","extra","withinWidth"),Bi=G([Zt("items"),xa(["itemSelector"]),Fe("tgroupBehaviours",[ud])]),Ae=G([Ka({name:"items",unit:"item"})]),Tk=al({name:"ToolbarGroup",configFields:Bi(),partFields:Ae(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:rs(t.tgroupBehaviours,[ud.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),cl=G([Fe("splitToolbarBehaviours",[mv]),Wn("builtGroups",function(){return fe([])})]),Dk=G([xa(["overflowToggledClass"]),Zt("getAnchor"),ue("getOverflowBounds"),Zt("lazySink")].concat(cl())),Bi=G([bl({factory:Ok,schema:li(),name:"primary"}),Be({factory:Ok,schema:li(),name:"overflow",overrides:function(n){return{toolbarBehaviours:Na([ud.config({mode:"cyclic",onEscape:function(t){return hs(t,n,"overflow-button").each(sd.focus),$.none()}})])}}}),Be({name:"overflow-button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Na([dd.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Be({name:"overflow-group"})]),Bk=al({name:"SplitFloatingToolbar",configFields:Dk(),partFields:Bi(),factory:function(n,t,e,o){return iS(n,t,0,o,{coupling:{sandbox:function(t){return o=t,e=n,{dom:{tag:"div",attributes:{id:(r=mu()).id()}},behaviours:Na([ud.config({mode:"special",onEscape:function(t){return nl.close(t),$.some(!0)}}),nl.config({onOpen:function(t,n){cS(o,e),hs(o,e,"overflow-button").each(function(t){dd.on(t),r.link(t.element())}),ud.focusIn(n)},onClose:function(){hs(o,e,"overflow-button").each(function(t){dd.off(t),sd.focus(t),r.unlink(t.element())})},isPartOf:function(t,n,e){return Tu(n,e)||Tu(o,e)},getAttachPoint:function(){return e.lazySink(o).getOrDie()}}),Wa.config({channels:E({},Zc({isExtraPart:G(!1),doReposition:function(){return sS(o,e)}}))})])};var o,e,r}},apis:{refresh:function(t){return cS(t,n)},toggle:function(t){return function(t,n){t=mv.getCoupled(t,"sandbox");nl.isOpen(t)?nl.close(t):nl.open(t,n.overflow())}(t,o)},getOverflow:function(t){return nl.getState(mv.getCoupled(t,"sandbox"))},reposition:function(t){return sS(t,n)}}})},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)},toggle:function(t,n){t.toggle(n)}}}),Ae=Object.freeze({refresh:function(t,n,e){e.isExpanded()&&(lr(t.element(),fS(n)),e=dS(n,t.element()),ir(t.element(),fS(n),e))},grow:function(t,n,e){e.isExpanded()||yS(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&bS(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&hS(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:xS,isShrinking:wS,isTransitioning:function(t,n,e){return!0===xS(t,n)||!0===wS(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?bS:yS)(t,n,e)},disableTransitions:mS}),Dk=Object.freeze({exhibit:function(t,n){var e=n.expanded;return No(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:_t(n.dimension.property,"0px")})},events:function(e,o){return bi([uo(Ur(),function(t,n){n.event().raw().propertyName===e.dimension.property&&(mS(t,e),o.isExpanded()&&lr(t.element(),e.dimension.property),(o.isExpanded()?e.onGrown:e.onShrunk)(t))})])}}),Bi=[Zt("closedClass"),Zt("openClass"),Zt("shrinkingClass"),Zt("growingClass"),un("getAnimationRoot"),wa("onShrunk"),wa("onStartShrink"),wa("onGrown"),wa("onStartGrow"),fn("expanded",!1),tn("dimension",$t("property",{width:[_u("property","width"),_u("getDimension",function(t){return tu(t)+"px"})],height:[_u("property","height"),_u("getDimension",function(t){return Ji(t)+"px"})]}))],Ak=Ju({fields:Bi,name:"sliding",active:Dk,apis:Ae,state:Object.freeze({init:function(t){var n=fe(t.expanded);return Li({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:d(n.set,!1),setExpanded:d(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),Dk=G([xa(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),wa("onOpened"),wa("onClosed")].concat(cl())),Ae=G([bl({factory:Ok,schema:li(),name:"primary"}),bl({factory:Ok,schema:li(),name:"overflow",overrides:function(n){return{toolbarBehaviours:Na([Ak.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){hs(t,n,"overflow-button").each(function(t){dd.off(t),sd.focus(t)}),n.onClosed(t)},onGrown:function(t){ud.focusIn(t),n.onOpened(t)},onStartGrow:function(t){hs(t,n,"overflow-button").each(dd.on)}}),ud.config({mode:"acyclic",onEscape:function(t){return hs(t,n,"overflow-button").each(sd.focus),$.some(!0)}})])}}}),Be({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Na([dd.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Be({name:"overflow-group"})]),_k=function(t,n){var e=hs(t,n,"overflow");rS(t,n,e,SS),e.each(Ak.refresh)},Mk=al({name:"SplitSlidingToolbar",configFields:Dk(),partFields:Ae(),factory:function(o,t,n,e){return iS(o,t,0,e,{coupling:{},apis:{refresh:function(t){return _k(t,o)},toggle:function(t){var n,e;hs(n=t,e=o,"overflow").each(function(t){_k(n,e),Ak.toggleGrow(t)})},getOverflow:function(t){return hs(t,o,"overflow")}}})},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)},toggle:function(t,n){t.toggle(n)}}}),Fk=G(Mo("toolbar-height-change")),Ik="silver.readonly",Rk=Ln([tn("readonly",te)]),cl=[se("disabled",!1),sn("tooltip"),sn("icon"),sn("text"),le("onSetup",function(){return W})],Vk=Ln([nn("type"),re("onAction")].concat(cl)),li=[sn("text"),sn("tooltip"),sn("icon"),re("fetch"),le("onSetup",function(){return W})],Hk=Ln(g([nn("type")],li)),Nk=Ln([nn("type"),sn("tooltip"),sn("icon"),sn("text"),ue("select"),re("fetch"),le("onSetup",function(){return W}),ce("presets","normal",["normal","color","listpreview"]),fn("columns",1),re("onAction"),re("onItemAction")]),Dk=[se("active",!1)].concat(cl),Pk=Ln(Dk.concat([nn("type"),re("onAction")])),Ae=[le("predicate",function(){return!1}),ce("scope","node",["node","editor"]),ce("position","selection",["node","selection","line"])],li=cl.concat([fn("type","contextformbutton"),fn("primary",!1),re("onAction"),pn("original",l)]),ue=Dk.concat([fn("type","contextformbutton"),fn("primary",!1),re("onAction"),pn("original",l)]),cl=cl.concat([fn("type","contextformbutton")]),Dk=Dk.concat([fn("type","contextformtogglebutton")]),ue=$t("type",{contextformbutton:li,contextformtogglebutton:ue}),zk=Ln([fn("type","contextform"),le("initValue",function(){return""}),sn("label"),rn("commands",ue),an("launch",$t("type",{contextformbutton:cl,contextformtogglebutton:Dk}))].concat(Ae)),Lk=Ln([fn("type","contexttoolbar"),nn("items")].concat(Ae)),ue=Object.freeze({getState:function(t,n,e){return e}}),cl=Object.freeze({events:function(o,r){function i(n,e){o.updateState.each(function(t){t=t(n,e);r.set(t)}),o.renderComponents.each(function(t){t=t(e,r.get()),t=y(t,n.getSystem().build);Lc(n,t)})}return bi([to(Kr(),function(t,n){var e=o.channel;lt(n.channels(),e)&&i(t,n.data())}),yi(function(n,t){o.initialData.each(function(t){i(n,t)})})])}}),Dk=Object.freeze({init:function(t){var n=fe($.none());return{readState:function(){return n.get().fold(function(){return"none"},function(t){return t})},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set($.none())}}}}),Ae=[Zt("channel"),un("renderComponents"),un("updateState"),un("initialData")],jk=Ju({fields:Ae,name:"reflecting",active:cl,apis:ue,state:Dk}),Dk=G([Zt("toggleClass"),Zt("fetch"),ka("onExecute"),fn("getHotspot",$.some),fn("getAnchorOverrides",G({})),fn("layouts",$.none()),ka("onItemExecute"),un("lazySink"),Zt("dom"),wa("onOpen"),Fe("splitDropdownBehaviours",[mv,ud,sd]),fn("matchWidth",!1),fn("useMinWidth",!1),fn("eventOrder",{}),un("role")].concat(Gr())),ka=bl({factory:Bd,schema:[Zt("dom")],name:"arrow",defaults:function(t){return{buttonBehaviours:Na([sd.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(Ke)},buttonBehaviours:Na([dd.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),Gr=bl({factory:Bd,schema:[Zt("dom")],name:"button",defaults:function(t){return{buttonBehaviours:Na([sd.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(e.uid).each(function(t){e.onExecute(t,n)})}}}}),Gr=G([ka,Gr,yl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Zt("text")],name:"aria-descriptor"}),Be({schema:[ya()],name:"menu",defaults:function(o){return{onExecute:function(n,e){n.getSystem().getByUid(o.uid).each(function(t){o.onItemExecute(t,n,e)})}}}}),Ua()]),Uk=al({name:"SplitDropdown",configFields:Dk(),partFields:Gr(),factory:function(o,t,n,e){function r(t){Ul.getCurrent(t).each(function(t){Kl.highlightFirst(t),ud.focusIn(t)})}function i(t){bv(o,function(t){return t},t,e,r,tv.HighlightFirst).get(W)}function u(t){return t=vs(t,o,"button"),Ke(t),$.some(!0)}var a=kt(bi([yi(function(e,t){hs(e,o,"aria-descriptor").each(function(t){var n=Mo("aria");Eo(t.element(),"id",n),Eo(e.element(),"aria-describedby",n)})})]),Pf($.some(i))),c={repositionMenus:function(t){dd.isOn(t)&&Sv(t)}};return{uid:o.uid,dom:o.dom,components:t,apis:c,eventOrder:E(E({},o.eventOrder),{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:a,behaviours:rs(o.splitDropdownBehaviours,[mv.config({others:{sandbox:function(t){var n=vs(t,o,"arrow");return wv(o,t,{onOpen:function(){dd.on(n),dd.on(t)},onClose:function(){dd.off(n),dd.off(t)}})}}}),ud.config({mode:"special",onSpace:u,onEnter:u,onDown:function(t){return i(t),$.some(!0)}}),sd.config({}),dd.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Wk=Mo("focus-button"),Gk=["checklist","ordered-list"],Xk=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],Yk=function(t,n,e){return zS(t,{toolbarButtonBehaviours:[].concat(0<e.length?[Af("toolbarButtonWith",e)]:[]),getApi:VS,onSetup:t.onSetup},n)},qk=function(t,n,e){return St(zS(t,{toolbarButtonBehaviours:[cd.config({}),dd.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[Af("toolbarToggleButtonWith",e)]:[]),getApi:HS,onSetup:t.onSetup},n))},Kk=function(t,n,e){var o,r,i,u,a=n.label.fold(function(){return{}},function(t){return{"aria-label":t}}),a=Qf(Gh.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:a,selectOnFocus:!0,inputBehaviours:Na([ud.config({mode:"special",onEnter:function(t){return c.findPrimary(t).map(function(t){return Ke(t),!0})},onLeft:function(t,n){return n.cut(),$.none()},onRight:function(t,n){return n.cut(),$.none()}})])})),c=(o=a,r=n.commands,i=e.shared.providers,u=y(r,function(t){return Qf(US(o,t,i))}),{asSpecs:function(){return y(u,function(t){return t.asSpec()})},findPrimary:function(e){return hu(r,function(t,n){return t.primary?$.from(u[n]).bind(function(t){return t.getOpt(e)}).filter(p(Zm.isDisabled)):$.none()})}});return MS({type:t,uid:Mo("context-toolbar"),initGroups:[{title:$.none(),items:[a.asSpec()]},{title:$.none(),items:c.asSpecs()}],onEscape:$.none,cyclicKeying:!0,backstage:e,getSink:function(){return tt.error("")}})},Jk=function(n,e){function t(t){return t.dom()===e.getBody()}var o=me.fromDom(e.selection.getNode());return XS(o,n.inNodeScope).orThunk(function(){return XS(o,n.inEditorScope).orThunk(function(){return function(t,n,e){for(var o=t.dom(),r=it(e)?e:G(!1);o.parentNode;){o=o.parentNode;var i=me.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return $.none()}(o,function(t){return XS(t,n.inNodeScope)},t)})})},$k=function(e,r){function o(n,e){var o=Kt(qt("ContextForm",zk,e));(t[n]=o).launch.map(function(t){c["form:"+n]=E(E({},e.launch),{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){r(o)}})}),("editor"===o.scope?a:u).push(o),s[n]=o}function i(n,e){qt("ContextToolbar",Lk,e).each(function(t){("editor"===e.scope?a:u).push(t),s[n]=t})}var t={},u=[],a=[],c={},s={},n=gt(e);return ft(n,function(t){var n=e[t];"contextform"===n.type?o(t,n):"contexttoolbar"===n.type&&i(t,n)}),{forms:t,inNodeScope:u,inEditorScope:a,lookupTable:s,formNavigators:c}},Qk=Mo("forward-slide"),Zk=Mo("backward-slide"),tC=Mo("change-slide-event"),nC="tox-pop--resizing";function eC(t,n,e,o){return{type:"basic",data:(e=e=At(t.settings,n).getOr(e),e=o===ZS.SemiColon?e.replace(/;$/,"").split(";"):e.split(" "),y(e,function(t){var n=t,e=t,t=t.split("=");return 1<t.length&&(n=t[0],e=t[1]),{title:n,format:e}}))}}function oC(e){function n(t){var n=k(RO,function(t){return e.formatter.match(t.format)}).fold(function(){return"left"},function(t){return t.title.toLowerCase()});qe(t,Gx,{icon:"align-"+n})}var t=$.some(function(t){return function(){return n(t)}}),o=$.some(n),r={type:"basic",data:RO};return{tooltip:"Align",icon:$.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:G($.none()),getPreviewFor:function(t){return function(){return $.none()}},onAction:qS(e),setInitialValue:o,nodeChangeHandler:t,dataset:r,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}}function rC(t){return t=t.split(/\s*,\s*/),y(t,function(t){return t.replace(/^['"]+|['"]+$/g,"")})}function iC(r){function i(){function n(t){return t?rC(t)[0]:""}var t=r.queryCommandValue("FontName"),e=u.data,o=t?t.toLowerCase():"";return{matchOpt:k(e,function(t){t=t.format;return t.toLowerCase()===o||n(t).toLowerCase()===n(o).toLowerCase()}).orThunk(function(){return 0===(t=o).indexOf("-apple-system")&&(n=rC(t.toLowerCase()),D(VO,function(t){return-1<n.indexOf(t.toLowerCase())}))?$.from({title:"System Font",format:o}):$.none();var t,n}),font:t}}function n(t){var n=i(),e=n.matchOpt,o=n.font,e=e.fold(function(){return o},function(t){return t.title});qe(t,Wx,{text:e})}var t=$.some(function(t){return function(){return n(t)}}),e=$.some(n),u=eC(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",ZS.SemiColon);return{tooltip:"Fonts",icon:$.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getCurrentValue:function(){return i().matchOpt},getPreviewFor:function(t){return function(){return $.some({tag:"div",styleAttr:-1===t.indexOf("dings")?"font-family:"+t:""})}},onAction:function(t){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,t.format)})}},setInitialValue:e,nodeChangeHandler:t,dataset:u,shouldHide:!1,isInvalid:function(){return!1}}}function uC(t,n){return/[0-9.]+px$/.test(t)?function(t,n){n=Math.pow(10,n);return Math.round(t*n)/n}(72*parseInt(t,10)/96,n||0)+"pt":t}function aC(e){function r(){var o=$.none(),r=u.data,i=e.queryCommandValue("FontSize");if(i)for(var t=function(t){var n=uC(i,t),e=V(HO,n).getOr("");o=k(r,function(t){return t.format===i||t.format===n||t.format===e})},n=3;o.isNone()&&0<=n;n--)t(n);return{matchOpt:o,px:i}}function n(t){var n=r(),e=n.matchOpt,o=n.px,e=e.fold(function(){return o},function(t){return t.title});qe(t,Wx,{text:e})}var t=G(G($.none())),o=$.some(function(t){return function(){return n(t)}}),i=$.some(n),u=eC(e,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",ZS.Space);return{tooltip:"Font sizes",icon:$.none(),isSelectedFor:function(n){return function(t){return t.exists(function(t){return t.format===n})}},getPreviewFor:t,getCurrentValue:function(){return r().matchOpt},onAction:function(t){return function(){e.undoManager.transact(function(){e.focus(),e.execCommand("FontSize",!1,t.format)})}},setInitialValue:i,nodeChangeHandler:o,dataset:u,shouldHide:!1,isInvalid:function(){return!1}}}function cC(e,t,n){var o=t();return hu(n,function(n){return k(o,function(t){return e.formatter.matchNode(n,t.format)})}).orThunk(function(){return e.formatter.match("p")?$.some({title:"Paragraph",format:"p"}):$.none()})}function sC(t){var n=t.selection.getStart(!0)||t.getBody();return t.dom.getParents(n,function(){return!0},t.getBody())}function lC(e){function o(t,n){t=cC(e,function(){return r.data},t).fold(function(){return"Paragraph"},function(t){return t.title}),qe(n,Wx,{text:t})}var t=$.some(function(n){return function(t){return o(t.parents,n)}}),n=$.some(function(t){var n=sC(e);o(n,t)}),r=eC(e,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",ZS.SemiColon);return{tooltip:"Blocks",icon:$.none(),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getCurrentValue:G($.none()),getPreviewFor:function(n){return function(){var t=e.formatter.get(n);return $.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styleAttr:e.formatter.getCssText(n)})}},onAction:qS(e),setInitialValue:n,nodeChangeHandler:t,dataset:r,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}}function fC(r,t){function e(t,n){var e=function(t){var n=t.items;return void 0!==n&&0<n.length?O(n,e):[{title:t.title,format:t.format}]},o=O(Bw(r),e),t=cC(r,function(){return o},t).fold(function(){return"Paragraph"},function(t){return t.title});qe(n,Wx,{text:t})}var n=$.some(function(n){return function(t){return e(t.parents,n)}}),o=$.some(function(t){var n=sC(r);e(n,t)});return{tooltip:"Formats",icon:$.none(),isSelectedFor:function(t){return function(){return r.formatter.match(t)}},getCurrentValue:G($.none()),getPreviewFor:function(n){return function(){var t=r.formatter.get(n);return void 0!==t?$.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styleAttr:r.formatter.getCssText(n)}):$.none()}},onAction:qS(r),setInitialValue:o,nodeChangeHandler:n,shouldHide:r.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!r.formatter.canApply(t.format)},dataset:t}}function dC(t){var e,n=t.toolbar,t=t.buttons;return!1===n?[]:void 0===n||!0===n?(e=t,t=y(NO,function(t){var n=x(t.items,function(t){return yt(e,t)||yt(zO,t)});return{name:t.name,items:n}}),x(t,function(t){return 0<t.items.length})):nt(n)?function(t){t=t.split("|");return y(t,function(t){return{items:t.trim().split(" ")}})}(n):m(n,function(t){return yt(t,"name")&&yt(t,"items")})?n:(b.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}function mC(n,e,o,r,t){return V(e,o.toLowerCase()).orThunk(function(){return t.bind(function(t){return hu(t,function(t){return V(e,t+o.toLowerCase())})})}).fold(function(){return V(zO,o.toLowerCase()).map(function(t){return t(n,r)}).orThunk(function(){return $.none()})},function(t){return e=r,V(PO,(n=t).type).fold(function(){return b.console.error("skipping button defined by",n),$.none()},function(t){return $.some(t(n,e))});var n,e})}function gC(e,o,r,i){var t=dC(o),t=y(t,function(t){var n=O(t.items,function(t){return 0===t.trim().length?[]:mC(e,o.buttons,t,r,i).toArray()});return{title:$.from(e.translate(t.name)),items:n}});return x(t,function(t){return 0<t.items.length})}function pC(e){return(cr(e,"position").is("fixed")?$.none():go(e)).orThunk(function(){var t=me.fromTag("span");vo(e,t);var n=go(t);return Oi(t),n}).map(Zi).getOrThunk(function(){return xu(0,0)})}function hC(n){return function(t){return t.translate(-n.left(),-n.top())}}function vC(n){return function(t){return t.translate(n.left(),n.top())}}function bC(e){return function(t,n){return S(e,function(t,n){return n(t)},xu(t,n))}}function yC(t,n,e){return t.fold(bC([vC(e),hC(n)]),bC([hC(n)]),bC([]))}function xC(t,n,e){return t.fold(bC([vC(e)]),bC([]),bC([vC(n)]))}function wC(t,n,e){return t.fold(bC([]),bC([hC(e)]),bC([vC(n),hC(e)]))}function SC(t,n,e){return t.fold(function(t,n){return{position:"absolute",left:t+"px",top:n+"px"}},function(t,n){return{position:"absolute",left:t-e.left()+"px",top:n-e.top()+"px"}},function(t,n){return{position:"fixed",left:t+"px",top:n+"px"}})}function kC(t,i,u,a){function n(o,r){return function(t,n){var e=o(i,u,a);return r(t.getOr(e.left()),n.getOr(e.top()))}}return t.fold(n(wC,KO.offset),n(xC,KO.absolute),n(yC,KO.fixed))}function CC(t,n){var e=t.element();Jo(e,n.transitionClass),Qo(e,n.fadeOutClass),Jo(e,n.fadeInClass),n.onShow(t)}function OC(t,n){var e=t.element();Jo(e,n.transitionClass),Qo(e,n.fadeInClass),Jo(e,n.fadeOutClass),n.onHide(t)}function EC(t,e,o){return D(t,function(t){switch(t){case"bottom":return n=o,e.bottom()<=n.bottom();case"top":return n=o,e.y()>=n.y()}var n})}function TC(t,n){return Do(t,n)?$.some(parseInt(To(t,n),10)):$.none()}function DC(r,t){return TC(r,t.leftAttr).bind(function(o){return TC(r,t.topAttr).map(function(t){var n=tu(r),e=Ji(r);return uu(o,t,n,e)})})}function BC(t,n,e){var o=To(t,n.positionAttr);switch(Bo(t=t,(n=n).leftAttr),Bo(t,n.topAttr),Bo(t,n.positionAttr),o){case"static":return $.some(ZO.static());case"absolute":return $.some(ZO.absolute(e.x(),e.y()));default:return $.none()}}function AC(t,n,e,o,r){var i=au(t);if(EC(n.modes,i,e))return $.none();var u=r(),a=ar(t,"position");c=t,r=n,t=i.x(),n=i.y(),a=a,Eo(c,r.leftAttr,t),Eo(c,r.topAttr,n),Eo(c,r.positionAttr,a);var c,r=$O(i.x(),i.y()),a=yC(r,o,u),r=$O(e.x(),e.y()),u=yC(r,o,u),i=i.y()<=e.y()?u.top():u.top()+e.height()-i.height();return $.some(ZO.fixed(a.left(),i))}function _C(t,n,e,o,r){var i,u,a,t=t.element();return cr(t,"position").is("fixed")?(a=e,DC(i=t,u=n).filter(function(t){return EC(u.modes,t,a)}).bind(function(t){return BC(i,u,t)})):AC(t,n,e,o,r)}function MC(n,t){ft(["left","top","position"],function(t){return lr(n.element(),t)}),t.onUndocked(n)}function FC(t,n,e,o,r){o=SC(r,0,o),ur(t.element(),o),("fixed"===o.position?n.onDocked:n.onUndocked)(t)}function IC(o,t,r,i,u){void 0===u&&(u=!1),t.contextual.each(function(e){e.lazyContext(o).each(function(t){var n,n=(n=i,(t=t).y()<n.bottom()&&t.bottom()>n.y());n!==r.isVisible()&&(r.setVisible(n),u&&!n?(tr(o.element(),[e.fadeOutClass]),e.onHide(o)):(n?CC:OC)(o,e))})})}function RC(o,r,t){var n,e,i=o.element();t.setDocked(!1),n=r,e=o.element(),DC(e,n).bind(function(t){return BC(e,n,t)}).each(function(t){t.fold(function(){return MC(o,r)},function(t,n){var e=so(i),e=(eu(e),pC(i));FC(o,r,0,e,$O(t,n))},W)}),t.setVisible(!0),r.contextual.each(function(t){nr(i,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(o)}),tE(o,r,t)}function VC(t,n,e){e.isDocked()&&RC(t,n,e)}function HC(e){var o=e.element();mo(o).each(function(t){var n;nE.isDocked(e)?(n=tu(t),ir(o,"width",n+"px"),n=$i(o),ir(t,"padding-top",n+"px")):(lr(o,"width"),lr(t,"padding-top"))})}function NC(t,n){n?(Qo(t,eE.fadeOutClass),tr(t,[eE.transitionClass,eE.fadeInClass])):(Qo(t,eE.fadeInClass),tr(t,[eE.fadeOutClass,eE.transitionClass]))}function PC(t,n){t=me.fromDom(t.getContainer()),n?(Jo(t,oE),Qo(t,rE)):(Jo(t,rE),Qo(t,oE))}function zC(e,o){function i(n){o().each(function(t){return n(t.element())})}function t(t){e.inline||HC(t),PC(e,nE.isDocked(t)),t.getSystem().broadcastOn([ol()],{}),o().each(function(t){return t.getSystem().broadcastOn([ol()],{})})}var u=fe($.none()),n=e.inline?[]:[Wa.config({channels:((n={})[Fk()]={onReceive:HC},n)})];return g([sd.config({}),nE.config({leftAttr:"data-dock-left",topAttr:"data-dock-top",positionAttr:"data-dock-pos",contextual:E({lazyContext:function(t){var n=$i(t.element()),t=e.inline?e.getContentAreaContainer():e.getContainer(),t=au(me.fromDom(t)),n=t.height()-n;return $.some(uu(t.x(),t.y(),t.width(),n))},onShow:function(){i(function(t){return NC(t,!0)})},onShown:function(r){i(function(t){return nr(t,[eE.transitionClass,eE.fadeInClass])}),u.get().each(function(t){var n,e,o;n=r.element(),o=so(e=t),Qu(o).filter(function(t){return!On(e,t)}).filter(function(t){return On(t,me.fromDom(o.dom().body))||Ne(n,t)}).each(function(){return $u(e)}),u.set($.none())})},onHide:function(t){var n;u.set((t=t.element(),n=o,Zu(t).orThunk(function(){return n().toOption().bind(function(t){return Zu(t.element())})}))),i(function(t){return NC(t,!1)})},onHidden:function(){i(function(t){return nr(t,[eE.transitionClass])})}},eE),modes:["top"],onDocked:t,onUndocked:t})],n)}function LC(t){return"<alloy.field."+t+">"}function jC(t){return{element:function(){return t.element().dom()}}}function UC(e,o){var r=y(gt(o),function(t){var n=o[t],n=Kt(qt("sidebar",mE,n));return{name:t,getApi:jC,onSetup:n.onSetup,onShow:n.onShow,onHide:n.onHide}});return y(r,function(t){var n=fe(W);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Mm([fm(t,n),dm(t,n),to(di(),function(n,t){var e=t.event();k(r,function(t){return t.name===e.name()}).each(function(t){(e.visible()?t.onShow:t.onHide)(t.getApi(n))})})])})})}function WC(t,e){Ul.getCurrent(t).each(function(t){return cd.set(t,[(n=e,dE.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:UC(t,n),slotBehaviours:Mm([yi(function(t){return dE.hideAllSlots(t)})])}}))]);var n})}function GC(t){return Ul.getCurrent(t).bind(function(t){return Ak.isGrowing(t)||Ak.hasGrown(t)?Ul.getCurrent(t).bind(function(n){return k(dE.getSlotNames(n),function(t){return dE.isShowing(n,t)})}):$.none()})}function XC(t,n,e){var o=t.element();!0===n?(cd.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:Yd('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Na([ud.config({mode:"special",onTab:function(){return $.some(!0)},onShiftTab:function(){return $.some(!0)}}),sd.config({})])}]),lr(o,"display"),Bo(o,"aria-hidden")):(cd.set(t,[]),ir(o,"display","none"),Eo(o,"aria-hidden","true"))}function YC(e,n,o){function r(t){t!==i.get()&&(XC(n(),t,o.providers),i.set(t))}var i=fe(!1),u=fe($.none());e.on("ProgressState",function(t){var n;u.get().each(Md.clearTimeout),ut(t.time)?(n=Md.setEditorTimeout(e,function(){return r(t.state)},t.time),u.set($.some(n))):(r(t.state),u.set($.none()))})}function qC(t){return"string"==typeof t?t.split(" "):t}function KC(r,i){var u=kt(vE,i.menus),n=0<gt(i.menus).length,t=void 0===i.menubar||!0===i.menubar?qC("file edit view insert format tools table help"):qC(!1===i.menubar?"":i.menubar),t=x(t,function(t){return n&&i.menus.hasOwnProperty(t)&&i.menus[t].hasOwnProperty("items")||vE.hasOwnProperty(t)}),t=y(t,function(t){var n,e,o,t=u[t];return n={title:t.title,items:qC(t.items)},e=i,o=r.getParam("removed_menuitems","").split(/[ ,]/),{text:n.title,getItems:function(){return O(n.items,function(t){var n=t.toLowerCase();return 0===n.trim().length||h(o,function(t){return t===n})?[]:"separator"===n||"|"===n?[{type:"separator"}]:e.menuItems[n]?[e.menuItems[n]]:[]})}}});return x(t,function(t){return 0<t.getItems().length&&h(t.getItems(),function(t){return"separator"!==t.type})})}function JC(n,t,e,o){var r=t.outerContainer,t=e.toolbar,i=e.buttons;m(t,nt)?(t=t.map(function(t){return gC(n,{toolbar:t,buttons:i},{backstage:o},$.none())}),hE.setToolbars(r,t)):hE.setToolbar(r,gC(n,e,{backstage:o},$.none()))}function $C(r){function t(t){var n=r.getDoc().documentElement,e=u.get(),o=a.get();e.left()!==i.innerWidth||e.top()!==i.innerHeight?(u.set(xu(i.innerWidth,i.innerHeight)),bp(r,t)):o.left()===n.offsetWidth&&o.top()===n.offsetHeight||(a.set(xu(n.offsetWidth,n.offsetHeight)),bp(r,t))}function n(t){return vp(r,t)}var i=r.getWin(),e=r.getDoc().documentElement,u=fe(xu(i.innerWidth,i.innerHeight)),a=fe(xu(e.offsetWidth,e.offsetHeight));wE.bind(i,"resize",t),wE.bind(i,"scroll",n);var o=zp(me.fromDom(r.getBody()),"load",t);r.on("remove",function(){o.unbind(),wE.unbind(i,"resize",t),wE.unbind(i,"scroll",n)})}function QC(t){var n,e,o,r;return(e=sh(n=t),o=dh(n),r=gh(n),OE(e).map(function(t){return CE(t,o,r)})).getOr(sh(t))}function ZC(t){var n=lh(t),e=fh(t),o=mh(t);return OE(n).map(function(t){return CE(t,e,o)})}function tO(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}}function nO(t){var n,e;!function(e){tw.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t,n){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:YS(e,t.name),onAction:tO(e,t.name)})});for(var t=1;t<=6;t++){var n="h"+t;e.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+t,onSetup:YS(e,n),onAction:tO(e,n)})}}(t),n=t,tw.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}),e=t,tw.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:YS(e,t.name)})})}function eO(t,n,e){function o(){return!!n.undoManager&&n.undoManager[e]()}function r(){t.setDisabled(n.readonly||!o())}return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}}function oO(n,t){function e(t){n.setActive(t.hasVisual)}return n.setActive(t.hasVisual),t.on("VisualAid",e),function(){return t.off("VisualAid",e)}}function rO(t,n){return{anchor:"makeshift",x:t,y:n}}function iO(t){return"longpress"===t.type||0===t.type.indexOf("touch")}function uO(t,n){var e=fg.DOM.getPos(t);return t=n,n=e.x,e=e.y,rO(t.x+n,t.y+e)}function aO(t,n){return"contextmenu"===n.type?t.inline?function(t){if(iO(t)){var n=t.touches[0];return rO(n.pageX,n.pageY)}return rO(t.pageX,t.pageY)}(n):uO(t.getContentAreaContainer(),function(t){if(iO(t)){var n=t.touches[0];return rO(n.clientX,n.clientY)}return rO(t.clientX,t.clientY)}(n)):RE(t)}function cO(t){return{anchor:"node",node:$.some(me.fromDom(t.selection.getNode())),root:me.fromDom(t.getBody())}}function sO(t,n,e,o,r,i){var u=e(),a=(e=t,t=n,i?cO(e):aO(e,t));wx(u,sg.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),Ed.showMenuAt(r,a,{menu:{markers:Qg("normal")},data:t})})}function lO(t){function n(){Md.setEditorTimeout(t,function(){t.selection.setRng(e)},10),i()}var e=t.selection.getRng();function o(t){t.preventDefault(),t.stopImmediatePropagation()}function r(){return i()}t.once("touchend",n),t.on("mousedown",o,!0),t.once("longpresscancel",r);var i=function(){t.off("touchend",n),t.off("longpresscancel",r),t.off("mousedown",o)}}function fO(n,e,t,o,r,i){var u=function(t,n){t=(n?cO:RE)(t);return E({bubble:na(0,12,HE),layouts:VE,overrides:{maxWidthFunction:dk(),maxHeightFunction:Us()}},t)}(n,i);wx(t,sg.CLOSE_ON_EXECUTE,o,!0).map(function(t){e.preventDefault(),Ed.showMenuWithinBounds(r,u,{menu:{markers:Qg("normal")},data:t,type:"horizontal"},function(){return $.some(GS(n))}),n.fire(Ck)})}function dO(n,e,o,r,i,u){function t(){var t=o();fO(n,e,t,r,i,u)}var a,c=(l=wn()).os.isiOS(),s=l.os.isOSX(),l=l.os.isAndroid();!s&&!c||u?(l&&!u&&n.selection.setCursorLocation(e.target,0),t()):(a=function(){lO(n),t()},!function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],e=e.getRng();return pc(t.getWin(),uc.domRange(e)).exists(function(t){return t.left()<=o.clientX&&t.right()>=o.clientX&&t.top()<=o.clientY&&t.bottom()>=o.clientY})}(n,e)?(n.once("selectionchange",a),n.once("touchend",function(){return n.off("selectionchange",a)})):a())}function mO(t){return"string"==typeof t?t.split(/[ ,]/):t}function gO(t){return nt(t)?"|"===t:"separator"===t.type}function pO(t,n){if(0===n.length)return t;var e=M(t).filter(function(t){return!gO(t)}).fold(function(){return[]},function(t){return[LE]});return t.concat(e).concat(n).concat([LE])}function hO(i,t,e){function n(t){return Ed.hide(a)}function o(o){var t,r,n="longpress"===o.type;NE(i)&&o.preventDefault(),t=i,o.ctrlKey&&!NE(t)||zE(i)||(r=!n&&(2!==o.button||o.target===i.getBody()),(u()?dO:sO)(i,o,function(){var t=r?i.selection.getStart(!0):o.target,n=i.ui.registry.getAll(),e=PE(i);return function(o,t,r){t=S(t,function(t,n){if(yt(o,n)){var e=o[n].update(r);if(nt(e))return pO(t,e.split(" "));if(0<e.length){e=y(e,jE);return pO(t,e)}return t}return t.concat([n])},[]);return 0<t.length&&gO(t[t.length-1])&&t.pop(),t}(n.contextMenus,e,t)},e,a,r))}var u=wn().deviceType.isTouch,a=Yi(Ed.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return i.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Na([Af("dismissContextMenu",[to(si(),function(t,n){nl.close(t),i.focus()})])])}));i.on("init",function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(u()?"":" ResizeWindow");i.on(t,n),i.on(u()?"longpress":"longpress contextmenu",o)})}function vO(t,n){var e;t.getSystem().addToGui(n),mo((e=n).element()).filter(Sr).each(function(n){cr(n,"z-index").each(function(t){Eo(n,UE,t)}),ir(n,"z-index",ar(e.element(),"z-index"))})}function bO(t){mo(t.element()).filter(Sr).each(function(t){var n=To(t,UE);Do(t,UE)?ir(t,"z-index",n):lr(t,"z-index"),Bo(t,UE)}),t.getSystem().removeFromGui(t)}function yO(t,n,e){return t.getSystem().build(yh.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))}function xO(t,n,e,o){return r=n,t=(n=t).element(),n=parseInt(To(t,r.leftAttr),10),r=parseInt(To(t,r.topAttr),10),(isNaN(n)||isNaN(r)?$.none():$.some(xu(n,r))).fold(function(){return e},function(t){return QO(t.left()+o.left(),t.top()+o.top())});var r}function wO(t,n,e,o,r,i){var e=xO(t,n,e,o),o=(n.mustSnap?WE:GE)(t,n,e,r,i),u=yC(e,r,i);return i=n,n=u,t=(t=t).element(),Eo(t,i.leftAttr,n.left()+"px"),Eo(t,i.topAttr,n.top()+"px"),o.fold(function(){return{coord:QO(u.left(),u.top()),extra:$.none()}},function(t){return{coord:t.output(),extra:t.extra()}})}function SO(t,n){n=n,t=(t=t).element(),Bo(t,n.leftAttr),Bo(t,n.topAttr)}function kO(t,e,o,r){return hu(t,function(t){var n=t.sensor();return function(t,n,e,o,r,i){t=xC(t,r,i),i=xC(n,r,i);return Math.abs(t.left()-i.left())<=e&&Math.abs(t.top()-i.top())<=o}(e,n,t.range().left(),t.range().top(),o,r)?$.some({output:G(kC(t.output(),e,o,r)),extra:t.extra}):$.none()})}function CO(n){return t=cr(n,"left"),e=cr(n,"top"),o=cr(n,"position"),r=function(t,n,e){return("fixed"===e?QO:JO)(parseInt(t,10),parseInt(n,10))},(t.isSome()&&e.isSome()&&o.isSome()?$.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):$.none()).getOrThunk(function(){var t=Zi(n);return $O(t.left(),t.top())});var t,e,o,r}function OO(e,t,r,i,u,a,n){var o,c,s,l,f,d=t.fold(function(){var e,o,t=(t=r,e=a.left(),o=a.top(),t.fold(function(t,n){return KO.offset(t+e,n+o)},function(t,n){return KO.absolute(t+e,n+o)},function(t,n){return KO.fixed(t+e,n+o)})),t=yC(t,i,u);return QO(t.left(),t.top())},function(n){var t=wO(e,n,r,a,i,u);return t.extra.each(function(t){n.onSensor(e,t)}),t.coord});return o=d,c=i,s=u,t=(l=n).bounds,d=xC(o,c,s),n=_c(d.left(),t.x(),t.x()+t.width()-l.width),l=_c(d.top(),t.y(),t.y()+t.height()-l.height),f=$O(n,l),o.fold(function(){var t=wC(f,c,s);return JO(t.left(),t.top())},function(){return f},function(){var t=yC(f,c,s);return QO(t.left(),t.top())})}function EO(t,n){return{bounds:t.getBounds(),height:$i(n.element()),width:nu(n.element())}}function TO(c,s,t,n,e){var e=t.update(n,e),l=t.getStartData().getOrThunk(function(){return EO(s,c)});e.each(function(t){var n,e,o,r,i,u,a;n=c,o=l,r=t,a=(e=s).getTarget(n.element()),e.repositionTarget&&(u=so(n.element()),i=eu(u),t=pC(a),u=CO(a),o=OO(n,e.snaps,u,i,t,r,o),t=SC(o,0,t),ur(a,t)),e.onDrag(n,a,r)})}function DO(n,t,e,o){t.each(bO),e.snaps.each(function(t){SO(n,t)}),t=e.getTarget(n.element()),o.reset(),e.onDrop(n,t)}function BO(i,u,a){return[to(_r(),function(n,t){var e,o,r;0===t.event().raw().button&&(t.stop(),t={drop:t=function(){return DO(n,$.some(o),i,u)},delayDrop:(e=Xp(t,200)).schedule,forceDrop:t,move:function(t){e.cancel(),TO(n,i,u,XE,t)}},o=yO(n,i.blockerClass,(r=t,bi([to(_r(),r.forceDrop),to(Ir(),r.drop),to(Mr(),function(t,n){r.move(n.event())}),to(Fr(),r.delayDrop)]))),a(n),vO(n,o))})]}function AO(r,i,u){var a=fe($.none());return[to(Tr(),function(n,t){t.stop();var e,t=function(){DO(n,a.get(),r,i),a.set($.none())},t={drop:t,delayDrop:function(){},forceDrop:t,move:function(t){TO(n,r,i,YE,t)}},o=yO(n,r.blockerClass,(e=t,bi([to(Tr(),e.forceDrop),to(Br(),e.drop),to(Ar(),e.drop),to(Dr(),function(t,n){e.move(n.event())})])));a.set($.some(o));u(n),vO(n,o)}),to(Dr(),function(t,n){n.stop(),TO(t,r,i,YE,n.event())}),to(Br(),function(t,n){n.stop(),DO(t,a.get(),r,i),a.set($.none())}),to(Ar(),function(t){DO(t,a.get(),r,i),a.set($.none())})]}function _O(t,o,r,i,n,e){return t.fold(function(){return qE.snap({sensor:$O(r-20,i-20),range:xu(n,e),output:$O($.some(r),$.some(i)),extra:{td:o}})},function(t){var n=r-20,e=i-20,t=t.element().dom().getBoundingClientRect();return qE.snap({sensor:$O(n,e),range:xu(40,40),output:$O($.some(r-t.width/2),$.some(i-t.height/2)),extra:{td:o}})})}function MO(t,r,i){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,n){var e,o=n.td;n=r.get(),e=o,n.exists(function(t){return On(t,e)})||(r.set($.some(o)),i(o))},mustSnap:!0}}function FO(t){return Qf(Bd.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Na([qE.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Fb.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))}(ya=ZS=ZS||{})[ya.SemiColon=0]="SemiColon",ya[ya.Space=1]="Space";var IO,RO=[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}],VO=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],HO={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},NO=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],PO={button:(Ua=function(e,o){return function(t,n){t=e(t).mapError(function(t){return Kn(t)}).getOrDie();return o(t,n)}})(FS,function(t,n){return t=t,n=n.backstage.shared.providers,Yk(t,n,[])}),togglebutton:Ua(RS,function(t,n){return t=t,n=n.backstage.shared.providers,qk(t,n,[])}),menubutton:Ua(IS,function(t,n){return kx(t,"tox-tbtn",n.backstage,$.none())}),splitbutton:Ua(function(t){return qt("SplitButton",Nk,t)},function(t,n){return LS(t,n.backstage.shared)}),styleSelectButton:function(t,n){return e=t,t=n.backstage,n=E({type:"advanced"},t.styleselect),$S(e,t,fC(e,n));var e},fontsizeSelectButton:function(t,n){return t=t,n=n.backstage,$S(t,n,aC(t))},fontSelectButton:function(t,n){return t=t,n=n.backstage,$S(t,n,iC(t))},formatButton:function(t,n){return t=t,n=n.backstage,$S(t,n,lC(t))},alignMenuButton:function(t,n){return t=t,n=n.backstage,$S(t,n,oC(t))}},zO={styleselect:PO.styleSelectButton,fontsizeselect:PO.fontsizeSelectButton,fontselect:PO.fontSelectButton,formatselect:PO.formatButton,align:PO.alignMenuButton},LO={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},jO={maxHeightFunction:Us(),maxWidthFunction:dk()},UO={onLtr:function(){return[Ra,Va,zu,Nu,Lu,Pu,Td,Dd,Jf,qf,$f,Kf]},onRtl:function(){return[Ra,Va,Lu,Pu,zu,Nu,Td,Dd,$f,Kf,Jf,qf]}},WO={onLtr:function(){return[Va,Nu,Pu,zu,Lu,Ra,Td,Dd,Jf,qf,$f,Kf]},onRtl:function(){return[Va,Pu,Nu,Lu,zu,Ra,Td,Dd,$f,Kf,Jf,qf]}},GO=function(r,t,e,i){function u(){return GS(r)}function a(){if(f()&&i.backstage.isContextMenuOpen())return 1;var t,n,e=(t=g.get().map(function(t){return t.getBoundingClientRect()}).getOrThunk(function(){return r.selection.getRng().getBoundingClientRect()}),n=r.inline?eu().top():cu(me.fromDom(r.getBody())).y(),{y:t.top+n,bottom:t.bottom+n}),o=u();return t=e.y,n=e.bottom,e=o.y(),o=o.bottom(),!(Math.max(t,e)<=Math.min(n,o))}function n(){Ed.hide(d)}function o(){m.get().each(function(t){var n=d.element();lr(n,"display"),a()?ir(n,"display","none"):qs.positionWithinBounds(e,t,d,$.some(u()))})}function c(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Na([ud.config({mode:"acyclic"}),Af("pop-dialog-wrap-events",[yi(function(t){r.shortcuts.add("ctrl+F9","focus statusbar",function(){return ud.focusIn(t)})}),xi(function(t){r.shortcuts.remove("ctrl+F9")})])])}}var s,l,f=wn().deviceType.isTouch,d=Yi((s={sink:e,onEscape:function(){return r.focus(),$.some(!0)}},l=fe([]),Ed.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){l.set([]),Ed.getContent(t).each(function(t){lr(t.element(),"visibility")}),Qo(t.element(),nC),lr(t.element(),"width")},inlineBehaviours:Na([Af("context-toolbar-events",[uo(Ur(),function(t,n){Ed.getContent(t).each(function(t){}),Qo(t.element(),nC),lr(t.element(),"width")}),to(tC,function(n,e){lr(n.element(),"width");var t=tu(n.element());Ed.setContent(n,e.event().contents()),Jo(n.element(),nC);var o=tu(n.element());ir(n.element(),"width",t+"px"),Ed.getContent(n).each(function(t){e.event().focus().bind(function(t){return $u(t),Zu(n.element())}).orThunk(function(){return ud.focusIn(t),Qu()})}),Md.setTimeout(function(){ir(n.element(),"width",o+"px")},0)}),to(Qk,function(t,n){Ed.getContent(t).each(function(t){l.set(l.get().concat([{bar:t,focus:Qu()}]))}),qe(t,tC,{contents:n.event().forwardContents(),focus:$.none()})}),to(Zk,function(n,t){M(l.get()).each(function(t){l.set(l.get().slice(0,l.get().length-1)),qe(n,tC,{contents:qi(t.bar),focus:t.focus})})})]),ud.config({mode:"special",onEscape:function(n){return M(l.get()).fold(function(){return s.onEscape()},function(t){return Ye(n,Zk),$.some(!0)})}})]),lazySink:function(){return tt.value(s.sink)}}))),m=fe($.none()),g=fe($.none()),p=fe(null),h=H(function(){return $k(t,function(t){t=v(t);qe(d,Qk,{forwardContents:c(t)})})}),v=function(t){var n=r.ui.registry.getAll().buttons,e=Sh(r)===bh.scrolling?bh.scrolling:bh.default,o=h();return"contexttoolbar"===t.type?(o=kt(n,o.formNavigators),o=gC(r,{buttons:o,toolbar:t.items},i,$.some(["form:"])),MS({type:e,uid:Mo("context-toolbar"),initGroups:o,onEscape:$.none,cyclicKeying:!0,backstage:i.backstage,getSink:function(){return tt.error("")}})):Kk(e,t,i.backstage)};r.on("contexttoolbar-show",function(n){var t=h();At(t.lookupTable,n.toolbarKey).each(function(t){w(t,n.target===r?$.none():$.some(n)),Ed.getContent(d).each(ud.focusIn)})});function b(t,n){return n="node"===t?i.backstage.shared.anchors.node(n):i.backstage.shared.anchors.cursor(),St(n,(n=t,t=f(),"line"===n?{bubble:na(12,0,LO),layouts:{onLtr:function(){return[ju]},onRtl:function(){return[Uu]}},overrides:jO}:{bubble:na(0,12,LO),layouts:t?WO:UO,overrides:jO}))}function y(){var t=h();Jk(t,r).fold(function(){m.set($.none()),Ed.hide(d)},function(t){w(t.toolbarApi,$.some(t.elem.dom()))})}function x(t){S(),p.set(t)}var w=function(t,n){var e,o;S(),f()&&i.backstage.isContextMenuOpen()||(e=v(t),o=n.map(me.fromDom),o=b(t.position,o),m.set($.some(o)),g.set(n),n=d.element(),lr(n,"display"),Ed.showWithinBounds(d,o,c(e),function(){return $.some(u())}),a()&&ir(n,"display","none"))},S=function(){var t=p.get();null!==t&&(Md.clearTimeout(t),p.set(null))};r.on("init",function(){r.on(Ck,n),r.on("ScrollContent ScrollWindow longpress",o),r.on("click keyup SetContent ObjectResized ResizeEditor",function(t){x(Md.setEditorTimeout(r,y,0))}),r.on("focusout",function(t){Md.setEditorTimeout(r,function(){Zu(e.element()).isNone()&&Zu(d.element()).isNone()&&(m.set($.none()),Ed.hide(d))},0)}),r.on("SwitchMode",function(){r.readonly&&(m.set($.none()),Ed.hide(d))}),r.on("NodeChange",function(t){Zu(d.element()).fold(function(){x(Md.setEditorTimeout(r,y,0))},function(t){})})})},XO=function(t,o,r){function n(n,e){ft([o,r],function(t){t.broadcastEvent(n,e)})}function e(n,e){ft([o,r],function(t){t.broadcastOn([n],e)})}function i(t){return e(el(),{target:t.target()})}function u(t){return e(el(),{target:me.fromDom(t.target)})}function a(t){0===t.button&&e(rl(),{target:me.fromDom(t.target)})}function c(t){return n(ii(),Gp(t))}function s(t){e(ol(),{}),n(ui(),Gp(t))}function l(){return e(ol(),{})}var f=Pp(me.fromDom(b.document),"touchstart",i),d=Pp(me.fromDom(b.document),"touchmove",function(t){return n(oi(),t)}),m=Pp(me.fromDom(b.document),"touchend",function(t){return n(ri(),t)}),g=Pp(me.fromDom(b.document),"mousedown",i),p=Pp(me.fromDom(b.document),"mouseup",function(t){0===t.raw().button&&e(rl(),{target:t.target()})});t.on("PostRender",function(){t.on("click",u),t.on("tap",u),t.on("mouseup",a),t.on("ScrollWindow",c),t.on("ResizeWindow",s),t.on("ResizeEditor",l)}),t.on("remove",function(){t.off("click",u),t.off("tap",u),t.off("mouseup",a),t.off("ScrollWindow",c),t.off("ResizeWindow",s),t.off("ResizeEditor",l),g.unbind(),f.unbind(),d.unbind(),m.unbind(),p.unbind()}),t.on("detach",function(){Yc(o),Yc(r),o.destroy(),r.destroy()})},YO=ba,Dk=tc,Gr=G([fn("shell",!1),Zt("makeItem"),fn("setupItem",W),ll("listBehaviours",[cd])]),ya=yl({name:"items",overrides:function(t){return{behaviours:Na([cd.config({})])}}}),Ua=G([ya]),qO=al({name:G("CustomList")(),configFields:Gr(),partFields:Ua(),factory:function(u,t,n,e){var t=u.shell?{behaviours:[cd.config({})],components:[]}:{behaviours:[],components:t},o=function(t){return u.shell?$.some(t):hs(t,u,"items")};return{uid:u.uid,dom:u.dom,components:t.components,behaviours:rs(u.listBehaviours,t.behaviours),apis:{setItems:function(r,i){o(r).fold(function(){throw b.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(n){var t=cd.contents(n),e=i.length,o=e-t.length,o=0<o?function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e}(o,function(){return u.makeItem()}):[],e=t.slice(e);ft(e,function(t){return cd.remove(n,t)}),ft(o,function(t){return cd.append(n,t)});o=cd.contents(n);ft(o,function(t,n){u.setupItem(r,t,i[n],n)})})}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),KO=xt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),JO=KO.offset,$O=KO.absolute,QO=KO.fixed,ZO=xt([{static:[]},{absolute:["x","y"]},{fixed:["x","y"]}]),tE=function(t,n,e){var o,r,i,u,a,c,s;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),a=o.element(),n=so(a),n=eu(n),c=H(function(){return pC(a)}),(s=i.isDocked())&&IC(o,r,i,u),_C(o,r,u,n,c).each(function(t){i.setDocked(!s),t.fold(function(){return MC(o,r)},function(t,n){return FC(o,r,0,c(),$O(t,n))},function(t,n){IC(o,r,i,u,!0),FC(o,r,0,c(),QO(t,n))})}))},ba=Object.freeze({refresh:tE,reset:VC,isDocked:function(t,n,e){return e.isDocked()}}),tc=Object.freeze({events:function(o,r){return bi([uo(Ur(),function(n,e){o.contextual.each(function(t){Zo(n.element(),t.transitionClass)&&(nr(n.element(),[t.transitionClass,t.fadeInClass]),(r.isVisible()?t.onShown:t.onHidden)(n)),e.stop()})}),to(ii(),function(t,n){tE(t,o,r)}),to(ui(),function(t,n){VC(t,o,r)})])}}),ya=[ln("contextual",[nn("fadeInClass"),nn("fadeOutClass"),nn("transitionClass"),re("lazyContext"),wa("onShow"),wa("onShown"),wa("onHide"),wa("onHidden")]),le("lazyViewport",su),nn("leftAttr"),nn("topAttr"),nn("positionAttr"),dn("modes",["top","bottom"],Ut(Zn)),wa("onDocked"),wa("onUndocked")],nE=Ju({fields:ya,name:"docking",active:tc,apis:ba,state:Object.freeze({init:function(){var n=fe(!1),e=fe(!0);return Li({isDocked:function(){return n.get()},setDocked:function(t){return n.set(t)},isVisible:function(){return e.get()},setVisible:function(t){return e.set(t)},readState:function(){return"docked:  "+n.get()+", visible: "+e.get()}})}})}),eE={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},oE="tox-tinymce--toolbar-sticky-on",rE="tox-tinymce--toolbar-sticky-off",iE=Object.freeze({setup:function(t,n){t.inline||(t.on("ResizeWindow ResizeEditor ResizeContent",function(){n().each(HC)}),t.on("SkinLoaded",function(){n().each(nE.reset)}),t.on("FullscreenStateChanged",function(){n().each(nE.refresh)})),t.on("PostRender",function(){PC(t,!1)})},isDocked:function(t){return t().map(nE.isDocked).getOr(!1)},getBehaviours:zC}),Gr=W,Ua=u,uE=G([]),aE=Object.freeze({setup:Gr,isDocked:Ua,getBehaviours:uE}),cE=kl({factory:function(n,e){var t={focus:ud.focusIn,setMenus:function(t,n){n=y(n,function(n){var t={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},t=IS(t).mapError(function(t){return Kn(t)}).getOrDie();return kx(t,"tox-mbtn",e.backstage,$.some("menuitem"))});cd.set(t,n)}};return{uid:n.uid,dom:n.dom,components:[],behaviours:Na([cd.config({}),Af("menubar-events",[yi(function(t){n.onSetup(t)}),to(Rr(),function(e,t){fu(e.element(),".tox-mbtn--active").each(function(n){du(t.event().target(),".tox-mbtn").each(function(t){On(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(t){Mb.expand(t),Mb.close(n),sd.focus(t)})})})})}),to(fi(),function(e,t){t.event().prevFocus().bind(function(t){return e.getSystem().getByDom(t).toOption()}).each(function(n){t.event().newFocus().bind(function(t){return e.getSystem().getByDom(t).toOption()}).each(function(t){Mb.isOpen(n)&&(Mb.expand(t),Mb.close(n))})})})]),ud.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),$.some(!0)}}),lv.config({})]),apis:t,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Zt("dom"),Zt("uid"),Zt("onEscape"),Zt("backstage"),fn("onSetup",W)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),sE="container",lE=[Fe("slotBehaviours",[])],fE=function(r,t,n){function e(t){return xs(r)}function o(t,n){return"true"!==To(t.element(),"aria-hidden")}var i,u=function(e,o){return void 0===o&&(o=void 0),function(t,n){return hs(t,r,n).map(function(t){return e(t,n)}).getOr(o)}},a=u(o,!1),c=u(function(t,n){var e;o(t)&&(e=t.element(),ir(e,"display","none"),Eo(e,"aria-hidden","true"),qe(t,di(),{name:n,visible:!1}))}),s=function(n,t){ft(t,function(t){return i(n,t)})},u=u(function(t,n){var e;o(t)||(e=t.element(),lr(e,"display"),Bo(e,"aria-hidden"),qe(t,di(),{name:n,visible:!0}))}),u={getSlotNames:e,getSlot:function(t,n){return hs(t,r,n)},isShowing:a,hideSlot:i=c,hideAllSlots:function(t){return s(t,e())},showSlot:u};return{uid:r.uid,dom:r.dom,components:t,behaviours:os(r.slotBehaviours),apis:u}},xt=F({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},Vo),dE=E(E({},xt),{sketch:function(t){var e,n=(e=[],{slot:function(t,n){return e.push(t),fs(sE,LC(t),n)},record:function(){return e}}),t=t(n),n=n.record(),n=y(n,function(t){return bl({name:t,pname:LC(t)})});return Os(sE,lE,n,fE,t)}}),mE=Ln([sn("icon"),sn("tooltip"),le("onShow",W),le("onHide",W),le("onSetup",function(){return W})]),gE=Mo("FixSizeEvent"),pE=Mo("AutoSizeEvent"),ya=Dk.optional({factory:cE,name:"menubar",schema:[Zt("backstage")]}),tc=Dk.optional({factory:{sketch:function(t){return qO.sketch({uid:t.uid,dom:t.dom,listBehaviours:Na([ud.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return MS({type:t.split,uid:Mo("multiple-toolbar-item"),backstage:t.backstage,cyclicKeying:!1,getSink:t.getSink,initGroups:[],onEscape:function(){return $.none()}})},setupItem:function(t,n,e,o){Ok.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Zt("dom"),Zt("onEscape")]}),ba=Dk.optional({factory:{sketch:function(t){var n;return((n=t).split===bh.sliding?_S:n.split===bh.floating?AS:MS)({type:t.split,uid:t.uid,onEscape:function(){return t.onEscape(),$.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,backstage:t.backstage,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader}})}},name:"toolbar",schema:[Zt("dom"),Zt("onEscape"),Zt("getSink")]}),Gr=Dk.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?zC:uE;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Na(e(n,t.getSink))}}},name:"header",schema:[Zt("dom")]}),Ua=Dk.optional({name:"socket",schema:[Zt("dom")]}),xt=Dk.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Na([lv.config({}),sd.config({}),Ak.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Ul.getCurrent(t).each(dE.hideAllSlots),Ye(t,pE)},onGrown:function(t){Ye(t,pE)},onStartGrow:function(t){qe(t,gE,{width:cr(t.element(),"width").getOr("")})},onStartShrink:function(t){qe(t,gE,{width:tu(t.element())+"px"})}}),cd.config({}),Ul.config({find:function(t){t=cd.contents(t);return dt(t)}})])}],behaviours:Na([ey(0),Af("sidebar-sliding-events",[to(gE,function(t,n){ir(t.element(),"width",n.event().width())}),to(pE,function(t,n){lr(t.element(),"width")})])])}}},name:"sidebar",schema:[Zt("dom")]}),Dk=Dk.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Na([cd.config({})]),components:[]}}},name:"throbber",schema:[Zt("dom")]}),hE=al({name:"OuterContainer",factory:function(e,t,n){var o={getSocket:function(t){return YO.getPart(t,e,"socket")},setSidebar:function(t,n){YO.getPart(t,e,"sidebar").each(function(t){return WC(t,n)})},toggleSidebar:function(t,n){YO.getPart(t,e,"sidebar").each(function(t){return t=t,e=n,void Ul.getCurrent(t).each(function(n){Ul.getCurrent(n).each(function(t){Ak.hasGrown(n)?dE.isShowing(t,e)?Ak.shrink(n):(dE.hideAllSlots(t),dE.showSlot(t,e)):(dE.hideAllSlots(t),dE.showSlot(t,e),Ak.grow(n))})});var e})},whichSidebar:function(t){return YO.getPart(t,e,"sidebar").bind(GC).getOrNull()},getHeader:function(t){return YO.getPart(t,e,"header")},getToolbar:function(t){return YO.getPart(t,e,"toolbar")},setToolbar:function(t,n){YO.getPart(t,e,"toolbar").each(function(t){t.getApis().setGroups(t,n)})},setToolbars:function(t,n){YO.getPart(t,e,"multiple-toolbar").each(function(t){qO.setItems(t,n)})},refreshToolbar:function(t){YO.getPart(t,e,"toolbar").each(function(t){return t.getApis().refresh(t)})},getMoreButton:function(t){return YO.getPart(t,e,"toolbar").bind(function(t){return t.getApis().getMoreButton(t)})},getThrobber:function(t){return YO.getPart(t,e,"throbber")},focusToolbar:function(t){YO.getPart(t,e,"toolbar").orThunk(function(){return YO.getPart(t,e,"multiple-toolbar")}).each(function(t){ud.focusIn(t)})},setMenubar:function(t,n){YO.getPart(t,e,"menubar").each(function(t){cE.setMenus(t,n)})},focusMenubar:function(t){YO.getPart(t,e,"menubar").each(function(t){cE.focus(t)})}};return{uid:e.uid,dom:e.dom,components:t,apis:o,behaviours:e.behaviours}},configFields:[Zt("dom"),Zt("behaviours")],partFields:[Gr,ya,ba,tc,Ua,xt,Dk],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){e=y(e,TS);t.setToolbar(n,e)},setToolbars:function(t,n,e){e=y(e,function(t){return y(t,TS)});t.setToolbars(n,e)},getMoreButton:function(t,n){return t.getMoreButton(n)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),vE={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},bE=function(t){function n(){t._skinLoaded=!0,pp(t)}return function(){t.initialized?n():t.on("init",n)}},yE=d(ya=function(t,n){var e,o,r,i,o=(o=(e=n).settings,r=o.skin,o=o.skin_url,!1!==r&&(r=r||"oxide",o=o?e.documentBaseURI.toAbsolute(o):xh.baseURL+"/skins/ui/"+r),o);o&&(i=o+"/skin.min.css",n.contentCSS.push(o+(t?"/content.inline":"/content")+".min.css")),!1===n.getParam("skin")==!1&&i?fg.DOM.styleSheetLoader.load(i,bE(n)):bE(n)()},!1),xE=d(ya,!0),wE=fg.DOM,SE=(ba=wn()).os.isiOS()&&ba.os.version.major<=12,kE={render:function(e,o,t,n,r){var i,u=fe(0);yE(e),i=me.fromDom(r.targetNode),r=o.mothership,Qs(i,r,bo),Xc(Cr(),o.uiMothership),e.on("PostRender",function(){JC(e,o,t,n),u.set(e.getWin().innerWidth),hE.setMenubar(o.outerContainer,KC(e,t)),hE.setSidebar(o.outerContainer,t.sidebar),$C(e)});var a,c,s,r=hE.getSocket(o.outerContainer).getOrDie("Could not find expected socket element");!0===SE&&(ur(r.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),a=function(){e.fire("ScrollContent")},c=20,s=null,l={cancel:function(){null!==s&&(b.clearTimeout(s),s=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===s&&(s=b.setTimeout(function(){a.apply(null,t),s=null},c))}},Pp(r.element(),"scroll",l.throttle)),CS(e,o),e.addCommand("ToggleSidebar",function(t,n){hE.toggleSidebar(o.outerContainer,n),e.fire("ToggleSidebar")}),e.addQueryValueHandler("ToggleSidebar",function(){return hE.whichSidebar(o.outerContainer)});var l=Sh(e);return l!==bh.sliding&&l!==bh.floating||e.on("ResizeWindow ResizeEditor ResizeContent",function(){var t=e.getWin().innerWidth;t!==u.get()&&(hE.refreshToolbar(o.outerContainer),u.set(t))}),{iframeContainer:r.element().dom(),editorContainer:o.outerContainer.element().dom()}}},CE=function(n,t,e){t=t.filter(function(t){return n<t}),e=e.filter(function(t){return t<n});return t.or(e).getOr(n)},OE=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?$.some(parseInt(""+t,10)):$.none()},EE=function(t){return ut(t)?t+"px":t},TE={render:function(n,o,e,r,t){var i,u=fg.DOM,a=Ch(n),c=Eh(n),s=me.fromDom(t.targetNode),l=mh(n).or(ZC(n)),t=Sh(n),f=t===bh.sliding||t===bh.floating;xE(n);function d(t){var n,e;void 0===t&&(t=!1),f&&hE.refreshToolbar(o.outerContainer),a||(n=n=hE.getToolbar(o.outerContainer),n=f?n.fold(function(){return 0},function(t){return 1<t.components().length?Ji(t.components()[1].element()):0}):0,e=Zi(s),n=e.top()-Ji(i.element())+n,ur(o.outerContainer.element(),{position:"absolute",top:Math.round(n)+"px",left:Math.round(e.left())+"px"}),n=l.getOrThunk(function(){var t=OE(ar(Cr(),"margin-left")).getOr(0);return tu(Cr())-e.left()+t}),ir(i.element(),"max-width",n+"px")),c&&(t?nE.reset(i):nE.refresh(i))}function m(){ir(o.outerContainer.element(),"display","flex"),u.addClass(n.getBody(),"mce-edit-focus"),lr(o.uiMothership.element(),"display"),d()}function g(){o.outerContainer&&(ir(o.outerContainer.element(),"display","none"),u.removeClass(n.getBody(),"mce-edit-focus")),ir(o.uiMothership.element(),"display","none")}function p(){var t;i?m():(i=hE.getHeader(o.outerContainer).getOrDie(),t=kh(n).getOr(Cr()),Xc(t,o.mothership),Xc(t,o.uiMothership),JC(n,o,e,r),hE.setMenubar(o.outerContainer,KC(n,e)),m(),n.on("activate",m),n.on("deactivate",g),n.on("NodeChange SkinLoaded ResizeWindow",function(){n.hidden||d(!0)}),n.nodeChanged())}return n.on("focus",p),n.on("blur hide",g),n.on("init",function(){n.hasFocus()&&p()}),CS(n,o),{editorContainer:o.outerContainer.element().dom()}}},DE=function(n){tw.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:YS(n,t.name)})});var t="alignnone",e="No alignment",o="JustifyNone",r="align-none";n.ui.registry.addButton(t,{tooltip:e,onAction:function(){return n.execCommand(o)},icon:r})},BE=function(t){var n;nO(t),n=t,tw.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:tO(n,"code")})},AE=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return eO(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return eO(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return eO(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return eO(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})},_E=function(t){var n,e;(n=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}}),(e=t).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return oO(t,e)},onAction:function(){e.execCommand("mceToggleVisualAid")}})},ME=function(t){var n;(n=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));function e(){t.setDisabled(!n.queryCommandState("outdent"))}return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})},FE=function(t,n){var e,o,r,i,u,a,c,s;e=JS(0,a=n,oC(r=t)),r.ui.registry.addNestedMenuItem("align",{text:a.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}}),o=JS(0,i=n,iC(r=t)),r.ui.registry.addNestedMenuItem("fontformats",{text:i.shared.providers.translate("Fonts"),getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}}),a=t,i=E({type:"advanced"},(r=n).styleselect),u=JS(0,r,fC(a,i)),a.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return u.items.validateItems(u.getStyleItems())}}),c=JS(0,n,lC(a=t)),a.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return c.items.validateItems(c.getStyleItems())}}),s=JS(0,n,aC(t=t)),t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}})},IE=function(t,n){DE(t),BE(t),FE(t,n),AE(t),wp.register(t),_E(t),ME(t)},RE=function(t){return{anchor:"selection",root:me.fromDom(t.selection.getNode())}},VE={onLtr:function(){return[Va,Nu,Pu,zu,Lu,Ra,Td,Dd,Jf,qf,$f,Kf]},onRtl:function(){return[Va,Pu,Nu,Lu,zu,Ra,Td,Dd,$f,Kf,Jf,qf]}},HE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},NE=function(t){return t.settings.contextmenu_never_use_native||!1},PE=function(t){return n="contextmenu",e="link linkchecker image imagetools table spellchecker configurepermanentpen",o=(t=t).ui.registry.getAll().contextMenus,V(t.settings,n).map(mO).getOrThunk(function(){return x(mO(e),function(t){return yt(o,t)})});var n,e,o},zE=function(t){return!1===t.getParam("contextmenu")},LE={type:"separator"},jE=function(n){if(nt(n))return n;switch(n.type){case"separator":return LE;case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var t=n.getSubmenuItems();return nt(t)?t:y(t,jE)}};default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:(t=n.onAction,function(){return t()})}}var t},UE="data-initial-z-index",tc=ln("snaps",[Zt("getSnapPoints"),wa("onSensor"),Zt("leftAttr"),Zt("topAttr"),fn("lazyViewport",su),fn("mustSnap",!1)]),Ua=[fn("useFixed",u),Zt("blockerClass"),fn("getTarget",l),fn("onDrag",W),fn("repositionTarget",!0),fn("onDrop",W),le("getBounds",su),tc],WE=function(t,n,r,i,u){var e=n.getSnapPoints(t);return kO(e,r,i,u).orThunk(function(){return S(e,function(n,e){var t=e.sensor(),o=function(t,n,e,o){t=xC(t,e,o),e=xC(n,e,o),o=Math.abs(t.left()-e.left()),e=Math.abs(t.top()-e.top());return xu(o,e)}(r,t,(e.range().left(),e.range().top(),i),u);return n.deltas.fold(function(){return{deltas:$.some(o),snap:$.some(e)}},function(t){return(o.left()+o.top())/2<=(t.left()+t.top())/2?{deltas:$.some(o),snap:$.some(e)}:n})},{deltas:$.none(),snap:$.none()}).snap.map(function(t){return{output:G(kC(t.output(),r,i,u)),extra:t.extra}})})},GE=function(t,n,e,o,r){t=n.getSnapPoints(t);return kO(t,e,o,r)},xt=function(t){return function(n,e){function o(t){e.setStartData(EO(n,t))}return bi(g([to(ii(),function(t){e.getStartData().each(function(){return o(t)})})],t(n,e,o)))}},XE=Object.freeze({getData:function(t){return $.from(xu(t.x(),t.y()))},getDelta:function(t,n){return xu(n.left()-t.left(),n.top()-t.top())}}),Dk=g(Ua,[_u("dragger",{handlers:xt(BO)})]),YE=Object.freeze({getData:function(t){t=t.raw().touches;return 1===t.length?function(t){t=t[0];return $.some(xu(t.clientX,t.clientY))}(t):$.none()},getDelta:function(t,n){return xu(n.left()-t.left(),n.top()-t.top())}}),ya=g(Ua,[_u("dragger",{handlers:xt(AO)})]),ba=g(Ua,[_u("dragger",{handlers:xt(function(t,n,e){return g(BO(t,n,e),AO(t,n,e))})})]),tc=Object.freeze({mouse:Dk,touch:ya,mouseOrTouch:ba}),Ua=Object.freeze({init:function(){var r=$.none(),n=$.none(),t=G({});return Li({readState:t,reset:function(){r=$.none(),n=$.none()},update:function(o,t){return o.getData(t).bind(function(t){return n=o,e=t,t=r.map(function(t){return n.getDelta(t,e)}),r=$.some(e),t;var n,e})},getStartData:function(){return n},setStartData:function(t){n=$.some(t)}})}}),xt=Object.freeze({snapTo:function(t,n,e,o){var r,i=n.getTarget(t.element());n.repositionTarget&&(r=so(t.element()),n=eu(r),t=pC(i),r=n,n=t,o={coord:kC((o=o).output(),o.output(),r,n),extra:o.extra()},t=SC(o.coord,0,t),ur(i,t))}}),qE=La({branchKey:"mode",branches:tc,name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:ki(["sensor","range","output"],["extra"])},state:Ua,apis:xt}),KE=wn(),JE=function(u,e){function n(t){var n=cu(t);return _O(g.getOpt(e),t,n.x(),n.y(),n.width(),n.height())}function o(t){var n=cu(t);return _O(p.getOpt(e),t,n.right(),n.bottom(),n.width(),n.height())}function r(t,n,e,o){var r,i=e(n);qE.snapTo(t,i),r=t,e=function(t){return t[o]<0},i=function(t,n){return t[o]>n},n=(t=n).dom().getBoundingClientRect(),lr(r.element(),"display"),t=fo(me.fromDom(u.getBody())).dom().innerHeight,e=e(n),t=i(n,t),(e||t)&&ir(r.element(),"display","none")}function i(t){return r(h,t,n,"top")}function a(t){return r(v,t,o,"bottom")}var c=fe([]),s=fe([]),t=fe(!1),l=fe($.none()),f=fe($.none()),d=MO(function(){return y(c.get(),n)},l,function(n){f.get().each(function(t){u.fire("TableSelectorChange",{start:n,finish:t})})}),m=MO(function(){return y(s.get(),o)},f,function(n){l.get().each(function(t){u.fire("TableSelectorChange",{start:t,finish:n})})}),g=FO(d),p=FO(m),h=Yi(g.asSpec()),v=Yi(p.asSpec());KE.deviceType.isTouch()&&(u.on("TableSelectionChange",function(n){t.get()||(jc(e,h),jc(e,v),t.set(!0)),l.set($.some(n.start)),f.set($.some(n.finish)),n.otherCells.each(function(t){c.set(t.upOrLeftCells),s.set(t.downOrRightCells),i(n.start),a(n.finish)})}),u.on("ResizeEditor ResizeWindow ScrollContent",function(){l.get().each(i),f.get().each(a)}),u.on("TableSelectionClear",function(){t.get()&&(Wc(h),Wc(v),t.set(!1)),l.set($.none()),f.set($.none())}))};function $E(t,n,e){var o,r,i,u,a=me.fromDom(t.getContainer()),e=(o=t,r=n,i=e,u=Ji(a),n=tu(a),(e={}).height=CE(u+r.top(),dh(o),gh(o)),i===IO.Both&&(e.width=CE(n+r.left(),fh(o),mh(o))),e);ht(e,function(t,n){return ir(a,n,EE(t))}),hp(t)}function QE(t,o){function r(t,n,e){return cd.set(t,[xr(o.translate(["{0} "+e,n[e]]))])}return Bd.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Na([lv.config({}),cd.config({}),sl.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Af("wordcount-events",[Si(function(t){var n=sl.getValue(t),e="words"===n.mode?"characters":"words";sl.setValue(t,{mode:e,count:n.count}),r(t,n.count,e)}),yi(function(e){t.on("wordCountUpdate",function(t){var n=sl.getValue(e).mode;sl.setValue(e,{mode:n,count:t.wordCount}),r(e,t.wordCount,n)})})])])})}function ZE(o,e){var t,n,r,i;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(i=function(){var t,n=[];return o.getParam("elementpath",!0,"boolean")&&n.push(zT(o,{})),xn(o.settings.plugins,"wordcount")&&n.push(QE(o,e)),o.getParam("branding",!0,"boolean")&&n.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(t=Hm.translate(["Powered by {0}","Tiny"]))+'">'+t+"</a>"}}),0<n.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:n}]:[]}(),n=!xn((t=o).settings.plugins,"autoresize"),(n=!1===(n=t.getParam("resize",n))?IO.None:"both"===n?IO.Both:IO.Vertical)!==IO.None&&i.push((r=n,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:e.translate("Resize")},innerHtml:td("resize-handle",e.icons)},behaviours:Na([qE.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,e){$E(o,e,r)},blockerClass:"tox-blocker"})])})),i)}}function tT(t){return[nn("type"),tn("columns",Qn),t]}function nT(n){return Gn("items","items",Ot(),Ut(Yt(function(t){return qt("Checking item of "+n,sD,t).fold(function(t){return tt.error(Kn(t))},function(t){return tt.value(t)})})))}function eT(t){return nt(t.type)&&nt(t.name)}function oT(t){return t=x(dD(t),eT),t=O(t,function(n){return t=n,$.from(mD[t.type]).fold(function(){return[]},function(t){return[tn(n.name,t)]});var t}),Ln(t)}function rT(t){return{internalDialog:Kt(qt("dialog",fD,t)),dataValidator:oT(t),initialData:t.initialData}}function iT(t){var e=[],o={};return ht(t,function(t,n){t.fold(function(){e.push(n)},function(t){o[n]=t})}),0<e.length?tt.error(e):tt.value(o)}function uT(t){return dt(function(t,n){t=at.call(t,0);return t.sort(n),t}(t,function(t,n){return n<t?-1:t<n?1:0}))}function aT(t,n){ir(t,"height",n+"px"),wn().browser.isIE()?lr(t,"flex-basis"):ir(t,"flex-basis",n+"px")}function cT(t,a,n){lu(t,'[role="dialog"]').each(function(u){fu(u,'[role="tablist"]').each(function(i){n.get().map(function(t){return ir(a,"height","0"),ir(a,"flex-basis","0"),Math.min(t,(e=a,o=i,r=lo(n=u).dom(),t=lu(n,".tox-dialog-wrap").getOr(n),t="fixed"===ar(t,"position")?Math.max(r.clientHeight,b.window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight),r=Ji(e),e=e.dom().offsetLeft>=o.dom().offsetLeft+tu(o)?Math.max(Ji(o),r):r,o=parseInt(ar(n,"margin-top"),10)||0,r=parseInt(ar(n,"margin-bottom"),10)||0,t-(Ji(n)+o+r-e)));var n,e,o,r}).each(function(t){aT(a,t)})})})}function sT(t){return fu(t,'[role="tabpanel"]')}function lT(i){var u;return{smartTabHeight:(u=fe($.none()),{extraEvents:[yi(function(t){var o=t.element();sT(o).each(function(n){var e;ir(n,"visibility","hidden"),t.getSystem().getByDom(n).toOption().each(function(t){var e,o,r,t=(o=n,r=t,y(e=i,function(t,n){cd.set(r,e[n].view());n=o.dom().getBoundingClientRect();return cd.set(r,[]),n.height})),t=uT(t);u.set(t)}),cT(o,n,u),lr(n,"visibility"),e=t,dt(i).each(function(t){return vD.showTab(e,t.value)}),Md.requestAnimationFrame(function(){cT(o,n,u)})})}),to(ui(),function(t){var n=t.element();sT(n).each(function(t){cT(n,t,u)})}),to(Uh,function(t,n){var r=t.element();sT(r).each(function(n){var t=Qu();ir(n,"visibility","hidden");var e=cr(n,"height").map(function(t){return parseInt(t,10)});lr(n,"height"),lr(n,"flex-basis");var o=n.dom().getBoundingClientRect().height;e.forall(function(t){return t<o})?(u.set($.from(o)),cT(r,n,u)):e.each(function(t){aT(n,t)}),lr(n,"visibility"),t.each($u)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}}function fT(t,e){function o(t){var n=sl.getValue(t),t=iT(n).getOr({}),n=i.get(),t=St(n,t);i.set(t)}function r(t){var n=i.get();sl.setValue(t,n)}var i=fe({}),u=fe(null),n=y(t.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:e.shared.providers.translate(t.title)},view:function(){return[Xb.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:y(t.items,function(t){return Ew(n,t,e)}),formBehaviours:Na([ud.config({mode:"acyclic",useTabstopAt:p(dy)}),Af("TabView.form.events",[yi(r),xi(o)]),Wa.config({channels:X([{key:bD,value:{onReceive:o}},{key:yD,value:{onReceive:r}}])})])}})]}}}),t=lT(n).smartTabHeight;return vD.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){n=sl.getValue(n);qe(t,jh,{name:n,oldName:u.get()}),u.set(n)},tabs:n,components:[vD.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[hD.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Na([lv.config({})])}),vD.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:t.selectFirst,tabSectionBehaviours:Na([Af("tabpanel",t.extraEvents),ud.config({mode:"acyclic"}),Ul.config({find:function(t){return dt(vD.getViewItems(t))}}),sl.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([bD],{}),i.get()},setValue:function(t,n){i.set(n),t.getSystem().broadcastOn([yD],{})}}})])})}function dT(t,n,r,e){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:E(E({},n.map(function(t){return{id:t}}).getOr({})),e?{"aria-live":"polite"}:{})},components:[],behaviours:Na([ey(0),jk.config({channel:SD,updateState:function(t,n){return $.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"!==t.body.type?[(e=t.body,o=r,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(n=Qf(Xb.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"].concat(e.classes)},components:y(e.items,function(t){return Ew(n,t,o)})}}))).asSpec()]}],behaviours:Na([ud.config({mode:"acyclic",useTabstopAt:p(dy)}),ny(n),uy(n,{postprocess:function(t){return iT(t).fold(function(t){return b.console.error(t),{}},function(t){return t})}})])})]:[fT(t.body,r)];var e,o,n},initialData:t})])}}function mT(t,e){return[ro(Vr(),my),t(Vh,function(t,n){e.onClose(),n.onClose()}),t(Hh,function(t,n,e,o){n.onCancel(t),Ye(o,Vh)}),to(Lh,function(t,n){return e.onUnblock()}),to(zh,function(t,n){return e.onBlock(n.event())})]}function gT(t,n){var e=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}}(n.map(function(t){return t.footerButtons}).getOr([]),function(t){return"start"===t.align});return[(n=function(t,n){return yh.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:y(n,function(t){return t.memento.asSpec()})})})("start",e.pass),n("end",e.fail)]}function pT(t,o){return{dom:Yd('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Na([jk.config({channel:kD,initialData:t,updateState:function(t,n){var r=y(n.buttons,function(t){var n,e,e=Qf((e=o,_x(n=t,n.type,e)));return{name:t.name,align:t.align,memento:e}});return $.some({lookupByName:function(t,n){return e=t,o=n,k(r,function(t){return t.name===o}).bind(function(t){return t.memento.getOpt(e)});var e,o},footerButtons:r})},renderComponents:gT})])}}function hT(t,n){return UT.parts().footer(pT(t,n))}function vT(n,e){if(n.getRoot().getSystem().isConnected()){var o=Ul.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return Xb.getField(o,e).fold(function(){var t=n.getFooter();return jk.getState(t).get().bind(function(t){return t.lookupByName(o,e)})},function(t){return $.some(t)})}return $.none()}function bT(i,o,u){function t(t){var n=i.getRoot();n.getSystem().isConnected()&&t(n)}var a={getData:function(){var t=i.getRoot(),n=t.getSystem().isConnected()?i.getFormWrapper():t,t=sl.getValue(n),n=F(u,function(t){return t.get()});return E(E({},t),n)},setData:function(r){t(function(t){var n=a.getData(),e=kt(n,r),o=function(t,n){t=t.getRoot();return jk.getState(t).get().map(function(t){return Kt(qt("data",t.dataValidator,n))}).getOr(n)}(i,e),n=i.getFormWrapper();sl.setValue(n,o),ht(u,function(t,n){yt(e,n)&&t.set(e[n])})})},disable:function(t){vT(i,t).each(Zm.disable)},enable:function(t){vT(i,t).each(Zm.enable)},focus:function(t){vT(i,t).each(sd.focus)},block:function(n){if(!nt(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){qe(t,zh,{message:n})})},unblock:function(){t(function(t){Ye(t,Lh)})},showTab:function(e){t(function(t){var n=i.getBody();jk.getState(n).get().exists(function(t){return t.isTabPanel()})&&Ul.getCurrent(n).each(function(t){vD.showTab(t,e)})})},redial:function(e){t(function(t){var n=o(e);t.getSystem().broadcastOn([xD],n),t.getSystem().broadcastOn([wD],n.internalDialog),t.getSystem().broadcastOn([SD],n.internalDialog),t.getSystem().broadcastOn([kD],n.internalDialog),a.setData(n.initialData)})},close:function(){t(function(t){Ye(t,Vh)})}};return a}function yT(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}}function xT(t,n){return UT.parts().close(Bd.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Na([lv.config({})])}))}function wT(){return UT.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})}function ST(t,n){return UT.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:Yd("<p>"+n.translate(t)+"</p>")}]}]})}function kT(t){return UT.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})}function CT(t,n){return[yh.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),yh.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]}function OT(n){var t="tox-dialog",e=t+"-wrap",o=e+"__backdrop",r=t+"__disable-scroll";return UT.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),$.some(!0)},useTabstopAt:function(t){return!dy(t)},dom:{tag:"div",classes:[t].concat(n.extraClasses),styles:E({position:"relative"},n.extraStyles)},components:g([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:Yd('<div class="'+e+'"></div>'),components:[{dom:{tag:"div",classes:DD?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:e,modalBehaviours:Na(g([sd.config({}),Af("dialog-events",n.dialogEvents.concat([uo(Vr(),function(t,n){ud.focusIn(t)})])),Af("scroll-lock",[yi(function(){Jo(Cr(),r)}),xi(function(){Qo(Cr(),r)})])],n.extraBehaviours)),eventOrder:E(((e={})[Jr()]=["dialog-events"],e[ai()]=["scroll-lock","dialog-events","alloy.base.behaviour"],e[ci()]=["alloy.base.behaviour","dialog-events","scroll-lock"],e),n.eventOrder)})}function ET(t){return Bd.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(t){Ye(t,Hh)}})}function TT(t,n,e){function o(t){return[xr(e.translate(t.title))]}return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:E({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:Na([jk.config({channel:wD,renderComponents:o})])}}function DT(){return{dom:Yd('<div class="tox-dialog__draghandle"></div>')}}function BT(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,t=UT.parts().title(TT(e,$.none(),o)),n=UT.parts().draghandle(DT()),o=UT.parts().close(ET(o)),o=[t].concat(e.draggable?[n]:[]).concat([o]),yh.sketch({dom:Yd('<div class="tox-dialog__header"></div>'),components:o});var e,o}function AT(t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(e){UT.setBusy(t(),function(t,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:Yd('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})},onUnblock:function(){UT.setIdle(t())}}}function _T(t,n,e,o){return Yi(OT(E(E({},t),{lazySink:o.shared.getSink,extraBehaviours:g([jk.config({channel:xD,updateState:function(t,n){return $.some(n)},initialData:n}),sy({})],t.extraBehaviours),onEscape:function(t){Ye(t,Hh)},dialogEvents:e,eventOrder:((e={})[Kr()]=["reflecting","receiving"],e[ai()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],e[ci()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],e)})))}function MT(t){return y(t,function(t){return"menu"===t.type?(e=y((n=t).items,function(t){var n=fe(!1);return E(E({},t),{storage:n})}),E(E({},n),{items:e})):t;var n,e})}function FT(t){return S(t,function(t,n){return"menu"!==n.type?t:S(n.items,function(t,n){return t[n.name]=n.storage,t},t)},{})}function IT(t,n,e){var o=BT(t.internalDialog.title,e),r=function(t,n){n=dT(t,$.none(),n,!1);return UT.parts().body(n)}({body:t.internalDialog.body},e),i=MT(t.internalDialog.buttons),u=FT(i),a=hT({buttons:i},e),c=ED(function(){return l},AT(function(){return s},n)),i="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],i={header:o,body:r,footer:$.some(a),extraClasses:i,extraBehaviours:[],extraStyles:{}},s=_T(i,t,c,e),l=bT({getRoot:function(){return s},getBody:function(){return UT.getBody(s)},getFooter:function(){return UT.getFooter(s)},getFormWrapper:function(){var t=UT.getBody(s);return Ul.getCurrent(t).getOr(t)}},n.redial,u);return{dialog:s,instanceApi:l}}function RT(t,n,e,o){var r,i,u=Mo("dialog-label"),a=Mo("dialog-content"),c=Qf((r={title:t.internalDialog.title,draggable:!0},i=u,l=e.shared.providers,yh.sketch({dom:Yd('<div class="tox-dialog__header"></div>'),components:[TT(r,$.some(i),l),DT(),ET(l)],containerBehaviours:Na([qE.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return du(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),s=Qf((r={body:t.internalDialog.body},i=a,l=e,o=o,dT(r,$.some(i),l,o))),l=MT(t.internalDialog.buttons),o=FT(l),f=Qf(TD({buttons:l},e)),l=ED(function(){return m},{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}}),d=Yi({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((e={role:"dialog"})["aria-labelledby"]=u,e["aria-describedby"]=""+a,e)},eventOrder:((e={})[Kr()]=[jk.name(),Wa.name()],e[Jr()]=["execute-on-form"],e[ai()]=["reflecting","execute-on-form"],e),behaviours:Na([ud.config({mode:"cyclic",onEscape:function(t){return Ye(t,Vh),$.some(!0)},useTabstopAt:function(t){return!dy(t)&&("button"!==ze(t)||"disabled"!==To(t,"disabled"))}}),jk.config({channel:xD,updateState:function(t,n){return $.some(n)},initialData:t}),sd.config({}),Af("execute-on-form",l.concat([uo(Vr(),function(t,n){ud.focusIn(t)})])),sy({})]),components:[c.asSpec(),s.asSpec(),f.asSpec()]}),m=bT({getRoot:function(){return d},getFooter:function(){return f.get(d)},getBody:function(){return s.get(d)},getFormWrapper:function(){var t=s.get(d);return Ul.getCurrent(t).getOr(t)}},n.redial,o);return{dialog:d,instanceApi:m}}function VT(n){function t(t){n.getSystem().isConnected()&&t(n)}return{block:function(n){if(!nt(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){qe(t,zh,{message:n})})},unblock:function(){t(function(t){Ye(t,Lh)})},close:function(){t(function(t){Ye(t,Vh)})},sendMessage:function(n){t(function(t){t.getSystem().broadcastOn([CD],n)})}}}function HT(t){return et(t)&&-1!==AD.indexOf(t.mceAction)}function NT(e,t,o,n){var r=BT(e.title,n),i=function(t){t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[gy({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Na([lv.config({}),sd.config({})])})]}],behaviours:Na([ud.config({mode:"acyclic",useTabstopAt:p(dy)})])};return UT.parts().body(t)}(e),u=e.buttons.bind(function(t){return 0===t.length?$.none():$.some(hT({buttons:t},n))}),a=OD(function(){return g},AT(function(){return m},t)),c=E(E({},e.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),e.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),s=e.width.isNone()&&e.height.isNone()?["tox-dialog--width-lg"]:[],l=new BD(e.url,{base_uri:new BD(b.window.location.href)}),f=l.protocol+"://"+l.host+(l.port?":"+l.port:""),d=fe($.none()),t=[Af("messages",[yi(function(){var t=Pp(me.fromDom(b.window),"message",function(t){var n;l.isSameOrigin(new BD(t.raw().origin))&&(n=t.raw().data,HT(n)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!rt(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(o,g,n):!HT(t=n)&&et(t)&&yt(t,"mceAction")&&e.onMessage(g,n))});d.set($.some(t))}),xi(function(){d.get().each(function(t){return t.unbind()})})]),Wa.config({channels:((t={})[CD]={onReceive:function(t,n){fu(t.element(),"iframe").each(function(t){t.dom().contentWindow.postMessage(n,f)})}},t)})],m=_T({header:r,body:i,footer:u,extraClasses:s,extraBehaviours:t,extraStyles:c},e,a,n),g=VT(m);return{dialog:m,instanceApi:g}}function PT(c){var s=c.backstage.shared;return{open:function(t,n){function e(t){UT.hide(a),n(t)}var o=Qf(_x({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:$.none()},"submit",c.backstage)),r=_x({name:"no",text:"No",primary:!0,align:"end",disabled:!1,icon:$.none()},"cancel",c.backstage),i=wT(),u=xT(function(){return e(!1)},s.providers),a=Yi(OT({lazySink:function(){return s.getSink()},header:yT(i,u),body:ST(t,s.providers),footer:$.some(kT(CT([],[r,o.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[to(Hh,function(){return e(!1)}),to(Ph,function(){return e(!0)})],eventOrder:{}}));UT.show(a);o=o.get(a);sd.focus(o)}}}(Dk=IO=IO||{})[Dk.None=0]="None",Dk[Dk.Both=1]="Both",Dk[Dk.Vertical=2]="Vertical";var zT=function(i,o){o.delimiter||(o.delimiter="»");return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Na([ud.config({mode:"flow",selector:"div[role=button]"}),lv.config({}),cd.config({}),Af("elementPathEvents",[yi(function(n,t){i.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return ud.focusIn(n)}),i.on("NodeChange",function(t){var e,t=function(t){for(var n=[],e=t.length;0<e--;){var o=t[e];if(1===o.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(o)){var r=i.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||n.push({name:r.name,element:o}),r.isPropagationStopped())break}}return n}(t.parents);0<t.length&&cd.set(n,(t=y((t=t)||[],function(n,t){return Bd.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":t,"tab-index":-1,"aria-level":t+1},innerHtml:n.name},action:function(t){i.focus(),i.selection.select(n.element),i.nodeChanged()}})}),e={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+o.delimiter+" "}},S(t.slice(1),function(t,n){return t.push(e),t.push(n),t},[t[0]])))})})])]),components:[]}},LT=function(a){function c(){return n.bind(hE.getHeader)}function s(){return tt.value(m)}function l(){return n.bind(function(t){return hE.getThrobber(t)}).getOrDie("Could not find throbber element")}var t=a.inline,f=t?TE:kE,d=Eh(a)?iE:aE,n=$.none(),e=wn(),o=e.browser.isIE()?["tox-platform-ie"]:[],r=e.deviceType.isTouch()?["tox-platform-touch"]:[],i=Hm.isRtl()?{attributes:{dir:"rtl"}}:{},m=Yi({dom:E({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(o).concat(r)},i),behaviours:Na([qs.config({useFixed:function(){return d.isDocked(c)}})])}),u=Qf({dom:{tag:"div",classes:["tox-anchorbar"]}}),g=function(){return n.bind(function(t){return hE.getMoreButton(t)}).getOrDie("Could not find more button element")},p=Zw(m,a,function(){return n.bind(function(t){return u.getOpt(t)}).getOrDie("Could not find a anchor bar element")},g),h=hE.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:p,onEscape:function(){a.focus()}}),v=Sh(a),b=hE.parts().toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:s,backstage:p,onEscape:function(){a.focus()},split:v,lazyToolbar:function(){return n.bind(function(t){return hE.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyMoreButton:g,lazyHeader:function(){return c().getOrDie("Could not find header element")}}),y=hE.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},onEscape:function(){},split:v}),e=hE.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),i=hE.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),g=hE.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:p}),v=a.getParam("statusbar",!0,"boolean")&&!t?$.some(ZE(a,p.shared.providers)):$.none(),e={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[e,i]},x=wh(a),w=hh(a),i=ph(a),h=hE.parts().header({dom:{tag:"div",classes:["tox-editor-header"]},components:T([i?[h]:[],x?[y]:w?[b]:[],Ch(a)?[]:[u.asSpec()]]),sticky:Eh(a),editor:a,getSink:s}),e=T([[h],t?[]:[e]]),e=T([[{dom:{tag:"div",classes:["tox-editor-container"]},components:e}],t?[]:v.toArray(),[g]]),v=Oh(a),g=E(E({role:"application"},Hm.isRtl()?{dir:"rtl"}:{}),v?{"aria-hidden":"true"}:{}),S=Yi(hE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(t?["tox-tinymce-inline"]:[]).concat(r).concat(o),styles:E({visibility:"hidden"},v?{opacity:"0",border:"0"}:{}),attributes:g},components:e,behaviours:Na([ud.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])})),n=$.some(S);a.shortcuts.add("alt+F9","focus menubar",function(){hE.focusMenubar(S)}),a.shortcuts.add("alt+F10","focus toolbar",function(){hE.focusToolbar(S)});var k=ch(S),C=ch(m);XO(a,k,C),Ih(a);function O(){var t=EE(QC(a)),n=EE(ZC(n=a).getOr(lh(n)));return a.inline||(sr("div","width",n)&&ir(S.element(),"width",n),sr("div","height",t)?ir(S.element(),"height",t):ir(S.element(),"height","200px")),t}return{mothership:k,uiMothership:C,backstage:p,renderUI:function(){var o,r;d.setup(a,c),IE(a,p),hO(a,s,p),r=(o=a).ui.registry.getAll().sidebars,ft(gt(r),function(n){function e(){return $.from(o.queryCommandValue("ToggleSidebar")).is(n)}var t=r[n];o.ui.registry.addToggleButton(n,{icon:t.icon,tooltip:t.tooltip,onAction:function(t){o.execCommand("ToggleSidebar",!1,n),t.setActive(e())},onSetup:function(t){function n(){return t.setActive(e())}return o.on("ToggleSidebar",n),function(){o.off("ToggleSidebar",n)}}})}),YC(a,l,p.shared);var t=a.ui.registry.getAll(),n=t.buttons,e=t.menuItems,i=t.contextToolbars,u=t.sidebars,t=vh(a),t={menuItems:e,menus:a.settings.menu?F(a.settings.menu,function(t){return kt(t,{items:t.items})}):{},menubar:a.settings.menubar,toolbar:t.getOrThunk(function(){return a.getParam("toolbar",!0)}),buttons:n,sidebar:u};GO(a,i,m,{backstage:p}),JE(a,m);n=a.getElement(),u=O(),i={mothership:k,uiMothership:C,outerContainer:S},u={targetNode:n,height:u};return f.render(a,i,t,p,u)},getUi:function(){return{channels:{broadcastAll:C.broadcast,broadcastOn:C.broadcastOn,register:function(){}}}}}},jT=function(t,n){var e=$.from(To(t,"id")).fold(function(){var t=Mo("dialog-label");return Eo(n,"id",t),t},l);Eo(t,"aria-labelledby",e)},ya=G([Zt("lazySink"),un("dragBlockClass"),le("getBounds",su),fn("useTabstopAt",G(!0)),fn("eventOrder",{}),Fe("modalBehaviours",[ud]),Sa("onExecute"),Ca("onEscape")]),ba={sketch:l},La=G([yl({name:"draghandle",overrides:function(t,n){return{behaviours:Na([qE.config({mode:"mouse",getTarget:function(t){return lu(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),bl({schema:[Zt("dom")],name:"title"}),bl({factory:ba,schema:[Zt("dom")],name:"close"}),bl({factory:ba,schema:[Zt("dom")],name:"body"}),yl({factory:ba,schema:[Zt("dom")],name:"footer"}),Be({factory:{sketch:function(t,n){return E(E({},t),{dom:n.dom,components:n.components})}},schema:[fn("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),fn("components",[])],name:"blocker"})]),UT=al({name:"ModalDialog",configFields:ya(),partFields:La(),factory:function(r,t,n,i){var u=Mo("alloy.dialog.busy"),a=Mo("alloy.dialog.idle"),c=Na([ud.config({mode:"special",onTab:function(){return $.some(!0)},onShiftTab:function(){return $.some(!0)}}),sd.config({})]),e=Mo("modal-events"),o=E(E({},r.eventOrder),{"alloy.system.attached":[e].concat(r.eventOrder["alloy.system.attached"]||[])});return{uid:r.uid,dom:r.dom,components:t,apis:{show:function(e){var t=r.lazySink(e).getOrDie(),o=fe($.none()),n=i.blocker(),n=t.getSystem().build(E(E({},n),{components:n.components.concat([qi(e)]),behaviours:Na([sd.config({}),Af("dialog-blocker-events",[uo(Vr(),function(){ud.focusIn(e)}),to(a,function(t,n){Do(e.element(),"aria-busy")&&(Bo(e.element(),"aria-busy"),o.get().each(function(t){return cd.remove(e,t)}))}),to(u,function(t,n){Eo(e.element(),"aria-busy","true");n=n.event().getBusySpec();o.get().each(function(t){cd.remove(e,t)});n=n(e,c),n=t.getSystem().build(n);o.set($.some(n)),cd.append(e,qi(n)),n.hasConfigured(ud)&&ud.focusIn(n)})])])}));jc(t,n),ud.focusIn(e)},hide:function(n){mo(n.element()).each(function(t){n.getSystem().getByDom(t).each(function(t){Wc(t)})})},getBody:function(t){return vs(t,r,"body")},getFooter:function(t){return vs(t,r,"footer")},setIdle:function(t){Ye(t,a)},setBusy:function(t,n){qe(t,u,{getBusySpec:n})}},eventOrder:o,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:rs(r.modalBehaviours,[cd.config({}),ud.config({mode:"cyclic",onEnter:r.onExecute,onEscape:r.onEscape,useTabstopAt:r.useTabstopAt}),Af(e,[yi(function(t){var n,e;jT(t.element(),vs(t,r,"title").element()),n=t.element(),e=vs(t,r,"body").element(),t=$.from(To(n,"id")).fold(function(){var t=Mo("dialog-describe");return Eo(e,"id",t),t},l),Eo(n,"aria-describedby",t)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),tc=[nn("type"),nn("text"),en("level",["info","warn","error","success"]),nn("icon"),fn("url","")],WT=Ln(tc),ki=[nn("type"),nn("text"),se("disabled",!1),se("primary",!1),Gn("name","name",Tt(function(){return Mo("button-name")}),Zn),sn("icon"),se("borderless",!1)],GT=Ln(ki),Ua=[nn("type"),nn("name"),nn("label"),se("disabled",!1)],XT=Ln(Ua),xt=te,Sa=(Dk=[nn("type"),nn("name")]).concat([sn("label")]),YT=Ln(Sa),Ca=Zn,qT=Ln(Sa),ba=Zn,KT=Ln(Sa),Be=Ut(Xn),ya=Sa.concat([se("sandboxed",!0)]),JT=Ln(ya),La=Zn,tc=Sa.concat([sn("inputMode"),sn("placeholder"),se("maximized",!1),se("disabled",!1)]),$T=Ln(tc),ki=Zn,Ua=Sa.concat([ie("items",[nn("text"),nn("value")]),ae("size",1),se("disabled",!1)]),QT=Ln(Ua),ya=Zn,tc=Sa.concat([se("constrain",!0),se("disabled",!1)]),ZT=Ln(tc),ae=Ln([nn("width"),nn("height")]),Ua=Sa.concat([sn("placeholder"),se("maximized",!1),se("disabled",!1)]),tD=Ln(Ua),tc=Zn,Ua=Sa.concat([ce("filetype","file",["image","media","file"]),fn("disabled",!1)]),nD=Ln(Ua),Ua=Ln([nn("value"),fn("meta",{})]),eD=Dk.concat([mn("tag","textarea"),nn("scriptId"),nn("scriptUrl"),dn("settings",void 0,oe)]),oD=Dk.concat([mn("tag","textarea"),re("init")]),rD=Yt(function(t){return qt("customeditor.old",jt(oD),t).orThunk(function(){return qt("customeditor.new",jt(eD),t)})}),Dk=Zn,re=[nn("type"),nn("html"),ce("presets","presentation",["presentation","document"])],iD=Ln(re),re=Sa.concat([tn("currentState",Ln([Zt("blob"),nn("url")]))]),uD=Ln(re),re=Sa.concat([fn("columns","auto")]),aD=Ln(re),Sa=(oe=[nn("value"),nn("text"),nn("icon")],Un(oe)),re=[nn("type"),rn("header",Zn),rn("cells",Ut(Zn))],cD=Ln(re),sD=Yn(function(){return Jn("type",{alertbanner:WT,bar:Ln((t=nT("bar"),[nn("type"),t])),button:GT,checkbox:XT,colorinput:YT,colorpicker:qT,dropzone:KT,grid:Ln(tT(nT("grid"))),iframe:JT,input:$T,selectbox:QT,sizeinput:ZT,textarea:tD,urlinput:nD,customeditor:rD,htmlpanel:iD,imagetools:uD,collection:aD,label:Ln((t=nT("label"),[nn("type"),nn("label"),t])),table:cD,panel:lD});var t}),Yn=[nn("type"),fn("classes",[]),rn("items",sD)],lD=Ln(Yn),Yn=[Gn("name","name",Tt(function(){return Mo("tab-name")}),Zn),nn("title"),rn("items",sD)],ie=[nn("type"),ie("tabs",Yn)],Yn=Ln(ie),ie=Ln([nn("type"),nn("name"),se("active",!1)].concat(Re)),Re=te,ce=g(Tt=[Gn("name","name",Tt(function(){return Mo("button-name")}),Zn),sn("icon"),ce("align","end",["start","end"]),se("primary",!1),se("disabled",!1)],[nn("text")]),se=g([en("type",["submit","cancel","custom"])],ce),Tt=g([en("type",["menu"]),sn("text"),sn("tooltip"),sn("icon"),rn("items",ie),le("onSetup",function(){return W})],Tt),ce=ce,Tt=$t("type",{submit:se,cancel:se,custom:se,menu:Tt}),fD=Ln([nn("title"),tn("body",Jn("type",{panel:lD,tabpanel:Yn})),mn("size","normal"),rn("buttons",Tt),fn("initialData",{}),le("onAction",W),le("onChange",W),le("onSubmit",W),le("onClose",W),le("onCancel",W),fn("onTabChange",W)]),dD=function(t){return et(t)?[t].concat(O(R(t),dD)):ot(t)?O(t,dD):[]},mD={checkbox:xt,colorinput:Ca,colorpicker:ba,dropzone:Be,input:ki,iframe:La,sizeinput:ae,selectbox:ya,size:ae,textarea:tc,urlinput:Ua,customeditor:Dk,collection:Sa,togglemenuitem:Re},ce=Ln(g([en("type",["cancel","custom"])],ce)),gD=Ln([nn("title"),nn("url"),cn("height"),cn("width"),an("buttons",Ut(ce)),le("onAction",W),le("onCancel",W),le("onClose",W),le("onMessage",W)]),pD={open:function(t,n){n=rT(n);return t(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(t,n){return t(Kt(qt("dialog",gD,n)))},redial:rT},le=kl({name:"TabButton",configFields:[fn("uid",void 0),Zt("value"),Gn("dom","dom",Dt(function(t){return{attributes:{role:"tab",id:Mo("aria"),"aria-selected":"false"}}}),$n()),un("action"),fn("domModification",{}),Fe("tabButtonBehaviours",[sd,ud,sl]),Zt("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Pf(t.action),behaviours:rs(t.tabButtonBehaviours,[sd.config({}),ud.config({mode:"execution",useSpace:!0,useEnter:!0}),sl.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),xa=G([Zt("tabs"),Zt("dom"),fn("clickToDismiss",!1),Fe("tabbarBehaviours",[Kl,ud]),xa(["tabClass","selectedClass"])]),le=Ka({factory:le,name:"tabs",unit:"tab",overrides:function(o,t){function r(t,n){Kl.dehighlight(t,n),qe(t,gi(),{tabbar:t,button:n})}function i(t,n){Kl.highlight(t,n),qe(t,mi(),{tabbar:t,button:n})}return{action:function(t){var n=t.getSystem().getByUid(o.uid).getOrDie(),e=Kl.isHighlighted(n,t);(e&&o.clickToDismiss?r:e?W:i)(n,t)},domModification:{classes:[o.markers.tabClass]}}}}),le=G([le]),hD=al({name:"Tabbar",configFields:xa(),partFields:le(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:rs(t.tabbarBehaviours,[Kl.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Eo(n.element(),"aria-selected","true")},onDehighlight:function(t,n){Eo(n.element(),"aria-selected","false")}}),ud.config({mode:"flow",getInitial:function(t){return Kl.getHighlighted(t).map(function(t){return t.element()})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),le=kl({name:"Tabview",configFields:[Fe("tabviewBehaviours",[cd])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:rs(t.tabviewBehaviours,[cd.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),wa=G([fn("selectFirst",!0),wa("onChangeTab"),wa("onDismissTab"),fn("tabs",[]),Fe("tabSectionBehaviours",[])]),Fe=bl({factory:hD,schema:[Zt("dom"),on("markers",[Zt("tabClass"),Zt("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),le=bl({factory:le,name:"tabview"}),le=G([Fe,le]),vD=al({name:"TabSection",configFields:wa(),partFields:le(),factory:function(r,t,n,e){function o(t,n){hs(t,r,"tabbar").each(function(t){n(t).each(Ke)})}return{uid:r.uid,dom:r.dom,components:t,behaviours:os(r.tabSectionBehaviours),events:bi(T([r.selectFirst?[yi(function(t,n){o(t,Kl.getFirst)})]:[],[to(mi(),function(t,n){var e,o,n=n.event().button();e=n,o=sl.getValue(e),hs(e,r,"tabview").each(function(n){k(r.tabs,function(t){return t.value===o}).each(function(t){t=t.view();Eo(n.element(),"aria-labelledby",To(e.element(),"id")),cd.set(n,t),r.onChangeTab(n,e,t)})})}),to(gi(),function(t,n){n=n.event().button();r.onDismissTab(t,n)})]])),apis:{getViewItems:function(t){return hs(t,r,"tabview").map(function(t){return cd.contents(t)}).getOr([])},showTab:function(t,e){o(t,function(n){var t=Kl.getCandidates(n);return k(t,function(t){return sl.getValue(t)===e}).filter(function(t){return!Kl.isHighlighted(n,t)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),bD="send-data-to-section",yD="send-data-to-view",xD=Mo("update-dialog"),wD=Mo("update-title"),SD=Mo("update-body"),kD=Mo("update-footer"),CD=Mo("body-send-message"),OD=function(i,t){function n(t,r){return to(t,function(e,o){u(e,function(t,n){r(i(),t,o.event(),e)})})}var u=function(n,e){jk.getState(n).get().each(function(t){e(t,n)})};return g(mT(n,t),[n(Nh,function(t,n,e){n.onAction(t,{name:e.name()})})])},ED=function(i,t){function n(t,r){return to(t,function(e,o){u(e,function(t,n){r(i(),t,o.event(),e)})})}var u=function(n,e){jk.getState(n).get().each(function(t){e(t.internalDialog,n)})};return g(mT(n,t),[n(Ph,function(t,n){return n.onSubmit(t)}),n(Rh,function(t,n,e){n.onChange(t,{name:e.name()})}),n(Nh,function(t,n,e,o){function r(){return ud.focusIn(o)}var i=Qu();n.onAction(t,{name:e.name(),value:e.value()}),Qu().fold(function(){r()},function(t){(!Ne(o.element(),t)||Do(t,"disabled")||Ne(t,i.getOrNull())&&Do(i.getOrDie(),"disabled"))&&r()})}),n(jh,function(t,n,e){n.onTabChange(t,{newTabName:e.name(),oldTabName:e.oldName()})}),xi(function(t){var n=i();sl.setValue(t,n.getData())})])},TD=pT,DD=Ym.deviceType.isTouch(),BD=tinymce.util.Tools.resolve("tinymce.util.URI"),AD=["insertContent","setContent","execCommand","close","block","unblock"],_D=function(t){var a,c,f=t.backstage,d=t.editor,m=Eh(d),e=(c=(a=t).backstage.shared,{open:function(t,n){function e(){UT.hide(u),n()}var o=Qf(_x({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:$.none()},"cancel",a.backstage)),r=wT(),i=xT(e,c.providers),u=Yi(OT({lazySink:function(){return c.getSink()},header:yT(r,i),body:ST(t,c.providers),footer:$.some(kT(CT([],[o.asSpec()]))),onEscape:e,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[to(Hh,e)],eventOrder:{}}));UT.show(u);o=o.get(u);sd.focus(o)}}),o=PT(t),r=function(t,e){return pD.openUrl(function(t){var n=NT(t,{closeWindow:function(){UT.hide(n.dialog),e(n.instanceApi)}},d,f);return UT.show(n.dialog),n.instanceApi},t)},i=function(t,r){return pD.open(function(t,n,e){var n=n,o=IT({dataValidator:e,initialData:n,internalDialog:t},{redial:pD.redial,closeWindow:function(){UT.hide(o.dialog),r(o.instanceApi)}},f);return UT.show(o.dialog),o.instanceApi.setData(n),o.instanceApi},t)},u=function(t,c,s,l){return pD.open(function(t,n,e){function o(){return u.on(function(t){nE.refresh(t)})}var r,i,n=Kt(qt("data",e,n)),u=(r=fe($.none()),{clear:function(){r.set($.none())},set:function(t){r.set($.some(t))},isSet:function(){return r.get().isSome()},on:function(t){r.get().each(t)}}),a=RT({dataValidator:e,initialData:n,internalDialog:t},{redial:pD.redial,closeWindow:function(){u.on(Ed.hide),d.off("ResizeEditor",o),u.clear(),s(a.instanceApi)}},f,l),t=Yi(Ed.sketch({lazySink:f.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},inlineBehaviours:Na(g([Af("window-manager-inline-events",[to(si(),function(t,n){Ye(a.dialog,Hh)})])],(i=d,m?[]:[nE.config({contextual:{lazyContext:function(){return $.some(au(me.fromDom(i.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},leftAttr:"data-dock-left",topAttr:"data-dock-top",positionAttr:"data-dock-pos",modes:["top"]})])))}));return u.set(t),Ed.showWithin(t,c,qi(a.dialog),$.some(Cr())),m||(nE.refresh(t),d.on("ResizeEditor",o)),a.instanceApi.setData(n),ud.focusIn(a.dialog),a.instanceApi},t)};return{open:function(t,n,e){return void 0!==n&&"toolbar"===n.inline?u(t,f.shared.anchors.toolbar(),e,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?u(t,f.shared.anchors.cursor(),e,n.ariaAttrs):i(t,e)},openUrl:function(t,n){return r(t,n)},alert:function(t,n){e.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){o.open(t,function(t){n(t)})}}};t.add("silver",function(t){var n=LT(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,n=n.getUi;jp(t,o.shared);t=_D({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:G(t),getNotificationManagerImpl:function(){return Fd(0,{backstage:o},e)},ui:n()}})}(window);