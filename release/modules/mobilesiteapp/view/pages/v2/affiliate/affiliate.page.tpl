<ion-header>
  <ion-toolbar>
    <div class="container">
      <div class="head">
        <div class="head__expand">
          <button class="head__button" type="button" (click)="navigateBack()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd" d="M16.1862 19.7188C16.6046 19.3439 16.6046 18.7361 16.1862 18.3612L9.08666 12L16.1862 5.63882C16.6046 5.26392 16.6046 4.65608 16.1862 4.28118C15.7678 3.90627 15.0894 3.90627 14.671 4.28118L6.81381 11.3212C6.3954 11.6961 6.3954 12.3039 6.81381 12.6788L14.671 19.7188C15.0894 20.0937 15.7678 20.0937 16.1862 19.7188Z" fill="#1B1B1F"/>
            </svg>
          </button>
        </div>
        <div class="head__title" *ngIf="!currentAffiliate">{t}Выберите город{/t}</div>
        <div class="head__title" *ngIf="currentAffiliate" [innerHTML]="currentAffiliate.title"></div>
        <div class="head__expand_right"></div>
      </div>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div id="affiliate-page" class="content_wrapper">
    <div class="content">
      <div class="map-info" *ngIf="inLoading">
        <app-affiliate-skeleton></app-affiliate-skeleton>
      </div>
      <div class="map-info" *ngIf="!inLoading">
        <div>
          <h4>{t}Город{/t}</h4>
          <div class="margin-24-bottom">
            <select class="form-select" *ngIf="affiliatesList && affiliatesList.length > 0" (change)="selectAffiliate($event)">
              <option
                      [value]="affiliate.id"
                      *ngFor="let affiliate of affiliatesList"
                      [innerHTML]="affiliate.title"
                      [attr.selected]="selectedAffiliate && selectedAffiliate.id == affiliate.id ? '' : null"
              ></option>
            </select>
          </div>
          <button type="button" class="button button_primary w-100 margin-24-bottom" (click)="setAffiliate()">{t}Выбрать{/t} <span [innerHTML]="selectedAffiliate.title"></span></button>
          <div *ngIf="selectedAffiliate && linkedWarehouses && linkedWarehouses.length > 0">
            <div class="margin-24-bottom">
              <div class="fw-medium c-primary fz-18"><b>{t}Список пунктов выдачи{/t}</b> {t}в{/t} <span [innerHTML]="selectedAffiliate.title"></span></div>
            </div>
            <div>
              <div class="point-item" *ngFor="let warehouse of linkedWarehouses">
                <div>
                  <div class="d-flex fw-bold margin-24-bottom" *ngIf="warehouse.adress || warehouse.title">
                    <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9.9997 0.833252C5.03226 0.833252 1.82507 6.01084 4.0539 10.3404L7.47493 17.5821C8.4736 19.6963 11.5273 19.6932 12.5245 17.5821L15.9456 10.3403C18.1735 6.0125 14.9694 0.833252 9.9997 0.833252V0.833252ZM14.8966 9.82756C14.8898 9.84081 15.0515 9.49885 11.4623 17.0966C10.8829 18.3229 9.1171 18.3241 8.53718 17.0966C4.9615 9.52751 5.11 9.84145 5.1029 9.82763C3.27577 6.29224 5.87141 1.98535 9.9997 1.98535C14.1256 1.98535 16.7249 6.28943 14.8966 9.82756Z" />
                      <path d="M10.0003 4.16675C8.16233 4.16675 6.66699 5.66209 6.66699 7.50008C6.66699 9.33808 8.16233 10.8334 10.0003 10.8334C11.8383 10.8334 13.3337 9.33808 13.3337 7.50008C13.3337 5.66209 11.8384 4.16675 10.0003 4.16675ZM10.0003 9.63364C8.82387 9.63364 7.8668 8.67657 7.8668 7.50012C7.8668 6.32367 8.82387 5.3666 10.0003 5.3666C11.1768 5.3666 12.1338 6.32367 12.1338 7.50012C12.1338 8.67657 11.1768 9.63364 10.0003 9.63364Z" />
                    </svg>
                    <span class="margin-8-left" *ngIf="warehouse.adress" [innerHTML]="warehouse.adress"></span>
                    <span class="margin-8-left" *ngIf="!warehouse.adress && warehouse.title" [innerHTML]="warehouse.title"></span>
                  </div>
                  <div class="d-flex margin-16-bottom" *ngIf="warehouse.workTime">
                    <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9.99967 0.833252C4.9453 0.833252 0.833008 4.94533 0.833008 9.99992C0.833008 15.0545 4.9453 19.1666 9.99967 19.1666C15.0543 19.1666 19.1663 15.0545 19.1663 9.99992C19.1663 4.94533 15.0541 0.833252 9.99967 0.833252ZM9.99967 17.8284C5.6831 17.8284 2.1712 14.3165 2.1712 9.99992C2.1712 5.68335 5.6831 2.17144 9.99967 2.17144C14.3162 2.17144 17.8281 5.68331 17.8281 9.9997C17.8281 14.3165 14.3162 17.8284 9.99967 17.8284Z" />
                      <path d="M13.1224 9.99986H10.223V5.98526C10.223 5.61569 9.92343 5.31616 9.55386 5.31616C9.18429 5.31616 8.88477 5.61569 8.88477 5.98526V10.669C8.88477 11.0385 9.18429 11.3381 9.55386 11.3381H13.1224C13.4919 11.3381 13.7915 11.0385 13.7915 10.669C13.7915 10.2994 13.4919 9.99986 13.1224 9.99986Z" />
                    </svg>
                    <span class="margin-8-left" [innerHTML]="warehouse.workTime"></span>
                  </div>
                  <div class="d-flex fw-bold" *ngIf="warehouse.phone">
                    <svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                      <path d="M15.9817 11.7285C15.5998 11.3307 15.139 11.1181 14.6508 11.1181C14.1664 11.1181 13.7018 11.3268 13.304 11.7245L12.0597 12.9649C11.9573 12.9098 11.8549 12.8586 11.7565 12.8074C11.6147 12.7365 11.4808 12.6696 11.3666 12.5987C10.2011 11.8584 9.14179 10.8937 8.12584 9.64537C7.63361 9.0232 7.30284 8.49947 7.06263 7.96787C7.38553 7.67254 7.6848 7.36539 7.9762 7.07006C8.08646 6.9598 8.19672 6.8456 8.30698 6.73534C9.13391 5.90841 9.13391 4.83733 8.30698 4.01039L7.23196 2.93537C7.10989 2.8133 6.98388 2.68729 6.86574 2.56128C6.62948 2.31714 6.3814 2.06512 6.12544 1.82886C5.74347 1.45083 5.28669 1.25 4.80628 1.25C4.32587 1.25 3.86121 1.45083 3.46743 1.82886C3.46349 1.83279 3.46349 1.83279 3.45955 1.83673L2.1207 3.18739C1.61667 3.69143 1.32921 4.30573 1.2662 5.01847C1.1717 6.1683 1.51035 7.23938 1.77024 7.94031C2.40816 9.66112 3.36111 11.2559 4.78265 12.9649C6.5074 15.0244 8.58262 16.6507 10.9532 17.7966C11.8589 18.2258 13.0678 18.7338 14.4184 18.8204C14.5011 18.8244 14.5878 18.8283 14.6665 18.8283C15.5761 18.8283 16.3401 18.5015 16.9386 17.8517C16.9426 17.8439 16.9504 17.8399 16.9544 17.832C17.1591 17.584 17.3954 17.3595 17.6435 17.1193C17.8128 16.9578 17.9861 16.7885 18.1554 16.6113C18.5452 16.2057 18.75 15.7332 18.75 15.2488C18.75 14.7606 18.5413 14.292 18.1436 13.8982L15.9817 11.7285ZM17.3915 15.875C17.3875 15.875 17.3875 15.8789 17.3915 15.875C17.2379 16.0403 17.0804 16.19 16.9111 16.3554C16.6551 16.5995 16.3952 16.8555 16.1511 17.1429C15.7533 17.5682 15.2847 17.769 14.6704 17.769C14.6114 17.769 14.5484 17.769 14.4893 17.7651C13.3198 17.6903 12.233 17.2335 11.4178 16.8437C9.18904 15.7647 7.23196 14.2329 5.60565 12.2916C4.26286 10.6731 3.36505 9.17677 2.77044 7.57016C2.40423 6.58964 2.27034 5.82571 2.32941 5.1051C2.36879 4.64438 2.54599 4.26241 2.87282 3.93557L4.21561 2.59279C4.40856 2.41165 4.61333 2.3132 4.81415 2.3132C5.06224 2.3132 5.26306 2.46284 5.38907 2.58885C5.39301 2.59279 5.39695 2.59672 5.40089 2.60066C5.64109 2.82512 5.86948 3.05745 6.10969 3.30553C6.23176 3.43154 6.35777 3.55755 6.48378 3.68749L7.55879 4.76251C7.9762 5.17992 7.9762 5.56582 7.55879 5.98323C7.4446 6.09742 7.33434 6.21162 7.22014 6.32187C6.88937 6.66052 6.57435 6.97555 6.23176 7.2827C6.22388 7.29057 6.21601 7.29451 6.21207 7.30238C5.87342 7.64104 5.93642 7.97181 6.00731 8.19626C6.01124 8.20808 6.01518 8.21989 6.01912 8.2317C6.2987 8.909 6.69248 9.54693 7.29103 10.3069L7.29496 10.3109C8.38179 11.6497 9.52769 12.6932 10.7917 13.4926C10.9532 13.595 11.1186 13.6777 11.2761 13.7564C11.4178 13.8273 11.5517 13.8942 11.6659 13.9651C11.6817 13.973 11.6974 13.9848 11.7132 13.9927C11.8471 14.0596 11.9731 14.0911 12.103 14.0911C12.4298 14.0911 12.6346 13.8864 12.7016 13.8194L14.0483 12.4727C14.1822 12.3388 14.3948 12.1774 14.6429 12.1774C14.887 12.1774 15.0879 12.3309 15.2099 12.4648C15.2139 12.4688 15.2139 12.4688 15.2178 12.4727L17.3875 14.6424C17.7931 15.0441 17.7931 15.4576 17.3915 15.875Z" />
                    </svg>
                    <a href="tel:{ { warehouse.normalizedPhone } }" class="margin-8-left" [innerHTML]="warehouse.phone"></a>
                  </div>
                </div>
                <button type="button" class="point-item__on-the-map" (click)="showWarehouseInformation(warehouse)">
                 <span class="point-item__on-the-map-txt">
                  {t}Подробнее{/t}
                </span>
                  <svg width="10" height="14" viewBox="0 0 10 14" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5.00002 0C1.27444 0 -1.13095 3.9538 0.54067 7.26002L3.10644 12.7901C3.85544 14.4045 6.14572 14.4021 6.89362 12.7901L9.45942 7.25996C11.1304 3.95506 8.72727 0 5.00002 0ZM8.67273 6.86838C8.66756 6.8785 8.78888 6.61737 6.09696 12.4193C5.66243 13.3558 4.33807 13.3566 3.90313 12.4193C1.22137 6.63925 1.33275 6.87899 1.32742 6.86843C-0.042929 4.16868 1.9038 0.879782 5.00002 0.879782C8.09448 0.879782 10.0439 4.16654 8.67273 6.86838Z" />
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M8.67273 6.86838C8.66756 6.8785 8.78888 6.61737 6.09696 12.4193C5.66243 13.3558 4.33807 13.3566 3.90313 12.4193C1.22137 6.63925 1.33275 6.87899 1.32742 6.86843C-0.042929 4.16868 1.9038 0.879782 5.00002 0.879782C8.09448 0.879782 10.0439 4.16654 8.67273 6.86838ZM2.5 5.09091C2.5 3.68735 3.6215 2.54545 5 2.54545C6.37853 2.54545 7.5 3.68735 7.5 5.09091C7.5 6.49447 6.3785 7.63637 5 7.63637C3.6215 7.63637 2.5 6.49447 2.5 5.09091Z" />
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="map" *ngIf="!inLoading">
        <div class="map-container">
          <ya-map
                  [center]="mapCenter"
                  [zoom]="4"
                  (ready)="onMapReady($event)"
                  *ngIf="coords && coords.length"
          >
            <ya-placemark [geometry]="coord" *ngFor="let coord of coords"></ya-placemark>
          </ya-map>
        </div>
      </div>
    </div>
  </div>
</ion-content>
