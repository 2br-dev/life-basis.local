/**
* Функции для работы с интернационализацией строк ReadyScript в JavaScript
*
* @author ReadyScript lab.
*/
var lang = 
{
    baseLang: (global.baseLang) ? global.baseLang : null, //Язык по умолчанию
    lang: (global.lang) ? global.lang : null, //Текущий язык
    messages: {}, //Список фраз
    plugins: {},    
    /**
    * Возвращает перевод фразы на текущем языке
    * 
    * @param string phrase - фраза для перевода
    * @param object params - объект для подстановки значений
    * @param alias - короткий идентификатор фразы
    * @example 
    * lang.t('У вас %msg сообщений', {msg: 35})
    * lang.t('У вас %msg сообщений. Далее большой текст', {msg: 35}, 'короткий_идентификатор_фразы')
    */
    t: function(phrase, params, alias) {
        var self = this;
        var to_translate = (typeof(alias) == 'undefined') ? phrase : alias;
        var translated = this.messages[to_translate];
        if (translated) {
            phrase = translated;
        }

        phrase = phrase.replace(/\[(.*?):%(.*?):(.*?)\]/g, function(whole, plugin, param_name, plugin_param) {
            if (self.plugins[plugin]) {
                var param_value = (params[param_name]) ? params[param_name] : null;
                var phrase_lang = (translated) ? self.lang : self.baseLang;
                return self.plugins[plugin].call(self, param_value, plugin_param, params, phrase_lang);
            }
            return '';
        })
        
        for(var key in params) {
            phrase = this.str_replace('%'+key, params[key], phrase);
        }
        
        phrase = phrase.split('^')[0];
        return phrase;
    },
    /**
    * Replaces all occurrences of search in haystack with replace  
    * version: 1109.2015
    * discuss at: http://phpjs.org/functions/str_replace    
    * 
    * @param search
    * @param replace
    * @param subject
    * @param count
    */
    str_replace: function(search, replace, subject, count) {
        
            j = 0,
            temp = '',
            repl = '',
            sl = 0,        fl = 0,
            f = [].concat(search),
            r = [].concat(replace),
            s = subject,
            ra = Object.prototype.toString.call(r) === '[object Array]',        
            sa = Object.prototype.toString.call(s) === '[object Array]';
        s = [].concat(s);
        if (count) {
            this.window[count] = 0;
        } 
        for (i = 0, sl = s.length; i < sl; i++) {
            if (s[i] === '') {
                continue;
            }        for (j = 0, fl = f.length; j < fl; j++) {
                temp = s[i] + '';
                repl = ra ? (r[j] !== undefined ? r[j] : '') : r[0];
                s[i] = (temp).split(f[j]).join(repl);
                if (count && s[i] !== temp) {
                    this.window[count] += (temp.length - s[i].length) / f[j].length;
                }
            }
        }
        return sa ? s : s[0];
    }
};

/**
* Плагин plural - подставляет слово во множественном числе с учетом словоформы.
* Пример испльзования во фразе: 
* lang.t("У вас %msg [plural:%msg:сообщение|сообщения|сообщений]", {msg: 1}); 
* lang.t("У вас %msg [plural:%msg:сообщение|сообщения|сообщений]", {msg: 2});
* lang.t("У вас %msg [plural:%msg:сообщение|сообщения|сообщений]", {msg: 5});
* lang.t("You have %msg [plural:%msg:message|messages]", {msg: 1}); //Если текущий язык английский
* lang.t("You have %msg [plural:%msg:message|messages]", {msg: 2}); //Если текущий язык английский
* 
* вывод:
* У Вас 1 сообщение
* У Вас 2 сообщения
* У Вас 5 сообщений
* You have 1 message
* You have 2 messages
* 
* @type Object
*/
lang.plugins.plural = function(param_value, plugin_param, params, phrase_lang) {
    var values = plugin_param.split('|');
    if (phrase_lang == 'ru') {
        var result;
        var first = values[0];
        var second = values[1];
        var five = values[2];
        
        var prepare = Math.abs( parseInt( param_value ) );
        if( prepare != 0 ) 
        {
            if( ( prepare - prepare % 10 ) / 10 == 1 ) {
                result = five;
            } else {
                prepare = prepare % 10;
                if( prepare == 1 ) {
                    result = first;
                } else if( prepare > 1 && prepare < 5 ) {
                    result = second;
                } else {
                    result = five;
                }
            }
        }
        else {
            result = five;
        }
    } else if (lang == 'en') {
        result = (param_value == 1) ? $values[0] : $values[1];
    } else {
        result = values[0];
    }
    return result;
};
/*!
 * jQuery JavaScript Library v2.2.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2016-04-05T19:26Z
 */

(function( global, factory ) {

    if ( typeof module === "object" && typeof module.exports === "object" ) {
        // For CommonJS and CommonJS-like environments where a proper `window`
        // is present, execute the factory and get jQuery.
        // For environments that do not have a `window` with a `document`
        // (such as Node.js), expose a factory as module.exports.
        // This accentuates the need for the creation of a real `window`.
        // e.g. var jQuery = require("jquery")(window);
        // See ticket #14549 for more info.
        module.exports = global.document ?
            factory( global, true ) :
            function( w ) {
                if ( !w.document ) {
                    throw new Error( "jQuery requires a window with a document" );
                }
                return factory( w );
            };
    } else {
        factory( global );
    }

// Pass this if window is not defined yet
}(typeof window !== "undefined" ? window : this, function( window, noGlobal ) {

// Support: Firefox 18+
// Can't be in strict mode, several libs including ASP.NET trace
// the stack via arguments.caller.callee and Firefox dies if
// you try to trace through "use strict" call chains. (#13335)
//"use strict";
    var arr = [];

    var document = window.document;

    var slice = arr.slice;

    var concat = arr.concat;

    var push = arr.push;

    var indexOf = arr.indexOf;

    var class2type = {};

    var toString = class2type.toString;

    var hasOwn = class2type.hasOwnProperty;

    var support = {};



    var
        version = "2.2.3",

        // Define a local copy of jQuery
        jQuery = function( selector, context ) {

            // The jQuery object is actually just the init constructor 'enhanced'
            // Need init if jQuery is called (just allow error to be thrown if not included)
            return new jQuery.fn.init( selector, context );
        },

        // Support: Android<4.1
        // Make sure we trim BOM and NBSP
        rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,

        // Matches dashed string for camelizing
        rmsPrefix = /^-ms-/,
        rdashAlpha = /-([\da-z])/gi,

        // Used by jQuery.camelCase as callback to replace()
        fcamelCase = function( all, letter ) {
            return letter.toUpperCase();
        };

    jQuery.fn = jQuery.prototype = {

        // The current version of jQuery being used
        jquery: version,

        constructor: jQuery,

        // Start with an empty selector
        selector: "",

        // The default length of a jQuery object is 0
        length: 0,

        toArray: function() {
            return slice.call( this );
        },

        // Get the Nth element in the matched element set OR
        // Get the whole matched element set as a clean array
        get: function( num ) {
            return num != null ?

                // Return just the one element from the set
                ( num < 0 ? this[ num + this.length ] : this[ num ] ) :

                // Return all the elements in a clean array
                slice.call( this );
        },

        // Take an array of elements and push it onto the stack
        // (returning the new matched element set)
        pushStack: function( elems ) {

            // Build a new jQuery matched element set
            var ret = jQuery.merge( this.constructor(), elems );

            // Add the old object onto the stack (as a reference)
            ret.prevObject = this;
            ret.context = this.context;

            // Return the newly-formed element set
            return ret;
        },

        // Execute a callback for every element in the matched set.
        each: function( callback ) {
            return jQuery.each( this, callback );
        },

        map: function( callback ) {
            return this.pushStack( jQuery.map( this, function( elem, i ) {
                return callback.call( elem, i, elem );
            } ) );
        },

        slice: function() {
            return this.pushStack( slice.apply( this, arguments ) );
        },

        first: function() {
            return this.eq( 0 );
        },

        last: function() {
            return this.eq( -1 );
        },

        eq: function( i ) {
            var len = this.length,
                j = +i + ( i < 0 ? len : 0 );
            return this.pushStack( j >= 0 && j < len ? [ this[ j ] ] : [] );
        },

        end: function() {
            return this.prevObject || this.constructor();
        },

        // For internal use only.
        // Behaves like an Array's method, not like a jQuery method.
        push: push,
        sort: arr.sort,
        splice: arr.splice
    };

    jQuery.extend = jQuery.fn.extend = function() {
        var options, name, src, copy, copyIsArray, clone,
            target = arguments[ 0 ] || {},
            i = 1,
            length = arguments.length,
            deep = false;

        // Handle a deep copy situation
        if ( typeof target === "boolean" ) {
            deep = target;

            // Skip the boolean and the target
            target = arguments[ i ] || {};
            i++;
        }

        // Handle case when target is a string or something (possible in deep copy)
        if ( typeof target !== "object" && !jQuery.isFunction( target ) ) {
            target = {};
        }

        // Extend jQuery itself if only one argument is passed
        if ( i === length ) {
            target = this;
            i--;
        }

        for ( ; i < length; i++ ) {

            // Only deal with non-null/undefined values
            if ( ( options = arguments[ i ] ) != null ) {

                // Extend the base object
                for ( name in options ) {
                    src = target[ name ];
                    copy = options[ name ];

                    // Prevent never-ending loop
                    if ( target === copy ) {
                        continue;
                    }

                    // Recurse if we're merging plain objects or arrays
                    if ( deep && copy && ( jQuery.isPlainObject( copy ) ||
                        ( copyIsArray = jQuery.isArray( copy ) ) ) ) {

                        if ( copyIsArray ) {
                            copyIsArray = false;
                            clone = src && jQuery.isArray( src ) ? src : [];

                        } else {
                            clone = src && jQuery.isPlainObject( src ) ? src : {};
                        }

                        // Never move original objects, clone them
                        target[ name ] = jQuery.extend( deep, clone, copy );

                        // Don't bring in undefined values
                    } else if ( copy !== undefined ) {
                        target[ name ] = copy;
                    }
                }
            }
        }

        // Return the modified object
        return target;
    };

    jQuery.extend( {

        // Unique for each copy of jQuery on the page
        expando: "jQuery" + ( version + Math.random() ).replace( /\D/g, "" ),

        // Assume jQuery is ready without the ready module
        isReady: true,

        error: function( msg ) {
            throw new Error( msg );
        },

        noop: function() {},

        isFunction: function( obj ) {
            return jQuery.type( obj ) === "function";
        },

        isArray: Array.isArray,

        isWindow: function( obj ) {
            return obj != null && obj === obj.window;
        },

        isNumeric: function( obj ) {

            // parseFloat NaNs numeric-cast false positives (null|true|false|"")
            // ...but misinterprets leading-number strings, particularly hex literals ("0x...")
            // subtraction forces infinities to NaN
            // adding 1 corrects loss of precision from parseFloat (#15100)
            var realStringObj = obj && obj.toString();
            return !jQuery.isArray( obj ) && ( realStringObj - parseFloat( realStringObj ) + 1 ) >= 0;
        },

        isPlainObject: function( obj ) {
            var key;

            // Not plain objects:
            // - Any object or value whose internal [[Class]] property is not "[object Object]"
            // - DOM nodes
            // - window
            if ( jQuery.type( obj ) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {
                return false;
            }

            // Not own constructor property must be Object
            if ( obj.constructor &&
                !hasOwn.call( obj, "constructor" ) &&
                !hasOwn.call( obj.constructor.prototype || {}, "isPrototypeOf" ) ) {
                return false;
            }

            // Own properties are enumerated firstly, so to speed up,
            // if last one is own, then all properties are own
            for ( key in obj ) {}

            return key === undefined || hasOwn.call( obj, key );
        },

        isEmptyObject: function( obj ) {
            var name;
            for ( name in obj ) {
                return false;
            }
            return true;
        },

        type: function( obj ) {
            if ( obj == null ) {
                return obj + "";
            }

            // Support: Android<4.0, iOS<6 (functionish RegExp)
            return typeof obj === "object" || typeof obj === "function" ?
                class2type[ toString.call( obj ) ] || "object" :
                typeof obj;
        },

        // Evaluates a script in a global context
        globalEval: function( code ) {
            var script,
                indirect = eval;

            code = jQuery.trim( code );

            if ( code ) {

                // If the code includes a valid, prologue position
                // strict mode pragma, execute code by injecting a
                // script tag into the document.
                if ( code.indexOf( "use strict" ) === 1 ) {
                    script = document.createElement( "script" );
                    script.text = code;
                    document.head.appendChild( script ).parentNode.removeChild( script );
                } else {

                    // Otherwise, avoid the DOM node creation, insertion
                    // and removal by using an indirect global eval

                    indirect( code );
                }
            }
        },

        // Convert dashed to camelCase; used by the css and data modules
        // Support: IE9-11+
        // Microsoft forgot to hump their vendor prefix (#9572)
        camelCase: function( string ) {
            return string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );
        },

        nodeName: function( elem, name ) {
            return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();
        },

        each: function( obj, callback ) {
            var length, i = 0;

            if ( isArrayLike( obj ) ) {
                length = obj.length;
                for ( ; i < length; i++ ) {
                    if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {
                        break;
                    }
                }
            } else {
                for ( i in obj ) {
                    if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {
                        break;
                    }
                }
            }

            return obj;
        },

        // Support: Android<4.1
        trim: function( text ) {
            return text == null ?
                "" :
                ( text + "" ).replace( rtrim, "" );
        },

        // results is for internal usage only
        makeArray: function( arr, results ) {
            var ret = results || [];

            if ( arr != null ) {
                if ( isArrayLike( Object( arr ) ) ) {
                    jQuery.merge( ret,
                        typeof arr === "string" ?
                            [ arr ] : arr
                    );
                } else {
                    push.call( ret, arr );
                }
            }

            return ret;
        },

        inArray: function( elem, arr, i ) {
            return arr == null ? -1 : indexOf.call( arr, elem, i );
        },

        merge: function( first, second ) {
            var len = +second.length,
                j = 0,
                i = first.length;

            for ( ; j < len; j++ ) {
                first[ i++ ] = second[ j ];
            }

            first.length = i;

            return first;
        },

        grep: function( elems, callback, invert ) {
            var callbackInverse,
                matches = [],
                i = 0,
                length = elems.length,
                callbackExpect = !invert;

            // Go through the array, only saving the items
            // that pass the validator function
            for ( ; i < length; i++ ) {
                callbackInverse = !callback( elems[ i ], i );
                if ( callbackInverse !== callbackExpect ) {
                    matches.push( elems[ i ] );
                }
            }

            return matches;
        },

        // arg is for internal usage only
        map: function( elems, callback, arg ) {
            var length, value,
                i = 0,
                ret = [];

            // Go through the array, translating each of the items to their new values
            if ( isArrayLike( elems ) ) {
                length = elems.length;
                for ( ; i < length; i++ ) {
                    value = callback( elems[ i ], i, arg );

                    if ( value != null ) {
                        ret.push( value );
                    }
                }

                // Go through every key on the object,
            } else {
                for ( i in elems ) {
                    value = callback( elems[ i ], i, arg );

                    if ( value != null ) {
                        ret.push( value );
                    }
                }
            }

            // Flatten any nested arrays
            return concat.apply( [], ret );
        },

        // A global GUID counter for objects
        guid: 1,

        // Bind a function to a context, optionally partially applying any
        // arguments.
        proxy: function( fn, context ) {
            var tmp, args, proxy;

            if ( typeof context === "string" ) {
                tmp = fn[ context ];
                context = fn;
                fn = tmp;
            }

            // Quick check to determine if target is callable, in the spec
            // this throws a TypeError, but we will just return undefined.
            if ( !jQuery.isFunction( fn ) ) {
                return undefined;
            }

            // Simulated bind
            args = slice.call( arguments, 2 );
            proxy = function() {
                return fn.apply( context || this, args.concat( slice.call( arguments ) ) );
            };

            // Set the guid of unique handler to the same of original handler, so it can be removed
            proxy.guid = fn.guid = fn.guid || jQuery.guid++;

            return proxy;
        },

        now: Date.now,

        // jQuery.support is not used in Core but other projects attach their
        // properties to it so it needs to exist.
        support: support
    } );

// JSHint would error on this code due to the Symbol not being defined in ES5.
// Defining this global in .jshintrc would create a danger of using the global
// unguarded in another place, it seems safer to just disable JSHint for these
// three lines.
    /* jshint ignore: start */
    if ( typeof Symbol === "function" ) {
        jQuery.fn[ Symbol.iterator ] = arr[ Symbol.iterator ];
    }
    /* jshint ignore: end */

// Populate the class2type map
    jQuery.each( "Boolean Number String Function Array Date RegExp Object Error Symbol".split( " " ),
        function( i, name ) {
            class2type[ "[object " + name + "]" ] = name.toLowerCase();
        } );

    function isArrayLike( obj ) {

        // Support: iOS 8.2 (not reproducible in simulator)
        // `in` check used to prevent JIT error (gh-2145)
        // hasOwn isn't used here due to false negatives
        // regarding Nodelist length in IE
        var length = !!obj && "length" in obj && obj.length,
            type = jQuery.type( obj );

        if ( type === "function" || jQuery.isWindow( obj ) ) {
            return false;
        }

        return type === "array" || length === 0 ||
            typeof length === "number" && length > 0 && ( length - 1 ) in obj;
    }
    var Sizzle =
        /*!
 * Sizzle CSS Selector Engine v2.2.1
 * http://sizzlejs.com/
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2015-10-17
 */
        (function( window ) {

            var i,
                support,
                Expr,
                getText,
                isXML,
                tokenize,
                compile,
                select,
                outermostContext,
                sortInput,
                hasDuplicate,

                // Local document vars
                setDocument,
                document,
                docElem,
                documentIsHTML,
                rbuggyQSA,
                rbuggyMatches,
                matches,
                contains,

                // Instance-specific data
                expando = "sizzle" + 1 * new Date(),
                preferredDoc = window.document,
                dirruns = 0,
                done = 0,
                classCache = createCache(),
                tokenCache = createCache(),
                compilerCache = createCache(),
                sortOrder = function( a, b ) {
                    if ( a === b ) {
                        hasDuplicate = true;
                    }
                    return 0;
                },

                // General-purpose constants
                MAX_NEGATIVE = 1 << 31,

                // Instance methods
                hasOwn = ({}).hasOwnProperty,
                arr = [],
                pop = arr.pop,
                push_native = arr.push,
                push = arr.push,
                slice = arr.slice,
                // Use a stripped-down indexOf as it's faster than native
                // http://jsperf.com/thor-indexof-vs-for/5
                indexOf = function( list, elem ) {
                    var i = 0,
                        len = list.length;
                    for ( ; i < len; i++ ) {
                        if ( list[i] === elem ) {
                            return i;
                        }
                    }
                    return -1;
                },

                booleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",

                // Regular expressions

                // http://www.w3.org/TR/css3-selectors/#whitespace
                whitespace = "[\\x20\\t\\r\\n\\f]",

                // http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier
                identifier = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",

                // Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors
                attributes = "\\[" + whitespace + "*(" + identifier + ")(?:" + whitespace +
                    // Operator (capture 2)
                    "*([*^$|!~]?=)" + whitespace +
                    // "Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]"
                    "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + identifier + "))|)" + whitespace +
                    "*\\]",

                pseudos = ":(" + identifier + ")(?:\\((" +
                    // To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:
                    // 1. quoted (capture 3; capture 4 or capture 5)
                    "('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|" +
                    // 2. simple (capture 6)
                    "((?:\\\\.|[^\\\\()[\\]]|" + attributes + ")*)|" +
                    // 3. anything else (capture 2)
                    ".*" +
                    ")\\)|)",

                // Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter
                rwhitespace = new RegExp( whitespace + "+", "g" ),
                rtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\])(?:\\\\.)*)" + whitespace + "+$", "g" ),

                rcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),
                rcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*" ),

                rattributeQuotes = new RegExp( "=" + whitespace + "*([^\\]'\"]*?)" + whitespace + "*\\]", "g" ),

                rpseudo = new RegExp( pseudos ),
                ridentifier = new RegExp( "^" + identifier + "$" ),

                matchExpr = {
                    "ID": new RegExp( "^#(" + identifier + ")" ),
                    "CLASS": new RegExp( "^\\.(" + identifier + ")" ),
                    "TAG": new RegExp( "^(" + identifier + "|[*])" ),
                    "ATTR": new RegExp( "^" + attributes ),
                    "PSEUDO": new RegExp( "^" + pseudos ),
                    "CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + whitespace +
                        "*(even|odd|(([+-]|)(\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace +
                        "*(\\d+)|))" + whitespace + "*\\)|)", "i" ),
                    "bool": new RegExp( "^(?:" + booleans + ")$", "i" ),
                    // For use in libraries implementing .is()
                    // We use this for POS matching in `select`
                    "needsContext": new RegExp( "^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" +
                        whitespace + "*((?:-\\d)?\\d*)" + whitespace + "*\\)|)(?=[^-]|$)", "i" )
                },

                rinputs = /^(?:input|select|textarea|button)$/i,
                rheader = /^h\d$/i,

                rnative = /^[^{]+\{\s*\[native \w/,

                // Easily-parseable/retrievable ID or TAG or CLASS selectors
                rquickExpr = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,

                rsibling = /[+~]/,
                rescape = /'|\\/g,

                // CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters
                runescape = new RegExp( "\\\\([\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig" ),
                funescape = function( _, escaped, escapedWhitespace ) {
                    var high = "0x" + escaped - 0x10000;
                    // NaN means non-codepoint
                    // Support: Firefox<24
                    // Workaround erroneous numeric interpretation of +"0x"
                    return high !== high || escapedWhitespace ?
                        escaped :
                        high < 0 ?
                            // BMP codepoint
                            String.fromCharCode( high + 0x10000 ) :
                            // Supplemental Plane codepoint (surrogate pair)
                            String.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );
                },

                // Used for iframes
                // See setDocument()
                // Removing the function wrapper causes a "Permission Denied"
                // error in IE
                unloadHandler = function() {
                    setDocument();
                };

// Optimize for push.apply( _, NodeList )
            try {
                push.apply(
                    (arr = slice.call( preferredDoc.childNodes )),
                    preferredDoc.childNodes
                );
                // Support: Android<4.0
                // Detect silently failing push.apply
                arr[ preferredDoc.childNodes.length ].nodeType;
            } catch ( e ) {
                push = { apply: arr.length ?

                        // Leverage slice if possible
                        function( target, els ) {
                            push_native.apply( target, slice.call(els) );
                        } :

                        // Support: IE<9
                        // Otherwise append directly
                        function( target, els ) {
                            var j = target.length,
                                i = 0;
                            // Can't trust NodeList.length
                            while ( (target[j++] = els[i++]) ) {}
                            target.length = j - 1;
                        }
                };
            }

            function Sizzle( selector, context, results, seed ) {
                var m, i, elem, nid, nidselect, match, groups, newSelector,
                    newContext = context && context.ownerDocument,

                    // nodeType defaults to 9, since context defaults to document
                    nodeType = context ? context.nodeType : 9;

                results = results || [];

                // Return early from calls with invalid selector or context
                if ( typeof selector !== "string" || !selector ||
                    nodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {

                    return results;
                }

                // Try to shortcut find operations (as opposed to filters) in HTML documents
                if ( !seed ) {

                    if ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {
                        setDocument( context );
                    }
                    context = context || document;

                    if ( documentIsHTML ) {

                        // If the selector is sufficiently simple, try using a "get*By*" DOM method
                        // (excepting DocumentFragment context, where the methods don't exist)
                        if ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {

                            // ID selector
                            if ( (m = match[1]) ) {

                                // Document context
                                if ( nodeType === 9 ) {
                                    if ( (elem = context.getElementById( m )) ) {

                                        // Support: IE, Opera, Webkit
                                        // TODO: identify versions
                                        // getElementById can match elements by name instead of ID
                                        if ( elem.id === m ) {
                                            results.push( elem );
                                            return results;
                                        }
                                    } else {
                                        return results;
                                    }

                                    // Element context
                                } else {

                                    // Support: IE, Opera, Webkit
                                    // TODO: identify versions
                                    // getElementById can match elements by name instead of ID
                                    if ( newContext && (elem = newContext.getElementById( m )) &&
                                        contains( context, elem ) &&
                                        elem.id === m ) {

                                        results.push( elem );
                                        return results;
                                    }
                                }

                                // Type selector
                            } else if ( match[2] ) {
                                push.apply( results, context.getElementsByTagName( selector ) );
                                return results;

                                // Class selector
                            } else if ( (m = match[3]) && support.getElementsByClassName &&
                                context.getElementsByClassName ) {

                                push.apply( results, context.getElementsByClassName( m ) );
                                return results;
                            }
                        }

                        // Take advantage of querySelectorAll
                        if ( support.qsa &&
                            !compilerCache[ selector + " " ] &&
                            (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {

                            if ( nodeType !== 1 ) {
                                newContext = context;
                                newSelector = selector;

                                // qSA looks outside Element context, which is not what we want
                                // Thanks to Andrew Dupont for this workaround technique
                                // Support: IE <=8
                                // Exclude object elements
                            } else if ( context.nodeName.toLowerCase() !== "object" ) {

                                // Capture the context ID, setting it first if necessary
                                if ( (nid = context.getAttribute( "id" )) ) {
                                    nid = nid.replace( rescape, "\\$&" );
                                } else {
                                    context.setAttribute( "id", (nid = expando) );
                                }

                                // Prefix every selector in the list
                                groups = tokenize( selector );
                                i = groups.length;
                                nidselect = ridentifier.test( nid ) ? "#" + nid : "[id='" + nid + "']";
                                while ( i-- ) {
                                    groups[i] = nidselect + " " + toSelector( groups[i] );
                                }
                                newSelector = groups.join( "," );

                                // Expand context for sibling selectors
                                newContext = rsibling.test( selector ) && testContext( context.parentNode ) ||
                                    context;
                            }

                            if ( newSelector ) {
                                try {
                                    push.apply( results,
                                        newContext.querySelectorAll( newSelector )
                                    );
                                    return results;
                                } catch ( qsaError ) {
                                } finally {
                                    if ( nid === expando ) {
                                        context.removeAttribute( "id" );
                                    }
                                }
                            }
                        }
                    }
                }

                // All others
                return select( selector.replace( rtrim, "$1" ), context, results, seed );
            }

            /**
             * Create key-value caches of limited size
             * @returns {function(string, object)} Returns the Object data after storing it on itself with
             *	property name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)
             *	deleting the oldest entry
             */
            function createCache() {
                var keys = [];

                function cache( key, value ) {
                    // Use (key + " ") to avoid collision with native prototype properties (see Issue #157)
                    if ( keys.push( key + " " ) > Expr.cacheLength ) {
                        // Only keep the most recent entries
                        delete cache[ keys.shift() ];
                    }
                    return (cache[ key + " " ] = value);
                }
                return cache;
            }

            /**
             * Mark a function for special use by Sizzle
             * @param {Function} fn The function to mark
             */
            function markFunction( fn ) {
                fn[ expando ] = true;
                return fn;
            }

            /**
             * Support testing using an element
             * @param {Function} fn Passed the created div and expects a boolean result
             */
            function assert( fn ) {
                var div = document.createElement("div");

                try {
                    return !!fn( div );
                } catch (e) {
                    return false;
                } finally {
                    // Remove from its parent by default
                    if ( div.parentNode ) {
                        div.parentNode.removeChild( div );
                    }
                    // release memory in IE
                    div = null;
                }
            }

            /**
             * Adds the same handler for all of the specified attrs
             * @param {String} attrs Pipe-separated list of attributes
             * @param {Function} handler The method that will be applied
             */
            function addHandle( attrs, handler ) {
                var arr = attrs.split("|"),
                    i = arr.length;

                while ( i-- ) {
                    Expr.attrHandle[ arr[i] ] = handler;
                }
            }

            /**
             * Checks document order of two siblings
             * @param {Element} a
             * @param {Element} b
             * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b
             */
            function siblingCheck( a, b ) {
                var cur = b && a,
                    diff = cur && a.nodeType === 1 && b.nodeType === 1 &&
                        ( ~b.sourceIndex || MAX_NEGATIVE ) -
                        ( ~a.sourceIndex || MAX_NEGATIVE );

                // Use IE sourceIndex if available on both nodes
                if ( diff ) {
                    return diff;
                }

                // Check if b follows a
                if ( cur ) {
                    while ( (cur = cur.nextSibling) ) {
                        if ( cur === b ) {
                            return -1;
                        }
                    }
                }

                return a ? 1 : -1;
            }

            /**
             * Returns a function to use in pseudos for input types
             * @param {String} type
             */
            function createInputPseudo( type ) {
                return function( elem ) {
                    var name = elem.nodeName.toLowerCase();
                    return name === "input" && elem.type === type;
                };
            }

            /**
             * Returns a function to use in pseudos for buttons
             * @param {String} type
             */
            function createButtonPseudo( type ) {
                return function( elem ) {
                    var name = elem.nodeName.toLowerCase();
                    return (name === "input" || name === "button") && elem.type === type;
                };
            }

            /**
             * Returns a function to use in pseudos for positionals
             * @param {Function} fn
             */
            function createPositionalPseudo( fn ) {
                return markFunction(function( argument ) {
                    argument = +argument;
                    return markFunction(function( seed, matches ) {
                        var j,
                            matchIndexes = fn( [], seed.length, argument ),
                            i = matchIndexes.length;

                        // Match elements found at the specified indexes
                        while ( i-- ) {
                            if ( seed[ (j = matchIndexes[i]) ] ) {
                                seed[j] = !(matches[j] = seed[j]);
                            }
                        }
                    });
                });
            }

            /**
             * Checks a node for validity as a Sizzle context
             * @param {Element|Object=} context
             * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value
             */
            function testContext( context ) {
                return context && typeof context.getElementsByTagName !== "undefined" && context;
            }

// Expose support vars for convenience
            support = Sizzle.support = {};

            /**
             * Detects XML nodes
             * @param {Element|Object} elem An element or a document
             * @returns {Boolean} True iff elem is a non-HTML XML node
             */
            isXML = Sizzle.isXML = function( elem ) {
                // documentElement is verified for cases where it doesn't yet exist
                // (such as loading iframes in IE - #4833)
                var documentElement = elem && (elem.ownerDocument || elem).documentElement;
                return documentElement ? documentElement.nodeName !== "HTML" : false;
            };

            /**
             * Sets document-related variables once based on the current document
             * @param {Element|Object} [doc] An element or document object to use to set the document
             * @returns {Object} Returns the current document
             */
            setDocument = Sizzle.setDocument = function( node ) {
                var hasCompare, parent,
                    doc = node ? node.ownerDocument || node : preferredDoc;

                // Return early if doc is invalid or already selected
                if ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {
                    return document;
                }

                // Update global variables
                document = doc;
                docElem = document.documentElement;
                documentIsHTML = !isXML( document );

                // Support: IE 9-11, Edge
                // Accessing iframe documents after unload throws "permission denied" errors (jQuery #13936)
                if ( (parent = document.defaultView) && parent.top !== parent ) {
                    // Support: IE 11
                    if ( parent.addEventListener ) {
                        parent.addEventListener( "unload", unloadHandler, false );

                        // Support: IE 9 - 10 only
                    } else if ( parent.attachEvent ) {
                        parent.attachEvent( "onunload", unloadHandler );
                    }
                }

                /* Attributes
	---------------------------------------------------------------------- */

                // Support: IE<8
                // Verify that getAttribute really returns attributes and not properties
                // (excepting IE8 booleans)
                support.attributes = assert(function( div ) {
                    div.className = "i";
                    return !div.getAttribute("className");
                });

                /* getElement(s)By*
	---------------------------------------------------------------------- */

                // Check if getElementsByTagName("*") returns only elements
                support.getElementsByTagName = assert(function( div ) {
                    div.appendChild( document.createComment("") );
                    return !div.getElementsByTagName("*").length;
                });

                // Support: IE<9
                support.getElementsByClassName = rnative.test( document.getElementsByClassName );

                // Support: IE<10
                // Check if getElementById returns elements by name
                // The broken getElementById methods don't pick up programatically-set names,
                // so use a roundabout getElementsByName test
                support.getById = assert(function( div ) {
                    docElem.appendChild( div ).id = expando;
                    return !document.getElementsByName || !document.getElementsByName( expando ).length;
                });

                // ID find and filter
                if ( support.getById ) {
                    Expr.find["ID"] = function( id, context ) {
                        if ( typeof context.getElementById !== "undefined" && documentIsHTML ) {
                            var m = context.getElementById( id );
                            return m ? [ m ] : [];
                        }
                    };
                    Expr.filter["ID"] = function( id ) {
                        var attrId = id.replace( runescape, funescape );
                        return function( elem ) {
                            return elem.getAttribute("id") === attrId;
                        };
                    };
                } else {
                    // Support: IE6/7
                    // getElementById is not reliable as a find shortcut
                    delete Expr.find["ID"];

                    Expr.filter["ID"] =  function( id ) {
                        var attrId = id.replace( runescape, funescape );
                        return function( elem ) {
                            var node = typeof elem.getAttributeNode !== "undefined" &&
                                elem.getAttributeNode("id");
                            return node && node.value === attrId;
                        };
                    };
                }

                // Tag
                Expr.find["TAG"] = support.getElementsByTagName ?
                    function( tag, context ) {
                        if ( typeof context.getElementsByTagName !== "undefined" ) {
                            return context.getElementsByTagName( tag );

                            // DocumentFragment nodes don't have gEBTN
                        } else if ( support.qsa ) {
                            return context.querySelectorAll( tag );
                        }
                    } :

                    function( tag, context ) {
                        var elem,
                            tmp = [],
                            i = 0,
                            // By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too
                            results = context.getElementsByTagName( tag );

                        // Filter out possible comments
                        if ( tag === "*" ) {
                            while ( (elem = results[i++]) ) {
                                if ( elem.nodeType === 1 ) {
                                    tmp.push( elem );
                                }
                            }

                            return tmp;
                        }
                        return results;
                    };

                // Class
                Expr.find["CLASS"] = support.getElementsByClassName && function( className, context ) {
                    if ( typeof context.getElementsByClassName !== "undefined" && documentIsHTML ) {
                        return context.getElementsByClassName( className );
                    }
                };

                /* QSA/matchesSelector
	---------------------------------------------------------------------- */

                // QSA and matchesSelector support

                // matchesSelector(:active) reports false when true (IE9/Opera 11.5)
                rbuggyMatches = [];

                // qSa(:focus) reports false when true (Chrome 21)
                // We allow this because of a bug in IE8/9 that throws an error
                // whenever `document.activeElement` is accessed on an iframe
                // So, we allow :focus to pass through QSA all the time to avoid the IE error
                // See http://bugs.jquery.com/ticket/13378
                rbuggyQSA = [];

                if ( (support.qsa = rnative.test( document.querySelectorAll )) ) {
                    // Build QSA regex
                    // Regex strategy adopted from Diego Perini
                    assert(function( div ) {
                        // Select is set to empty string on purpose
                        // This is to test IE's treatment of not explicitly
                        // setting a boolean content attribute,
                        // since its presence should be enough
                        // http://bugs.jquery.com/ticket/12359
                        docElem.appendChild( div ).innerHTML = "<a id='" + expando + "'></a>" +
                            "<select id='" + expando + "-\r\\' msallowcapture=''>" +
                            "<option selected=''></option></select>";

                        // Support: IE8, Opera 11-12.16
                        // Nothing should be selected when empty strings follow ^= or $= or *=
                        // The test attribute must be unknown in Opera but "safe" for WinRT
                        // http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section
                        if ( div.querySelectorAll("[msallowcapture^='']").length ) {
                            rbuggyQSA.push( "[*^$]=" + whitespace + "*(?:''|\"\")" );
                        }

                        // Support: IE8
                        // Boolean attributes and "value" are not treated correctly
                        if ( !div.querySelectorAll("[selected]").length ) {
                            rbuggyQSA.push( "\\[" + whitespace + "*(?:value|" + booleans + ")" );
                        }

                        // Support: Chrome<29, Android<4.4, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.8+
                        if ( !div.querySelectorAll( "[id~=" + expando + "-]" ).length ) {
                            rbuggyQSA.push("~=");
                        }

                        // Webkit/Opera - :checked should return selected option elements
                        // http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
                        // IE8 throws error here and will not see later tests
                        if ( !div.querySelectorAll(":checked").length ) {
                            rbuggyQSA.push(":checked");
                        }

                        // Support: Safari 8+, iOS 8+
                        // https://bugs.webkit.org/show_bug.cgi?id=136851
                        // In-page `selector#id sibing-combinator selector` fails
                        if ( !div.querySelectorAll( "a#" + expando + "+*" ).length ) {
                            rbuggyQSA.push(".#.+[+~]");
                        }
                    });

                    assert(function( div ) {
                        // Support: Windows 8 Native Apps
                        // The type and name attributes are restricted during .innerHTML assignment
                        var input = document.createElement("input");
                        input.setAttribute( "type", "hidden" );
                        div.appendChild( input ).setAttribute( "name", "D" );

                        // Support: IE8
                        // Enforce case-sensitivity of name attribute
                        if ( div.querySelectorAll("[name=d]").length ) {
                            rbuggyQSA.push( "name" + whitespace + "*[*^$|!~]?=" );
                        }

                        // FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)
                        // IE8 throws error here and will not see later tests
                        if ( !div.querySelectorAll(":enabled").length ) {
                            rbuggyQSA.push( ":enabled", ":disabled" );
                        }

                        // Opera 10-11 does not throw on post-comma invalid pseudos
                        div.querySelectorAll("*,:x");
                        rbuggyQSA.push(",.*:");
                    });
                }

                if ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||
                    docElem.webkitMatchesSelector ||
                    docElem.mozMatchesSelector ||
                    docElem.oMatchesSelector ||
                    docElem.msMatchesSelector) )) ) {

                    assert(function( div ) {
                        // Check to see if it's possible to do matchesSelector
                        // on a disconnected node (IE 9)
                        support.disconnectedMatch = matches.call( div, "div" );

                        // This should fail with an exception
                        // Gecko does not error, returns false instead
                        matches.call( div, "[s!='']:x" );
                        rbuggyMatches.push( "!=", pseudos );
                    });
                }

                rbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join("|") );
                rbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join("|") );

                /* Contains
	---------------------------------------------------------------------- */
                hasCompare = rnative.test( docElem.compareDocumentPosition );

                // Element contains another
                // Purposefully self-exclusive
                // As in, an element does not contain itself
                contains = hasCompare || rnative.test( docElem.contains ) ?
                    function( a, b ) {
                        var adown = a.nodeType === 9 ? a.documentElement : a,
                            bup = b && b.parentNode;
                        return a === bup || !!( bup && bup.nodeType === 1 && (
                            adown.contains ?
                                adown.contains( bup ) :
                                a.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16
                        ));
                    } :
                    function( a, b ) {
                        if ( b ) {
                            while ( (b = b.parentNode) ) {
                                if ( b === a ) {
                                    return true;
                                }
                            }
                        }
                        return false;
                    };

                /* Sorting
	---------------------------------------------------------------------- */

                // Document order sorting
                sortOrder = hasCompare ?
                    function( a, b ) {

                        // Flag for duplicate removal
                        if ( a === b ) {
                            hasDuplicate = true;
                            return 0;
                        }

                        // Sort on method existence if only one input has compareDocumentPosition
                        var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;
                        if ( compare ) {
                            return compare;
                        }

                        // Calculate position if both inputs belong to the same document
                        compare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?
                            a.compareDocumentPosition( b ) :

                            // Otherwise we know they are disconnected
                            1;

                        // Disconnected nodes
                        if ( compare & 1 ||
                            (!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {

                            // Choose the first element that is related to our preferred document
                            if ( a === document || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {
                                return -1;
                            }
                            if ( b === document || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {
                                return 1;
                            }

                            // Maintain original order
                            return sortInput ?
                                ( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
                                0;
                        }

                        return compare & 4 ? -1 : 1;
                    } :
                    function( a, b ) {
                        // Exit early if the nodes are identical
                        if ( a === b ) {
                            hasDuplicate = true;
                            return 0;
                        }

                        var cur,
                            i = 0,
                            aup = a.parentNode,
                            bup = b.parentNode,
                            ap = [ a ],
                            bp = [ b ];

                        // Parentless nodes are either documents or disconnected
                        if ( !aup || !bup ) {
                            return a === document ? -1 :
                                b === document ? 1 :
                                    aup ? -1 :
                                        bup ? 1 :
                                            sortInput ?
                                                ( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :
                                                0;

                            // If the nodes are siblings, we can do a quick check
                        } else if ( aup === bup ) {
                            return siblingCheck( a, b );
                        }

                        // Otherwise we need full lists of their ancestors for comparison
                        cur = a;
                        while ( (cur = cur.parentNode) ) {
                            ap.unshift( cur );
                        }
                        cur = b;
                        while ( (cur = cur.parentNode) ) {
                            bp.unshift( cur );
                        }

                        // Walk down the tree looking for a discrepancy
                        while ( ap[i] === bp[i] ) {
                            i++;
                        }

                        return i ?
                            // Do a sibling check if the nodes have a common ancestor
                            siblingCheck( ap[i], bp[i] ) :

                            // Otherwise nodes in our document sort first
                            ap[i] === preferredDoc ? -1 :
                                bp[i] === preferredDoc ? 1 :
                                    0;
                    };

                return document;
            };

            Sizzle.matches = function( expr, elements ) {
                return Sizzle( expr, null, null, elements );
            };

            Sizzle.matchesSelector = function( elem, expr ) {
                // Set document vars if needed
                if ( ( elem.ownerDocument || elem ) !== document ) {
                    setDocument( elem );
                }

                // Make sure that attribute selectors are quoted
                expr = expr.replace( rattributeQuotes, "='$1']" );

                if ( support.matchesSelector && documentIsHTML &&
                    !compilerCache[ expr + " " ] &&
                    ( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&
                    ( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {

                    try {
                        var ret = matches.call( elem, expr );

                        // IE 9's matchesSelector returns false on disconnected nodes
                        if ( ret || support.disconnectedMatch ||
                            // As well, disconnected nodes are said to be in a document
                            // fragment in IE 9
                            elem.document && elem.document.nodeType !== 11 ) {
                            return ret;
                        }
                    } catch (e) {}
                }

                return Sizzle( expr, document, null, [ elem ] ).length > 0;
            };

            Sizzle.contains = function( context, elem ) {
                // Set document vars if needed
                if ( ( context.ownerDocument || context ) !== document ) {
                    setDocument( context );
                }
                return contains( context, elem );
            };

            Sizzle.attr = function( elem, name ) {
                // Set document vars if needed
                if ( ( elem.ownerDocument || elem ) !== document ) {
                    setDocument( elem );
                }

                var fn = Expr.attrHandle[ name.toLowerCase() ],
                    // Don't get fooled by Object.prototype properties (jQuery #13807)
                    val = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?
                        fn( elem, name, !documentIsHTML ) :
                        undefined;

                return val !== undefined ?
                    val :
                    support.attributes || !documentIsHTML ?
                        elem.getAttribute( name ) :
                        (val = elem.getAttributeNode(name)) && val.specified ?
                            val.value :
                            null;
            };

            Sizzle.error = function( msg ) {
                throw new Error( "Syntax error, unrecognized expression: " + msg );
            };

            /**
             * Document sorting and removing duplicates
             * @param {ArrayLike} results
             */
            Sizzle.uniqueSort = function( results ) {
                var elem,
                    duplicates = [],
                    j = 0,
                    i = 0;

                // Unless we *know* we can detect duplicates, assume their presence
                hasDuplicate = !support.detectDuplicates;
                sortInput = !support.sortStable && results.slice( 0 );
                results.sort( sortOrder );

                if ( hasDuplicate ) {
                    while ( (elem = results[i++]) ) {
                        if ( elem === results[ i ] ) {
                            j = duplicates.push( i );
                        }
                    }
                    while ( j-- ) {
                        results.splice( duplicates[ j ], 1 );
                    }
                }

                // Clear input after sorting to release objects
                // See https://github.com/jquery/sizzle/pull/225
                sortInput = null;

                return results;
            };

            /**
             * Utility function for retrieving the text value of an array of DOM nodes
             * @param {Array|Element} elem
             */
            getText = Sizzle.getText = function( elem ) {
                var node,
                    ret = "",
                    i = 0,
                    nodeType = elem.nodeType;

                if ( !nodeType ) {
                    // If no nodeType, this is expected to be an array
                    while ( (node = elem[i++]) ) {
                        // Do not traverse comment nodes
                        ret += getText( node );
                    }
                } else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {
                    // Use textContent for elements
                    // innerText usage removed for consistency of new lines (jQuery #11153)
                    if ( typeof elem.textContent === "string" ) {
                        return elem.textContent;
                    } else {
                        // Traverse its children
                        for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
                            ret += getText( elem );
                        }
                    }
                } else if ( nodeType === 3 || nodeType === 4 ) {
                    return elem.nodeValue;
                }
                // Do not include comment or processing instruction nodes

                return ret;
            };

            Expr = Sizzle.selectors = {

                // Can be adjusted by the user
                cacheLength: 50,

                createPseudo: markFunction,

                match: matchExpr,

                attrHandle: {},

                find: {},

                relative: {
                    ">": { dir: "parentNode", first: true },
                    " ": { dir: "parentNode" },
                    "+": { dir: "previousSibling", first: true },
                    "~": { dir: "previousSibling" }
                },

                preFilter: {
                    "ATTR": function( match ) {
                        match[1] = match[1].replace( runescape, funescape );

                        // Move the given value to match[3] whether quoted or unquoted
                        match[3] = ( match[3] || match[4] || match[5] || "" ).replace( runescape, funescape );

                        if ( match[2] === "~=" ) {
                            match[3] = " " + match[3] + " ";
                        }

                        return match.slice( 0, 4 );
                    },

                    "CHILD": function( match ) {
                        /* matches from matchExpr["CHILD"]
				1 type (only|nth|...)
				2 what (child|of-type)
				3 argument (even|odd|\d*|\d*n([+-]\d+)?|...)
				4 xn-component of xn+y argument ([+-]?\d*n|)
				5 sign of xn-component
				6 x of xn-component
				7 sign of y-component
				8 y of y-component
			*/
                        match[1] = match[1].toLowerCase();

                        if ( match[1].slice( 0, 3 ) === "nth" ) {
                            // nth-* requires argument
                            if ( !match[3] ) {
                                Sizzle.error( match[0] );
                            }

                            // numeric x and y parameters for Expr.filter.CHILD
                            // remember that false/true cast respectively to 0/1
                            match[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === "even" || match[3] === "odd" ) );
                            match[5] = +( ( match[7] + match[8] ) || match[3] === "odd" );

                            // other types prohibit arguments
                        } else if ( match[3] ) {
                            Sizzle.error( match[0] );
                        }

                        return match;
                    },

                    "PSEUDO": function( match ) {
                        var excess,
                            unquoted = !match[6] && match[2];

                        if ( matchExpr["CHILD"].test( match[0] ) ) {
                            return null;
                        }

                        // Accept quoted arguments as-is
                        if ( match[3] ) {
                            match[2] = match[4] || match[5] || "";

                            // Strip excess characters from unquoted arguments
                        } else if ( unquoted && rpseudo.test( unquoted ) &&
                            // Get excess from tokenize (recursively)
                            (excess = tokenize( unquoted, true )) &&
                            // advance to the next closing parenthesis
                            (excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length) ) {

                            // excess is a negative index
                            match[0] = match[0].slice( 0, excess );
                            match[2] = unquoted.slice( 0, excess );
                        }

                        // Return only captures needed by the pseudo filter method (type and argument)
                        return match.slice( 0, 3 );
                    }
                },

                filter: {

                    "TAG": function( nodeNameSelector ) {
                        var nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();
                        return nodeNameSelector === "*" ?
                            function() { return true; } :
                            function( elem ) {
                                return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;
                            };
                    },

                    "CLASS": function( className ) {
                        var pattern = classCache[ className + " " ];

                        return pattern ||
                            (pattern = new RegExp( "(^|" + whitespace + ")" + className + "(" + whitespace + "|$)" )) &&
                            classCache( className, function( elem ) {
                                return pattern.test( typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== "undefined" && elem.getAttribute("class") || "" );
                            });
                    },

                    "ATTR": function( name, operator, check ) {
                        return function( elem ) {
                            var result = Sizzle.attr( elem, name );

                            if ( result == null ) {
                                return operator === "!=";
                            }
                            if ( !operator ) {
                                return true;
                            }

                            result += "";

                            return operator === "=" ? result === check :
                                operator === "!=" ? result !== check :
                                    operator === "^=" ? check && result.indexOf( check ) === 0 :
                                        operator === "*=" ? check && result.indexOf( check ) > -1 :
                                            operator === "$=" ? check && result.slice( -check.length ) === check :
                                                operator === "~=" ? ( " " + result.replace( rwhitespace, " " ) + " " ).indexOf( check ) > -1 :
                                                    operator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :
                                                        false;
                        };
                    },

                    "CHILD": function( type, what, argument, first, last ) {
                        var simple = type.slice( 0, 3 ) !== "nth",
                            forward = type.slice( -4 ) !== "last",
                            ofType = what === "of-type";

                        return first === 1 && last === 0 ?

                            // Shortcut for :nth-*(n)
                            function( elem ) {
                                return !!elem.parentNode;
                            } :

                            function( elem, context, xml ) {
                                var cache, uniqueCache, outerCache, node, nodeIndex, start,
                                    dir = simple !== forward ? "nextSibling" : "previousSibling",
                                    parent = elem.parentNode,
                                    name = ofType && elem.nodeName.toLowerCase(),
                                    useCache = !xml && !ofType,
                                    diff = false;

                                if ( parent ) {

                                    // :(first|last|only)-(child|of-type)
                                    if ( simple ) {
                                        while ( dir ) {
                                            node = elem;
                                            while ( (node = node[ dir ]) ) {
                                                if ( ofType ?
                                                    node.nodeName.toLowerCase() === name :
                                                    node.nodeType === 1 ) {

                                                    return false;
                                                }
                                            }
                                            // Reverse direction for :only-* (if we haven't yet done so)
                                            start = dir = type === "only" && !start && "nextSibling";
                                        }
                                        return true;
                                    }

                                    start = [ forward ? parent.firstChild : parent.lastChild ];

                                    // non-xml :nth-child(...) stores cache data on `parent`
                                    if ( forward && useCache ) {

                                        // Seek `elem` from a previously-cached index

                                        // ...in a gzip-friendly way
                                        node = parent;
                                        outerCache = node[ expando ] || (node[ expando ] = {});

                                        // Support: IE <9 only
                                        // Defend against cloned attroperties (jQuery gh-1709)
                                        uniqueCache = outerCache[ node.uniqueID ] ||
                                            (outerCache[ node.uniqueID ] = {});

                                        cache = uniqueCache[ type ] || [];
                                        nodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];
                                        diff = nodeIndex && cache[ 2 ];
                                        node = nodeIndex && parent.childNodes[ nodeIndex ];

                                        while ( (node = ++nodeIndex && node && node[ dir ] ||

                                            // Fallback to seeking `elem` from the start
                                            (diff = nodeIndex = 0) || start.pop()) ) {

                                            // When found, cache indexes on `parent` and break
                                            if ( node.nodeType === 1 && ++diff && node === elem ) {
                                                uniqueCache[ type ] = [ dirruns, nodeIndex, diff ];
                                                break;
                                            }
                                        }

                                    } else {
                                        // Use previously-cached element index if available
                                        if ( useCache ) {
                                            // ...in a gzip-friendly way
                                            node = elem;
                                            outerCache = node[ expando ] || (node[ expando ] = {});

                                            // Support: IE <9 only
                                            // Defend against cloned attroperties (jQuery gh-1709)
                                            uniqueCache = outerCache[ node.uniqueID ] ||
                                                (outerCache[ node.uniqueID ] = {});

                                            cache = uniqueCache[ type ] || [];
                                            nodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];
                                            diff = nodeIndex;
                                        }

                                        // xml :nth-child(...)
                                        // or :nth-last-child(...) or :nth(-last)?-of-type(...)
                                        if ( diff === false ) {
                                            // Use the same loop as above to seek `elem` from the start
                                            while ( (node = ++nodeIndex && node && node[ dir ] ||
                                                (diff = nodeIndex = 0) || start.pop()) ) {

                                                if ( ( ofType ?
                                                    node.nodeName.toLowerCase() === name :
                                                    node.nodeType === 1 ) &&
                                                    ++diff ) {

                                                    // Cache the index of each encountered element
                                                    if ( useCache ) {
                                                        outerCache = node[ expando ] || (node[ expando ] = {});

                                                        // Support: IE <9 only
                                                        // Defend against cloned attroperties (jQuery gh-1709)
                                                        uniqueCache = outerCache[ node.uniqueID ] ||
                                                            (outerCache[ node.uniqueID ] = {});

                                                        uniqueCache[ type ] = [ dirruns, diff ];
                                                    }

                                                    if ( node === elem ) {
                                                        break;
                                                    }
                                                }
                                            }
                                        }
                                    }

                                    // Incorporate the offset, then check against cycle size
                                    diff -= last;
                                    return diff === first || ( diff % first === 0 && diff / first >= 0 );
                                }
                            };
                    },

                    "PSEUDO": function( pseudo, argument ) {
                        // pseudo-class names are case-insensitive
                        // http://www.w3.org/TR/selectors/#pseudo-classes
                        // Prioritize by case sensitivity in case custom pseudos are added with uppercase letters
                        // Remember that setFilters inherits from pseudos
                        var args,
                            fn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||
                                Sizzle.error( "unsupported pseudo: " + pseudo );

                        // The user may use createPseudo to indicate that
                        // arguments are needed to create the filter function
                        // just as Sizzle does
                        if ( fn[ expando ] ) {
                            return fn( argument );
                        }

                        // But maintain support for old signatures
                        if ( fn.length > 1 ) {
                            args = [ pseudo, pseudo, "", argument ];
                            return Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?
                                markFunction(function( seed, matches ) {
                                    var idx,
                                        matched = fn( seed, argument ),
                                        i = matched.length;
                                    while ( i-- ) {
                                        idx = indexOf( seed, matched[i] );
                                        seed[ idx ] = !( matches[ idx ] = matched[i] );
                                    }
                                }) :
                                function( elem ) {
                                    return fn( elem, 0, args );
                                };
                        }

                        return fn;
                    }
                },

                pseudos: {
                    // Potentially complex pseudos
                    "not": markFunction(function( selector ) {
                        // Trim the selector passed to compile
                        // to avoid treating leading and trailing
                        // spaces as combinators
                        var input = [],
                            results = [],
                            matcher = compile( selector.replace( rtrim, "$1" ) );

                        return matcher[ expando ] ?
                            markFunction(function( seed, matches, context, xml ) {
                                var elem,
                                    unmatched = matcher( seed, null, xml, [] ),
                                    i = seed.length;

                                // Match elements unmatched by `matcher`
                                while ( i-- ) {
                                    if ( (elem = unmatched[i]) ) {
                                        seed[i] = !(matches[i] = elem);
                                    }
                                }
                            }) :
                            function( elem, context, xml ) {
                                input[0] = elem;
                                matcher( input, null, xml, results );
                                // Don't keep the element (issue #299)
                                input[0] = null;
                                return !results.pop();
                            };
                    }),

                    "has": markFunction(function( selector ) {
                        return function( elem ) {
                            return Sizzle( selector, elem ).length > 0;
                        };
                    }),

                    "contains": markFunction(function( text ) {
                        text = text.replace( runescape, funescape );
                        return function( elem ) {
                            return ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;
                        };
                    }),

                    // "Whether an element is represented by a :lang() selector
                    // is based solely on the element's language value
                    // being equal to the identifier C,
                    // or beginning with the identifier C immediately followed by "-".
                    // The matching of C against the element's language value is performed case-insensitively.
                    // The identifier C does not have to be a valid language name."
                    // http://www.w3.org/TR/selectors/#lang-pseudo
                    "lang": markFunction( function( lang ) {
                        // lang value must be a valid identifier
                        if ( !ridentifier.test(lang || "") ) {
                            Sizzle.error( "unsupported lang: " + lang );
                        }
                        lang = lang.replace( runescape, funescape ).toLowerCase();
                        return function( elem ) {
                            var elemLang;
                            do {
                                if ( (elemLang = documentIsHTML ?
                                    elem.lang :
                                    elem.getAttribute("xml:lang") || elem.getAttribute("lang")) ) {

                                    elemLang = elemLang.toLowerCase();
                                    return elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;
                                }
                            } while ( (elem = elem.parentNode) && elem.nodeType === 1 );
                            return false;
                        };
                    }),

                    // Miscellaneous
                    "target": function( elem ) {
                        var hash = window.location && window.location.hash;
                        return hash && hash.slice( 1 ) === elem.id;
                    },

                    "root": function( elem ) {
                        return elem === docElem;
                    },

                    "focus": function( elem ) {
                        return elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);
                    },

                    // Boolean properties
                    "enabled": function( elem ) {
                        return elem.disabled === false;
                    },

                    "disabled": function( elem ) {
                        return elem.disabled === true;
                    },

                    "checked": function( elem ) {
                        // In CSS3, :checked should return both checked and selected elements
                        // http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked
                        var nodeName = elem.nodeName.toLowerCase();
                        return (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);
                    },

                    "selected": function( elem ) {
                        // Accessing this property makes selected-by-default
                        // options in Safari work properly
                        if ( elem.parentNode ) {
                            elem.parentNode.selectedIndex;
                        }

                        return elem.selected === true;
                    },

                    // Contents
                    "empty": function( elem ) {
                        // http://www.w3.org/TR/selectors/#empty-pseudo
                        // :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),
                        //   but not by others (comment: 8; processing instruction: 7; etc.)
                        // nodeType < 6 works because attributes (2) do not appear as children
                        for ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {
                            if ( elem.nodeType < 6 ) {
                                return false;
                            }
                        }
                        return true;
                    },

                    "parent": function( elem ) {
                        return !Expr.pseudos["empty"]( elem );
                    },

                    // Element/input types
                    "header": function( elem ) {
                        return rheader.test( elem.nodeName );
                    },

                    "input": function( elem ) {
                        return rinputs.test( elem.nodeName );
                    },

                    "button": function( elem ) {
                        var name = elem.nodeName.toLowerCase();
                        return name === "input" && elem.type === "button" || name === "button";
                    },

                    "text": function( elem ) {
                        var attr;
                        return elem.nodeName.toLowerCase() === "input" &&
                            elem.type === "text" &&

                            // Support: IE<8
                            // New HTML5 attribute values (e.g., "search") appear with elem.type === "text"
                            ( (attr = elem.getAttribute("type")) == null || attr.toLowerCase() === "text" );
                    },

                    // Position-in-collection
                    "first": createPositionalPseudo(function() {
                        return [ 0 ];
                    }),

                    "last": createPositionalPseudo(function( matchIndexes, length ) {
                        return [ length - 1 ];
                    }),

                    "eq": createPositionalPseudo(function( matchIndexes, length, argument ) {
                        return [ argument < 0 ? argument + length : argument ];
                    }),

                    "even": createPositionalPseudo(function( matchIndexes, length ) {
                        var i = 0;
                        for ( ; i < length; i += 2 ) {
                            matchIndexes.push( i );
                        }
                        return matchIndexes;
                    }),

                    "odd": createPositionalPseudo(function( matchIndexes, length ) {
                        var i = 1;
                        for ( ; i < length; i += 2 ) {
                            matchIndexes.push( i );
                        }
                        return matchIndexes;
                    }),

                    "lt": createPositionalPseudo(function( matchIndexes, length, argument ) {
                        var i = argument < 0 ? argument + length : argument;
                        for ( ; --i >= 0; ) {
                            matchIndexes.push( i );
                        }
                        return matchIndexes;
                    }),

                    "gt": createPositionalPseudo(function( matchIndexes, length, argument ) {
                        var i = argument < 0 ? argument + length : argument;
                        for ( ; ++i < length; ) {
                            matchIndexes.push( i );
                        }
                        return matchIndexes;
                    })
                }
            };

            Expr.pseudos["nth"] = Expr.pseudos["eq"];

// Add button/input type pseudos
            for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {
                Expr.pseudos[ i ] = createInputPseudo( i );
            }
            for ( i in { submit: true, reset: true } ) {
                Expr.pseudos[ i ] = createButtonPseudo( i );
            }

// Easy API for creating new setFilters
            function setFilters() {}
            setFilters.prototype = Expr.filters = Expr.pseudos;
            Expr.setFilters = new setFilters();

            tokenize = Sizzle.tokenize = function( selector, parseOnly ) {
                var matched, match, tokens, type,
                    soFar, groups, preFilters,
                    cached = tokenCache[ selector + " " ];

                if ( cached ) {
                    return parseOnly ? 0 : cached.slice( 0 );
                }

                soFar = selector;
                groups = [];
                preFilters = Expr.preFilter;

                while ( soFar ) {

                    // Comma and first run
                    if ( !matched || (match = rcomma.exec( soFar )) ) {
                        if ( match ) {
                            // Don't consume trailing commas as valid
                            soFar = soFar.slice( match[0].length ) || soFar;
                        }
                        groups.push( (tokens = []) );
                    }

                    matched = false;

                    // Combinators
                    if ( (match = rcombinators.exec( soFar )) ) {
                        matched = match.shift();
                        tokens.push({
                            value: matched,
                            // Cast descendant combinators to space
                            type: match[0].replace( rtrim, " " )
                        });
                        soFar = soFar.slice( matched.length );
                    }

                    // Filters
                    for ( type in Expr.filter ) {
                        if ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||
                            (match = preFilters[ type ]( match ))) ) {
                            matched = match.shift();
                            tokens.push({
                                value: matched,
                                type: type,
                                matches: match
                            });
                            soFar = soFar.slice( matched.length );
                        }
                    }

                    if ( !matched ) {
                        break;
                    }
                }

                // Return the length of the invalid excess
                // if we're just parsing
                // Otherwise, throw an error or return tokens
                return parseOnly ?
                    soFar.length :
                    soFar ?
                        Sizzle.error( selector ) :
                        // Cache the tokens
                        tokenCache( selector, groups ).slice( 0 );
            };

            function toSelector( tokens ) {
                var i = 0,
                    len = tokens.length,
                    selector = "";
                for ( ; i < len; i++ ) {
                    selector += tokens[i].value;
                }
                return selector;
            }

            function addCombinator( matcher, combinator, base ) {
                var dir = combinator.dir,
                    checkNonElements = base && dir === "parentNode",
                    doneName = done++;

                return combinator.first ?
                    // Check against closest ancestor/preceding element
                    function( elem, context, xml ) {
                        while ( (elem = elem[ dir ]) ) {
                            if ( elem.nodeType === 1 || checkNonElements ) {
                                return matcher( elem, context, xml );
                            }
                        }
                    } :

                    // Check against all ancestor/preceding elements
                    function( elem, context, xml ) {
                        var oldCache, uniqueCache, outerCache,
                            newCache = [ dirruns, doneName ];

                        // We can't set arbitrary data on XML nodes, so they don't benefit from combinator caching
                        if ( xml ) {
                            while ( (elem = elem[ dir ]) ) {
                                if ( elem.nodeType === 1 || checkNonElements ) {
                                    if ( matcher( elem, context, xml ) ) {
                                        return true;
                                    }
                                }
                            }
                        } else {
                            while ( (elem = elem[ dir ]) ) {
                                if ( elem.nodeType === 1 || checkNonElements ) {
                                    outerCache = elem[ expando ] || (elem[ expando ] = {});

                                    // Support: IE <9 only
                                    // Defend against cloned attroperties (jQuery gh-1709)
                                    uniqueCache = outerCache[ elem.uniqueID ] || (outerCache[ elem.uniqueID ] = {});

                                    if ( (oldCache = uniqueCache[ dir ]) &&
                                        oldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {

                                        // Assign to newCache so results back-propagate to previous elements
                                        return (newCache[ 2 ] = oldCache[ 2 ]);
                                    } else {
                                        // Reuse newcache so results back-propagate to previous elements
                                        uniqueCache[ dir ] = newCache;

                                        // A match means we're done; a fail means we have to keep checking
                                        if ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {
                                            return true;
                                        }
                                    }
                                }
                            }
                        }
                    };
            }

            function elementMatcher( matchers ) {
                return matchers.length > 1 ?
                    function( elem, context, xml ) {
                        var i = matchers.length;
                        while ( i-- ) {
                            if ( !matchers[i]( elem, context, xml ) ) {
                                return false;
                            }
                        }
                        return true;
                    } :
                    matchers[0];
            }

            function multipleContexts( selector, contexts, results ) {
                var i = 0,
                    len = contexts.length;
                for ( ; i < len; i++ ) {
                    Sizzle( selector, contexts[i], results );
                }
                return results;
            }

            function condense( unmatched, map, filter, context, xml ) {
                var elem,
                    newUnmatched = [],
                    i = 0,
                    len = unmatched.length,
                    mapped = map != null;

                for ( ; i < len; i++ ) {
                    if ( (elem = unmatched[i]) ) {
                        if ( !filter || filter( elem, context, xml ) ) {
                            newUnmatched.push( elem );
                            if ( mapped ) {
                                map.push( i );
                            }
                        }
                    }
                }

                return newUnmatched;
            }

            function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {
                if ( postFilter && !postFilter[ expando ] ) {
                    postFilter = setMatcher( postFilter );
                }
                if ( postFinder && !postFinder[ expando ] ) {
                    postFinder = setMatcher( postFinder, postSelector );
                }
                return markFunction(function( seed, results, context, xml ) {
                    var temp, i, elem,
                        preMap = [],
                        postMap = [],
                        preexisting = results.length,

                        // Get initial elements from seed or context
                        elems = seed || multipleContexts( selector || "*", context.nodeType ? [ context ] : context, [] ),

                        // Prefilter to get matcher input, preserving a map for seed-results synchronization
                        matcherIn = preFilter && ( seed || !selector ) ?
                            condense( elems, preMap, preFilter, context, xml ) :
                            elems,

                        matcherOut = matcher ?
                            // If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,
                            postFinder || ( seed ? preFilter : preexisting || postFilter ) ?

                                // ...intermediate processing is necessary
                                [] :

                                // ...otherwise use results directly
                                results :
                            matcherIn;

                    // Find primary matches
                    if ( matcher ) {
                        matcher( matcherIn, matcherOut, context, xml );
                    }

                    // Apply postFilter
                    if ( postFilter ) {
                        temp = condense( matcherOut, postMap );
                        postFilter( temp, [], context, xml );

                        // Un-match failing elements by moving them back to matcherIn
                        i = temp.length;
                        while ( i-- ) {
                            if ( (elem = temp[i]) ) {
                                matcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);
                            }
                        }
                    }

                    if ( seed ) {
                        if ( postFinder || preFilter ) {
                            if ( postFinder ) {
                                // Get the final matcherOut by condensing this intermediate into postFinder contexts
                                temp = [];
                                i = matcherOut.length;
                                while ( i-- ) {
                                    if ( (elem = matcherOut[i]) ) {
                                        // Restore matcherIn since elem is not yet a final match
                                        temp.push( (matcherIn[i] = elem) );
                                    }
                                }
                                postFinder( null, (matcherOut = []), temp, xml );
                            }

                            // Move matched elements from seed to results to keep them synchronized
                            i = matcherOut.length;
                            while ( i-- ) {
                                if ( (elem = matcherOut[i]) &&
                                    (temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {

                                    seed[temp] = !(results[temp] = elem);
                                }
                            }
                        }

                        // Add elements to results, through postFinder if defined
                    } else {
                        matcherOut = condense(
                            matcherOut === results ?
                                matcherOut.splice( preexisting, matcherOut.length ) :
                                matcherOut
                        );
                        if ( postFinder ) {
                            postFinder( null, results, matcherOut, xml );
                        } else {
                            push.apply( results, matcherOut );
                        }
                    }
                });
            }

            function matcherFromTokens( tokens ) {
                var checkContext, matcher, j,
                    len = tokens.length,
                    leadingRelative = Expr.relative[ tokens[0].type ],
                    implicitRelative = leadingRelative || Expr.relative[" "],
                    i = leadingRelative ? 1 : 0,

                    // The foundational matcher ensures that elements are reachable from top-level context(s)
                    matchContext = addCombinator( function( elem ) {
                        return elem === checkContext;
                    }, implicitRelative, true ),
                    matchAnyContext = addCombinator( function( elem ) {
                        return indexOf( checkContext, elem ) > -1;
                    }, implicitRelative, true ),
                    matchers = [ function( elem, context, xml ) {
                        var ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (
                            (checkContext = context).nodeType ?
                                matchContext( elem, context, xml ) :
                                matchAnyContext( elem, context, xml ) );
                        // Avoid hanging onto element (issue #299)
                        checkContext = null;
                        return ret;
                    } ];

                for ( ; i < len; i++ ) {
                    if ( (matcher = Expr.relative[ tokens[i].type ]) ) {
                        matchers = [ addCombinator(elementMatcher( matchers ), matcher) ];
                    } else {
                        matcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );

                        // Return special upon seeing a positional matcher
                        if ( matcher[ expando ] ) {
                            // Find the next relative operator (if any) for proper handling
                            j = ++i;
                            for ( ; j < len; j++ ) {
                                if ( Expr.relative[ tokens[j].type ] ) {
                                    break;
                                }
                            }
                            return setMatcher(
                                i > 1 && elementMatcher( matchers ),
                                i > 1 && toSelector(
                                // If the preceding token was a descendant combinator, insert an implicit any-element `*`
                                tokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === " " ? "*" : "" })
                                ).replace( rtrim, "$1" ),
                                matcher,
                                i < j && matcherFromTokens( tokens.slice( i, j ) ),
                                j < len && matcherFromTokens( (tokens = tokens.slice( j )) ),
                                j < len && toSelector( tokens )
                            );
                        }
                        matchers.push( matcher );
                    }
                }

                return elementMatcher( matchers );
            }

            function matcherFromGroupMatchers( elementMatchers, setMatchers ) {
                var bySet = setMatchers.length > 0,
                    byElement = elementMatchers.length > 0,
                    superMatcher = function( seed, context, xml, results, outermost ) {
                        var elem, j, matcher,
                            matchedCount = 0,
                            i = "0",
                            unmatched = seed && [],
                            setMatched = [],
                            contextBackup = outermostContext,
                            // We must always have either seed elements or outermost context
                            elems = seed || byElement && Expr.find["TAG"]( "*", outermost ),
                            // Use integer dirruns iff this is the outermost matcher
                            dirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),
                            len = elems.length;

                        if ( outermost ) {
                            outermostContext = context === document || context || outermost;
                        }

                        // Add elements passing elementMatchers directly to results
                        // Support: IE<9, Safari
                        // Tolerate NodeList properties (IE: "length"; Safari: <number>) matching elements by id
                        for ( ; i !== len && (elem = elems[i]) != null; i++ ) {
                            if ( byElement && elem ) {
                                j = 0;
                                if ( !context && elem.ownerDocument !== document ) {
                                    setDocument( elem );
                                    xml = !documentIsHTML;
                                }
                                while ( (matcher = elementMatchers[j++]) ) {
                                    if ( matcher( elem, context || document, xml) ) {
                                        results.push( elem );
                                        break;
                                    }
                                }
                                if ( outermost ) {
                                    dirruns = dirrunsUnique;
                                }
                            }

                            // Track unmatched elements for set filters
                            if ( bySet ) {
                                // They will have gone through all possible matchers
                                if ( (elem = !matcher && elem) ) {
                                    matchedCount--;
                                }

                                // Lengthen the array for every element, matched or not
                                if ( seed ) {
                                    unmatched.push( elem );
                                }
                            }
                        }

                        // `i` is now the count of elements visited above, and adding it to `matchedCount`
                        // makes the latter nonnegative.
                        matchedCount += i;

                        // Apply set filters to unmatched elements
                        // NOTE: This can be skipped if there are no unmatched elements (i.e., `matchedCount`
                        // equals `i`), unless we didn't visit _any_ elements in the above loop because we have
                        // no element matchers and no seed.
                        // Incrementing an initially-string "0" `i` allows `i` to remain a string only in that
                        // case, which will result in a "00" `matchedCount` that differs from `i` but is also
                        // numerically zero.
                        if ( bySet && i !== matchedCount ) {
                            j = 0;
                            while ( (matcher = setMatchers[j++]) ) {
                                matcher( unmatched, setMatched, context, xml );
                            }

                            if ( seed ) {
                                // Reintegrate element matches to eliminate the need for sorting
                                if ( matchedCount > 0 ) {
                                    while ( i-- ) {
                                        if ( !(unmatched[i] || setMatched[i]) ) {
                                            setMatched[i] = pop.call( results );
                                        }
                                    }
                                }

                                // Discard index placeholder values to get only actual matches
                                setMatched = condense( setMatched );
                            }

                            // Add matches to results
                            push.apply( results, setMatched );

                            // Seedless set matches succeeding multiple successful matchers stipulate sorting
                            if ( outermost && !seed && setMatched.length > 0 &&
                                ( matchedCount + setMatchers.length ) > 1 ) {

                                Sizzle.uniqueSort( results );
                            }
                        }

                        // Override manipulation of globals by nested matchers
                        if ( outermost ) {
                            dirruns = dirrunsUnique;
                            outermostContext = contextBackup;
                        }

                        return unmatched;
                    };

                return bySet ?
                    markFunction( superMatcher ) :
                    superMatcher;
            }

            compile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {
                var i,
                    setMatchers = [],
                    elementMatchers = [],
                    cached = compilerCache[ selector + " " ];

                if ( !cached ) {
                    // Generate a function of recursive functions that can be used to check each element
                    if ( !match ) {
                        match = tokenize( selector );
                    }
                    i = match.length;
                    while ( i-- ) {
                        cached = matcherFromTokens( match[i] );
                        if ( cached[ expando ] ) {
                            setMatchers.push( cached );
                        } else {
                            elementMatchers.push( cached );
                        }
                    }

                    // Cache the compiled function
                    cached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );

                    // Save selector and tokenization
                    cached.selector = selector;
                }
                return cached;
            };

            /**
             * A low-level selection function that works with Sizzle's compiled
             *  selector functions
             * @param {String|Function} selector A selector or a pre-compiled
             *  selector function built with Sizzle.compile
             * @param {Element} context
             * @param {Array} [results]
             * @param {Array} [seed] A set of elements to match against
             */
            select = Sizzle.select = function( selector, context, results, seed ) {
                var i, tokens, token, type, find,
                    compiled = typeof selector === "function" && selector,
                    match = !seed && tokenize( (selector = compiled.selector || selector) );

                results = results || [];

                // Try to minimize operations if there is only one selector in the list and no seed
                // (the latter of which guarantees us context)
                if ( match.length === 1 ) {

                    // Reduce context if the leading compound selector is an ID
                    tokens = match[0] = match[0].slice( 0 );
                    if ( tokens.length > 2 && (token = tokens[0]).type === "ID" &&
                        support.getById && context.nodeType === 9 && documentIsHTML &&
                        Expr.relative[ tokens[1].type ] ) {

                        context = ( Expr.find["ID"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];
                        if ( !context ) {
                            return results;

                            // Precompiled matchers will still verify ancestry, so step up a level
                        } else if ( compiled ) {
                            context = context.parentNode;
                        }

                        selector = selector.slice( tokens.shift().value.length );
                    }

                    // Fetch a seed set for right-to-left matching
                    i = matchExpr["needsContext"].test( selector ) ? 0 : tokens.length;
                    while ( i-- ) {
                        token = tokens[i];

                        // Abort if we hit a combinator
                        if ( Expr.relative[ (type = token.type) ] ) {
                            break;
                        }
                        if ( (find = Expr.find[ type ]) ) {
                            // Search, expanding context for leading sibling combinators
                            if ( (seed = find(
                                token.matches[0].replace( runescape, funescape ),
                                rsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context
                            )) ) {

                                // If seed is empty or no tokens remain, we can return early
                                tokens.splice( i, 1 );
                                selector = seed.length && toSelector( tokens );
                                if ( !selector ) {
                                    push.apply( results, seed );
                                    return results;
                                }

                                break;
                            }
                        }
                    }
                }

                // Compile and execute a filtering function if one is not provided
                // Provide `match` to avoid retokenization if we modified the selector above
                ( compiled || compile( selector, match ) )(
                    seed,
                    context,
                    !documentIsHTML,
                    results,
                    !context || rsibling.test( selector ) && testContext( context.parentNode ) || context
                );
                return results;
            };

// One-time assignments

// Sort stability
            support.sortStable = expando.split("").sort( sortOrder ).join("") === expando;

// Support: Chrome 14-35+
// Always assume duplicates if they aren't passed to the comparison function
            support.detectDuplicates = !!hasDuplicate;

// Initialize against the default document
            setDocument();

// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)
// Detached nodes confoundingly follow *each other*
            support.sortDetached = assert(function( div1 ) {
                // Should return 1, but returns 4 (following)
                return div1.compareDocumentPosition( document.createElement("div") ) & 1;
            });

// Support: IE<8
// Prevent attribute/property "interpolation"
// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx
            if ( !assert(function( div ) {
                div.innerHTML = "<a href='#'></a>";
                return div.firstChild.getAttribute("href") === "#" ;
            }) ) {
                addHandle( "type|href|height|width", function( elem, name, isXML ) {
                    if ( !isXML ) {
                        return elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );
                    }
                });
            }

// Support: IE<9
// Use defaultValue in place of getAttribute("value")
            if ( !support.attributes || !assert(function( div ) {
                div.innerHTML = "<input/>";
                div.firstChild.setAttribute( "value", "" );
                return div.firstChild.getAttribute( "value" ) === "";
            }) ) {
                addHandle( "value", function( elem, name, isXML ) {
                    if ( !isXML && elem.nodeName.toLowerCase() === "input" ) {
                        return elem.defaultValue;
                    }
                });
            }

// Support: IE<9
// Use getAttributeNode to fetch booleans when getAttribute lies
            if ( !assert(function( div ) {
                return div.getAttribute("disabled") == null;
            }) ) {
                addHandle( booleans, function( elem, name, isXML ) {
                    var val;
                    if ( !isXML ) {
                        return elem[ name ] === true ? name.toLowerCase() :
                            (val = elem.getAttributeNode( name )) && val.specified ?
                                val.value :
                                null;
                    }
                });
            }

            return Sizzle;

        })( window );



    jQuery.find = Sizzle;
    jQuery.expr = Sizzle.selectors;
    jQuery.expr[ ":" ] = jQuery.expr.pseudos;
    jQuery.uniqueSort = jQuery.unique = Sizzle.uniqueSort;
    jQuery.text = Sizzle.getText;
    jQuery.isXMLDoc = Sizzle.isXML;
    jQuery.contains = Sizzle.contains;



    var dir = function( elem, dir, until ) {
        var matched = [],
            truncate = until !== undefined;

        while ( ( elem = elem[ dir ] ) && elem.nodeType !== 9 ) {
            if ( elem.nodeType === 1 ) {
                if ( truncate && jQuery( elem ).is( until ) ) {
                    break;
                }
                matched.push( elem );
            }
        }
        return matched;
    };


    var siblings = function( n, elem ) {
        var matched = [];

        for ( ; n; n = n.nextSibling ) {
            if ( n.nodeType === 1 && n !== elem ) {
                matched.push( n );
            }
        }

        return matched;
    };


    var rneedsContext = jQuery.expr.match.needsContext;

    var rsingleTag = ( /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/ );



    var risSimple = /^.[^:#\[\.,]*$/;

// Implement the identical functionality for filter and not
    function winnow( elements, qualifier, not ) {
        if ( jQuery.isFunction( qualifier ) ) {
            return jQuery.grep( elements, function( elem, i ) {
                /* jshint -W018 */
                return !!qualifier.call( elem, i, elem ) !== not;
            } );

        }

        if ( qualifier.nodeType ) {
            return jQuery.grep( elements, function( elem ) {
                return ( elem === qualifier ) !== not;
            } );

        }

        if ( typeof qualifier === "string" ) {
            if ( risSimple.test( qualifier ) ) {
                return jQuery.filter( qualifier, elements, not );
            }

            qualifier = jQuery.filter( qualifier, elements );
        }

        return jQuery.grep( elements, function( elem ) {
            return ( indexOf.call( qualifier, elem ) > -1 ) !== not;
        } );
    }

    jQuery.filter = function( expr, elems, not ) {
        var elem = elems[ 0 ];

        if ( not ) {
            expr = ":not(" + expr + ")";
        }

        return elems.length === 1 && elem.nodeType === 1 ?
            jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :
            jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {
                return elem.nodeType === 1;
            } ) );
    };

    jQuery.fn.extend( {
        find: function( selector ) {
            var i,
                len = this.length,
                ret = [],
                self = this;

            if ( typeof selector !== "string" ) {
                return this.pushStack( jQuery( selector ).filter( function() {
                    for ( i = 0; i < len; i++ ) {
                        if ( jQuery.contains( self[ i ], this ) ) {
                            return true;
                        }
                    }
                } ) );
            }

            for ( i = 0; i < len; i++ ) {
                jQuery.find( selector, self[ i ], ret );
            }

            // Needed because $( selector, context ) becomes $( context ).find( selector )
            ret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );
            ret.selector = this.selector ? this.selector + " " + selector : selector;
            return ret;
        },
        filter: function( selector ) {
            return this.pushStack( winnow( this, selector || [], false ) );
        },
        not: function( selector ) {
            return this.pushStack( winnow( this, selector || [], true ) );
        },
        is: function( selector ) {
            return !!winnow(
                this,

                // If this is a positional/relative selector, check membership in the returned set
                // so $("p:first").is("p:last") won't return true for a doc with two "p".
                typeof selector === "string" && rneedsContext.test( selector ) ?
                    jQuery( selector ) :
                    selector || [],
                false
            ).length;
        }
    } );


// Initialize a jQuery object


// A central reference to the root jQuery(document)
    var rootjQuery,

        // A simple way to check for HTML strings
        // Prioritize #id over <tag> to avoid XSS via location.hash (#9521)
        // Strict HTML recognition (#11290: must start with <)
        rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,

        init = jQuery.fn.init = function( selector, context, root ) {
            var match, elem;

            // HANDLE: $(""), $(null), $(undefined), $(false)
            if ( !selector ) {
                return this;
            }

            // Method init() accepts an alternate rootjQuery
            // so migrate can support jQuery.sub (gh-2101)
            root = root || rootjQuery;

            // Handle HTML strings
            if ( typeof selector === "string" ) {
                if ( selector[ 0 ] === "<" &&
                    selector[ selector.length - 1 ] === ">" &&
                    selector.length >= 3 ) {

                    // Assume that strings that start and end with <> are HTML and skip the regex check
                    match = [ null, selector, null ];

                } else {
                    match = rquickExpr.exec( selector );
                }

                // Match html or make sure no context is specified for #id
                if ( match && ( match[ 1 ] || !context ) ) {

                    // HANDLE: $(html) -> $(array)
                    if ( match[ 1 ] ) {
                        context = context instanceof jQuery ? context[ 0 ] : context;

                        // Option to run scripts is true for back-compat
                        // Intentionally let the error be thrown if parseHTML is not present
                        jQuery.merge( this, jQuery.parseHTML(
                            match[ 1 ],
                            context && context.nodeType ? context.ownerDocument || context : document,
                            true
                        ) );

                        // HANDLE: $(html, props)
                        if ( rsingleTag.test( match[ 1 ] ) && jQuery.isPlainObject( context ) ) {
                            for ( match in context ) {

                                // Properties of context are called as methods if possible
                                if ( jQuery.isFunction( this[ match ] ) ) {
                                    this[ match ]( context[ match ] );

                                    // ...and otherwise set as attributes
                                } else {
                                    this.attr( match, context[ match ] );
                                }
                            }
                        }

                        return this;

                        // HANDLE: $(#id)
                    } else {
                        elem = document.getElementById( match[ 2 ] );

                        // Support: Blackberry 4.6
                        // gEBID returns nodes no longer in the document (#6963)
                        if ( elem && elem.parentNode ) {

                            // Inject the element directly into the jQuery object
                            this.length = 1;
                            this[ 0 ] = elem;
                        }

                        this.context = document;
                        this.selector = selector;
                        return this;
                    }

                    // HANDLE: $(expr, $(...))
                } else if ( !context || context.jquery ) {
                    return ( context || root ).find( selector );

                    // HANDLE: $(expr, context)
                    // (which is just equivalent to: $(context).find(expr)
                } else {
                    return this.constructor( context ).find( selector );
                }

                // HANDLE: $(DOMElement)
            } else if ( selector.nodeType ) {
                this.context = this[ 0 ] = selector;
                this.length = 1;
                return this;

                // HANDLE: $(function)
                // Shortcut for document ready
            } else if ( jQuery.isFunction( selector ) ) {
                return root.ready !== undefined ?
                    root.ready( selector ) :

                    // Execute immediately if ready is not present
                    selector( jQuery );
            }

            if ( selector.selector !== undefined ) {
                this.selector = selector.selector;
                this.context = selector.context;
            }

            return jQuery.makeArray( selector, this );
        };

// Give the init function the jQuery prototype for later instantiation
    init.prototype = jQuery.fn;

// Initialize central reference
    rootjQuery = jQuery( document );


    var rparentsprev = /^(?:parents|prev(?:Until|All))/,

        // Methods guaranteed to produce a unique set when starting from a unique set
        guaranteedUnique = {
            children: true,
            contents: true,
            next: true,
            prev: true
        };

    jQuery.fn.extend( {
        has: function( target ) {
            var targets = jQuery( target, this ),
                l = targets.length;

            return this.filter( function() {
                var i = 0;
                for ( ; i < l; i++ ) {
                    if ( jQuery.contains( this, targets[ i ] ) ) {
                        return true;
                    }
                }
            } );
        },

        closest: function( selectors, context ) {
            var cur,
                i = 0,
                l = this.length,
                matched = [],
                pos = rneedsContext.test( selectors ) || typeof selectors !== "string" ?
                    jQuery( selectors, context || this.context ) :
                    0;

            for ( ; i < l; i++ ) {
                for ( cur = this[ i ]; cur && cur !== context; cur = cur.parentNode ) {

                    // Always skip document fragments
                    if ( cur.nodeType < 11 && ( pos ?
                        pos.index( cur ) > -1 :

                        // Don't pass non-elements to Sizzle
                        cur.nodeType === 1 &&
                        jQuery.find.matchesSelector( cur, selectors ) ) ) {

                        matched.push( cur );
                        break;
                    }
                }
            }

            return this.pushStack( matched.length > 1 ? jQuery.uniqueSort( matched ) : matched );
        },

        // Determine the position of an element within the set
        index: function( elem ) {

            // No argument, return index in parent
            if ( !elem ) {
                return ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;
            }

            // Index in selector
            if ( typeof elem === "string" ) {
                return indexOf.call( jQuery( elem ), this[ 0 ] );
            }

            // Locate the position of the desired element
            return indexOf.call( this,

                // If it receives a jQuery object, the first element is used
                elem.jquery ? elem[ 0 ] : elem
            );
        },

        add: function( selector, context ) {
            return this.pushStack(
                jQuery.uniqueSort(
                    jQuery.merge( this.get(), jQuery( selector, context ) )
                )
            );
        },

        addBack: function( selector ) {
            return this.add( selector == null ?
                this.prevObject : this.prevObject.filter( selector )
            );
        }
    } );

    function sibling( cur, dir ) {
        while ( ( cur = cur[ dir ] ) && cur.nodeType !== 1 ) {}
        return cur;
    }

    jQuery.each( {
        parent: function( elem ) {
            var parent = elem.parentNode;
            return parent && parent.nodeType !== 11 ? parent : null;
        },
        parents: function( elem ) {
            return dir( elem, "parentNode" );
        },
        parentsUntil: function( elem, i, until ) {
            return dir( elem, "parentNode", until );
        },
        next: function( elem ) {
            return sibling( elem, "nextSibling" );
        },
        prev: function( elem ) {
            return sibling( elem, "previousSibling" );
        },
        nextAll: function( elem ) {
            return dir( elem, "nextSibling" );
        },
        prevAll: function( elem ) {
            return dir( elem, "previousSibling" );
        },
        nextUntil: function( elem, i, until ) {
            return dir( elem, "nextSibling", until );
        },
        prevUntil: function( elem, i, until ) {
            return dir( elem, "previousSibling", until );
        },
        siblings: function( elem ) {
            return siblings( ( elem.parentNode || {} ).firstChild, elem );
        },
        children: function( elem ) {
            return siblings( elem.firstChild );
        },
        contents: function( elem ) {
            return elem.contentDocument || jQuery.merge( [], elem.childNodes );
        }
    }, function( name, fn ) {
        jQuery.fn[ name ] = function( until, selector ) {
            var matched = jQuery.map( this, fn, until );

            if ( name.slice( -5 ) !== "Until" ) {
                selector = until;
            }

            if ( selector && typeof selector === "string" ) {
                matched = jQuery.filter( selector, matched );
            }

            if ( this.length > 1 ) {

                // Remove duplicates
                if ( !guaranteedUnique[ name ] ) {
                    jQuery.uniqueSort( matched );
                }

                // Reverse order for parents* and prev-derivatives
                if ( rparentsprev.test( name ) ) {
                    matched.reverse();
                }
            }

            return this.pushStack( matched );
        };
    } );
    var rnotwhite = ( /\S+/g );



// Convert String-formatted options into Object-formatted ones
    function createOptions( options ) {
        var object = {};
        jQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {
            object[ flag ] = true;
        } );
        return object;
    }

    /*
 * Create a callback list using the following parameters:
 *
 *	options: an optional list of space-separated options that will change how
 *			the callback list behaves or a more traditional option object
 *
 * By default a callback list will act like an event callback list and can be
 * "fired" multiple times.
 *
 * Possible options:
 *
 *	once:			will ensure the callback list can only be fired once (like a Deferred)
 *
 *	memory:			will keep track of previous values and will call any callback added
 *					after the list has been fired right away with the latest "memorized"
 *					values (like a Deferred)
 *
 *	unique:			will ensure a callback can only be added once (no duplicate in the list)
 *
 *	stopOnFalse:	interrupt callings when a callback returns false
 *
 */
    jQuery.Callbacks = function( options ) {

        // Convert options from String-formatted to Object-formatted if needed
        // (we check in cache first)
        options = typeof options === "string" ?
            createOptions( options ) :
            jQuery.extend( {}, options );

        var // Flag to know if list is currently firing
            firing,

            // Last fire value for non-forgettable lists
            memory,

            // Flag to know if list was already fired
            fired,

            // Flag to prevent firing
            locked,

            // Actual callback list
            list = [],

            // Queue of execution data for repeatable lists
            queue = [],

            // Index of currently firing callback (modified by add/remove as needed)
            firingIndex = -1,

            // Fire callbacks
            fire = function() {

                // Enforce single-firing
                locked = options.once;

                // Execute callbacks for all pending executions,
                // respecting firingIndex overrides and runtime changes
                fired = firing = true;
                for ( ; queue.length; firingIndex = -1 ) {
                    memory = queue.shift();
                    while ( ++firingIndex < list.length ) {

                        // Run callback and check for early termination
                        if ( list[ firingIndex ].apply( memory[ 0 ], memory[ 1 ] ) === false &&
                            options.stopOnFalse ) {

                            // Jump to end and forget the data so .add doesn't re-fire
                            firingIndex = list.length;
                            memory = false;
                        }
                    }
                }

                // Forget the data if we're done with it
                if ( !options.memory ) {
                    memory = false;
                }

                firing = false;

                // Clean up if we're done firing for good
                if ( locked ) {

                    // Keep an empty list if we have data for future add calls
                    if ( memory ) {
                        list = [];

                        // Otherwise, this object is spent
                    } else {
                        list = "";
                    }
                }
            },

            // Actual Callbacks object
            self = {

                // Add a callback or a collection of callbacks to the list
                add: function() {
                    if ( list ) {

                        // If we have memory from a past run, we should fire after adding
                        if ( memory && !firing ) {
                            firingIndex = list.length - 1;
                            queue.push( memory );
                        }

                        ( function add( args ) {
                            jQuery.each( args, function( _, arg ) {
                                if ( jQuery.isFunction( arg ) ) {
                                    if ( !options.unique || !self.has( arg ) ) {
                                        list.push( arg );
                                    }
                                } else if ( arg && arg.length && jQuery.type( arg ) !== "string" ) {

                                    // Inspect recursively
                                    add( arg );
                                }
                            } );
                        } )( arguments );

                        if ( memory && !firing ) {
                            fire();
                        }
                    }
                    return this;
                },

                // Remove a callback from the list
                remove: function() {
                    jQuery.each( arguments, function( _, arg ) {
                        var index;
                        while ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {
                            list.splice( index, 1 );

                            // Handle firing indexes
                            if ( index <= firingIndex ) {
                                firingIndex--;
                            }
                        }
                    } );
                    return this;
                },

                // Check if a given callback is in the list.
                // If no argument is given, return whether or not list has callbacks attached.
                has: function( fn ) {
                    return fn ?
                        jQuery.inArray( fn, list ) > -1 :
                        list.length > 0;
                },

                // Remove all callbacks from the list
                empty: function() {
                    if ( list ) {
                        list = [];
                    }
                    return this;
                },

                // Disable .fire and .add
                // Abort any current/pending executions
                // Clear all callbacks and values
                disable: function() {
                    locked = queue = [];
                    list = memory = "";
                    return this;
                },
                disabled: function() {
                    return !list;
                },

                // Disable .fire
                // Also disable .add unless we have memory (since it would have no effect)
                // Abort any pending executions
                lock: function() {
                    locked = queue = [];
                    if ( !memory ) {
                        list = memory = "";
                    }
                    return this;
                },
                locked: function() {
                    return !!locked;
                },

                // Call all callbacks with the given context and arguments
                fireWith: function( context, args ) {
                    if ( !locked ) {
                        args = args || [];
                        args = [ context, args.slice ? args.slice() : args ];
                        queue.push( args );
                        if ( !firing ) {
                            fire();
                        }
                    }
                    return this;
                },

                // Call all the callbacks with the given arguments
                fire: function() {
                    self.fireWith( this, arguments );
                    return this;
                },

                // To know if the callbacks have already been called at least once
                fired: function() {
                    return !!fired;
                }
            };

        return self;
    };


    jQuery.extend( {

        Deferred: function( func ) {
            var tuples = [

                    // action, add listener, listener list, final state
                    [ "resolve", "done", jQuery.Callbacks( "once memory" ), "resolved" ],
                    [ "reject", "fail", jQuery.Callbacks( "once memory" ), "rejected" ],
                    [ "notify", "progress", jQuery.Callbacks( "memory" ) ]
                ],
                state = "pending",
                promise = {
                    state: function() {
                        return state;
                    },
                    always: function() {
                        deferred.done( arguments ).fail( arguments );
                        return this;
                    },
                    then: function( /* fnDone, fnFail, fnProgress */ ) {
                        var fns = arguments;
                        return jQuery.Deferred( function( newDefer ) {
                            jQuery.each( tuples, function( i, tuple ) {
                                var fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];

                                // deferred[ done | fail | progress ] for forwarding actions to newDefer
                                deferred[ tuple[ 1 ] ]( function() {
                                    var returned = fn && fn.apply( this, arguments );
                                    if ( returned && jQuery.isFunction( returned.promise ) ) {
                                        returned.promise()
                                            .progress( newDefer.notify )
                                            .done( newDefer.resolve )
                                            .fail( newDefer.reject );
                                    } else {
                                        newDefer[ tuple[ 0 ] + "With" ](
                                            this === promise ? newDefer.promise() : this,
                                            fn ? [ returned ] : arguments
                                        );
                                    }
                                } );
                            } );
                            fns = null;
                        } ).promise();
                    },

                    // Get a promise for this deferred
                    // If obj is provided, the promise aspect is added to the object
                    promise: function( obj ) {
                        return obj != null ? jQuery.extend( obj, promise ) : promise;
                    }
                },
                deferred = {};

            // Keep pipe for back-compat
            promise.pipe = promise.then;

            // Add list-specific methods
            jQuery.each( tuples, function( i, tuple ) {
                var list = tuple[ 2 ],
                    stateString = tuple[ 3 ];

                // promise[ done | fail | progress ] = list.add
                promise[ tuple[ 1 ] ] = list.add;

                // Handle state
                if ( stateString ) {
                    list.add( function() {

                        // state = [ resolved | rejected ]
                        state = stateString;

                        // [ reject_list | resolve_list ].disable; progress_list.lock
                    }, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );
                }

                // deferred[ resolve | reject | notify ]
                deferred[ tuple[ 0 ] ] = function() {
                    deferred[ tuple[ 0 ] + "With" ]( this === deferred ? promise : this, arguments );
                    return this;
                };
                deferred[ tuple[ 0 ] + "With" ] = list.fireWith;
            } );

            // Make the deferred a promise
            promise.promise( deferred );

            // Call given func if any
            if ( func ) {
                func.call( deferred, deferred );
            }

            // All done!
            return deferred;
        },

        // Deferred helper
        when: function( subordinate /* , ..., subordinateN */ ) {
            var i = 0,
                resolveValues = slice.call( arguments ),
                length = resolveValues.length,

                // the count of uncompleted subordinates
                remaining = length !== 1 ||
                ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,

                // the master Deferred.
                // If resolveValues consist of only a single Deferred, just use that.
                deferred = remaining === 1 ? subordinate : jQuery.Deferred(),

                // Update function for both resolve and progress values
                updateFunc = function( i, contexts, values ) {
                    return function( value ) {
                        contexts[ i ] = this;
                        values[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;
                        if ( values === progressValues ) {
                            deferred.notifyWith( contexts, values );
                        } else if ( !( --remaining ) ) {
                            deferred.resolveWith( contexts, values );
                        }
                    };
                },

                progressValues, progressContexts, resolveContexts;

            // Add listeners to Deferred subordinates; treat others as resolved
            if ( length > 1 ) {
                progressValues = new Array( length );
                progressContexts = new Array( length );
                resolveContexts = new Array( length );
                for ( ; i < length; i++ ) {
                    if ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {
                        resolveValues[ i ].promise()
                            .progress( updateFunc( i, progressContexts, progressValues ) )
                            .done( updateFunc( i, resolveContexts, resolveValues ) )
                            .fail( deferred.reject );
                    } else {
                        --remaining;
                    }
                }
            }

            // If we're not waiting on anything, resolve the master
            if ( !remaining ) {
                deferred.resolveWith( resolveContexts, resolveValues );
            }

            return deferred.promise();
        }
    } );


// The deferred used on DOM ready
    var readyList;

    jQuery.fn.ready = function( fn ) {

        // Add the callback
        jQuery.ready.promise().done( fn );

        return this;
    };

    jQuery.extend( {

        // Is the DOM ready to be used? Set to true once it occurs.
        isReady: false,

        // A counter to track how many items to wait for before
        // the ready event fires. See #6781
        readyWait: 1,

        // Hold (or release) the ready event
        holdReady: function( hold ) {
            if ( hold ) {
                jQuery.readyWait++;
            } else {
                jQuery.ready( true );
            }
        },

        // Handle when the DOM is ready
        ready: function( wait ) {

            // Abort if there are pending holds or we're already ready
            if ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {
                return;
            }

            // Remember that the DOM is ready
            jQuery.isReady = true;

            // If a normal DOM Ready event fired, decrement, and wait if need be
            if ( wait !== true && --jQuery.readyWait > 0 ) {
                return;
            }

            // If there are functions bound, to execute
            readyList.resolveWith( document, [ jQuery ] );

            // Trigger any bound ready events
            if ( jQuery.fn.triggerHandler ) {
                jQuery( document ).triggerHandler( "ready" );
                jQuery( document ).off( "ready" );
            }
        }
    } );

    /**
     * The ready event handler and self cleanup method
     */
    function completed() {
        document.removeEventListener( "DOMContentLoaded", completed );
        window.removeEventListener( "load", completed );
        jQuery.ready();
    }

    jQuery.ready.promise = function( obj ) {
        if ( !readyList ) {

            readyList = jQuery.Deferred();

            // Catch cases where $(document).ready() is called
            // after the browser event has already occurred.
            // Support: IE9-10 only
            // Older IE sometimes signals "interactive" too soon
            if ( document.readyState === "complete" ||
                ( document.readyState !== "loading" && !document.documentElement.doScroll ) ) {

                // Handle it asynchronously to allow scripts the opportunity to delay ready
                window.setTimeout( jQuery.ready );

            } else {

                // Use the handy event callback
                document.addEventListener( "DOMContentLoaded", completed );

                // A fallback to window.onload, that will always work
                window.addEventListener( "load", completed );
            }
        }
        return readyList.promise( obj );
    };

// Kick off the DOM ready check even if the user does not
    jQuery.ready.promise();




// Multifunctional method to get and set values of a collection
// The value/s can optionally be executed if it's a function
    var access = function( elems, fn, key, value, chainable, emptyGet, raw ) {
        var i = 0,
            len = elems.length,
            bulk = key == null;

        // Sets many values
        if ( jQuery.type( key ) === "object" ) {
            chainable = true;
            for ( i in key ) {
                access( elems, fn, i, key[ i ], true, emptyGet, raw );
            }

            // Sets one value
        } else if ( value !== undefined ) {
            chainable = true;

            if ( !jQuery.isFunction( value ) ) {
                raw = true;
            }

            if ( bulk ) {

                // Bulk operations run against the entire set
                if ( raw ) {
                    fn.call( elems, value );
                    fn = null;

                    // ...except when executing function values
                } else {
                    bulk = fn;
                    fn = function( elem, key, value ) {
                        return bulk.call( jQuery( elem ), value );
                    };
                }
            }

            if ( fn ) {
                for ( ; i < len; i++ ) {
                    fn(
                        elems[ i ], key, raw ?
                            value :
                            value.call( elems[ i ], i, fn( elems[ i ], key ) )
                    );
                }
            }
        }

        return chainable ?
            elems :

            // Gets
            bulk ?
                fn.call( elems ) :
                len ? fn( elems[ 0 ], key ) : emptyGet;
    };
    var acceptData = function( owner ) {

        // Accepts only:
        //  - Node
        //    - Node.ELEMENT_NODE
        //    - Node.DOCUMENT_NODE
        //  - Object
        //    - Any
        /* jshint -W018 */
        return owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );
    };




    function Data() {
        this.expando = jQuery.expando + Data.uid++;
    }

    Data.uid = 1;

    Data.prototype = {

        register: function( owner, initial ) {
            var value = initial || {};

            // If it is a node unlikely to be stringify-ed or looped over
            // use plain assignment
            if ( owner.nodeType ) {
                owner[ this.expando ] = value;

                // Otherwise secure it in a non-enumerable, non-writable property
                // configurability must be true to allow the property to be
                // deleted with the delete operator
            } else {
                Object.defineProperty( owner, this.expando, {
                    value: value,
                    writable: true,
                    configurable: true
                } );
            }
            return owner[ this.expando ];
        },
        cache: function( owner ) {

            // We can accept data for non-element nodes in modern browsers,
            // but we should not, see #8335.
            // Always return an empty object.
            if ( !acceptData( owner ) ) {
                return {};
            }

            // Check if the owner object already has a cache
            var value = owner[ this.expando ];

            // If not, create one
            if ( !value ) {
                value = {};

                // We can accept data for non-element nodes in modern browsers,
                // but we should not, see #8335.
                // Always return an empty object.
                if ( acceptData( owner ) ) {

                    // If it is a node unlikely to be stringify-ed or looped over
                    // use plain assignment
                    if ( owner.nodeType ) {
                        owner[ this.expando ] = value;

                        // Otherwise secure it in a non-enumerable property
                        // configurable must be true to allow the property to be
                        // deleted when data is removed
                    } else {
                        Object.defineProperty( owner, this.expando, {
                            value: value,
                            configurable: true
                        } );
                    }
                }
            }

            return value;
        },
        set: function( owner, data, value ) {
            var prop,
                cache = this.cache( owner );

            // Handle: [ owner, key, value ] args
            if ( typeof data === "string" ) {
                cache[ data ] = value;

                // Handle: [ owner, { properties } ] args
            } else {

                // Copy the properties one-by-one to the cache object
                for ( prop in data ) {
                    cache[ prop ] = data[ prop ];
                }
            }
            return cache;
        },
        get: function( owner, key ) {
            return key === undefined ?
                this.cache( owner ) :
                owner[ this.expando ] && owner[ this.expando ][ key ];
        },
        access: function( owner, key, value ) {
            var stored;

            // In cases where either:
            //
            //   1. No key was specified
            //   2. A string key was specified, but no value provided
            //
            // Take the "read" path and allow the get method to determine
            // which value to return, respectively either:
            //
            //   1. The entire cache object
            //   2. The data stored at the key
            //
            if ( key === undefined ||
                ( ( key && typeof key === "string" ) && value === undefined ) ) {

                stored = this.get( owner, key );

                return stored !== undefined ?
                    stored : this.get( owner, jQuery.camelCase( key ) );
            }

            // When the key is not a string, or both a key and value
            // are specified, set or extend (existing objects) with either:
            //
            //   1. An object of properties
            //   2. A key and value
            //
            this.set( owner, key, value );

            // Since the "set" path can have two possible entry points
            // return the expected data based on which path was taken[*]
            return value !== undefined ? value : key;
        },
        remove: function( owner, key ) {
            var i, name, camel,
                cache = owner[ this.expando ];

            if ( cache === undefined ) {
                return;
            }

            if ( key === undefined ) {
                this.register( owner );

            } else {

                // Support array or space separated string of keys
                if ( jQuery.isArray( key ) ) {

                    // If "name" is an array of keys...
                    // When data is initially created, via ("key", "val") signature,
                    // keys will be converted to camelCase.
                    // Since there is no way to tell _how_ a key was added, remove
                    // both plain key and camelCase key. #12786
                    // This will only penalize the array argument path.
                    name = key.concat( key.map( jQuery.camelCase ) );
                } else {
                    camel = jQuery.camelCase( key );

                    // Try the string as a key before any manipulation
                    if ( key in cache ) {
                        name = [ key, camel ];
                    } else {

                        // If a key with the spaces exists, use it.
                        // Otherwise, create an array by matching non-whitespace
                        name = camel;
                        name = name in cache ?
                            [ name ] : ( name.match( rnotwhite ) || [] );
                    }
                }

                i = name.length;

                while ( i-- ) {
                    delete cache[ name[ i ] ];
                }
            }

            // Remove the expando if there's no more data
            if ( key === undefined || jQuery.isEmptyObject( cache ) ) {

                // Support: Chrome <= 35-45+
                // Webkit & Blink performance suffers when deleting properties
                // from DOM nodes, so set to undefined instead
                // https://code.google.com/p/chromium/issues/detail?id=378607
                if ( owner.nodeType ) {
                    owner[ this.expando ] = undefined;
                } else {
                    delete owner[ this.expando ];
                }
            }
        },
        hasData: function( owner ) {
            var cache = owner[ this.expando ];
            return cache !== undefined && !jQuery.isEmptyObject( cache );
        }
    };
    var dataPriv = new Data();

    var dataUser = new Data();



//	Implementation Summary
//
//	1. Enforce API surface and semantic compatibility with 1.9.x branch
//	2. Improve the module's maintainability by reducing the storage
//		paths to a single mechanism.
//	3. Use the same single mechanism to support "private" and "user" data.
//	4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)
//	5. Avoid exposing implementation details on user objects (eg. expando properties)
//	6. Provide a clear path for implementation upgrade to WeakMap in 2014

    var rbrace = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
        rmultiDash = /[A-Z]/g;

    function dataAttr( elem, key, data ) {
        var name;

        // If nothing was found internally, try to fetch any
        // data from the HTML5 data-* attribute
        if ( data === undefined && elem.nodeType === 1 ) {
            name = "data-" + key.replace( rmultiDash, "-$&" ).toLowerCase();
            data = elem.getAttribute( name );

            if ( typeof data === "string" ) {
                try {
                    data = data === "true" ? true :
                        data === "false" ? false :
                            data === "null" ? null :

                                // Only convert to a number if it doesn't change the string
                                +data + "" === data ? +data :
                                    rbrace.test( data ) ? jQuery.parseJSON( data ) :
                                        data;
                } catch ( e ) {}

                // Make sure we set the data so it isn't changed later
                dataUser.set( elem, key, data );
            } else {
                data = undefined;
            }
        }
        return data;
    }

    jQuery.extend( {
        hasData: function( elem ) {
            return dataUser.hasData( elem ) || dataPriv.hasData( elem );
        },

        data: function( elem, name, data ) {
            return dataUser.access( elem, name, data );
        },

        removeData: function( elem, name ) {
            dataUser.remove( elem, name );
        },

        // TODO: Now that all calls to _data and _removeData have been replaced
        // with direct calls to dataPriv methods, these can be deprecated.
        _data: function( elem, name, data ) {
            return dataPriv.access( elem, name, data );
        },

        _removeData: function( elem, name ) {
            dataPriv.remove( elem, name );
        }
    } );

    jQuery.fn.extend( {
        data: function( key, value ) {
            var i, name, data,
                elem = this[ 0 ],
                attrs = elem && elem.attributes;

            // Gets all values
            if ( key === undefined ) {
                if ( this.length ) {
                    data = dataUser.get( elem );

                    if ( elem.nodeType === 1 && !dataPriv.get( elem, "hasDataAttrs" ) ) {
                        i = attrs.length;
                        while ( i-- ) {

                            // Support: IE11+
                            // The attrs elements can be null (#14894)
                            if ( attrs[ i ] ) {
                                name = attrs[ i ].name;
                                if ( name.indexOf( "data-" ) === 0 ) {
                                    name = jQuery.camelCase( name.slice( 5 ) );
                                    dataAttr( elem, name, data[ name ] );
                                }
                            }
                        }
                        dataPriv.set( elem, "hasDataAttrs", true );
                    }
                }

                return data;
            }

            // Sets multiple values
            if ( typeof key === "object" ) {
                return this.each( function() {
                    dataUser.set( this, key );
                } );
            }

            return access( this, function( value ) {
                var data, camelKey;

                // The calling jQuery object (element matches) is not empty
                // (and therefore has an element appears at this[ 0 ]) and the
                // `value` parameter was not undefined. An empty jQuery object
                // will result in `undefined` for elem = this[ 0 ] which will
                // throw an exception if an attempt to read a data cache is made.
                if ( elem && value === undefined ) {

                    // Attempt to get data from the cache
                    // with the key as-is
                    data = dataUser.get( elem, key ) ||

                        // Try to find dashed key if it exists (gh-2779)
                        // This is for 2.2.x only
                        dataUser.get( elem, key.replace( rmultiDash, "-$&" ).toLowerCase() );

                    if ( data !== undefined ) {
                        return data;
                    }

                    camelKey = jQuery.camelCase( key );

                    // Attempt to get data from the cache
                    // with the key camelized
                    data = dataUser.get( elem, camelKey );
                    if ( data !== undefined ) {
                        return data;
                    }

                    // Attempt to "discover" the data in
                    // HTML5 custom data-* attrs
                    data = dataAttr( elem, camelKey, undefined );
                    if ( data !== undefined ) {
                        return data;
                    }

                    // We tried really hard, but the data doesn't exist.
                    return;
                }

                // Set the data...
                camelKey = jQuery.camelCase( key );
                this.each( function() {

                    // First, attempt to store a copy or reference of any
                    // data that might've been store with a camelCased key.
                    var data = dataUser.get( this, camelKey );

                    // For HTML5 data-* attribute interop, we have to
                    // store property names with dashes in a camelCase form.
                    // This might not apply to all properties...*
                    dataUser.set( this, camelKey, value );

                    // *... In the case of properties that might _actually_
                    // have dashes, we need to also store a copy of that
                    // unchanged property.
                    if ( key.indexOf( "-" ) > -1 && data !== undefined ) {
                        dataUser.set( this, key, value );
                    }
                } );
            }, null, value, arguments.length > 1, null, true );
        },

        removeData: function( key ) {
            return this.each( function() {
                dataUser.remove( this, key );
            } );
        }
    } );


    jQuery.extend( {
        queue: function( elem, type, data ) {
            var queue;

            if ( elem ) {
                type = ( type || "fx" ) + "queue";
                queue = dataPriv.get( elem, type );

                // Speed up dequeue by getting out quickly if this is just a lookup
                if ( data ) {
                    if ( !queue || jQuery.isArray( data ) ) {
                        queue = dataPriv.access( elem, type, jQuery.makeArray( data ) );
                    } else {
                        queue.push( data );
                    }
                }
                return queue || [];
            }
        },

        dequeue: function( elem, type ) {
            type = type || "fx";

            var queue = jQuery.queue( elem, type ),
                startLength = queue.length,
                fn = queue.shift(),
                hooks = jQuery._queueHooks( elem, type ),
                next = function() {
                    jQuery.dequeue( elem, type );
                };

            // If the fx queue is dequeued, always remove the progress sentinel
            if ( fn === "inprogress" ) {
                fn = queue.shift();
                startLength--;
            }

            if ( fn ) {

                // Add a progress sentinel to prevent the fx queue from being
                // automatically dequeued
                if ( type === "fx" ) {
                    queue.unshift( "inprogress" );
                }

                // Clear up the last queue stop function
                delete hooks.stop;
                fn.call( elem, next, hooks );
            }

            if ( !startLength && hooks ) {
                hooks.empty.fire();
            }
        },

        // Not public - generate a queueHooks object, or return the current one
        _queueHooks: function( elem, type ) {
            var key = type + "queueHooks";
            return dataPriv.get( elem, key ) || dataPriv.access( elem, key, {
                empty: jQuery.Callbacks( "once memory" ).add( function() {
                    dataPriv.remove( elem, [ type + "queue", key ] );
                } )
            } );
        }
    } );

    jQuery.fn.extend( {
        queue: function( type, data ) {
            var setter = 2;

            if ( typeof type !== "string" ) {
                data = type;
                type = "fx";
                setter--;
            }

            if ( arguments.length < setter ) {
                return jQuery.queue( this[ 0 ], type );
            }

            return data === undefined ?
                this :
                this.each( function() {
                    var queue = jQuery.queue( this, type, data );

                    // Ensure a hooks for this queue
                    jQuery._queueHooks( this, type );

                    if ( type === "fx" && queue[ 0 ] !== "inprogress" ) {
                        jQuery.dequeue( this, type );
                    }
                } );
        },
        dequeue: function( type ) {
            return this.each( function() {
                jQuery.dequeue( this, type );
            } );
        },
        clearQueue: function( type ) {
            return this.queue( type || "fx", [] );
        },

        // Get a promise resolved when queues of a certain type
        // are emptied (fx is the type by default)
        promise: function( type, obj ) {
            var tmp,
                count = 1,
                defer = jQuery.Deferred(),
                elements = this,
                i = this.length,
                resolve = function() {
                    if ( !( --count ) ) {
                        defer.resolveWith( elements, [ elements ] );
                    }
                };

            if ( typeof type !== "string" ) {
                obj = type;
                type = undefined;
            }
            type = type || "fx";

            while ( i-- ) {
                tmp = dataPriv.get( elements[ i ], type + "queueHooks" );
                if ( tmp && tmp.empty ) {
                    count++;
                    tmp.empty.add( resolve );
                }
            }
            resolve();
            return defer.promise( obj );
        }
    } );
    var pnum = ( /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/ ).source;

    var rcssNum = new RegExp( "^(?:([+-])=|)(" + pnum + ")([a-z%]*)$", "i" );


    var cssExpand = [ "Top", "Right", "Bottom", "Left" ];

    var isHidden = function( elem, el ) {

        // isHidden might be called from jQuery#filter function;
        // in that case, element will be second argument
        elem = el || elem;
        return jQuery.css( elem, "display" ) === "none" ||
            !jQuery.contains( elem.ownerDocument, elem );
    };



    function adjustCSS( elem, prop, valueParts, tween ) {
        var adjusted,
            scale = 1,
            maxIterations = 20,
            currentValue = tween ?
                function() { return tween.cur(); } :
                function() { return jQuery.css( elem, prop, "" ); },
            initial = currentValue(),
            unit = valueParts && valueParts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),

            // Starting value computation is required for potential unit mismatches
            initialInUnit = ( jQuery.cssNumber[ prop ] || unit !== "px" && +initial ) &&
                rcssNum.exec( jQuery.css( elem, prop ) );

        if ( initialInUnit && initialInUnit[ 3 ] !== unit ) {

            // Trust units reported by jQuery.css
            unit = unit || initialInUnit[ 3 ];

            // Make sure we update the tween properties later on
            valueParts = valueParts || [];

            // Iteratively approximate from a nonzero starting point
            initialInUnit = +initial || 1;

            do {

                // If previous iteration zeroed out, double until we get *something*.
                // Use string for doubling so we don't accidentally see scale as unchanged below
                scale = scale || ".5";

                // Adjust and apply
                initialInUnit = initialInUnit / scale;
                jQuery.style( elem, prop, initialInUnit + unit );

                // Update scale, tolerating zero or NaN from tween.cur()
                // Break the loop if scale is unchanged or perfect, or if we've just had enough.
            } while (
                scale !== ( scale = currentValue() / initial ) && scale !== 1 && --maxIterations
                );
        }

        if ( valueParts ) {
            initialInUnit = +initialInUnit || +initial || 0;

            // Apply relative offset (+=/-=) if specified
            adjusted = valueParts[ 1 ] ?
                initialInUnit + ( valueParts[ 1 ] + 1 ) * valueParts[ 2 ] :
                +valueParts[ 2 ];
            if ( tween ) {
                tween.unit = unit;
                tween.start = initialInUnit;
                tween.end = adjusted;
            }
        }
        return adjusted;
    }
    var rcheckableType = ( /^(?:checkbox|radio)$/i );

    var rtagName = ( /<([\w:-]+)/ );

    var rscriptType = ( /^$|\/(?:java|ecma)script/i );



// We have to close these tags to support XHTML (#13200)
    var wrapMap = {

        // Support: IE9
        option: [ 1, "<select multiple='multiple'>", "</select>" ],

        // XHTML parsers do not magically insert elements in the
        // same way that tag soup parsers do. So we cannot shorten
        // this by omitting <tbody> or other required elements.
        thead: [ 1, "<table>", "</table>" ],
        col: [ 2, "<table><colgroup>", "</colgroup></table>" ],
        tr: [ 2, "<table><tbody>", "</tbody></table>" ],
        td: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],

        _default: [ 0, "", "" ]
    };

// Support: IE9
    wrapMap.optgroup = wrapMap.option;

    wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;
    wrapMap.th = wrapMap.td;


    function getAll( context, tag ) {

        // Support: IE9-11+
        // Use typeof to avoid zero-argument method invocation on host objects (#15151)
        var ret = typeof context.getElementsByTagName !== "undefined" ?
            context.getElementsByTagName( tag || "*" ) :
            typeof context.querySelectorAll !== "undefined" ?
                context.querySelectorAll( tag || "*" ) :
                [];

        return tag === undefined || tag && jQuery.nodeName( context, tag ) ?
            jQuery.merge( [ context ], ret ) :
            ret;
    }


// Mark scripts as having already been evaluated
    function setGlobalEval( elems, refElements ) {
        var i = 0,
            l = elems.length;

        for ( ; i < l; i++ ) {
            dataPriv.set(
                elems[ i ],
                "globalEval",
                !refElements || dataPriv.get( refElements[ i ], "globalEval" )
            );
        }
    }


    var rhtml = /<|&#?\w+;/;

    function buildFragment( elems, context, scripts, selection, ignored ) {
        var elem, tmp, tag, wrap, contains, j,
            fragment = context.createDocumentFragment(),
            nodes = [],
            i = 0,
            l = elems.length;

        for ( ; i < l; i++ ) {
            elem = elems[ i ];

            if ( elem || elem === 0 ) {

                // Add nodes directly
                if ( jQuery.type( elem ) === "object" ) {

                    // Support: Android<4.1, PhantomJS<2
                    // push.apply(_, arraylike) throws on ancient WebKit
                    jQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );

                    // Convert non-html into a text node
                } else if ( !rhtml.test( elem ) ) {
                    nodes.push( context.createTextNode( elem ) );

                    // Convert html into DOM nodes
                } else {
                    tmp = tmp || fragment.appendChild( context.createElement( "div" ) );

                    // Deserialize a standard representation
                    tag = ( rtagName.exec( elem ) || [ "", "" ] )[ 1 ].toLowerCase();
                    wrap = wrapMap[ tag ] || wrapMap._default;
                    tmp.innerHTML = wrap[ 1 ] + jQuery.htmlPrefilter( elem ) + wrap[ 2 ];

                    // Descend through wrappers to the right content
                    j = wrap[ 0 ];
                    while ( j-- ) {
                        tmp = tmp.lastChild;
                    }

                    // Support: Android<4.1, PhantomJS<2
                    // push.apply(_, arraylike) throws on ancient WebKit
                    jQuery.merge( nodes, tmp.childNodes );

                    // Remember the top-level container
                    tmp = fragment.firstChild;

                    // Ensure the created nodes are orphaned (#12392)
                    tmp.textContent = "";
                }
            }
        }

        // Remove wrapper from fragment
        fragment.textContent = "";

        i = 0;
        while ( ( elem = nodes[ i++ ] ) ) {

            // Skip elements already in the context collection (trac-4087)
            if ( selection && jQuery.inArray( elem, selection ) > -1 ) {
                if ( ignored ) {
                    ignored.push( elem );
                }
                continue;
            }

            contains = jQuery.contains( elem.ownerDocument, elem );

            // Append to fragment
            tmp = getAll( fragment.appendChild( elem ), "script" );

            // Preserve script evaluation history
            if ( contains ) {
                setGlobalEval( tmp );
            }

            // Capture executables
            if ( scripts ) {
                j = 0;
                while ( ( elem = tmp[ j++ ] ) ) {
                    if ( rscriptType.test( elem.type || "" ) ) {
                        scripts.push( elem );
                    }
                }
            }
        }

        return fragment;
    }


    ( function() {
        var fragment = document.createDocumentFragment(),
            div = fragment.appendChild( document.createElement( "div" ) ),
            input = document.createElement( "input" );

        // Support: Android 4.0-4.3, Safari<=5.1
        // Check state lost if the name is set (#11217)
        // Support: Windows Web Apps (WWA)
        // `name` and `type` must use .setAttribute for WWA (#14901)
        input.setAttribute( "type", "radio" );
        input.setAttribute( "checked", "checked" );
        input.setAttribute( "name", "t" );

        div.appendChild( input );

        // Support: Safari<=5.1, Android<4.2
        // Older WebKit doesn't clone checked state correctly in fragments
        support.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;

        // Support: IE<=11+
        // Make sure textarea (and checkbox) defaultValue is properly cloned
        div.innerHTML = "<textarea>x</textarea>";
        support.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;
    } )();


    var
        rkeyEvent = /^key/,
        rmouseEvent = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
        rtypenamespace = /^([^.]*)(?:\.(.+)|)/;

    function returnTrue() {
        return true;
    }

    function returnFalse() {
        return false;
    }

// Support: IE9
// See #13393 for more info
    function safeActiveElement() {
        try {
            return document.activeElement;
        } catch ( err ) { }
    }

    function on( elem, types, selector, data, fn, one ) {
        var origFn, type;

        // Types can be a map of types/handlers
        if ( typeof types === "object" ) {

            // ( types-Object, selector, data )
            if ( typeof selector !== "string" ) {

                // ( types-Object, data )
                data = data || selector;
                selector = undefined;
            }
            for ( type in types ) {
                on( elem, type, selector, data, types[ type ], one );
            }
            return elem;
        }

        if ( data == null && fn == null ) {

            // ( types, fn )
            fn = selector;
            data = selector = undefined;
        } else if ( fn == null ) {
            if ( typeof selector === "string" ) {

                // ( types, selector, fn )
                fn = data;
                data = undefined;
            } else {

                // ( types, data, fn )
                fn = data;
                data = selector;
                selector = undefined;
            }
        }
        if ( fn === false ) {
            fn = returnFalse;
        } else if ( !fn ) {
            return elem;
        }

        if ( one === 1 ) {
            origFn = fn;
            fn = function( event ) {

                // Can use an empty set, since event contains the info
                jQuery().off( event );
                return origFn.apply( this, arguments );
            };

            // Use same guid so caller can remove using origFn
            fn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );
        }
        return elem.each( function() {
            jQuery.event.add( this, types, fn, data, selector );
        } );
    }

    /*
 * Helper functions for managing events -- not part of the public interface.
 * Props to Dean Edwards' addEvent library for many of the ideas.
 */
    jQuery.event = {

        global: {},

        add: function( elem, types, handler, data, selector ) {

            var handleObjIn, eventHandle, tmp,
                events, t, handleObj,
                special, handlers, type, namespaces, origType,
                elemData = dataPriv.get( elem );

            // Don't attach events to noData or text/comment nodes (but allow plain objects)
            if ( !elemData ) {
                return;
            }

            // Caller can pass in an object of custom data in lieu of the handler
            if ( handler.handler ) {
                handleObjIn = handler;
                handler = handleObjIn.handler;
                selector = handleObjIn.selector;
            }

            // Make sure that the handler has a unique ID, used to find/remove it later
            if ( !handler.guid ) {
                handler.guid = jQuery.guid++;
            }

            // Init the element's event structure and main handler, if this is the first
            if ( !( events = elemData.events ) ) {
                events = elemData.events = {};
            }
            if ( !( eventHandle = elemData.handle ) ) {
                eventHandle = elemData.handle = function( e ) {

                    // Discard the second event of a jQuery.event.trigger() and
                    // when an event is called after a page has unloaded
                    return typeof jQuery !== "undefined" && jQuery.event.triggered !== e.type ?
                        jQuery.event.dispatch.apply( elem, arguments ) : undefined;
                };
            }

            // Handle multiple events separated by a space
            types = ( types || "" ).match( rnotwhite ) || [ "" ];
            t = types.length;
            while ( t-- ) {
                tmp = rtypenamespace.exec( types[ t ] ) || [];
                type = origType = tmp[ 1 ];
                namespaces = ( tmp[ 2 ] || "" ).split( "." ).sort();

                // There *must* be a type, no attaching namespace-only handlers
                if ( !type ) {
                    continue;
                }

                // If event changes its type, use the special event handlers for the changed type
                special = jQuery.event.special[ type ] || {};

                // If selector defined, determine special event api type, otherwise given type
                type = ( selector ? special.delegateType : special.bindType ) || type;

                // Update special based on newly reset type
                special = jQuery.event.special[ type ] || {};

                // handleObj is passed to all event handlers
                handleObj = jQuery.extend( {
                    type: type,
                    origType: origType,
                    data: data,
                    handler: handler,
                    guid: handler.guid,
                    selector: selector,
                    needsContext: selector && jQuery.expr.match.needsContext.test( selector ),
                    namespace: namespaces.join( "." )
                }, handleObjIn );

                // Init the event handler queue if we're the first
                if ( !( handlers = events[ type ] ) ) {
                    handlers = events[ type ] = [];
                    handlers.delegateCount = 0;

                    // Only use addEventListener if the special events handler returns false
                    if ( !special.setup ||
                        special.setup.call( elem, data, namespaces, eventHandle ) === false ) {

                        if ( elem.addEventListener ) {
                            elem.addEventListener( type, eventHandle );
                        }
                    }
                }

                if ( special.add ) {
                    special.add.call( elem, handleObj );

                    if ( !handleObj.handler.guid ) {
                        handleObj.handler.guid = handler.guid;
                    }
                }

                // Add to the element's handler list, delegates in front
                if ( selector ) {
                    handlers.splice( handlers.delegateCount++, 0, handleObj );
                } else {
                    handlers.push( handleObj );
                }

                // Keep track of which events have ever been used, for event optimization
                jQuery.event.global[ type ] = true;
            }

        },

        // Detach an event or set of events from an element
        remove: function( elem, types, handler, selector, mappedTypes ) {

            var j, origCount, tmp,
                events, t, handleObj,
                special, handlers, type, namespaces, origType,
                elemData = dataPriv.hasData( elem ) && dataPriv.get( elem );

            if ( !elemData || !( events = elemData.events ) ) {
                return;
            }

            // Once for each type.namespace in types; type may be omitted
            types = ( types || "" ).match( rnotwhite ) || [ "" ];
            t = types.length;
            while ( t-- ) {
                tmp = rtypenamespace.exec( types[ t ] ) || [];
                type = origType = tmp[ 1 ];
                namespaces = ( tmp[ 2 ] || "" ).split( "." ).sort();

                // Unbind all events (on this namespace, if provided) for the element
                if ( !type ) {
                    for ( type in events ) {
                        jQuery.event.remove( elem, type + types[ t ], handler, selector, true );
                    }
                    continue;
                }

                special = jQuery.event.special[ type ] || {};
                type = ( selector ? special.delegateType : special.bindType ) || type;
                handlers = events[ type ] || [];
                tmp = tmp[ 2 ] &&
                    new RegExp( "(^|\\.)" + namespaces.join( "\\.(?:.*\\.|)" ) + "(\\.|$)" );

                // Remove matching events
                origCount = j = handlers.length;
                while ( j-- ) {
                    handleObj = handlers[ j ];

                    if ( ( mappedTypes || origType === handleObj.origType ) &&
                        ( !handler || handler.guid === handleObj.guid ) &&
                        ( !tmp || tmp.test( handleObj.namespace ) ) &&
                        ( !selector || selector === handleObj.selector ||
                            selector === "**" && handleObj.selector ) ) {
                        handlers.splice( j, 1 );

                        if ( handleObj.selector ) {
                            handlers.delegateCount--;
                        }
                        if ( special.remove ) {
                            special.remove.call( elem, handleObj );
                        }
                    }
                }

                // Remove generic event handler if we removed something and no more handlers exist
                // (avoids potential for endless recursion during removal of special event handlers)
                if ( origCount && !handlers.length ) {
                    if ( !special.teardown ||
                        special.teardown.call( elem, namespaces, elemData.handle ) === false ) {

                        jQuery.removeEvent( elem, type, elemData.handle );
                    }

                    delete events[ type ];
                }
            }

            // Remove data and the expando if it's no longer used
            if ( jQuery.isEmptyObject( events ) ) {
                dataPriv.remove( elem, "handle events" );
            }
        },

        dispatch: function( event ) {

            // Make a writable jQuery.Event from the native event object
            event = jQuery.event.fix( event );

            var i, j, ret, matched, handleObj,
                handlerQueue = [],
                args = slice.call( arguments ),
                handlers = ( dataPriv.get( this, "events" ) || {} )[ event.type ] || [],
                special = jQuery.event.special[ event.type ] || {};

            // Use the fix-ed jQuery.Event rather than the (read-only) native event
            args[ 0 ] = event;
            event.delegateTarget = this;

            // Call the preDispatch hook for the mapped type, and let it bail if desired
            if ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {
                return;
            }

            // Determine handlers
            handlerQueue = jQuery.event.handlers.call( this, event, handlers );

            // Run delegates first; they may want to stop propagation beneath us
            i = 0;
            while ( ( matched = handlerQueue[ i++ ] ) && !event.isPropagationStopped() ) {
                event.currentTarget = matched.elem;

                j = 0;
                while ( ( handleObj = matched.handlers[ j++ ] ) &&
                !event.isImmediatePropagationStopped() ) {

                    // Triggered event must either 1) have no namespace, or 2) have namespace(s)
                    // a subset or equal to those in the bound event (both can have no namespace).
                    if ( !event.rnamespace || event.rnamespace.test( handleObj.namespace ) ) {

                        event.handleObj = handleObj;
                        event.data = handleObj.data;

                        ret = ( ( jQuery.event.special[ handleObj.origType ] || {} ).handle ||
                            handleObj.handler ).apply( matched.elem, args );

                        if ( ret !== undefined ) {
                            if ( ( event.result = ret ) === false ) {
                                event.preventDefault();
                                event.stopPropagation();
                            }
                        }
                    }
                }
            }

            // Call the postDispatch hook for the mapped type
            if ( special.postDispatch ) {
                special.postDispatch.call( this, event );
            }

            return event.result;
        },

        handlers: function( event, handlers ) {
            var i, matches, sel, handleObj,
                handlerQueue = [],
                delegateCount = handlers.delegateCount,
                cur = event.target;

            // Support (at least): Chrome, IE9
            // Find delegate handlers
            // Black-hole SVG <use> instance trees (#13180)
            //
            // Support: Firefox<=42+
            // Avoid non-left-click in FF but don't block IE radio events (#3861, gh-2343)
            if ( delegateCount && cur.nodeType &&
                ( event.type !== "click" || isNaN( event.button ) || event.button < 1 ) ) {

                for ( ; cur !== this; cur = cur.parentNode || this ) {

                    // Don't check non-elements (#13208)
                    // Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)
                    if ( cur.nodeType === 1 && ( cur.disabled !== true || event.type !== "click" ) ) {
                        matches = [];
                        for ( i = 0; i < delegateCount; i++ ) {
                            handleObj = handlers[ i ];

                            // Don't conflict with Object.prototype properties (#13203)
                            sel = handleObj.selector + " ";

                            if ( matches[ sel ] === undefined ) {
                                matches[ sel ] = handleObj.needsContext ?
                                    jQuery( sel, this ).index( cur ) > -1 :
                                    jQuery.find( sel, this, null, [ cur ] ).length;
                            }
                            if ( matches[ sel ] ) {
                                matches.push( handleObj );
                            }
                        }
                        if ( matches.length ) {
                            handlerQueue.push( { elem: cur, handlers: matches } );
                        }
                    }
                }
            }

            // Add the remaining (directly-bound) handlers
            if ( delegateCount < handlers.length ) {
                handlerQueue.push( { elem: this, handlers: handlers.slice( delegateCount ) } );
            }

            return handlerQueue;
        },

        // Includes some event props shared by KeyEvent and MouseEvent
        props: ( "altKey bubbles cancelable ctrlKey currentTarget detail eventPhase " +
            "metaKey relatedTarget shiftKey target timeStamp view which" ).split( " " ),

        fixHooks: {},

        keyHooks: {
            props: "char charCode key keyCode".split( " " ),
            filter: function( event, original ) {

                // Add which for key events
                if ( event.which == null ) {
                    event.which = original.charCode != null ? original.charCode : original.keyCode;
                }

                return event;
            }
        },

        mouseHooks: {
            props: ( "button buttons clientX clientY offsetX offsetY pageX pageY " +
                "screenX screenY toElement" ).split( " " ),
            filter: function( event, original ) {
                var eventDoc, doc, body,
                    button = original.button;

                // Calculate pageX/Y if missing and clientX/Y available
                if ( event.pageX == null && original.clientX != null ) {
                    eventDoc = event.target.ownerDocument || document;
                    doc = eventDoc.documentElement;
                    body = eventDoc.body;

                    event.pageX = original.clientX +
                        ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) -
                        ( doc && doc.clientLeft || body && body.clientLeft || 0 );
                    event.pageY = original.clientY +
                        ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) -
                        ( doc && doc.clientTop  || body && body.clientTop  || 0 );
                }

                // Add which for click: 1 === left; 2 === middle; 3 === right
                // Note: button is not normalized, so don't use it
                if ( !event.which && button !== undefined ) {
                    event.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );
                }

                return event;
            }
        },

        fix: function( event ) {
            if ( event[ jQuery.expando ] ) {
                return event;
            }

            // Create a writable copy of the event object and normalize some properties
            var i, prop, copy,
                type = event.type,
                originalEvent = event,
                fixHook = this.fixHooks[ type ];

            if ( !fixHook ) {
                this.fixHooks[ type ] = fixHook =
                    rmouseEvent.test( type ) ? this.mouseHooks :
                        rkeyEvent.test( type ) ? this.keyHooks :
                            {};
            }
            copy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;

            event = new jQuery.Event( originalEvent );

            i = copy.length;
            while ( i-- ) {
                prop = copy[ i ];
                event[ prop ] = originalEvent[ prop ];
            }

            // Support: Cordova 2.5 (WebKit) (#13255)
            // All events should have a target; Cordova deviceready doesn't
            if ( !event.target ) {
                event.target = document;
            }

            // Support: Safari 6.0+, Chrome<28
            // Target should not be a text node (#504, #13143)
            if ( event.target.nodeType === 3 ) {
                event.target = event.target.parentNode;
            }

            return fixHook.filter ? fixHook.filter( event, originalEvent ) : event;
        },

        special: {
            load: {

                // Prevent triggered image.load events from bubbling to window.load
                noBubble: true
            },
            focus: {

                // Fire native event if possible so blur/focus sequence is correct
                trigger: function() {
                    if ( this !== safeActiveElement() && this.focus ) {
                        this.focus();
                        return false;
                    }
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function() {
                    if ( this === safeActiveElement() && this.blur ) {
                        this.blur();
                        return false;
                    }
                },
                delegateType: "focusout"
            },
            click: {

                // For checkbox, fire native event so checked state will be right
                trigger: function() {
                    if ( this.type === "checkbox" && this.click && jQuery.nodeName( this, "input" ) ) {
                        this.click();
                        return false;
                    }
                },

                // For cross-browser consistency, don't fire native .click() on links
                _default: function( event ) {
                    return jQuery.nodeName( event.target, "a" );
                }
            },

            beforeunload: {
                postDispatch: function( event ) {

                    // Support: Firefox 20+
                    // Firefox doesn't alert if the returnValue field is not set.
                    if ( event.result !== undefined && event.originalEvent ) {
                        event.originalEvent.returnValue = event.result;
                    }
                }
            }
        }
    };

    jQuery.removeEvent = function( elem, type, handle ) {

        // This "if" is needed for plain objects
        if ( elem.removeEventListener ) {
            elem.removeEventListener( type, handle );
        }
    };

    jQuery.Event = function( src, props ) {

        // Allow instantiation without the 'new' keyword
        if ( !( this instanceof jQuery.Event ) ) {
            return new jQuery.Event( src, props );
        }

        // Event object
        if ( src && src.type ) {
            this.originalEvent = src;
            this.type = src.type;

            // Events bubbling up the document may have been marked as prevented
            // by a handler lower down the tree; reflect the correct value.
            this.isDefaultPrevented = src.defaultPrevented ||
            src.defaultPrevented === undefined &&

            // Support: Android<4.0
            src.returnValue === false ?
                returnTrue :
                returnFalse;

            // Event type
        } else {
            this.type = src;
        }

        // Put explicitly provided properties onto the event object
        if ( props ) {
            jQuery.extend( this, props );
        }

        // Create a timestamp if incoming event doesn't have one
        this.timeStamp = src && src.timeStamp || jQuery.now();

        // Mark it as fixed
        this[ jQuery.expando ] = true;
    };

// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding
// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html
    jQuery.Event.prototype = {
        constructor: jQuery.Event,
        isDefaultPrevented: returnFalse,
        isPropagationStopped: returnFalse,
        isImmediatePropagationStopped: returnFalse,

        preventDefault: function() {
            var e = this.originalEvent;

            this.isDefaultPrevented = returnTrue;

            if ( e ) {
                e.preventDefault();
            }
        },
        stopPropagation: function() {
            var e = this.originalEvent;

            this.isPropagationStopped = returnTrue;

            if ( e ) {
                e.stopPropagation();
            }
        },
        stopImmediatePropagation: function() {
            var e = this.originalEvent;

            this.isImmediatePropagationStopped = returnTrue;

            if ( e ) {
                e.stopImmediatePropagation();
            }

            this.stopPropagation();
        }
    };

// Create mouseenter/leave events using mouseover/out and event-time checks
// so that event delegation works in jQuery.
// Do the same for pointerenter/pointerleave and pointerover/pointerout
//
// Support: Safari 7 only
// Safari sends mouseenter too often; see:
// https://code.google.com/p/chromium/issues/detail?id=470258
// for the description of the bug (it existed in older Chrome versions as well).
    jQuery.each( {
        mouseenter: "mouseover",
        mouseleave: "mouseout",
        pointerenter: "pointerover",
        pointerleave: "pointerout"
    }, function( orig, fix ) {
        jQuery.event.special[ orig ] = {
            delegateType: fix,
            bindType: fix,

            handle: function( event ) {
                var ret,
                    target = this,
                    related = event.relatedTarget,
                    handleObj = event.handleObj;

                // For mouseenter/leave call the handler if related is outside the target.
                // NB: No relatedTarget if the mouse left/entered the browser window
                if ( !related || ( related !== target && !jQuery.contains( target, related ) ) ) {
                    event.type = handleObj.origType;
                    ret = handleObj.handler.apply( this, arguments );
                    event.type = fix;
                }
                return ret;
            }
        };
    } );

    jQuery.fn.extend( {
        on: function( types, selector, data, fn ) {
            return on( this, types, selector, data, fn );
        },
        one: function( types, selector, data, fn ) {
            return on( this, types, selector, data, fn, 1 );
        },
        off: function( types, selector, fn ) {
            var handleObj, type;
            if ( types && types.preventDefault && types.handleObj ) {

                // ( event )  dispatched jQuery.Event
                handleObj = types.handleObj;
                jQuery( types.delegateTarget ).off(
                    handleObj.namespace ?
                        handleObj.origType + "." + handleObj.namespace :
                        handleObj.origType,
                    handleObj.selector,
                    handleObj.handler
                );
                return this;
            }
            if ( typeof types === "object" ) {

                // ( types-object [, selector] )
                for ( type in types ) {
                    this.off( type, selector, types[ type ] );
                }
                return this;
            }
            if ( selector === false || typeof selector === "function" ) {

                // ( types [, fn] )
                fn = selector;
                selector = undefined;
            }
            if ( fn === false ) {
                fn = returnFalse;
            }
            return this.each( function() {
                jQuery.event.remove( this, types, fn, selector );
            } );
        }
    } );


    var
        rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,

        // Support: IE 10-11, Edge 10240+
        // In IE/Edge using regex groups here causes severe slowdowns.
        // See https://connect.microsoft.com/IE/feedback/details/1736512/
        rnoInnerhtml = /<script|<style|<link/i,

        // checked="checked" or checked
        rchecked = /checked\s*(?:[^=]|=\s*.checked.)/i,
        rscriptTypeMasked = /^true\/(.*)/,
        rcleanScript = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;

// Manipulating tables requires a tbody
    function manipulationTarget( elem, content ) {
        return jQuery.nodeName( elem, "table" ) &&
        jQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, "tr" ) ?

            elem.getElementsByTagName( "tbody" )[ 0 ] ||
            elem.appendChild( elem.ownerDocument.createElement( "tbody" ) ) :
            elem;
    }

// Replace/restore the type attribute of script elements for safe DOM manipulation
    function disableScript( elem ) {
        elem.type = ( elem.getAttribute( "type" ) !== null ) + "/" + elem.type;
        return elem;
    }
    function restoreScript( elem ) {
        var match = rscriptTypeMasked.exec( elem.type );

        if ( match ) {
            elem.type = match[ 1 ];
        } else {
            elem.removeAttribute( "type" );
        }

        return elem;
    }

    function cloneCopyEvent( src, dest ) {
        var i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;

        if ( dest.nodeType !== 1 ) {
            return;
        }

        // 1. Copy private data: events, handlers, etc.
        if ( dataPriv.hasData( src ) ) {
            pdataOld = dataPriv.access( src );
            pdataCur = dataPriv.set( dest, pdataOld );
            events = pdataOld.events;

            if ( events ) {
                delete pdataCur.handle;
                pdataCur.events = {};

                for ( type in events ) {
                    for ( i = 0, l = events[ type ].length; i < l; i++ ) {
                        jQuery.event.add( dest, type, events[ type ][ i ] );
                    }
                }
            }
        }

        // 2. Copy user data
        if ( dataUser.hasData( src ) ) {
            udataOld = dataUser.access( src );
            udataCur = jQuery.extend( {}, udataOld );

            dataUser.set( dest, udataCur );
        }
    }

// Fix IE bugs, see support tests
    function fixInput( src, dest ) {
        var nodeName = dest.nodeName.toLowerCase();

        // Fails to persist the checked state of a cloned checkbox or radio button.
        if ( nodeName === "input" && rcheckableType.test( src.type ) ) {
            dest.checked = src.checked;

            // Fails to return the selected option to the default selected state when cloning options
        } else if ( nodeName === "input" || nodeName === "textarea" ) {
            dest.defaultValue = src.defaultValue;
        }
    }

    function domManip( collection, args, callback, ignored ) {

        // Flatten any nested arrays
        args = concat.apply( [], args );

        var fragment, first, scripts, hasScripts, node, doc,
            i = 0,
            l = collection.length,
            iNoClone = l - 1,
            value = args[ 0 ],
            isFunction = jQuery.isFunction( value );

        // We can't cloneNode fragments that contain checked, in WebKit
        if ( isFunction ||
            ( l > 1 && typeof value === "string" &&
                !support.checkClone && rchecked.test( value ) ) ) {
            return collection.each( function( index ) {
                var self = collection.eq( index );
                if ( isFunction ) {
                    args[ 0 ] = value.call( this, index, self.html() );
                }
                domManip( self, args, callback, ignored );
            } );
        }

        if ( l ) {
            fragment = buildFragment( args, collection[ 0 ].ownerDocument, false, collection, ignored );
            first = fragment.firstChild;

            if ( fragment.childNodes.length === 1 ) {
                fragment = first;
            }

            // Require either new content or an interest in ignored elements to invoke the callback
            if ( first || ignored ) {
                scripts = jQuery.map( getAll( fragment, "script" ), disableScript );
                hasScripts = scripts.length;

                // Use the original fragment for the last item
                // instead of the first because it can end up
                // being emptied incorrectly in certain situations (#8070).
                for ( ; i < l; i++ ) {
                    node = fragment;

                    if ( i !== iNoClone ) {
                        node = jQuery.clone( node, true, true );

                        // Keep references to cloned scripts for later restoration
                        if ( hasScripts ) {

                            // Support: Android<4.1, PhantomJS<2
                            // push.apply(_, arraylike) throws on ancient WebKit
                            jQuery.merge( scripts, getAll( node, "script" ) );
                        }
                    }

                    callback.call( collection[ i ], node, i );
                }

                if ( hasScripts ) {
                    doc = scripts[ scripts.length - 1 ].ownerDocument;

                    // Reenable scripts
                    jQuery.map( scripts, restoreScript );

                    // Evaluate executable scripts on first document insertion
                    for ( i = 0; i < hasScripts; i++ ) {
                        node = scripts[ i ];
                        if ( rscriptType.test( node.type || "" ) &&
                            !dataPriv.access( node, "globalEval" ) &&
                            jQuery.contains( doc, node ) ) {

                            if ( node.src ) {

                                // Optional AJAX dependency, but won't run scripts if not present
                                if ( jQuery._evalUrl ) {
                                    jQuery._evalUrl( node.src );
                                }
                            } else {
                                jQuery.globalEval( node.textContent.replace( rcleanScript, "" ) );
                            }
                        }
                    }
                }
            }
        }

        return collection;
    }

    function remove( elem, selector, keepData ) {
        var node,
            nodes = selector ? jQuery.filter( selector, elem ) : elem,
            i = 0;

        for ( ; ( node = nodes[ i ] ) != null; i++ ) {
            if ( !keepData && node.nodeType === 1 ) {
                jQuery.cleanData( getAll( node ) );
            }

            if ( node.parentNode ) {
                if ( keepData && jQuery.contains( node.ownerDocument, node ) ) {
                    setGlobalEval( getAll( node, "script" ) );
                }
                node.parentNode.removeChild( node );
            }
        }

        return elem;
    }

    jQuery.extend( {
        htmlPrefilter: function( html ) {
            return html.replace( rxhtmlTag, "<$1></$2>" );
        },

        clone: function( elem, dataAndEvents, deepDataAndEvents ) {
            var i, l, srcElements, destElements,
                clone = elem.cloneNode( true ),
                inPage = jQuery.contains( elem.ownerDocument, elem );

            // Fix IE cloning issues
            if ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&
                !jQuery.isXMLDoc( elem ) ) {

                // We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2
                destElements = getAll( clone );
                srcElements = getAll( elem );

                for ( i = 0, l = srcElements.length; i < l; i++ ) {
                    fixInput( srcElements[ i ], destElements[ i ] );
                }
            }

            // Copy the events from the original to the clone
            if ( dataAndEvents ) {
                if ( deepDataAndEvents ) {
                    srcElements = srcElements || getAll( elem );
                    destElements = destElements || getAll( clone );

                    for ( i = 0, l = srcElements.length; i < l; i++ ) {
                        cloneCopyEvent( srcElements[ i ], destElements[ i ] );
                    }
                } else {
                    cloneCopyEvent( elem, clone );
                }
            }

            // Preserve script evaluation history
            destElements = getAll( clone, "script" );
            if ( destElements.length > 0 ) {
                setGlobalEval( destElements, !inPage && getAll( elem, "script" ) );
            }

            // Return the cloned set
            return clone;
        },

        cleanData: function( elems ) {
            var data, elem, type,
                special = jQuery.event.special,
                i = 0;

            for ( ; ( elem = elems[ i ] ) !== undefined; i++ ) {
                if ( acceptData( elem ) ) {
                    if ( ( data = elem[ dataPriv.expando ] ) ) {
                        if ( data.events ) {
                            for ( type in data.events ) {
                                if ( special[ type ] ) {
                                    jQuery.event.remove( elem, type );

                                    // This is a shortcut to avoid jQuery.event.remove's overhead
                                } else {
                                    jQuery.removeEvent( elem, type, data.handle );
                                }
                            }
                        }

                        // Support: Chrome <= 35-45+
                        // Assign undefined instead of using delete, see Data#remove
                        elem[ dataPriv.expando ] = undefined;
                    }
                    if ( elem[ dataUser.expando ] ) {

                        // Support: Chrome <= 35-45+
                        // Assign undefined instead of using delete, see Data#remove
                        elem[ dataUser.expando ] = undefined;
                    }
                }
            }
        }
    } );

    jQuery.fn.extend( {

        // Keep domManip exposed until 3.0 (gh-2225)
        domManip: domManip,

        detach: function( selector ) {
            return remove( this, selector, true );
        },

        remove: function( selector ) {
            return remove( this, selector );
        },

        text: function( value ) {
            return access( this, function( value ) {
                return value === undefined ?
                    jQuery.text( this ) :
                    this.empty().each( function() {
                        if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
                            this.textContent = value;
                        }
                    } );
            }, null, value, arguments.length );
        },

        append: function() {
            return domManip( this, arguments, function( elem ) {
                if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
                    var target = manipulationTarget( this, elem );
                    target.appendChild( elem );
                }
            } );
        },

        prepend: function() {
            return domManip( this, arguments, function( elem ) {
                if ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {
                    var target = manipulationTarget( this, elem );
                    target.insertBefore( elem, target.firstChild );
                }
            } );
        },

        before: function() {
            return domManip( this, arguments, function( elem ) {
                if ( this.parentNode ) {
                    this.parentNode.insertBefore( elem, this );
                }
            } );
        },

        after: function() {
            return domManip( this, arguments, function( elem ) {
                if ( this.parentNode ) {
                    this.parentNode.insertBefore( elem, this.nextSibling );
                }
            } );
        },

        empty: function() {
            var elem,
                i = 0;

            for ( ; ( elem = this[ i ] ) != null; i++ ) {
                if ( elem.nodeType === 1 ) {

                    // Prevent memory leaks
                    jQuery.cleanData( getAll( elem, false ) );

                    // Remove any remaining nodes
                    elem.textContent = "";
                }
            }

            return this;
        },

        clone: function( dataAndEvents, deepDataAndEvents ) {
            dataAndEvents = dataAndEvents == null ? false : dataAndEvents;
            deepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;

            return this.map( function() {
                return jQuery.clone( this, dataAndEvents, deepDataAndEvents );
            } );
        },

        html: function( value ) {
            return access( this, function( value ) {
                var elem = this[ 0 ] || {},
                    i = 0,
                    l = this.length;

                if ( value === undefined && elem.nodeType === 1 ) {
                    return elem.innerHTML;
                }

                // See if we can take a shortcut and just use innerHTML
                if ( typeof value === "string" && !rnoInnerhtml.test( value ) &&
                    !wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {

                    value = jQuery.htmlPrefilter( value );

                    try {
                        for ( ; i < l; i++ ) {
                            elem = this[ i ] || {};

                            // Remove element nodes and prevent memory leaks
                            if ( elem.nodeType === 1 ) {
                                jQuery.cleanData( getAll( elem, false ) );
                                elem.innerHTML = value;
                            }
                        }

                        elem = 0;

                        // If using innerHTML throws an exception, use the fallback method
                    } catch ( e ) {}
                }

                if ( elem ) {
                    this.empty().append( value );
                }
            }, null, value, arguments.length );
        },

        replaceWith: function() {
            var ignored = [];

            // Make the changes, replacing each non-ignored context element with the new content
            return domManip( this, arguments, function( elem ) {
                var parent = this.parentNode;

                if ( jQuery.inArray( this, ignored ) < 0 ) {
                    jQuery.cleanData( getAll( this ) );
                    if ( parent ) {
                        parent.replaceChild( elem, this );
                    }
                }

                // Force callback invocation
            }, ignored );
        }
    } );

    jQuery.each( {
        appendTo: "append",
        prependTo: "prepend",
        insertBefore: "before",
        insertAfter: "after",
        replaceAll: "replaceWith"
    }, function( name, original ) {
        jQuery.fn[ name ] = function( selector ) {
            var elems,
                ret = [],
                insert = jQuery( selector ),
                last = insert.length - 1,
                i = 0;

            for ( ; i <= last; i++ ) {
                elems = i === last ? this : this.clone( true );
                jQuery( insert[ i ] )[ original ]( elems );

                // Support: QtWebKit
                // .get() because push.apply(_, arraylike) throws
                push.apply( ret, elems.get() );
            }

            return this.pushStack( ret );
        };
    } );


    var iframe,
        elemdisplay = {

            // Support: Firefox
            // We have to pre-define these values for FF (#10227)
            HTML: "block",
            BODY: "block"
        };

    /**
     * Retrieve the actual display of a element
     * @param {String} name nodeName of the element
     * @param {Object} doc Document object
     */

// Called only from within defaultDisplay
    function actualDisplay( name, doc ) {
        var elem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),

            display = jQuery.css( elem[ 0 ], "display" );

        // We don't have any data stored on the element,
        // so use "detach" method as fast way to get rid of the element
        elem.detach();

        return display;
    }

    /**
     * Try to determine the default display value of an element
     * @param {String} nodeName
     */
    function defaultDisplay( nodeName ) {
        var doc = document,
            display = elemdisplay[ nodeName ];

        if ( !display ) {
            display = actualDisplay( nodeName, doc );

            // If the simple way fails, read from inside an iframe
            if ( display === "none" || !display ) {

                // Use the already-created iframe if possible
                iframe = ( iframe || jQuery( "<iframe frameborder='0' width='0' height='0'/>" ) )
                    .appendTo( doc.documentElement );

                // Always write a new HTML skeleton so Webkit and Firefox don't choke on reuse
                doc = iframe[ 0 ].contentDocument;

                // Support: IE
                doc.write();
                doc.close();

                display = actualDisplay( nodeName, doc );
                iframe.detach();
            }

            // Store the correct default display
            elemdisplay[ nodeName ] = display;
        }

        return display;
    }
    var rmargin = ( /^margin/ );

    var rnumnonpx = new RegExp( "^(" + pnum + ")(?!px)[a-z%]+$", "i" );

    var getStyles = function( elem ) {

        // Support: IE<=11+, Firefox<=30+ (#15098, #14150)
        // IE throws on elements created in popups
        // FF meanwhile throws on frame elements through "defaultView.getComputedStyle"
        var view = elem.ownerDocument.defaultView;

        if ( !view || !view.opener ) {
            view = window;
        }

        return view.getComputedStyle( elem );
    };

    var swap = function( elem, options, callback, args ) {
        var ret, name,
            old = {};

        // Remember the old values, and insert the new ones
        for ( name in options ) {
            old[ name ] = elem.style[ name ];
            elem.style[ name ] = options[ name ];
        }

        ret = callback.apply( elem, args || [] );

        // Revert the old values
        for ( name in options ) {
            elem.style[ name ] = old[ name ];
        }

        return ret;
    };


    var documentElement = document.documentElement;



    ( function() {
        var pixelPositionVal, boxSizingReliableVal, pixelMarginRightVal, reliableMarginLeftVal,
            container = document.createElement( "div" ),
            div = document.createElement( "div" );

        // Finish early in limited (non-browser) environments
        if ( !div.style ) {
            return;
        }

        // Support: IE9-11+
        // Style of cloned element affects source element cloned (#8908)
        div.style.backgroundClip = "content-box";
        div.cloneNode( true ).style.backgroundClip = "";
        support.clearCloneStyle = div.style.backgroundClip === "content-box";

        container.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;" +
            "padding:0;margin-top:1px;position:absolute";
        container.appendChild( div );

        // Executing both pixelPosition & boxSizingReliable tests require only one layout
        // so they're executed at the same time to save the second computation.
        function computeStyleTests() {
            div.style.cssText =

                // Support: Firefox<29, Android 2.3
                // Vendor-prefix box-sizing
                "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;" +
                "position:relative;display:block;" +
                "margin:auto;border:1px;padding:1px;" +
                "top:1%;width:50%";
            div.innerHTML = "";
            documentElement.appendChild( container );

            var divStyle = window.getComputedStyle( div );
            pixelPositionVal = divStyle.top !== "1%";
            reliableMarginLeftVal = divStyle.marginLeft === "2px";
            boxSizingReliableVal = divStyle.width === "4px";

            // Support: Android 4.0 - 4.3 only
            // Some styles come back with percentage values, even though they shouldn't
            div.style.marginRight = "50%";
            pixelMarginRightVal = divStyle.marginRight === "4px";

            documentElement.removeChild( container );
        }

        jQuery.extend( support, {
            pixelPosition: function() {

                // This test is executed only once but we still do memoizing
                // since we can use the boxSizingReliable pre-computing.
                // No need to check if the test was already performed, though.
                computeStyleTests();
                return pixelPositionVal;
            },
            boxSizingReliable: function() {
                if ( boxSizingReliableVal == null ) {
                    computeStyleTests();
                }
                return boxSizingReliableVal;
            },
            pixelMarginRight: function() {

                // Support: Android 4.0-4.3
                // We're checking for boxSizingReliableVal here instead of pixelMarginRightVal
                // since that compresses better and they're computed together anyway.
                if ( boxSizingReliableVal == null ) {
                    computeStyleTests();
                }
                return pixelMarginRightVal;
            },
            reliableMarginLeft: function() {

                // Support: IE <=8 only, Android 4.0 - 4.3 only, Firefox <=3 - 37
                if ( boxSizingReliableVal == null ) {
                    computeStyleTests();
                }
                return reliableMarginLeftVal;
            },
            reliableMarginRight: function() {

                // Support: Android 2.3
                // Check if div with explicit width and no margin-right incorrectly
                // gets computed margin-right based on width of container. (#3333)
                // WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right
                // This support function is only executed once so no memoizing is needed.
                var ret,
                    marginDiv = div.appendChild( document.createElement( "div" ) );

                // Reset CSS: box-sizing; display; margin; border; padding
                marginDiv.style.cssText = div.style.cssText =

                    // Support: Android 2.3
                    // Vendor-prefix box-sizing
                    "-webkit-box-sizing:content-box;box-sizing:content-box;" +
                    "display:block;margin:0;border:0;padding:0";
                marginDiv.style.marginRight = marginDiv.style.width = "0";
                div.style.width = "1px";
                documentElement.appendChild( container );

                ret = !parseFloat( window.getComputedStyle( marginDiv ).marginRight );

                documentElement.removeChild( container );
                div.removeChild( marginDiv );

                return ret;
            }
        } );
    } )();


    function curCSS( elem, name, computed ) {
        var width, minWidth, maxWidth, ret,
            style = elem.style;

        computed = computed || getStyles( elem );
        ret = computed ? computed.getPropertyValue( name ) || computed[ name ] : undefined;

        // Support: Opera 12.1x only
        // Fall back to style even without computed
        // computed is undefined for elems on document fragments
        if ( ( ret === "" || ret === undefined ) && !jQuery.contains( elem.ownerDocument, elem ) ) {
            ret = jQuery.style( elem, name );
        }

        // Support: IE9
        // getPropertyValue is only needed for .css('filter') (#12537)
        if ( computed ) {

            // A tribute to the "awesome hack by Dean Edwards"
            // Android Browser returns percentage for some values,
            // but width seems to be reliably pixels.
            // This is against the CSSOM draft spec:
            // http://dev.w3.org/csswg/cssom/#resolved-values
            if ( !support.pixelMarginRight() && rnumnonpx.test( ret ) && rmargin.test( name ) ) {

                // Remember the original values
                width = style.width;
                minWidth = style.minWidth;
                maxWidth = style.maxWidth;

                // Put in the new values to get a computed value out
                style.minWidth = style.maxWidth = style.width = ret;
                ret = computed.width;

                // Revert the changed values
                style.width = width;
                style.minWidth = minWidth;
                style.maxWidth = maxWidth;
            }
        }

        return ret !== undefined ?

            // Support: IE9-11+
            // IE returns zIndex value as an integer.
            ret + "" :
            ret;
    }


    function addGetHookIf( conditionFn, hookFn ) {

        // Define the hook, we'll check on the first run if it's really needed.
        return {
            get: function() {
                if ( conditionFn() ) {

                    // Hook not needed (or it's not possible to use it due
                    // to missing dependency), remove it.
                    delete this.get;
                    return;
                }

                // Hook needed; redefine it so that the support test is not executed again.
                return ( this.get = hookFn ).apply( this, arguments );
            }
        };
    }


    var

        // Swappable if display is none or starts with table
        // except "table", "table-cell", or "table-caption"
        // See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display
        rdisplayswap = /^(none|table(?!-c[ea]).+)/,

        cssShow = { position: "absolute", visibility: "hidden", display: "block" },
        cssNormalTransform = {
            letterSpacing: "0",
            fontWeight: "400"
        },

        cssPrefixes = [ "Webkit", "O", "Moz", "ms" ],
        emptyStyle = document.createElement( "div" ).style;

// Return a css property mapped to a potentially vendor prefixed property
    function vendorPropName( name ) {

        // Shortcut for names that are not vendor prefixed
        if ( name in emptyStyle ) {
            return name;
        }

        // Check for vendor prefixed names
        var capName = name[ 0 ].toUpperCase() + name.slice( 1 ),
            i = cssPrefixes.length;

        while ( i-- ) {
            name = cssPrefixes[ i ] + capName;
            if ( name in emptyStyle ) {
                return name;
            }
        }
    }

    function setPositiveNumber( elem, value, subtract ) {

        // Any relative (+/-) values have already been
        // normalized at this point
        var matches = rcssNum.exec( value );
        return matches ?

            // Guard against undefined "subtract", e.g., when used as in cssHooks
            Math.max( 0, matches[ 2 ] - ( subtract || 0 ) ) + ( matches[ 3 ] || "px" ) :
            value;
    }

    function augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {
        var i = extra === ( isBorderBox ? "border" : "content" ) ?

            // If we already have the right measurement, avoid augmentation
            4 :

            // Otherwise initialize for horizontal or vertical properties
            name === "width" ? 1 : 0,

            val = 0;

        for ( ; i < 4; i += 2 ) {

            // Both box models exclude margin, so add it if we want it
            if ( extra === "margin" ) {
                val += jQuery.css( elem, extra + cssExpand[ i ], true, styles );
            }

            if ( isBorderBox ) {

                // border-box includes padding, so remove it if we want content
                if ( extra === "content" ) {
                    val -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );
                }

                // At this point, extra isn't border nor margin, so remove border
                if ( extra !== "margin" ) {
                    val -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
                }
            } else {

                // At this point, extra isn't content, so add padding
                val += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );

                // At this point, extra isn't content nor padding, so add border
                if ( extra !== "padding" ) {
                    val += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );
                }
            }
        }

        return val;
    }

    function getWidthOrHeight( elem, name, extra ) {

        // Start with offset property, which is equivalent to the border-box value
        var valueIsBorderBox = true,
            val = name === "width" ? elem.offsetWidth : elem.offsetHeight,
            styles = getStyles( elem ),
            isBorderBox = jQuery.css( elem, "boxSizing", false, styles ) === "border-box";

        // Support: IE11 only
        // In IE 11 fullscreen elements inside of an iframe have
        // 100x too small dimensions (gh-1764).
        if ( document.msFullscreenElement && window.top !== window ) {

            // Support: IE11 only
            // Running getBoundingClientRect on a disconnected node
            // in IE throws an error.
            if ( elem.getClientRects().length ) {
                val = Math.round( elem.getBoundingClientRect()[ name ] * 100 );
            }
        }

        // Some non-html elements return undefined for offsetWidth, so check for null/undefined
        // svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285
        // MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668
        if ( val <= 0 || val == null ) {

            // Fall back to computed then uncomputed css if necessary
            val = curCSS( elem, name, styles );
            if ( val < 0 || val == null ) {
                val = elem.style[ name ];
            }

            // Computed unit is not pixels. Stop here and return.
            if ( rnumnonpx.test( val ) ) {
                return val;
            }

            // Check for style in case a browser which returns unreliable values
            // for getComputedStyle silently falls back to the reliable elem.style
            valueIsBorderBox = isBorderBox &&
                ( support.boxSizingReliable() || val === elem.style[ name ] );

            // Normalize "", auto, and prepare for extra
            val = parseFloat( val ) || 0;
        }

        // Use the active box-sizing model to add/subtract irrelevant styles
        return ( val +
            augmentWidthOrHeight(
                elem,
                name,
                extra || ( isBorderBox ? "border" : "content" ),
                valueIsBorderBox,
                styles
            )
        ) + "px";
    }

    function showHide( elements, show ) {
        var display, elem, hidden,
            values = [],
            index = 0,
            length = elements.length;

        for ( ; index < length; index++ ) {
            elem = elements[ index ];
            if ( !elem.style ) {
                continue;
            }

            values[ index ] = dataPriv.get( elem, "olddisplay" );
            display = elem.style.display;
            if ( show ) {

                // Reset the inline display of this element to learn if it is
                // being hidden by cascaded rules or not
                if ( !values[ index ] && display === "none" ) {
                    elem.style.display = "";
                }

                // Set elements which have been overridden with display: none
                // in a stylesheet to whatever the default browser style is
                // for such an element
                if ( elem.style.display === "" && isHidden( elem ) ) {
                    values[ index ] = dataPriv.access(
                        elem,
                        "olddisplay",
                        defaultDisplay( elem.nodeName )
                    );
                }
            } else {
                hidden = isHidden( elem );

                if ( display !== "none" || !hidden ) {
                    dataPriv.set(
                        elem,
                        "olddisplay",
                        hidden ? display : jQuery.css( elem, "display" )
                    );
                }
            }
        }

        // Set the display of most of the elements in a second loop
        // to avoid the constant reflow
        for ( index = 0; index < length; index++ ) {
            elem = elements[ index ];
            if ( !elem.style ) {
                continue;
            }
            if ( !show || elem.style.display === "none" || elem.style.display === "" ) {
                elem.style.display = show ? values[ index ] || "" : "none";
            }
        }

        return elements;
    }

    jQuery.extend( {

        // Add in style property hooks for overriding the default
        // behavior of getting and setting a style property
        cssHooks: {
            opacity: {
                get: function( elem, computed ) {
                    if ( computed ) {

                        // We should always get a number back from opacity
                        var ret = curCSS( elem, "opacity" );
                        return ret === "" ? "1" : ret;
                    }
                }
            }
        },

        // Don't automatically add "px" to these possibly-unitless properties
        cssNumber: {
            "animationIterationCount": true,
            "columnCount": true,
            "fillOpacity": true,
            "flexGrow": true,
            "flexShrink": true,
            "fontWeight": true,
            "lineHeight": true,
            "opacity": true,
            "order": true,
            "orphans": true,
            "widows": true,
            "zIndex": true,
            "zoom": true
        },

        // Add in properties whose names you wish to fix before
        // setting or getting the value
        cssProps: {
            "float": "cssFloat"
        },

        // Get and set the style property on a DOM Node
        style: function( elem, name, value, extra ) {

            // Don't set styles on text and comment nodes
            if ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {
                return;
            }

            // Make sure that we're working with the right name
            var ret, type, hooks,
                origName = jQuery.camelCase( name ),
                style = elem.style;

            name = jQuery.cssProps[ origName ] ||
                ( jQuery.cssProps[ origName ] = vendorPropName( origName ) || origName );

            // Gets hook for the prefixed version, then unprefixed version
            hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

            // Check if we're setting a value
            if ( value !== undefined ) {
                type = typeof value;

                // Convert "+=" or "-=" to relative numbers (#7345)
                if ( type === "string" && ( ret = rcssNum.exec( value ) ) && ret[ 1 ] ) {
                    value = adjustCSS( elem, name, ret );

                    // Fixes bug #9237
                    type = "number";
                }

                // Make sure that null and NaN values aren't set (#7116)
                if ( value == null || value !== value ) {
                    return;
                }

                // If a number was passed in, add the unit (except for certain CSS properties)
                if ( type === "number" ) {
                    value += ret && ret[ 3 ] || ( jQuery.cssNumber[ origName ] ? "" : "px" );
                }

                // Support: IE9-11+
                // background-* props affect original clone's values
                if ( !support.clearCloneStyle && value === "" && name.indexOf( "background" ) === 0 ) {
                    style[ name ] = "inherit";
                }

                // If a hook was provided, use that value, otherwise just set the specified value
                if ( !hooks || !( "set" in hooks ) ||
                    ( value = hooks.set( elem, value, extra ) ) !== undefined ) {

                    style[ name ] = value;
                }

            } else {

                // If a hook was provided get the non-computed value from there
                if ( hooks && "get" in hooks &&
                    ( ret = hooks.get( elem, false, extra ) ) !== undefined ) {

                    return ret;
                }

                // Otherwise just get the value from the style object
                return style[ name ];
            }
        },

        css: function( elem, name, extra, styles ) {
            var val, num, hooks,
                origName = jQuery.camelCase( name );

            // Make sure that we're working with the right name
            name = jQuery.cssProps[ origName ] ||
                ( jQuery.cssProps[ origName ] = vendorPropName( origName ) || origName );

            // Try prefixed name followed by the unprefixed name
            hooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];

            // If a hook was provided get the computed value from there
            if ( hooks && "get" in hooks ) {
                val = hooks.get( elem, true, extra );
            }

            // Otherwise, if a way to get the computed value exists, use that
            if ( val === undefined ) {
                val = curCSS( elem, name, styles );
            }

            // Convert "normal" to computed value
            if ( val === "normal" && name in cssNormalTransform ) {
                val = cssNormalTransform[ name ];
            }

            // Make numeric if forced or a qualifier was provided and val looks numeric
            if ( extra === "" || extra ) {
                num = parseFloat( val );
                return extra === true || isFinite( num ) ? num || 0 : val;
            }
            return val;
        }
    } );

    jQuery.each( [ "height", "width" ], function( i, name ) {
        jQuery.cssHooks[ name ] = {
            get: function( elem, computed, extra ) {
                if ( computed ) {

                    // Certain elements can have dimension info if we invisibly show them
                    // but it must have a current display style that would benefit
                    return rdisplayswap.test( jQuery.css( elem, "display" ) ) &&
                    elem.offsetWidth === 0 ?
                        swap( elem, cssShow, function() {
                            return getWidthOrHeight( elem, name, extra );
                        } ) :
                        getWidthOrHeight( elem, name, extra );
                }
            },

            set: function( elem, value, extra ) {
                var matches,
                    styles = extra && getStyles( elem ),
                    subtract = extra && augmentWidthOrHeight(
                        elem,
                        name,
                        extra,
                        jQuery.css( elem, "boxSizing", false, styles ) === "border-box",
                        styles
                    );

                // Convert to pixels if value adjustment is needed
                if ( subtract && ( matches = rcssNum.exec( value ) ) &&
                    ( matches[ 3 ] || "px" ) !== "px" ) {

                    elem.style[ name ] = value;
                    value = jQuery.css( elem, name );
                }

                return setPositiveNumber( elem, value, subtract );
            }
        };
    } );

    jQuery.cssHooks.marginLeft = addGetHookIf( support.reliableMarginLeft,
        function( elem, computed ) {
            if ( computed ) {
                return ( parseFloat( curCSS( elem, "marginLeft" ) ) ||
                    elem.getBoundingClientRect().left -
                    swap( elem, { marginLeft: 0 }, function() {
                        return elem.getBoundingClientRect().left;
                    } )
                ) + "px";
            }
        }
    );

// Support: Android 2.3
    jQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,
        function( elem, computed ) {
            if ( computed ) {
                return swap( elem, { "display": "inline-block" },
                    curCSS, [ elem, "marginRight" ] );
            }
        }
    );

// These hooks are used by animate to expand properties
    jQuery.each( {
        margin: "",
        padding: "",
        border: "Width"
    }, function( prefix, suffix ) {
        jQuery.cssHooks[ prefix + suffix ] = {
            expand: function( value ) {
                var i = 0,
                    expanded = {},

                    // Assumes a single number if not a string
                    parts = typeof value === "string" ? value.split( " " ) : [ value ];

                for ( ; i < 4; i++ ) {
                    expanded[ prefix + cssExpand[ i ] + suffix ] =
                        parts[ i ] || parts[ i - 2 ] || parts[ 0 ];
                }

                return expanded;
            }
        };

        if ( !rmargin.test( prefix ) ) {
            jQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;
        }
    } );

    jQuery.fn.extend( {
        css: function( name, value ) {
            return access( this, function( elem, name, value ) {
                var styles, len,
                    map = {},
                    i = 0;

                if ( jQuery.isArray( name ) ) {
                    styles = getStyles( elem );
                    len = name.length;

                    for ( ; i < len; i++ ) {
                        map[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );
                    }

                    return map;
                }

                return value !== undefined ?
                    jQuery.style( elem, name, value ) :
                    jQuery.css( elem, name );
            }, name, value, arguments.length > 1 );
        },
        show: function() {
            return showHide( this, true );
        },
        hide: function() {
            return showHide( this );
        },
        toggle: function( state ) {
            if ( typeof state === "boolean" ) {
                return state ? this.show() : this.hide();
            }

            return this.each( function() {
                if ( isHidden( this ) ) {
                    jQuery( this ).show();
                } else {
                    jQuery( this ).hide();
                }
            } );
        }
    } );


    function Tween( elem, options, prop, end, easing ) {
        return new Tween.prototype.init( elem, options, prop, end, easing );
    }
    jQuery.Tween = Tween;

    Tween.prototype = {
        constructor: Tween,
        init: function( elem, options, prop, end, easing, unit ) {
            this.elem = elem;
            this.prop = prop;
            this.easing = easing || jQuery.easing._default;
            this.options = options;
            this.start = this.now = this.cur();
            this.end = end;
            this.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );
        },
        cur: function() {
            var hooks = Tween.propHooks[ this.prop ];

            return hooks && hooks.get ?
                hooks.get( this ) :
                Tween.propHooks._default.get( this );
        },
        run: function( percent ) {
            var eased,
                hooks = Tween.propHooks[ this.prop ];

            if ( this.options.duration ) {
                this.pos = eased = jQuery.easing[ this.easing ](
                    percent, this.options.duration * percent, 0, 1, this.options.duration
                );
            } else {
                this.pos = eased = percent;
            }
            this.now = ( this.end - this.start ) * eased + this.start;

            if ( this.options.step ) {
                this.options.step.call( this.elem, this.now, this );
            }

            if ( hooks && hooks.set ) {
                hooks.set( this );
            } else {
                Tween.propHooks._default.set( this );
            }
            return this;
        }
    };

    Tween.prototype.init.prototype = Tween.prototype;

    Tween.propHooks = {
        _default: {
            get: function( tween ) {
                var result;

                // Use a property on the element directly when it is not a DOM element,
                // or when there is no matching style property that exists.
                if ( tween.elem.nodeType !== 1 ||
                    tween.elem[ tween.prop ] != null && tween.elem.style[ tween.prop ] == null ) {
                    return tween.elem[ tween.prop ];
                }

                // Passing an empty string as a 3rd parameter to .css will automatically
                // attempt a parseFloat and fallback to a string if the parse fails.
                // Simple values such as "10px" are parsed to Float;
                // complex values such as "rotate(1rad)" are returned as-is.
                result = jQuery.css( tween.elem, tween.prop, "" );

                // Empty strings, null, undefined and "auto" are converted to 0.
                return !result || result === "auto" ? 0 : result;
            },
            set: function( tween ) {

                // Use step hook for back compat.
                // Use cssHook if its there.
                // Use .style if available and use plain properties where available.
                if ( jQuery.fx.step[ tween.prop ] ) {
                    jQuery.fx.step[ tween.prop ]( tween );
                } else if ( tween.elem.nodeType === 1 &&
                    ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null ||
                        jQuery.cssHooks[ tween.prop ] ) ) {
                    jQuery.style( tween.elem, tween.prop, tween.now + tween.unit );
                } else {
                    tween.elem[ tween.prop ] = tween.now;
                }
            }
        }
    };

// Support: IE9
// Panic based approach to setting things on disconnected nodes
    Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {
        set: function( tween ) {
            if ( tween.elem.nodeType && tween.elem.parentNode ) {
                tween.elem[ tween.prop ] = tween.now;
            }
        }
    };

    jQuery.easing = {
        linear: function( p ) {
            return p;
        },
        swing: function( p ) {
            return 0.5 - Math.cos( p * Math.PI ) / 2;
        },
        _default: "swing"
    };

    jQuery.fx = Tween.prototype.init;

// Back Compat <1.8 extension point
    jQuery.fx.step = {};




    var
        fxNow, timerId,
        rfxtypes = /^(?:toggle|show|hide)$/,
        rrun = /queueHooks$/;

// Animations created synchronously will run synchronously
    function createFxNow() {
        window.setTimeout( function() {
            fxNow = undefined;
        } );
        return ( fxNow = jQuery.now() );
    }

// Generate parameters to create a standard animation
    function genFx( type, includeWidth ) {
        var which,
            i = 0,
            attrs = { height: type };

        // If we include width, step value is 1 to do all cssExpand values,
        // otherwise step value is 2 to skip over Left and Right
        includeWidth = includeWidth ? 1 : 0;
        for ( ; i < 4 ; i += 2 - includeWidth ) {
            which = cssExpand[ i ];
            attrs[ "margin" + which ] = attrs[ "padding" + which ] = type;
        }

        if ( includeWidth ) {
            attrs.opacity = attrs.width = type;
        }

        return attrs;
    }

    function createTween( value, prop, animation ) {
        var tween,
            collection = ( Animation.tweeners[ prop ] || [] ).concat( Animation.tweeners[ "*" ] ),
            index = 0,
            length = collection.length;
        for ( ; index < length; index++ ) {
            if ( ( tween = collection[ index ].call( animation, prop, value ) ) ) {

                // We're done with this property
                return tween;
            }
        }
    }

    function defaultPrefilter( elem, props, opts ) {
        /* jshint validthis: true */
        var prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,
            anim = this,
            orig = {},
            style = elem.style,
            hidden = elem.nodeType && isHidden( elem ),
            dataShow = dataPriv.get( elem, "fxshow" );

        // Handle queue: false promises
        if ( !opts.queue ) {
            hooks = jQuery._queueHooks( elem, "fx" );
            if ( hooks.unqueued == null ) {
                hooks.unqueued = 0;
                oldfire = hooks.empty.fire;
                hooks.empty.fire = function() {
                    if ( !hooks.unqueued ) {
                        oldfire();
                    }
                };
            }
            hooks.unqueued++;

            anim.always( function() {

                // Ensure the complete handler is called before this completes
                anim.always( function() {
                    hooks.unqueued--;
                    if ( !jQuery.queue( elem, "fx" ).length ) {
                        hooks.empty.fire();
                    }
                } );
            } );
        }

        // Height/width overflow pass
        if ( elem.nodeType === 1 && ( "height" in props || "width" in props ) ) {

            // Make sure that nothing sneaks out
            // Record all 3 overflow attributes because IE9-10 do not
            // change the overflow attribute when overflowX and
            // overflowY are set to the same value
            opts.overflow = [ style.overflow, style.overflowX, style.overflowY ];

            // Set display property to inline-block for height/width
            // animations on inline elements that are having width/height animated
            display = jQuery.css( elem, "display" );

            // Test default display if display is currently "none"
            checkDisplay = display === "none" ?
                dataPriv.get( elem, "olddisplay" ) || defaultDisplay( elem.nodeName ) : display;

            if ( checkDisplay === "inline" && jQuery.css( elem, "float" ) === "none" ) {
                style.display = "inline-block";
            }
        }

        if ( opts.overflow ) {
            style.overflow = "hidden";
            anim.always( function() {
                style.overflow = opts.overflow[ 0 ];
                style.overflowX = opts.overflow[ 1 ];
                style.overflowY = opts.overflow[ 2 ];
            } );
        }

        // show/hide pass
        for ( prop in props ) {
            value = props[ prop ];
            if ( rfxtypes.exec( value ) ) {
                delete props[ prop ];
                toggle = toggle || value === "toggle";
                if ( value === ( hidden ? "hide" : "show" ) ) {

                    // If there is dataShow left over from a stopped hide or show
                    // and we are going to proceed with show, we should pretend to be hidden
                    if ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {
                        hidden = true;
                    } else {
                        continue;
                    }
                }
                orig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );

                // Any non-fx value stops us from restoring the original display value
            } else {
                display = undefined;
            }
        }

        if ( !jQuery.isEmptyObject( orig ) ) {
            if ( dataShow ) {
                if ( "hidden" in dataShow ) {
                    hidden = dataShow.hidden;
                }
            } else {
                dataShow = dataPriv.access( elem, "fxshow", {} );
            }

            // Store state if its toggle - enables .stop().toggle() to "reverse"
            if ( toggle ) {
                dataShow.hidden = !hidden;
            }
            if ( hidden ) {
                jQuery( elem ).show();
            } else {
                anim.done( function() {
                    jQuery( elem ).hide();
                } );
            }
            anim.done( function() {
                var prop;

                dataPriv.remove( elem, "fxshow" );
                for ( prop in orig ) {
                    jQuery.style( elem, prop, orig[ prop ] );
                }
            } );
            for ( prop in orig ) {
                tween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );

                if ( !( prop in dataShow ) ) {
                    dataShow[ prop ] = tween.start;
                    if ( hidden ) {
                        tween.end = tween.start;
                        tween.start = prop === "width" || prop === "height" ? 1 : 0;
                    }
                }
            }

            // If this is a noop like .hide().hide(), restore an overwritten display value
        } else if ( ( display === "none" ? defaultDisplay( elem.nodeName ) : display ) === "inline" ) {
            style.display = display;
        }
    }

    function propFilter( props, specialEasing ) {
        var index, name, easing, value, hooks;

        // camelCase, specialEasing and expand cssHook pass
        for ( index in props ) {
            name = jQuery.camelCase( index );
            easing = specialEasing[ name ];
            value = props[ index ];
            if ( jQuery.isArray( value ) ) {
                easing = value[ 1 ];
                value = props[ index ] = value[ 0 ];
            }

            if ( index !== name ) {
                props[ name ] = value;
                delete props[ index ];
            }

            hooks = jQuery.cssHooks[ name ];
            if ( hooks && "expand" in hooks ) {
                value = hooks.expand( value );
                delete props[ name ];

                // Not quite $.extend, this won't overwrite existing keys.
                // Reusing 'index' because we have the correct "name"
                for ( index in value ) {
                    if ( !( index in props ) ) {
                        props[ index ] = value[ index ];
                        specialEasing[ index ] = easing;
                    }
                }
            } else {
                specialEasing[ name ] = easing;
            }
        }
    }

    function Animation( elem, properties, options ) {
        var result,
            stopped,
            index = 0,
            length = Animation.prefilters.length,
            deferred = jQuery.Deferred().always( function() {

                // Don't match elem in the :animated selector
                delete tick.elem;
            } ),
            tick = function() {
                if ( stopped ) {
                    return false;
                }
                var currentTime = fxNow || createFxNow(),
                    remaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),

                    // Support: Android 2.3
                    // Archaic crash bug won't allow us to use `1 - ( 0.5 || 0 )` (#12497)
                    temp = remaining / animation.duration || 0,
                    percent = 1 - temp,
                    index = 0,
                    length = animation.tweens.length;

                for ( ; index < length ; index++ ) {
                    animation.tweens[ index ].run( percent );
                }

                deferred.notifyWith( elem, [ animation, percent, remaining ] );

                if ( percent < 1 && length ) {
                    return remaining;
                } else {
                    deferred.resolveWith( elem, [ animation ] );
                    return false;
                }
            },
            animation = deferred.promise( {
                elem: elem,
                props: jQuery.extend( {}, properties ),
                opts: jQuery.extend( true, {
                    specialEasing: {},
                    easing: jQuery.easing._default
                }, options ),
                originalProperties: properties,
                originalOptions: options,
                startTime: fxNow || createFxNow(),
                duration: options.duration,
                tweens: [],
                createTween: function( prop, end ) {
                    var tween = jQuery.Tween( elem, animation.opts, prop, end,
                        animation.opts.specialEasing[ prop ] || animation.opts.easing );
                    animation.tweens.push( tween );
                    return tween;
                },
                stop: function( gotoEnd ) {
                    var index = 0,

                        // If we are going to the end, we want to run all the tweens
                        // otherwise we skip this part
                        length = gotoEnd ? animation.tweens.length : 0;
                    if ( stopped ) {
                        return this;
                    }
                    stopped = true;
                    for ( ; index < length ; index++ ) {
                        animation.tweens[ index ].run( 1 );
                    }

                    // Resolve when we played the last frame; otherwise, reject
                    if ( gotoEnd ) {
                        deferred.notifyWith( elem, [ animation, 1, 0 ] );
                        deferred.resolveWith( elem, [ animation, gotoEnd ] );
                    } else {
                        deferred.rejectWith( elem, [ animation, gotoEnd ] );
                    }
                    return this;
                }
            } ),
            props = animation.props;

        propFilter( props, animation.opts.specialEasing );

        for ( ; index < length ; index++ ) {
            result = Animation.prefilters[ index ].call( animation, elem, props, animation.opts );
            if ( result ) {
                if ( jQuery.isFunction( result.stop ) ) {
                    jQuery._queueHooks( animation.elem, animation.opts.queue ).stop =
                        jQuery.proxy( result.stop, result );
                }
                return result;
            }
        }

        jQuery.map( props, createTween, animation );

        if ( jQuery.isFunction( animation.opts.start ) ) {
            animation.opts.start.call( elem, animation );
        }

        jQuery.fx.timer(
            jQuery.extend( tick, {
                elem: elem,
                anim: animation,
                queue: animation.opts.queue
            } )
        );

        // attach callbacks from options
        return animation.progress( animation.opts.progress )
            .done( animation.opts.done, animation.opts.complete )
            .fail( animation.opts.fail )
            .always( animation.opts.always );
    }

    jQuery.Animation = jQuery.extend( Animation, {
        tweeners: {
            "*": [ function( prop, value ) {
                var tween = this.createTween( prop, value );
                adjustCSS( tween.elem, prop, rcssNum.exec( value ), tween );
                return tween;
            } ]
        },

        tweener: function( props, callback ) {
            if ( jQuery.isFunction( props ) ) {
                callback = props;
                props = [ "*" ];
            } else {
                props = props.match( rnotwhite );
            }

            var prop,
                index = 0,
                length = props.length;

            for ( ; index < length ; index++ ) {
                prop = props[ index ];
                Animation.tweeners[ prop ] = Animation.tweeners[ prop ] || [];
                Animation.tweeners[ prop ].unshift( callback );
            }
        },

        prefilters: [ defaultPrefilter ],

        prefilter: function( callback, prepend ) {
            if ( prepend ) {
                Animation.prefilters.unshift( callback );
            } else {
                Animation.prefilters.push( callback );
            }
        }
    } );

    jQuery.speed = function( speed, easing, fn ) {
        var opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {
            complete: fn || !fn && easing ||
                jQuery.isFunction( speed ) && speed,
            duration: speed,
            easing: fn && easing || easing && !jQuery.isFunction( easing ) && easing
        };

        opt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ?
            opt.duration : opt.duration in jQuery.fx.speeds ?
                jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;

        // Normalize opt.queue - true/undefined/null -> "fx"
        if ( opt.queue == null || opt.queue === true ) {
            opt.queue = "fx";
        }

        // Queueing
        opt.old = opt.complete;

        opt.complete = function() {
            if ( jQuery.isFunction( opt.old ) ) {
                opt.old.call( this );
            }

            if ( opt.queue ) {
                jQuery.dequeue( this, opt.queue );
            }
        };

        return opt;
    };

    jQuery.fn.extend( {
        fadeTo: function( speed, to, easing, callback ) {

            // Show any hidden elements after setting opacity to 0
            return this.filter( isHidden ).css( "opacity", 0 ).show()

                // Animate to the value specified
                .end().animate( { opacity: to }, speed, easing, callback );
        },
        animate: function( prop, speed, easing, callback ) {
            var empty = jQuery.isEmptyObject( prop ),
                optall = jQuery.speed( speed, easing, callback ),
                doAnimation = function() {

                    // Operate on a copy of prop so per-property easing won't be lost
                    var anim = Animation( this, jQuery.extend( {}, prop ), optall );

                    // Empty animations, or finishing resolves immediately
                    if ( empty || dataPriv.get( this, "finish" ) ) {
                        anim.stop( true );
                    }
                };
            doAnimation.finish = doAnimation;

            return empty || optall.queue === false ?
                this.each( doAnimation ) :
                this.queue( optall.queue, doAnimation );
        },
        stop: function( type, clearQueue, gotoEnd ) {
            var stopQueue = function( hooks ) {
                var stop = hooks.stop;
                delete hooks.stop;
                stop( gotoEnd );
            };

            if ( typeof type !== "string" ) {
                gotoEnd = clearQueue;
                clearQueue = type;
                type = undefined;
            }
            if ( clearQueue && type !== false ) {
                this.queue( type || "fx", [] );
            }

            return this.each( function() {
                var dequeue = true,
                    index = type != null && type + "queueHooks",
                    timers = jQuery.timers,
                    data = dataPriv.get( this );

                if ( index ) {
                    if ( data[ index ] && data[ index ].stop ) {
                        stopQueue( data[ index ] );
                    }
                } else {
                    for ( index in data ) {
                        if ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {
                            stopQueue( data[ index ] );
                        }
                    }
                }

                for ( index = timers.length; index--; ) {
                    if ( timers[ index ].elem === this &&
                        ( type == null || timers[ index ].queue === type ) ) {

                        timers[ index ].anim.stop( gotoEnd );
                        dequeue = false;
                        timers.splice( index, 1 );
                    }
                }

                // Start the next in the queue if the last step wasn't forced.
                // Timers currently will call their complete callbacks, which
                // will dequeue but only if they were gotoEnd.
                if ( dequeue || !gotoEnd ) {
                    jQuery.dequeue( this, type );
                }
            } );
        },
        finish: function( type ) {
            if ( type !== false ) {
                type = type || "fx";
            }
            return this.each( function() {
                var index,
                    data = dataPriv.get( this ),
                    queue = data[ type + "queue" ],
                    hooks = data[ type + "queueHooks" ],
                    timers = jQuery.timers,
                    length = queue ? queue.length : 0;

                // Enable finishing flag on private data
                data.finish = true;

                // Empty the queue first
                jQuery.queue( this, type, [] );

                if ( hooks && hooks.stop ) {
                    hooks.stop.call( this, true );
                }

                // Look for any active animations, and finish them
                for ( index = timers.length; index--; ) {
                    if ( timers[ index ].elem === this && timers[ index ].queue === type ) {
                        timers[ index ].anim.stop( true );
                        timers.splice( index, 1 );
                    }
                }

                // Look for any animations in the old queue and finish them
                for ( index = 0; index < length; index++ ) {
                    if ( queue[ index ] && queue[ index ].finish ) {
                        queue[ index ].finish.call( this );
                    }
                }

                // Turn off finishing flag
                delete data.finish;
            } );
        }
    } );

    jQuery.each( [ "toggle", "show", "hide" ], function( i, name ) {
        var cssFn = jQuery.fn[ name ];
        jQuery.fn[ name ] = function( speed, easing, callback ) {
            return speed == null || typeof speed === "boolean" ?
                cssFn.apply( this, arguments ) :
                this.animate( genFx( name, true ), speed, easing, callback );
        };
    } );

// Generate shortcuts for custom animations
    jQuery.each( {
        slideDown: genFx( "show" ),
        slideUp: genFx( "hide" ),
        slideToggle: genFx( "toggle" ),
        fadeIn: { opacity: "show" },
        fadeOut: { opacity: "hide" },
        fadeToggle: { opacity: "toggle" }
    }, function( name, props ) {
        jQuery.fn[ name ] = function( speed, easing, callback ) {
            return this.animate( props, speed, easing, callback );
        };
    } );

    jQuery.timers = [];
    jQuery.fx.tick = function() {
        var timer,
            i = 0,
            timers = jQuery.timers;

        fxNow = jQuery.now();

        for ( ; i < timers.length; i++ ) {
            timer = timers[ i ];

            // Checks the timer has not already been removed
            if ( !timer() && timers[ i ] === timer ) {
                timers.splice( i--, 1 );
            }
        }

        if ( !timers.length ) {
            jQuery.fx.stop();
        }
        fxNow = undefined;
    };

    jQuery.fx.timer = function( timer ) {
        jQuery.timers.push( timer );
        if ( timer() ) {
            jQuery.fx.start();
        } else {
            jQuery.timers.pop();
        }
    };

    jQuery.fx.interval = 13;
    jQuery.fx.start = function() {
        if ( !timerId ) {
            timerId = window.setInterval( jQuery.fx.tick, jQuery.fx.interval );
        }
    };

    jQuery.fx.stop = function() {
        window.clearInterval( timerId );

        timerId = null;
    };

    jQuery.fx.speeds = {
        slow: 600,
        fast: 200,

        // Default speed
        _default: 400
    };


// Based off of the plugin by Clint Helfers, with permission.
// http://web.archive.org/web/20100324014747/http://blindsignals.com/index.php/2009/07/jquery-delay/
    jQuery.fn.delay = function( time, type ) {
        time = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;
        type = type || "fx";

        return this.queue( type, function( next, hooks ) {
            var timeout = window.setTimeout( next, time );
            hooks.stop = function() {
                window.clearTimeout( timeout );
            };
        } );
    };


    ( function() {
        var input = document.createElement( "input" ),
            select = document.createElement( "select" ),
            opt = select.appendChild( document.createElement( "option" ) );

        input.type = "checkbox";

        // Support: iOS<=5.1, Android<=4.2+
        // Default value for a checkbox should be "on"
        support.checkOn = input.value !== "";

        // Support: IE<=11+
        // Must access selectedIndex to make default options select
        support.optSelected = opt.selected;

        // Support: Android<=2.3
        // Options inside disabled selects are incorrectly marked as disabled
        select.disabled = true;
        support.optDisabled = !opt.disabled;

        // Support: IE<=11+
        // An input loses its value after becoming a radio
        input = document.createElement( "input" );
        input.value = "t";
        input.type = "radio";
        support.radioValue = input.value === "t";
    } )();


    var boolHook,
        attrHandle = jQuery.expr.attrHandle;

    jQuery.fn.extend( {
        attr: function( name, value ) {
            return access( this, jQuery.attr, name, value, arguments.length > 1 );
        },

        removeAttr: function( name ) {
            return this.each( function() {
                jQuery.removeAttr( this, name );
            } );
        }
    } );

    jQuery.extend( {
        attr: function( elem, name, value ) {
            var ret, hooks,
                nType = elem.nodeType;

            // Don't get/set attributes on text, comment and attribute nodes
            if ( nType === 3 || nType === 8 || nType === 2 ) {
                return;
            }

            // Fallback to prop when attributes are not supported
            if ( typeof elem.getAttribute === "undefined" ) {
                return jQuery.prop( elem, name, value );
            }

            // All attributes are lowercase
            // Grab necessary hook if one is defined
            if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {
                name = name.toLowerCase();
                hooks = jQuery.attrHooks[ name ] ||
                    ( jQuery.expr.match.bool.test( name ) ? boolHook : undefined );
            }

            if ( value !== undefined ) {
                if ( value === null ) {
                    jQuery.removeAttr( elem, name );
                    return;
                }

                if ( hooks && "set" in hooks &&
                    ( ret = hooks.set( elem, value, name ) ) !== undefined ) {
                    return ret;
                }

                elem.setAttribute( name, value + "" );
                return value;
            }

            if ( hooks && "get" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {
                return ret;
            }

            ret = jQuery.find.attr( elem, name );

            // Non-existent attributes return null, we normalize to undefined
            return ret == null ? undefined : ret;
        },

        attrHooks: {
            type: {
                set: function( elem, value ) {
                    if ( !support.radioValue && value === "radio" &&
                        jQuery.nodeName( elem, "input" ) ) {
                        var val = elem.value;
                        elem.setAttribute( "type", value );
                        if ( val ) {
                            elem.value = val;
                        }
                        return value;
                    }
                }
            }
        },

        removeAttr: function( elem, value ) {
            var name, propName,
                i = 0,
                attrNames = value && value.match( rnotwhite );

            if ( attrNames && elem.nodeType === 1 ) {
                while ( ( name = attrNames[ i++ ] ) ) {
                    propName = jQuery.propFix[ name ] || name;

                    // Boolean attributes get special treatment (#10870)
                    if ( jQuery.expr.match.bool.test( name ) ) {

                        // Set corresponding property to false
                        elem[ propName ] = false;
                    }

                    elem.removeAttribute( name );
                }
            }
        }
    } );

// Hooks for boolean attributes
    boolHook = {
        set: function( elem, value, name ) {
            if ( value === false ) {

                // Remove boolean attributes when set to false
                jQuery.removeAttr( elem, name );
            } else {
                elem.setAttribute( name, name );
            }
            return name;
        }
    };
    jQuery.each( jQuery.expr.match.bool.source.match( /\w+/g ), function( i, name ) {
        var getter = attrHandle[ name ] || jQuery.find.attr;

        attrHandle[ name ] = function( elem, name, isXML ) {
            var ret, handle;
            if ( !isXML ) {

                // Avoid an infinite loop by temporarily removing this function from the getter
                handle = attrHandle[ name ];
                attrHandle[ name ] = ret;
                ret = getter( elem, name, isXML ) != null ?
                    name.toLowerCase() :
                    null;
                attrHandle[ name ] = handle;
            }
            return ret;
        };
    } );




    var rfocusable = /^(?:input|select|textarea|button)$/i,
        rclickable = /^(?:a|area)$/i;

    jQuery.fn.extend( {
        prop: function( name, value ) {
            return access( this, jQuery.prop, name, value, arguments.length > 1 );
        },

        removeProp: function( name ) {
            return this.each( function() {
                delete this[ jQuery.propFix[ name ] || name ];
            } );
        }
    } );

    jQuery.extend( {
        prop: function( elem, name, value ) {
            var ret, hooks,
                nType = elem.nodeType;

            // Don't get/set properties on text, comment and attribute nodes
            if ( nType === 3 || nType === 8 || nType === 2 ) {
                return;
            }

            if ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {

                // Fix name and attach hooks
                name = jQuery.propFix[ name ] || name;
                hooks = jQuery.propHooks[ name ];
            }

            if ( value !== undefined ) {
                if ( hooks && "set" in hooks &&
                    ( ret = hooks.set( elem, value, name ) ) !== undefined ) {
                    return ret;
                }

                return ( elem[ name ] = value );
            }

            if ( hooks && "get" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {
                return ret;
            }

            return elem[ name ];
        },

        propHooks: {
            tabIndex: {
                get: function( elem ) {

                    // elem.tabIndex doesn't always return the
                    // correct value when it hasn't been explicitly set
                    // http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/
                    // Use proper attribute retrieval(#12072)
                    var tabindex = jQuery.find.attr( elem, "tabindex" );

                    return tabindex ?
                        parseInt( tabindex, 10 ) :
                        rfocusable.test( elem.nodeName ) ||
                        rclickable.test( elem.nodeName ) && elem.href ?
                            0 :
                            -1;
                }
            }
        },

        propFix: {
            "for": "htmlFor",
            "class": "className"
        }
    } );

// Support: IE <=11 only
// Accessing the selectedIndex property
// forces the browser to respect setting selected
// on the option
// The getter ensures a default option is selected
// when in an optgroup
    if ( !support.optSelected ) {
        jQuery.propHooks.selected = {
            get: function( elem ) {
                var parent = elem.parentNode;
                if ( parent && parent.parentNode ) {
                    parent.parentNode.selectedIndex;
                }
                return null;
            },
            set: function( elem ) {
                var parent = elem.parentNode;
                if ( parent ) {
                    parent.selectedIndex;

                    if ( parent.parentNode ) {
                        parent.parentNode.selectedIndex;
                    }
                }
            }
        };
    }

    jQuery.each( [
        "tabIndex",
        "readOnly",
        "maxLength",
        "cellSpacing",
        "cellPadding",
        "rowSpan",
        "colSpan",
        "useMap",
        "frameBorder",
        "contentEditable"
    ], function() {
        jQuery.propFix[ this.toLowerCase() ] = this;
    } );




    var rclass = /[\t\r\n\f]/g;

    function getClass( elem ) {
        return elem.getAttribute && elem.getAttribute( "class" ) || "";
    }

    jQuery.fn.extend( {
        addClass: function( value ) {
            var classes, elem, cur, curValue, clazz, j, finalValue,
                i = 0;

            if ( jQuery.isFunction( value ) ) {
                return this.each( function( j ) {
                    jQuery( this ).addClass( value.call( this, j, getClass( this ) ) );
                } );
            }

            if ( typeof value === "string" && value ) {
                classes = value.match( rnotwhite ) || [];

                while ( ( elem = this[ i++ ] ) ) {
                    curValue = getClass( elem );
                    cur = elem.nodeType === 1 &&
                        ( " " + curValue + " " ).replace( rclass, " " );

                    if ( cur ) {
                        j = 0;
                        while ( ( clazz = classes[ j++ ] ) ) {
                            if ( cur.indexOf( " " + clazz + " " ) < 0 ) {
                                cur += clazz + " ";
                            }
                        }

                        // Only assign if different to avoid unneeded rendering.
                        finalValue = jQuery.trim( cur );
                        if ( curValue !== finalValue ) {
                            elem.setAttribute( "class", finalValue );
                        }
                    }
                }
            }

            return this;
        },

        removeClass: function( value ) {
            var classes, elem, cur, curValue, clazz, j, finalValue,
                i = 0;

            if ( jQuery.isFunction( value ) ) {
                return this.each( function( j ) {
                    jQuery( this ).removeClass( value.call( this, j, getClass( this ) ) );
                } );
            }

            if ( !arguments.length ) {
                return this.attr( "class", "" );
            }

            if ( typeof value === "string" && value ) {
                classes = value.match( rnotwhite ) || [];

                while ( ( elem = this[ i++ ] ) ) {
                    curValue = getClass( elem );

                    // This expression is here for better compressibility (see addClass)
                    cur = elem.nodeType === 1 &&
                        ( " " + curValue + " " ).replace( rclass, " " );

                    if ( cur ) {
                        j = 0;
                        while ( ( clazz = classes[ j++ ] ) ) {

                            // Remove *all* instances
                            while ( cur.indexOf( " " + clazz + " " ) > -1 ) {
                                cur = cur.replace( " " + clazz + " ", " " );
                            }
                        }

                        // Only assign if different to avoid unneeded rendering.
                        finalValue = jQuery.trim( cur );
                        if ( curValue !== finalValue ) {
                            elem.setAttribute( "class", finalValue );
                        }
                    }
                }
            }

            return this;
        },

        toggleClass: function( value, stateVal ) {
            var type = typeof value;

            if ( typeof stateVal === "boolean" && type === "string" ) {
                return stateVal ? this.addClass( value ) : this.removeClass( value );
            }

            if ( jQuery.isFunction( value ) ) {
                return this.each( function( i ) {
                    jQuery( this ).toggleClass(
                        value.call( this, i, getClass( this ), stateVal ),
                        stateVal
                    );
                } );
            }

            return this.each( function() {
                var className, i, self, classNames;

                if ( type === "string" ) {

                    // Toggle individual class names
                    i = 0;
                    self = jQuery( this );
                    classNames = value.match( rnotwhite ) || [];

                    while ( ( className = classNames[ i++ ] ) ) {

                        // Check each className given, space separated list
                        if ( self.hasClass( className ) ) {
                            self.removeClass( className );
                        } else {
                            self.addClass( className );
                        }
                    }

                    // Toggle whole class name
                } else if ( value === undefined || type === "boolean" ) {
                    className = getClass( this );
                    if ( className ) {

                        // Store className if set
                        dataPriv.set( this, "__className__", className );
                    }

                    // If the element has a class name or if we're passed `false`,
                    // then remove the whole classname (if there was one, the above saved it).
                    // Otherwise bring back whatever was previously saved (if anything),
                    // falling back to the empty string if nothing was stored.
                    if ( this.setAttribute ) {
                        this.setAttribute( "class",
                            className || value === false ?
                                "" :
                                dataPriv.get( this, "__className__" ) || ""
                        );
                    }
                }
            } );
        },

        hasClass: function( selector ) {
            var className, elem,
                i = 0;

            className = " " + selector + " ";
            while ( ( elem = this[ i++ ] ) ) {
                if ( elem.nodeType === 1 &&
                    ( " " + getClass( elem ) + " " ).replace( rclass, " " )
                        .indexOf( className ) > -1
                ) {
                    return true;
                }
            }

            return false;
        }
    } );




    var rreturn = /\r/g,
        rspaces = /[\x20\t\r\n\f]+/g;

    jQuery.fn.extend( {
        val: function( value ) {
            var hooks, ret, isFunction,
                elem = this[ 0 ];

            if ( !arguments.length ) {
                if ( elem ) {
                    hooks = jQuery.valHooks[ elem.type ] ||
                        jQuery.valHooks[ elem.nodeName.toLowerCase() ];

                    if ( hooks &&
                        "get" in hooks &&
                        ( ret = hooks.get( elem, "value" ) ) !== undefined
                    ) {
                        return ret;
                    }

                    ret = elem.value;

                    return typeof ret === "string" ?

                        // Handle most common string cases
                        ret.replace( rreturn, "" ) :

                        // Handle cases where value is null/undef or number
                        ret == null ? "" : ret;
                }

                return;
            }

            isFunction = jQuery.isFunction( value );

            return this.each( function( i ) {
                var val;

                if ( this.nodeType !== 1 ) {
                    return;
                }

                if ( isFunction ) {
                    val = value.call( this, i, jQuery( this ).val() );
                } else {
                    val = value;
                }

                // Treat null/undefined as ""; convert numbers to string
                if ( val == null ) {
                    val = "";

                } else if ( typeof val === "number" ) {
                    val += "";

                } else if ( jQuery.isArray( val ) ) {
                    val = jQuery.map( val, function( value ) {
                        return value == null ? "" : value + "";
                    } );
                }

                hooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];

                // If set returns undefined, fall back to normal setting
                if ( !hooks || !( "set" in hooks ) || hooks.set( this, val, "value" ) === undefined ) {
                    this.value = val;
                }
            } );
        }
    } );

    jQuery.extend( {
        valHooks: {
            option: {
                get: function( elem ) {

                    var val = jQuery.find.attr( elem, "value" );
                    return val != null ?
                        val :

                        // Support: IE10-11+
                        // option.text throws exceptions (#14686, #14858)
                        // Strip and collapse whitespace
                        // https://html.spec.whatwg.org/#strip-and-collapse-whitespace
                        jQuery.trim( jQuery.text( elem ) ).replace( rspaces, " " );
                }
            },
            select: {
                get: function( elem ) {
                    var value, option,
                        options = elem.options,
                        index = elem.selectedIndex,
                        one = elem.type === "select-one" || index < 0,
                        values = one ? null : [],
                        max = one ? index + 1 : options.length,
                        i = index < 0 ?
                            max :
                            one ? index : 0;

                    // Loop through all the selected options
                    for ( ; i < max; i++ ) {
                        option = options[ i ];

                        // IE8-9 doesn't update selected after form reset (#2551)
                        if ( ( option.selected || i === index ) &&

                            // Don't return options that are disabled or in a disabled optgroup
                            ( support.optDisabled ?
                                !option.disabled : option.getAttribute( "disabled" ) === null ) &&
                            ( !option.parentNode.disabled ||
                                !jQuery.nodeName( option.parentNode, "optgroup" ) ) ) {

                            // Get the specific value for the option
                            value = jQuery( option ).val();

                            // We don't need an array for one selects
                            if ( one ) {
                                return value;
                            }

                            // Multi-Selects return an array
                            values.push( value );
                        }
                    }

                    return values;
                },

                set: function( elem, value ) {
                    var optionSet, option,
                        options = elem.options,
                        values = jQuery.makeArray( value ),
                        i = options.length;

                    while ( i-- ) {
                        option = options[ i ];
                        if ( option.selected =
                            jQuery.inArray( jQuery.valHooks.option.get( option ), values ) > -1
                        ) {
                            optionSet = true;
                        }
                    }

                    // Force browsers to behave consistently when non-matching value is set
                    if ( !optionSet ) {
                        elem.selectedIndex = -1;
                    }
                    return values;
                }
            }
        }
    } );

// Radios and checkboxes getter/setter
    jQuery.each( [ "radio", "checkbox" ], function() {
        jQuery.valHooks[ this ] = {
            set: function( elem, value ) {
                if ( jQuery.isArray( value ) ) {
                    return ( elem.checked = jQuery.inArray( jQuery( elem ).val(), value ) > -1 );
                }
            }
        };
        if ( !support.checkOn ) {
            jQuery.valHooks[ this ].get = function( elem ) {
                return elem.getAttribute( "value" ) === null ? "on" : elem.value;
            };
        }
    } );




// Return jQuery for attributes-only inclusion


    var rfocusMorph = /^(?:focusinfocus|focusoutblur)$/;

    jQuery.extend( jQuery.event, {

        trigger: function( event, data, elem, onlyHandlers ) {

            var i, cur, tmp, bubbleType, ontype, handle, special,
                eventPath = [ elem || document ],
                type = hasOwn.call( event, "type" ) ? event.type : event,
                namespaces = hasOwn.call( event, "namespace" ) ? event.namespace.split( "." ) : [];

            cur = tmp = elem = elem || document;

            // Don't do events on text and comment nodes
            if ( elem.nodeType === 3 || elem.nodeType === 8 ) {
                return;
            }

            // focus/blur morphs to focusin/out; ensure we're not firing them right now
            if ( rfocusMorph.test( type + jQuery.event.triggered ) ) {
                return;
            }

            if ( type.indexOf( "." ) > -1 ) {

                // Namespaced trigger; create a regexp to match event type in handle()
                namespaces = type.split( "." );
                type = namespaces.shift();
                namespaces.sort();
            }
            ontype = type.indexOf( ":" ) < 0 && "on" + type;

            // Caller can pass in a jQuery.Event object, Object, or just an event type string
            event = event[ jQuery.expando ] ?
                event :
                new jQuery.Event( type, typeof event === "object" && event );

            // Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)
            event.isTrigger = onlyHandlers ? 2 : 3;
            event.namespace = namespaces.join( "." );
            event.rnamespace = event.namespace ?
                new RegExp( "(^|\\.)" + namespaces.join( "\\.(?:.*\\.|)" ) + "(\\.|$)" ) :
                null;

            // Clean up the event in case it is being reused
            event.result = undefined;
            if ( !event.target ) {
                event.target = elem;
            }

            // Clone any incoming data and prepend the event, creating the handler arg list
            data = data == null ?
                [ event ] :
                jQuery.makeArray( data, [ event ] );

            // Allow special events to draw outside the lines
            special = jQuery.event.special[ type ] || {};
            if ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {
                return;
            }

            // Determine event propagation path in advance, per W3C events spec (#9951)
            // Bubble up to document, then to window; watch for a global ownerDocument var (#9724)
            if ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {

                bubbleType = special.delegateType || type;
                if ( !rfocusMorph.test( bubbleType + type ) ) {
                    cur = cur.parentNode;
                }
                for ( ; cur; cur = cur.parentNode ) {
                    eventPath.push( cur );
                    tmp = cur;
                }

                // Only add window if we got to document (e.g., not plain obj or detached DOM)
                if ( tmp === ( elem.ownerDocument || document ) ) {
                    eventPath.push( tmp.defaultView || tmp.parentWindow || window );
                }
            }

            // Fire handlers on the event path
            i = 0;
            while ( ( cur = eventPath[ i++ ] ) && !event.isPropagationStopped() ) {

                event.type = i > 1 ?
                    bubbleType :
                    special.bindType || type;

                // jQuery handler
                handle = ( dataPriv.get( cur, "events" ) || {} )[ event.type ] &&
                    dataPriv.get( cur, "handle" );
                if ( handle ) {
                    handle.apply( cur, data );
                }

                // Native handler
                handle = ontype && cur[ ontype ];
                if ( handle && handle.apply && acceptData( cur ) ) {
                    event.result = handle.apply( cur, data );
                    if ( event.result === false ) {
                        event.preventDefault();
                    }
                }
            }
            event.type = type;

            // If nobody prevented the default action, do it now
            if ( !onlyHandlers && !event.isDefaultPrevented() ) {

                if ( ( !special._default ||
                    special._default.apply( eventPath.pop(), data ) === false ) &&
                    acceptData( elem ) ) {

                    // Call a native DOM method on the target with the same name name as the event.
                    // Don't do default actions on window, that's where global variables be (#6170)
                    if ( ontype && jQuery.isFunction( elem[ type ] ) && !jQuery.isWindow( elem ) ) {

                        // Don't re-trigger an onFOO event when we call its FOO() method
                        tmp = elem[ ontype ];

                        if ( tmp ) {
                            elem[ ontype ] = null;
                        }

                        // Prevent re-triggering of the same event, since we already bubbled it above
                        jQuery.event.triggered = type;
                        elem[ type ]();
                        jQuery.event.triggered = undefined;

                        if ( tmp ) {
                            elem[ ontype ] = tmp;
                        }
                    }
                }
            }

            return event.result;
        },

        // Piggyback on a donor event to simulate a different one
        simulate: function( type, elem, event ) {
            var e = jQuery.extend(
                new jQuery.Event(),
                event,
                {
                    type: type,
                    isSimulated: true

                    // Previously, `originalEvent: {}` was set here, so stopPropagation call
                    // would not be triggered on donor event, since in our own
                    // jQuery.event.stopPropagation function we had a check for existence of
                    // originalEvent.stopPropagation method, so, consequently it would be a noop.
                    //
                    // But now, this "simulate" function is used only for events
                    // for which stopPropagation() is noop, so there is no need for that anymore.
                    //
                    // For the 1.x branch though, guard for "click" and "submit"
                    // events is still used, but was moved to jQuery.event.stopPropagation function
                    // because `originalEvent` should point to the original event for the constancy
                    // with other events and for more focused logic
                }
            );

            jQuery.event.trigger( e, null, elem );

            if ( e.isDefaultPrevented() ) {
                event.preventDefault();
            }
        }

    } );

    jQuery.fn.extend( {

        trigger: function( type, data ) {
            return this.each( function() {
                jQuery.event.trigger( type, data, this );
            } );
        },
        triggerHandler: function( type, data ) {
            var elem = this[ 0 ];
            if ( elem ) {
                return jQuery.event.trigger( type, data, elem, true );
            }
        }
    } );


    jQuery.each( ( "blur focus focusin focusout load resize scroll unload click dblclick " +
        "mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +
        "change select submit keydown keypress keyup error contextmenu" ).split( " " ),
        function( i, name ) {

            // Handle event binding
            jQuery.fn[ name ] = function( data, fn ) {
                return arguments.length > 0 ?
                    this.on( name, null, data, fn ) :
                    this.trigger( name );
            };
        } );

    jQuery.fn.extend( {
        hover: function( fnOver, fnOut ) {
            return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );
        }
    } );




    support.focusin = "onfocusin" in window;


// Support: Firefox
// Firefox doesn't have focus(in | out) events
// Related ticket - https://bugzilla.mozilla.org/show_bug.cgi?id=687787
//
// Support: Chrome, Safari
// focus(in | out) events fire after focus & blur events,
// which is spec violation - http://www.w3.org/TR/DOM-Level-3-Events/#events-focusevent-event-order
// Related ticket - https://code.google.com/p/chromium/issues/detail?id=449857
    if ( !support.focusin ) {
        jQuery.each( { focus: "focusin", blur: "focusout" }, function( orig, fix ) {

            // Attach a single capturing handler on the document while someone wants focusin/focusout
            var handler = function( event ) {
                jQuery.event.simulate( fix, event.target, jQuery.event.fix( event ) );
            };

            jQuery.event.special[ fix ] = {
                setup: function() {
                    var doc = this.ownerDocument || this,
                        attaches = dataPriv.access( doc, fix );

                    if ( !attaches ) {
                        doc.addEventListener( orig, handler, true );
                    }
                    dataPriv.access( doc, fix, ( attaches || 0 ) + 1 );
                },
                teardown: function() {
                    var doc = this.ownerDocument || this,
                        attaches = dataPriv.access( doc, fix ) - 1;

                    if ( !attaches ) {
                        doc.removeEventListener( orig, handler, true );
                        dataPriv.remove( doc, fix );

                    } else {
                        dataPriv.access( doc, fix, attaches );
                    }
                }
            };
        } );
    }
    var location = window.location;

    var nonce = jQuery.now();

    var rquery = ( /\?/ );



// Support: Android 2.3
// Workaround failure to string-cast null input
    jQuery.parseJSON = function( data ) {
        return JSON.parse( data + "" );
    };


// Cross-browser xml parsing
    jQuery.parseXML = function( data ) {
        var xml;
        if ( !data || typeof data !== "string" ) {
            return null;
        }

        // Support: IE9
        try {
            xml = ( new window.DOMParser() ).parseFromString( data, "text/xml" );
        } catch ( e ) {
            xml = undefined;
        }

        if ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {
            jQuery.error( "Invalid XML: " + data );
        }
        return xml;
    };


    var
        rhash = /#.*$/,
        rts = /([?&])_=[^&]*/,
        rheaders = /^(.*?):[ \t]*([^\r\n]*)$/mg,

        // #7653, #8125, #8152: local protocol detection
        rlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
        rnoContent = /^(?:GET|HEAD)$/,
        rprotocol = /^\/\//,

        /* Prefilters
	 * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)
	 * 2) These are called:
	 *    - BEFORE asking for a transport
	 *    - AFTER param serialization (s.data is a string if s.processData is true)
	 * 3) key is the dataType
	 * 4) the catchall symbol "*" can be used
	 * 5) execution will start with transport dataType and THEN continue down to "*" if needed
	 */
        prefilters = {},

        /* Transports bindings
	 * 1) key is the dataType
	 * 2) the catchall symbol "*" can be used
	 * 3) selection will start with transport dataType and THEN go to "*" if needed
	 */
        transports = {},

        // Avoid comment-prolog char sequence (#10098); must appease lint and evade compression
        allTypes = "*/".concat( "*" ),

        // Anchor tag for parsing the document origin
        originAnchor = document.createElement( "a" );
    originAnchor.href = location.href;

// Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport
    function addToPrefiltersOrTransports( structure ) {

        // dataTypeExpression is optional and defaults to "*"
        return function( dataTypeExpression, func ) {

            if ( typeof dataTypeExpression !== "string" ) {
                func = dataTypeExpression;
                dataTypeExpression = "*";
            }

            var dataType,
                i = 0,
                dataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];

            if ( jQuery.isFunction( func ) ) {

                // For each dataType in the dataTypeExpression
                while ( ( dataType = dataTypes[ i++ ] ) ) {

                    // Prepend if requested
                    if ( dataType[ 0 ] === "+" ) {
                        dataType = dataType.slice( 1 ) || "*";
                        ( structure[ dataType ] = structure[ dataType ] || [] ).unshift( func );

                        // Otherwise append
                    } else {
                        ( structure[ dataType ] = structure[ dataType ] || [] ).push( func );
                    }
                }
            }
        };
    }

// Base inspection function for prefilters and transports
    function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {

        var inspected = {},
            seekingTransport = ( structure === transports );

        function inspect( dataType ) {
            var selected;
            inspected[ dataType ] = true;
            jQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {
                var dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );
                if ( typeof dataTypeOrTransport === "string" &&
                    !seekingTransport && !inspected[ dataTypeOrTransport ] ) {

                    options.dataTypes.unshift( dataTypeOrTransport );
                    inspect( dataTypeOrTransport );
                    return false;
                } else if ( seekingTransport ) {
                    return !( selected = dataTypeOrTransport );
                }
            } );
            return selected;
        }

        return inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );
    }

// A special extend for ajax options
// that takes "flat" options (not to be deep extended)
// Fixes #9887
    function ajaxExtend( target, src ) {
        var key, deep,
            flatOptions = jQuery.ajaxSettings.flatOptions || {};

        for ( key in src ) {
            if ( src[ key ] !== undefined ) {
                ( flatOptions[ key ] ? target : ( deep || ( deep = {} ) ) )[ key ] = src[ key ];
            }
        }
        if ( deep ) {
            jQuery.extend( true, target, deep );
        }

        return target;
    }

    /* Handles responses to an ajax request:
 * - finds the right dataType (mediates between content-type and expected dataType)
 * - returns the corresponding response
 */
    function ajaxHandleResponses( s, jqXHR, responses ) {

        var ct, type, finalDataType, firstDataType,
            contents = s.contents,
            dataTypes = s.dataTypes;

        // Remove auto dataType and get content-type in the process
        while ( dataTypes[ 0 ] === "*" ) {
            dataTypes.shift();
            if ( ct === undefined ) {
                ct = s.mimeType || jqXHR.getResponseHeader( "Content-Type" );
            }
        }

        // Check if we're dealing with a known content-type
        if ( ct ) {
            for ( type in contents ) {
                if ( contents[ type ] && contents[ type ].test( ct ) ) {
                    dataTypes.unshift( type );
                    break;
                }
            }
        }

        // Check to see if we have a response for the expected dataType
        if ( dataTypes[ 0 ] in responses ) {
            finalDataType = dataTypes[ 0 ];
        } else {

            // Try convertible dataTypes
            for ( type in responses ) {
                if ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[ 0 ] ] ) {
                    finalDataType = type;
                    break;
                }
                if ( !firstDataType ) {
                    firstDataType = type;
                }
            }

            // Or just use first one
            finalDataType = finalDataType || firstDataType;
        }

        // If we found a dataType
        // We add the dataType to the list if needed
        // and return the corresponding response
        if ( finalDataType ) {
            if ( finalDataType !== dataTypes[ 0 ] ) {
                dataTypes.unshift( finalDataType );
            }
            return responses[ finalDataType ];
        }
    }

    /* Chain conversions given the request and the original response
 * Also sets the responseXXX fields on the jqXHR instance
 */
    function ajaxConvert( s, response, jqXHR, isSuccess ) {
        var conv2, current, conv, tmp, prev,
            converters = {},

            // Work with a copy of dataTypes in case we need to modify it for conversion
            dataTypes = s.dataTypes.slice();

        // Create converters map with lowercased keys
        if ( dataTypes[ 1 ] ) {
            for ( conv in s.converters ) {
                converters[ conv.toLowerCase() ] = s.converters[ conv ];
            }
        }

        current = dataTypes.shift();

        // Convert to each sequential dataType
        while ( current ) {

            if ( s.responseFields[ current ] ) {
                jqXHR[ s.responseFields[ current ] ] = response;
            }

            // Apply the dataFilter if provided
            if ( !prev && isSuccess && s.dataFilter ) {
                response = s.dataFilter( response, s.dataType );
            }

            prev = current;
            current = dataTypes.shift();

            if ( current ) {

                // There's only work to do if current dataType is non-auto
                if ( current === "*" ) {

                    current = prev;

                    // Convert response if prev dataType is non-auto and differs from current
                } else if ( prev !== "*" && prev !== current ) {

                    // Seek a direct converter
                    conv = converters[ prev + " " + current ] || converters[ "* " + current ];

                    // If none found, seek a pair
                    if ( !conv ) {
                        for ( conv2 in converters ) {

                            // If conv2 outputs current
                            tmp = conv2.split( " " );
                            if ( tmp[ 1 ] === current ) {

                                // If prev can be converted to accepted input
                                conv = converters[ prev + " " + tmp[ 0 ] ] ||
                                    converters[ "* " + tmp[ 0 ] ];
                                if ( conv ) {

                                    // Condense equivalence converters
                                    if ( conv === true ) {
                                        conv = converters[ conv2 ];

                                        // Otherwise, insert the intermediate dataType
                                    } else if ( converters[ conv2 ] !== true ) {
                                        current = tmp[ 0 ];
                                        dataTypes.unshift( tmp[ 1 ] );
                                    }
                                    break;
                                }
                            }
                        }
                    }

                    // Apply converter (if not an equivalence)
                    if ( conv !== true ) {

                        // Unless errors are allowed to bubble, catch and return them
                        if ( conv && s.throws ) {
                            response = conv( response );
                        } else {
                            try {
                                response = conv( response );
                            } catch ( e ) {
                                return {
                                    state: "parsererror",
                                    error: conv ? e : "No conversion from " + prev + " to " + current
                                };
                            }
                        }
                    }
                }
            }
        }

        return { state: "success", data: response };
    }

    jQuery.extend( {

        // Counter for holding the number of active queries
        active: 0,

        // Last-Modified header cache for next request
        lastModified: {},
        etag: {},

        ajaxSettings: {
            url: location.href,
            type: "GET",
            isLocal: rlocalProtocol.test( location.protocol ),
            global: true,
            processData: true,
            async: true,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            /*
		timeout: 0,
		data: null,
		dataType: null,
		username: null,
		password: null,
		cache: null,
		throws: false,
		traditional: false,
		headers: {},
		*/

            accepts: {
                "*": allTypes,
                text: "text/plain",
                html: "text/html",
                xml: "application/xml, text/xml",
                json: "application/json, text/javascript"
            },

            contents: {
                xml: /\bxml\b/,
                html: /\bhtml/,
                json: /\bjson\b/
            },

            responseFields: {
                xml: "responseXML",
                text: "responseText",
                json: "responseJSON"
            },

            // Data converters
            // Keys separate source (or catchall "*") and destination types with a single space
            converters: {

                // Convert anything to text
                "* text": String,

                // Text to html (true = no transformation)
                "text html": true,

                // Evaluate text as a json expression
                "text json": jQuery.parseJSON,

                // Parse text as xml
                "text xml": jQuery.parseXML
            },

            // For options that shouldn't be deep extended:
            // you can add your own custom options here if
            // and when you create one that shouldn't be
            // deep extended (see ajaxExtend)
            flatOptions: {
                url: true,
                context: true
            }
        },

        // Creates a full fledged settings object into target
        // with both ajaxSettings and settings fields.
        // If target is omitted, writes into ajaxSettings.
        ajaxSetup: function( target, settings ) {
            return settings ?

                // Building a settings object
                ajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :

                // Extending ajaxSettings
                ajaxExtend( jQuery.ajaxSettings, target );
        },

        ajaxPrefilter: addToPrefiltersOrTransports( prefilters ),
        ajaxTransport: addToPrefiltersOrTransports( transports ),

        // Main method
        ajax: function( url, options ) {

            // If url is an object, simulate pre-1.5 signature
            if ( typeof url === "object" ) {
                options = url;
                url = undefined;
            }

            // Force options to be an object
            options = options || {};

            var transport,

                // URL without anti-cache param
                cacheURL,

                // Response headers
                responseHeadersString,
                responseHeaders,

                // timeout handle
                timeoutTimer,

                // Url cleanup var
                urlAnchor,

                // To know if global events are to be dispatched
                fireGlobals,

                // Loop variable
                i,

                // Create the final options object
                s = jQuery.ajaxSetup( {}, options ),

                // Callbacks context
                callbackContext = s.context || s,

                // Context for global events is callbackContext if it is a DOM node or jQuery collection
                globalEventContext = s.context &&
                ( callbackContext.nodeType || callbackContext.jquery ) ?
                    jQuery( callbackContext ) :
                    jQuery.event,

                // Deferreds
                deferred = jQuery.Deferred(),
                completeDeferred = jQuery.Callbacks( "once memory" ),

                // Status-dependent callbacks
                statusCode = s.statusCode || {},

                // Headers (they are sent all at once)
                requestHeaders = {},
                requestHeadersNames = {},

                // The jqXHR state
                state = 0,

                // Default abort message
                strAbort = "canceled",

                // Fake xhr
                jqXHR = {
                    readyState: 0,

                    // Builds headers hashtable if needed
                    getResponseHeader: function( key ) {
                        var match;
                        if ( state === 2 ) {
                            if ( !responseHeaders ) {
                                responseHeaders = {};
                                while ( ( match = rheaders.exec( responseHeadersString ) ) ) {
                                    responseHeaders[ match[ 1 ].toLowerCase() ] = match[ 2 ];
                                }
                            }
                            match = responseHeaders[ key.toLowerCase() ];
                        }
                        return match == null ? null : match;
                    },

                    // Raw string
                    getAllResponseHeaders: function() {
                        return state === 2 ? responseHeadersString : null;
                    },

                    // Caches the header
                    setRequestHeader: function( name, value ) {
                        var lname = name.toLowerCase();
                        if ( !state ) {
                            name = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;
                            requestHeaders[ name ] = value;
                        }
                        return this;
                    },

                    // Overrides response content-type header
                    overrideMimeType: function( type ) {
                        if ( !state ) {
                            s.mimeType = type;
                        }
                        return this;
                    },

                    // Status-dependent callbacks
                    statusCode: function( map ) {
                        var code;
                        if ( map ) {
                            if ( state < 2 ) {
                                for ( code in map ) {

                                    // Lazy-add the new callback in a way that preserves old ones
                                    statusCode[ code ] = [ statusCode[ code ], map[ code ] ];
                                }
                            } else {

                                // Execute the appropriate callbacks
                                jqXHR.always( map[ jqXHR.status ] );
                            }
                        }
                        return this;
                    },

                    // Cancel the request
                    abort: function( statusText ) {
                        var finalText = statusText || strAbort;
                        if ( transport ) {
                            transport.abort( finalText );
                        }
                        done( 0, finalText );
                        return this;
                    }
                };

            // Attach deferreds
            deferred.promise( jqXHR ).complete = completeDeferred.add;
            jqXHR.success = jqXHR.done;
            jqXHR.error = jqXHR.fail;

            // Remove hash character (#7531: and string promotion)
            // Add protocol if not provided (prefilters might expect it)
            // Handle falsy url in the settings object (#10093: consistency with old signature)
            // We also use the url parameter if available
            s.url = ( ( url || s.url || location.href ) + "" ).replace( rhash, "" )
                .replace( rprotocol, location.protocol + "//" );

            // Alias method option to type as per ticket #12004
            s.type = options.method || options.type || s.method || s.type;

            // Extract dataTypes list
            s.dataTypes = jQuery.trim( s.dataType || "*" ).toLowerCase().match( rnotwhite ) || [ "" ];

            // A cross-domain request is in order when the origin doesn't match the current origin.
            if ( s.crossDomain == null ) {
                urlAnchor = document.createElement( "a" );

                // Support: IE8-11+
                // IE throws exception if url is malformed, e.g. http://example.com:80x/
                try {
                    urlAnchor.href = s.url;

                    // Support: IE8-11+
                    // Anchor's host property isn't correctly set when s.url is relative
                    urlAnchor.href = urlAnchor.href;
                    s.crossDomain = originAnchor.protocol + "//" + originAnchor.host !==
                        urlAnchor.protocol + "//" + urlAnchor.host;
                } catch ( e ) {

                    // If there is an error parsing the URL, assume it is crossDomain,
                    // it can be rejected by the transport if it is invalid
                    s.crossDomain = true;
                }
            }

            // Convert data if not already a string
            if ( s.data && s.processData && typeof s.data !== "string" ) {
                s.data = jQuery.param( s.data, s.traditional );
            }

            // Apply prefilters
            inspectPrefiltersOrTransports( prefilters, s, options, jqXHR );

            // If request was aborted inside a prefilter, stop there
            if ( state === 2 ) {
                return jqXHR;
            }

            // We can fire global events as of now if asked to
            // Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)
            fireGlobals = jQuery.event && s.global;

            // Watch for a new set of requests
            if ( fireGlobals && jQuery.active++ === 0 ) {
                jQuery.event.trigger( "ajaxStart" );
            }

            // Uppercase the type
            s.type = s.type.toUpperCase();

            // Determine if request has content
            s.hasContent = !rnoContent.test( s.type );

            // Save the URL in case we're toying with the If-Modified-Since
            // and/or If-None-Match header later on
            cacheURL = s.url;

            // More options handling for requests with no content
            if ( !s.hasContent ) {

                // If data is available, append data to url
                if ( s.data ) {
                    cacheURL = ( s.url += ( rquery.test( cacheURL ) ? "&" : "?" ) + s.data );

                    // #9682: remove data so that it's not used in an eventual retry
                    delete s.data;
                }

                // Add anti-cache in url if needed
                if ( s.cache === false ) {
                    s.url = rts.test( cacheURL ) ?

                        // If there is already a '_' parameter, set its value
                        cacheURL.replace( rts, "$1_=" + nonce++ ) :

                        // Otherwise add one to the end
                        cacheURL + ( rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + nonce++;
                }
            }

            // Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
            if ( s.ifModified ) {
                if ( jQuery.lastModified[ cacheURL ] ) {
                    jqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );
                }
                if ( jQuery.etag[ cacheURL ] ) {
                    jqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );
                }
            }

            // Set the correct header, if data is being sent
            if ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {
                jqXHR.setRequestHeader( "Content-Type", s.contentType );
            }

            // Set the Accepts header for the server, depending on the dataType
            jqXHR.setRequestHeader(
                "Accept",
                s.dataTypes[ 0 ] && s.accepts[ s.dataTypes[ 0 ] ] ?
                    s.accepts[ s.dataTypes[ 0 ] ] +
                    ( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :
                    s.accepts[ "*" ]
            );

            // Check for headers option
            for ( i in s.headers ) {
                jqXHR.setRequestHeader( i, s.headers[ i ] );
            }

            // Allow custom headers/mimetypes and early abort
            if ( s.beforeSend &&
                ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {

                // Abort if not done already and return
                return jqXHR.abort();
            }

            // Aborting is no longer a cancellation
            strAbort = "abort";

            // Install callbacks on deferreds
            for ( i in { success: 1, error: 1, complete: 1 } ) {
                jqXHR[ i ]( s[ i ] );
            }

            // Get transport
            transport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );

            // If no transport, we auto-abort
            if ( !transport ) {
                done( -1, "No Transport" );
            } else {
                jqXHR.readyState = 1;

                // Send global event
                if ( fireGlobals ) {
                    globalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );
                }

                // If request was aborted inside ajaxSend, stop there
                if ( state === 2 ) {
                    return jqXHR;
                }

                // Timeout
                if ( s.async && s.timeout > 0 ) {
                    timeoutTimer = window.setTimeout( function() {
                        jqXHR.abort( "timeout" );
                    }, s.timeout );
                }

                try {
                    state = 1;
                    transport.send( requestHeaders, done );
                } catch ( e ) {

                    // Propagate exception as error if not done
                    if ( state < 2 ) {
                        done( -1, e );

                        // Simply rethrow otherwise
                    } else {
                        throw e;
                    }
                }
            }

            // Callback for when everything is done
            function done( status, nativeStatusText, responses, headers ) {
                var isSuccess, success, error, response, modified,
                    statusText = nativeStatusText;

                // Called once
                if ( state === 2 ) {
                    return;
                }

                // State is "done" now
                state = 2;

                // Clear timeout if it exists
                if ( timeoutTimer ) {
                    window.clearTimeout( timeoutTimer );
                }

                // Dereference transport for early garbage collection
                // (no matter how long the jqXHR object will be used)
                transport = undefined;

                // Cache response headers
                responseHeadersString = headers || "";

                // Set readyState
                jqXHR.readyState = status > 0 ? 4 : 0;

                // Determine if successful
                isSuccess = status >= 200 && status < 300 || status === 304;

                // Get response data
                if ( responses ) {
                    response = ajaxHandleResponses( s, jqXHR, responses );
                }

                // Convert no matter what (that way responseXXX fields are always set)
                response = ajaxConvert( s, response, jqXHR, isSuccess );

                // If successful, handle type chaining
                if ( isSuccess ) {

                    // Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.
                    if ( s.ifModified ) {
                        modified = jqXHR.getResponseHeader( "Last-Modified" );
                        if ( modified ) {
                            jQuery.lastModified[ cacheURL ] = modified;
                        }
                        modified = jqXHR.getResponseHeader( "etag" );
                        if ( modified ) {
                            jQuery.etag[ cacheURL ] = modified;
                        }
                    }

                    // if no content
                    if ( status === 204 || s.type === "HEAD" ) {
                        statusText = "nocontent";

                        // if not modified
                    } else if ( status === 304 ) {
                        statusText = "notmodified";

                        // If we have data, let's convert it
                    } else {
                        statusText = response.state;
                        success = response.data;
                        error = response.error;
                        isSuccess = !error;
                    }
                } else {

                    // Extract error from statusText and normalize for non-aborts
                    error = statusText;
                    if ( status || !statusText ) {
                        statusText = "error";
                        if ( status < 0 ) {
                            status = 0;
                        }
                    }
                }

                // Set data for the fake xhr object
                jqXHR.status = status;
                jqXHR.statusText = ( nativeStatusText || statusText ) + "";

                // Success/Error
                if ( isSuccess ) {
                    deferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );
                } else {
                    deferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );
                }

                // Status-dependent callbacks
                jqXHR.statusCode( statusCode );
                statusCode = undefined;

                if ( fireGlobals ) {
                    globalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",
                        [ jqXHR, s, isSuccess ? success : error ] );
                }

                // Complete
                completeDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );

                if ( fireGlobals ) {
                    globalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );

                    // Handle the global AJAX counter
                    if ( !( --jQuery.active ) ) {
                        jQuery.event.trigger( "ajaxStop" );
                    }
                }
            }

            return jqXHR;
        },

        getJSON: function( url, data, callback ) {
            return jQuery.get( url, data, callback, "json" );
        },

        getScript: function( url, callback ) {
            return jQuery.get( url, undefined, callback, "script" );
        }
    } );

    jQuery.each( [ "get", "post" ], function( i, method ) {
        jQuery[ method ] = function( url, data, callback, type ) {

            // Shift arguments if data argument was omitted
            if ( jQuery.isFunction( data ) ) {
                type = type || callback;
                callback = data;
                data = undefined;
            }

            // The url can be an options object (which then must have .url)
            return jQuery.ajax( jQuery.extend( {
                url: url,
                type: method,
                dataType: type,
                data: data,
                success: callback
            }, jQuery.isPlainObject( url ) && url ) );
        };
    } );


    jQuery._evalUrl = function( url ) {
        return jQuery.ajax( {
            url: url,

            // Make this explicit, since user can override this through ajaxSetup (#11264)
            type: "GET",
            dataType: "script",
            async: false,
            global: false,
            "throws": true
        } );
    };


    jQuery.fn.extend( {
        wrapAll: function( html ) {
            var wrap;

            if ( jQuery.isFunction( html ) ) {
                return this.each( function( i ) {
                    jQuery( this ).wrapAll( html.call( this, i ) );
                } );
            }

            if ( this[ 0 ] ) {

                // The elements to wrap the target around
                wrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );

                if ( this[ 0 ].parentNode ) {
                    wrap.insertBefore( this[ 0 ] );
                }

                wrap.map( function() {
                    var elem = this;

                    while ( elem.firstElementChild ) {
                        elem = elem.firstElementChild;
                    }

                    return elem;
                } ).append( this );
            }

            return this;
        },

        wrapInner: function( html ) {
            if ( jQuery.isFunction( html ) ) {
                return this.each( function( i ) {
                    jQuery( this ).wrapInner( html.call( this, i ) );
                } );
            }

            return this.each( function() {
                var self = jQuery( this ),
                    contents = self.contents();

                if ( contents.length ) {
                    contents.wrapAll( html );

                } else {
                    self.append( html );
                }
            } );
        },

        wrap: function( html ) {
            var isFunction = jQuery.isFunction( html );

            return this.each( function( i ) {
                jQuery( this ).wrapAll( isFunction ? html.call( this, i ) : html );
            } );
        },

        unwrap: function() {
            return this.parent().each( function() {
                if ( !jQuery.nodeName( this, "body" ) ) {
                    jQuery( this ).replaceWith( this.childNodes );
                }
            } ).end();
        }
    } );


    jQuery.expr.filters.hidden = function( elem ) {
        return !jQuery.expr.filters.visible( elem );
    };
    jQuery.expr.filters.visible = function( elem ) {

        // Support: Opera <= 12.12
        // Opera reports offsetWidths and offsetHeights less than zero on some elements
        // Use OR instead of AND as the element is not visible if either is true
        // See tickets #10406 and #13132
        return elem.offsetWidth > 0 || elem.offsetHeight > 0 || elem.getClientRects().length > 0;
    };




    var r20 = /%20/g,
        rbracket = /\[\]$/,
        rCRLF = /\r?\n/g,
        rsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,
        rsubmittable = /^(?:input|select|textarea|keygen)/i;

    function buildParams( prefix, obj, traditional, add ) {
        var name;

        if ( jQuery.isArray( obj ) ) {

            // Serialize array item.
            jQuery.each( obj, function( i, v ) {
                if ( traditional || rbracket.test( prefix ) ) {

                    // Treat each array item as a scalar.
                    add( prefix, v );

                } else {

                    // Item is non-scalar (array or object), encode its numeric index.
                    buildParams(
                        prefix + "[" + ( typeof v === "object" && v != null ? i : "" ) + "]",
                        v,
                        traditional,
                        add
                    );
                }
            } );

        } else if ( !traditional && jQuery.type( obj ) === "object" ) {

            // Serialize object item.
            for ( name in obj ) {
                buildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );
            }

        } else {

            // Serialize scalar item.
            add( prefix, obj );
        }
    }

// Serialize an array of form elements or a set of
// key/values into a query string
    jQuery.param = function( a, traditional ) {
        var prefix,
            s = [],
            add = function( key, value ) {

                // If value is a function, invoke it and return its value
                value = jQuery.isFunction( value ) ? value() : ( value == null ? "" : value );
                s[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );
            };

        // Set traditional to true for jQuery <= 1.3.2 behavior.
        if ( traditional === undefined ) {
            traditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;
        }

        // If an array was passed in, assume that it is an array of form elements.
        if ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {

            // Serialize the form elements
            jQuery.each( a, function() {
                add( this.name, this.value );
            } );

        } else {

            // If traditional, encode the "old" way (the way 1.3.2 or older
            // did it), otherwise encode params recursively.
            for ( prefix in a ) {
                buildParams( prefix, a[ prefix ], traditional, add );
            }
        }

        // Return the resulting serialization
        return s.join( "&" ).replace( r20, "+" );
    };

    jQuery.fn.extend( {
        serialize: function() {
            return jQuery.param( this.serializeArray() );
        },
        serializeArray: function() {
            return this.map( function() {

                // Can add propHook for "elements" to filter or add form elements
                var elements = jQuery.prop( this, "elements" );
                return elements ? jQuery.makeArray( elements ) : this;
            } )
                .filter( function() {
                    var type = this.type;

                    // Use .is( ":disabled" ) so that fieldset[disabled] works
                    return this.name && !jQuery( this ).is( ":disabled" ) &&
                        rsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&
                        ( this.checked || !rcheckableType.test( type ) );
                } )
                .map( function( i, elem ) {
                    var val = jQuery( this ).val();

                    return val == null ?
                        null :
                        jQuery.isArray( val ) ?
                            jQuery.map( val, function( val ) {
                                return { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
                            } ) :
                            { name: elem.name, value: val.replace( rCRLF, "\r\n" ) };
                } ).get();
        }
    } );


    jQuery.ajaxSettings.xhr = function() {
        try {
            return new window.XMLHttpRequest();
        } catch ( e ) {}
    };

    var xhrSuccessStatus = {

            // File protocol always yields status code 0, assume 200
            0: 200,

            // Support: IE9
            // #1450: sometimes IE returns 1223 when it should be 204
            1223: 204
        },
        xhrSupported = jQuery.ajaxSettings.xhr();

    support.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );
    support.ajax = xhrSupported = !!xhrSupported;

    jQuery.ajaxTransport( function( options ) {
        var callback, errorCallback;

        // Cross domain only allowed if supported through XMLHttpRequest
        if ( support.cors || xhrSupported && !options.crossDomain ) {
            return {
                send: function( headers, complete ) {
                    var i,
                        xhr = options.xhr();

                    xhr.open(
                        options.type,
                        options.url,
                        options.async,
                        options.username,
                        options.password
                    );

                    // Apply custom fields if provided
                    if ( options.xhrFields ) {
                        for ( i in options.xhrFields ) {
                            xhr[ i ] = options.xhrFields[ i ];
                        }
                    }

                    // Override mime type if needed
                    if ( options.mimeType && xhr.overrideMimeType ) {
                        xhr.overrideMimeType( options.mimeType );
                    }

                    // X-Requested-With header
                    // For cross-domain requests, seeing as conditions for a preflight are
                    // akin to a jigsaw puzzle, we simply never set it to be sure.
                    // (it can always be set on a per-request basis or even using ajaxSetup)
                    // For same-domain requests, won't change header if already provided.
                    if ( !options.crossDomain && !headers[ "X-Requested-With" ] ) {
                        headers[ "X-Requested-With" ] = "XMLHttpRequest";
                    }

                    // Set headers
                    for ( i in headers ) {
                        xhr.setRequestHeader( i, headers[ i ] );
                    }

                    // Callback
                    callback = function( type ) {
                        return function() {
                            if ( callback ) {
                                callback = errorCallback = xhr.onload =
                                    xhr.onerror = xhr.onabort = xhr.onreadystatechange = null;

                                if ( type === "abort" ) {
                                    xhr.abort();
                                } else if ( type === "error" ) {

                                    // Support: IE9
                                    // On a manual native abort, IE9 throws
                                    // errors on any property access that is not readyState
                                    if ( typeof xhr.status !== "number" ) {
                                        complete( 0, "error" );
                                    } else {
                                        complete(

                                            // File: protocol always yields status 0; see #8605, #14207
                                            xhr.status,
                                            xhr.statusText
                                        );
                                    }
                                } else {
                                    complete(
                                        xhrSuccessStatus[ xhr.status ] || xhr.status,
                                        xhr.statusText,

                                        // Support: IE9 only
                                        // IE9 has no XHR2 but throws on binary (trac-11426)
                                        // For XHR2 non-text, let the caller handle it (gh-2498)
                                        ( xhr.responseType || "text" ) !== "text"  ||
                                        typeof xhr.responseText !== "string" ?
                                            { binary: xhr.response } :
                                            { text: xhr.responseText },
                                        xhr.getAllResponseHeaders()
                                    );
                                }
                            }
                        };
                    };

                    // Listen to events
                    xhr.onload = callback();
                    errorCallback = xhr.onerror = callback( "error" );

                    // Support: IE9
                    // Use onreadystatechange to replace onabort
                    // to handle uncaught aborts
                    if ( xhr.onabort !== undefined ) {
                        xhr.onabort = errorCallback;
                    } else {
                        xhr.onreadystatechange = function() {

                            // Check readyState before timeout as it changes
                            if ( xhr.readyState === 4 ) {

                                // Allow onerror to be called first,
                                // but that will not handle a native abort
                                // Also, save errorCallback to a variable
                                // as xhr.onerror cannot be accessed
                                window.setTimeout( function() {
                                    if ( callback ) {
                                        errorCallback();
                                    }
                                } );
                            }
                        };
                    }

                    // Create the abort callback
                    callback = callback( "abort" );

                    try {

                        // Do send the request (this may raise an exception)
                        xhr.send( options.hasContent && options.data || null );
                    } catch ( e ) {

                        // #14683: Only rethrow if this hasn't been notified as an error yet
                        if ( callback ) {
                            throw e;
                        }
                    }
                },

                abort: function() {
                    if ( callback ) {
                        callback();
                    }
                }
            };
        }
    } );




// Install script dataType
    jQuery.ajaxSetup( {
        accepts: {
            script: "text/javascript, application/javascript, " +
                "application/ecmascript, application/x-ecmascript"
        },
        contents: {
            script: /\b(?:java|ecma)script\b/
        },
        converters: {
            "text script": function( text ) {
                jQuery.globalEval( text );
                return text;
            }
        }
    } );

// Handle cache's special case and crossDomain
    jQuery.ajaxPrefilter( "script", function( s ) {
        if ( s.cache === undefined ) {
            s.cache = false;
        }
        if ( s.crossDomain ) {
            s.type = "GET";
        }
    } );

// Bind script tag hack transport
    jQuery.ajaxTransport( "script", function( s ) {

        // This transport only deals with cross domain requests
        if ( s.crossDomain ) {
            var script, callback;
            return {
                send: function( _, complete ) {
                    script = jQuery( "<script>" ).prop( {
                        charset: s.scriptCharset,
                        src: s.url
                    } ).on(
                        "load error",
                        callback = function( evt ) {
                            script.remove();
                            callback = null;
                            if ( evt ) {
                                complete( evt.type === "error" ? 404 : 200, evt.type );
                            }
                        }
                    );

                    // Use native DOM manipulation to avoid our domManip AJAX trickery
                    document.head.appendChild( script[ 0 ] );
                },
                abort: function() {
                    if ( callback ) {
                        callback();
                    }
                }
            };
        }
    } );




    var oldCallbacks = [],
        rjsonp = /(=)\?(?=&|$)|\?\?/;

// Default jsonp settings
    jQuery.ajaxSetup( {
        jsonp: "callback",
        jsonpCallback: function() {
            var callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( nonce++ ) );
            this[ callback ] = true;
            return callback;
        }
    } );

// Detect, normalize options and install callbacks for jsonp requests
    jQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {

        var callbackName, overwritten, responseContainer,
            jsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?
                    "url" :
                    typeof s.data === "string" &&
                    ( s.contentType || "" )
                        .indexOf( "application/x-www-form-urlencoded" ) === 0 &&
                    rjsonp.test( s.data ) && "data"
            );

        // Handle iff the expected data type is "jsonp" or we have a parameter to set
        if ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {

            // Get callback name, remembering preexisting value associated with it
            callbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?
                s.jsonpCallback() :
                s.jsonpCallback;

            // Insert callback into url or form data
            if ( jsonProp ) {
                s[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );
            } else if ( s.jsonp !== false ) {
                s.url += ( rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;
            }

            // Use data converter to retrieve json after script execution
            s.converters[ "script json" ] = function() {
                if ( !responseContainer ) {
                    jQuery.error( callbackName + " was not called" );
                }
                return responseContainer[ 0 ];
            };

            // Force json dataType
            s.dataTypes[ 0 ] = "json";

            // Install callback
            overwritten = window[ callbackName ];
            window[ callbackName ] = function() {
                responseContainer = arguments;
            };

            // Clean-up function (fires after converters)
            jqXHR.always( function() {

                // If previous value didn't exist - remove it
                if ( overwritten === undefined ) {
                    jQuery( window ).removeProp( callbackName );

                    // Otherwise restore preexisting value
                } else {
                    window[ callbackName ] = overwritten;
                }

                // Save back as free
                if ( s[ callbackName ] ) {

                    // Make sure that re-using the options doesn't screw things around
                    s.jsonpCallback = originalSettings.jsonpCallback;

                    // Save the callback name for future use
                    oldCallbacks.push( callbackName );
                }

                // Call if it was a function and we have a response
                if ( responseContainer && jQuery.isFunction( overwritten ) ) {
                    overwritten( responseContainer[ 0 ] );
                }

                responseContainer = overwritten = undefined;
            } );

            // Delegate to script
            return "script";
        }
    } );




// Argument "data" should be string of html
// context (optional): If specified, the fragment will be created in this context,
// defaults to document
// keepScripts (optional): If true, will include scripts passed in the html string
    jQuery.parseHTML = function( data, context, keepScripts ) {
        if ( !data || typeof data !== "string" ) {
            return null;
        }
        if ( typeof context === "boolean" ) {
            keepScripts = context;
            context = false;
        }
        context = context || document;

        var parsed = rsingleTag.exec( data ),
            scripts = !keepScripts && [];

        // Single tag
        if ( parsed ) {
            return [ context.createElement( parsed[ 1 ] ) ];
        }

        parsed = buildFragment( [ data ], context, scripts );

        if ( scripts && scripts.length ) {
            jQuery( scripts ).remove();
        }

        return jQuery.merge( [], parsed.childNodes );
    };


// Keep a copy of the old load method
    var _load = jQuery.fn.load;

    /**
     * Load a url into a page
     */
    jQuery.fn.load = function( url, params, callback ) {
        if ( typeof url !== "string" && _load ) {
            return _load.apply( this, arguments );
        }

        var selector, type, response,
            self = this,
            off = url.indexOf( " " );

        if ( off > -1 ) {
            selector = jQuery.trim( url.slice( off ) );
            url = url.slice( 0, off );
        }

        // If it's a function
        if ( jQuery.isFunction( params ) ) {

            // We assume that it's the callback
            callback = params;
            params = undefined;

            // Otherwise, build a param string
        } else if ( params && typeof params === "object" ) {
            type = "POST";
        }

        // If we have elements to modify, make the request
        if ( self.length > 0 ) {
            jQuery.ajax( {
                url: url,

                // If "type" variable is undefined, then "GET" method will be used.
                // Make value of this field explicit since
                // user can override it through ajaxSetup method
                type: type || "GET",
                dataType: "html",
                data: params
            } ).done( function( responseText ) {

                // Save response for use in complete callback
                response = arguments;

                self.html( selector ?

                    // If a selector was specified, locate the right elements in a dummy div
                    // Exclude scripts to avoid IE 'Permission Denied' errors
                    jQuery( "<div>" ).append( jQuery.parseHTML( responseText ) ).find( selector ) :

                    // Otherwise use the full result
                    responseText );

                // If the request succeeds, this function gets "data", "status", "jqXHR"
                // but they are ignored because response was set above.
                // If it fails, this function gets "jqXHR", "status", "error"
            } ).always( callback && function( jqXHR, status ) {
                self.each( function() {
                    callback.apply( this, response || [ jqXHR.responseText, status, jqXHR ] );
                } );
            } );
        }

        return this;
    };




// Attach a bunch of functions for handling common AJAX events
    jQuery.each( [
        "ajaxStart",
        "ajaxStop",
        "ajaxComplete",
        "ajaxError",
        "ajaxSuccess",
        "ajaxSend"
    ], function( i, type ) {
        jQuery.fn[ type ] = function( fn ) {
            return this.on( type, fn );
        };
    } );




    jQuery.expr.filters.animated = function( elem ) {
        return jQuery.grep( jQuery.timers, function( fn ) {
            return elem === fn.elem;
        } ).length;
    };




    /**
     * Gets a window from an element
     */
    function getWindow( elem ) {
        return jQuery.isWindow( elem ) ? elem : elem.nodeType === 9 && elem.defaultView;
    }

    jQuery.offset = {
        setOffset: function( elem, options, i ) {
            var curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,
                position = jQuery.css( elem, "position" ),
                curElem = jQuery( elem ),
                props = {};

            // Set position first, in-case top/left are set even on static elem
            if ( position === "static" ) {
                elem.style.position = "relative";
            }

            curOffset = curElem.offset();
            curCSSTop = jQuery.css( elem, "top" );
            curCSSLeft = jQuery.css( elem, "left" );
            calculatePosition = ( position === "absolute" || position === "fixed" ) &&
                ( curCSSTop + curCSSLeft ).indexOf( "auto" ) > -1;

            // Need to be able to calculate position if either
            // top or left is auto and position is either absolute or fixed
            if ( calculatePosition ) {
                curPosition = curElem.position();
                curTop = curPosition.top;
                curLeft = curPosition.left;

            } else {
                curTop = parseFloat( curCSSTop ) || 0;
                curLeft = parseFloat( curCSSLeft ) || 0;
            }

            if ( jQuery.isFunction( options ) ) {

                // Use jQuery.extend here to allow modification of coordinates argument (gh-1848)
                options = options.call( elem, i, jQuery.extend( {}, curOffset ) );
            }

            if ( options.top != null ) {
                props.top = ( options.top - curOffset.top ) + curTop;
            }
            if ( options.left != null ) {
                props.left = ( options.left - curOffset.left ) + curLeft;
            }

            if ( "using" in options ) {
                options.using.call( elem, props );

            } else {
                curElem.css( props );
            }
        }
    };

    jQuery.fn.extend( {
        offset: function( options ) {
            if ( arguments.length ) {
                return options === undefined ?
                    this :
                    this.each( function( i ) {
                        jQuery.offset.setOffset( this, options, i );
                    } );
            }

            var docElem, win,
                elem = this[ 0 ],
                box = { top: 0, left: 0 },
                doc = elem && elem.ownerDocument;

            if ( !doc ) {
                return;
            }

            docElem = doc.documentElement;

            // Make sure it's not a disconnected DOM node
            if ( !jQuery.contains( docElem, elem ) ) {
                return box;
            }

            box = elem.getBoundingClientRect();
            win = getWindow( doc );
            return {
                top: box.top + win.pageYOffset - docElem.clientTop,
                left: box.left + win.pageXOffset - docElem.clientLeft
            };
        },

        position: function() {
            if ( !this[ 0 ] ) {
                return;
            }

            var offsetParent, offset,
                elem = this[ 0 ],
                parentOffset = { top: 0, left: 0 };

            // Fixed elements are offset from window (parentOffset = {top:0, left: 0},
            // because it is its only offset parent
            if ( jQuery.css( elem, "position" ) === "fixed" ) {

                // Assume getBoundingClientRect is there when computed position is fixed
                offset = elem.getBoundingClientRect();

            } else {

                // Get *real* offsetParent
                offsetParent = this.offsetParent();

                // Get correct offsets
                offset = this.offset();
                if ( !jQuery.nodeName( offsetParent[ 0 ], "html" ) ) {
                    parentOffset = offsetParent.offset();
                }

                // Add offsetParent borders
                parentOffset.top += jQuery.css( offsetParent[ 0 ], "borderTopWidth", true );
                parentOffset.left += jQuery.css( offsetParent[ 0 ], "borderLeftWidth", true );
            }

            // Subtract parent offsets and element margins
            return {
                top: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),
                left: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )
            };
        },

        // This method will return documentElement in the following cases:
        // 1) For the element inside the iframe without offsetParent, this method will return
        //    documentElement of the parent window
        // 2) For the hidden or detached element
        // 3) For body or html element, i.e. in case of the html node - it will return itself
        //
        // but those exceptions were never presented as a real life use-cases
        // and might be considered as more preferable results.
        //
        // This logic, however, is not guaranteed and can change at any point in the future
        offsetParent: function() {
            return this.map( function() {
                var offsetParent = this.offsetParent;

                while ( offsetParent && jQuery.css( offsetParent, "position" ) === "static" ) {
                    offsetParent = offsetParent.offsetParent;
                }

                return offsetParent || documentElement;
            } );
        }
    } );

// Create scrollLeft and scrollTop methods
    jQuery.each( { scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function( method, prop ) {
        var top = "pageYOffset" === prop;

        jQuery.fn[ method ] = function( val ) {
            return access( this, function( elem, method, val ) {
                var win = getWindow( elem );

                if ( val === undefined ) {
                    return win ? win[ prop ] : elem[ method ];
                }

                if ( win ) {
                    win.scrollTo(
                        !top ? val : win.pageXOffset,
                        top ? val : win.pageYOffset
                    );

                } else {
                    elem[ method ] = val;
                }
            }, method, val, arguments.length );
        };
    } );

// Support: Safari<7-8+, Chrome<37-44+
// Add the top/left cssHooks using jQuery.fn.position
// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084
// Blink bug: https://code.google.com/p/chromium/issues/detail?id=229280
// getComputedStyle returns percent when specified for top/left/bottom/right;
// rather than make the css module depend on the offset module, just check for it here
    jQuery.each( [ "top", "left" ], function( i, prop ) {
        jQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,
            function( elem, computed ) {
                if ( computed ) {
                    computed = curCSS( elem, prop );

                    // If curCSS returns percentage, fallback to offset
                    return rnumnonpx.test( computed ) ?
                        jQuery( elem ).position()[ prop ] + "px" :
                        computed;
                }
            }
        );
    } );


// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods
    jQuery.each( { Height: "height", Width: "width" }, function( name, type ) {
        jQuery.each( { padding: "inner" + name, content: type, "": "outer" + name },
            function( defaultExtra, funcName ) {

                // Margin is only for outerHeight, outerWidth
                jQuery.fn[ funcName ] = function( margin, value ) {
                    var chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),
                        extra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );

                    return access( this, function( elem, type, value ) {
                        var doc;

                        if ( jQuery.isWindow( elem ) ) {

                            // As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there
                            // isn't a whole lot we can do. See pull request at this URL for discussion:
                            // https://github.com/jquery/jquery/pull/764
                            return elem.document.documentElement[ "client" + name ];
                        }

                        // Get document width or height
                        if ( elem.nodeType === 9 ) {
                            doc = elem.documentElement;

                            // Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],
                            // whichever is greatest
                            return Math.max(
                                elem.body[ "scroll" + name ], doc[ "scroll" + name ],
                                elem.body[ "offset" + name ], doc[ "offset" + name ],
                                doc[ "client" + name ]
                            );
                        }

                        return value === undefined ?

                            // Get width or height on the element, requesting but not forcing parseFloat
                            jQuery.css( elem, type, extra ) :

                            // Set width or height on the element
                            jQuery.style( elem, type, value, extra );
                    }, type, chainable ? margin : undefined, chainable, null );
                };
            } );
    } );


    jQuery.fn.extend( {

        bind: function( types, data, fn ) {
            return this.on( types, null, data, fn );
        },
        unbind: function( types, fn ) {
            return this.off( types, null, fn );
        },

        delegate: function( selector, types, data, fn ) {
            return this.on( types, selector, data, fn );
        },
        undelegate: function( selector, types, fn ) {

            // ( namespace ) or ( selector, types [, fn] )
            return arguments.length === 1 ?
                this.off( selector, "**" ) :
                this.off( types, selector || "**", fn );
        },
        size: function() {
            return this.length;
        }
    } );

    jQuery.fn.andSelf = jQuery.fn.addBack;




// Register as a named AMD module, since jQuery can be concatenated with other
// files that may use define, but not via a proper concatenation script that
// understands anonymous AMD modules. A named AMD is safest and most robust
// way to register. Lowercase jquery is used because AMD module names are
// derived from file names, and jQuery is normally delivered in a lowercase
// file name. Do this after creating the global so that if an AMD module wants
// to call noConflict to hide this version of jQuery, it will work.

// Note that for maximum portability, libraries that are not jQuery should
// declare themselves as anonymous modules, and avoid setting a global if an
// AMD loader is present. jQuery is a special case. For more information, see
// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon

    if ( typeof define === "function" && define.amd ) {
        define( "jquery", [], function() {
            return jQuery;
        } );
    }



    var

        // Map over jQuery in case of overwrite
        _jQuery = window.jQuery,

        // Map over the $ in case of overwrite
        _$ = window.$;

    jQuery.noConflict = function( deep ) {
        if ( window.$ === jQuery ) {
            window.$ = _$;
        }

        if ( deep && window.jQuery === jQuery ) {
            window.jQuery = _jQuery;
        }

        return jQuery;
    };

// Expose jQuery and $ identifiers, even in AMD
// (#7102#comment:10, https://github.com/jquery/jquery/pull/557)
// and CommonJS for browser emulators (#13566)
    if ( !noGlobal ) {
        window.jQuery = window.$ = jQuery;
    }

    return jQuery;
}));

/*
* @deprecated
* Для совместимости с необновляемыми темами (fashion) добавляем упрощенную функцию live 
* будет удалено в последующих версиях
*/
(function($){
    $.fn.live = function(event, handler) { 
        return this.on(event, handler);
    }
})(jQuery);

/*
* @deprecated
* Для совместимости с необновляемыми темами (fashion) добавляем упрощенную функцию browser
* будет удалено в последующих версиях
* jQuery Browser Plugin 0.0.7
*/
!function(a){"function"==typeof define&&define.amd?define(["jquery"],function(b){a(b)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("jquery")):a(window.jQuery)}(function(a){"use strict";function b(a){void 0===a&&(a=window.navigator.userAgent),a=a.toLowerCase();var b=/(edge)\/([\w.]+)/.exec(a)||/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],c=/(ipad)/.exec(a)||/(ipod)/.exec(a)||/(iphone)/.exec(a)||/(kindle)/.exec(a)||/(silk)/.exec(a)||/(android)/.exec(a)||/(windows phone)/.exec(a)||/(win)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||/(cros)/.exec(a)||/(playbook)/.exec(a)||/(bb)/.exec(a)||/(blackberry)/.exec(a)||[],d={},e={browser:b[5]||b[3]||b[1]||"",version:b[2]||b[4]||"0",versionNumber:b[4]||b[2]||"0",platform:c[0]||""};if(e.browser&&(d[e.browser]=!0,d.version=e.version,d.versionNumber=parseInt(e.versionNumber,10)),e.platform&&(d[e.platform]=!0),(d.android||d.bb||d.blackberry||d.ipad||d.iphone||d.ipod||d.kindle||d.playbook||d.silk||d["windows phone"])&&(d.mobile=!0),(d.cros||d.mac||d.linux||d.win)&&(d.desktop=!0),(d.chrome||d.opr||d.safari)&&(d.webkit=!0),d.rv||d.edge){var f="msie";e.browser=f,d[f]=!0}if(d.safari&&d.blackberry){var g="blackberry";e.browser=g,d[g]=!0}if(d.safari&&d.playbook){var h="playbook";e.browser=h,d[h]=!0}if(d.bb){var i="blackberry";e.browser=i,d[i]=!0}if(d.opr){var j="opera";e.browser=j,d[j]=!0}if(d.safari&&d.android){var k="android";e.browser=k,d[k]=!0}if(d.safari&&d.kindle){var l="kindle";e.browser=l,d[l]=!0}if(d.safari&&d.silk){var m="silk";e.browser=m,d[m]=!0}return d.name=e.browser,d.platform=e.platform,d}return window.jQBrowser=b(window.navigator.userAgent),window.jQBrowser.uaMatch=b,a&&(a.browser=window.jQBrowser),window.jQBrowser});

/*! jQuery UI - v1.11.4 - 2017-05-08
* http://jqueryui.com
* Includes: core.js, widget.js, mouse.js, position.js, draggable.js, droppable.js, resizable.js, selectable.js, sortable.js, accordion.js, autocomplete.js, button.js, datepicker.js, dialog.js, menu.js, progressbar.js, selectmenu.js, slider.js, spinner.js, effect.js, effect-blind.js, effect-bounce.js, effect-clip.js, effect-drop.js, effect-explode.js, effect-fade.js, effect-fold.js, effect-highlight.js, effect-puff.js, effect-pulsate.js, effect-scale.js, effect-shake.js, effect-size.js, effect-slide.js, effect-transfer.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

(function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){function e(e,s){var n,o,a,r=e.nodeName.toLowerCase();return"area"===r?(n=e.parentNode,o=n.name,e.href&&o&&"map"===n.nodeName.toLowerCase()?(a=t("img[usemap='#"+o+"']")[0],!!a&&i(a)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!e.disabled:"a"===r?e.href||s:s)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}function s(t){for(var e,i;t.length&&t[0]!==document;){if(e=t.css("position"),("absolute"===e||"relative"===e||"fixed"===e)&&(i=parseInt(t.css("zIndex"),10),!isNaN(i)&&0!==i))return i;t=t.parent()}return 0}function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},t.extend(this._defaults,this.regional[""]),this.regional.en=t.extend(!0,{},this.regional[""]),this.regional["en-US"]=t.extend(!0,{},this.regional.en),this.dpDiv=o(t("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function o(e){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(i,"mouseout",function(){t(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",a)}function a(){t.datepicker._isDisabledDatepicker(_.inline?_.dpDiv.parent()[0]:_.input[0])||(t(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),t(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&t(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&t(this).addClass("ui-datepicker-next-hover"))}function r(e,i){t.extend(e,i);for(var s in i)null==i[s]&&(e[s]=i[s]);return e}function l(t){return function(){var e=this.element.val();t.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),s="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return s&&"static"===e.css("position")?!1:n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var s=t.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&e(i,!n)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function s(e,i,s,o){return t.each(n,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){t(this).css(o,s(this,e)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(o,s(this,e,!0,n)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,s){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),s&&s.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,s,n=t(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),t.ui.plugin={add:function(e,i,s){var n,o=t.ui[e].prototype;for(n in s)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,s[n]])},call:function(t,e,i,s){var n,o=t.plugins[e];if(o&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;o.length>n;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}};var h=0,c=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{s=t._data(n,"events"),s&&s.remove&&t(n).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,a,r,l={},h=e.split(".")[0];return e=e.split(".")[1],n=h+"-"+e,s||(s=i,i=t.Widget),t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)},t[h]=t[h]||{},o=t[h][e],a=t[h][e]=function(t,e){return this._createWidget?(arguments.length&&this._createWidget(t,e),void 0):new a(t,e)},t.extend(a,o,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),r=new i,r.options=t.widget.extend({},r.options),t.each(s,function(e,s){return t.isFunction(s)?(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}(),void 0):(l[e]=s,void 0)}),a.prototype=t.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix||e:e},l,{constructor:a,namespace:h,widgetName:e,widgetFullName:n}),o?(t.each(o._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var i,s,n=c.call(arguments,1),o=0,a=n.length;a>o;o++)for(i in n[o])s=n[o][i],n[o].hasOwnProperty(i)&&void 0!==s&&(e[i]=t.isPlainObject(s)?t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(n){var o="string"==typeof n,a=c.call(arguments,1),r=this;return o?this.each(function(){var i,o=t.data(this,s);return"instance"===n?(r=o,!1):o?t.isFunction(o[n])&&"_"!==n.charAt(0)?(i=o[n].apply(o,a),i!==o&&void 0!==i?(r=i&&i.jquery?r.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+n+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; "+"attempted to call method '"+n+"'")}):(a.length&&(n=t.widget.extend.apply(null,[n].concat(a))),this.each(function(){var e=t.data(this,s);e?(e.option(n||{}),e._init&&e._init()):t.data(this,s,new i(n,this))})),r}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,i){i=t(i||this.defaultElement||this)[0],this.element=t(i),this.uuid=h++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),i!==this&&(t.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===i&&this.destroy()}}),this.document=t(i.style?i.ownerDocument:i.document||i),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(n=a[e]=t.widget.extend({},this.options[e]),o=0;s.length-1>o;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,a){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?n.delegate(c,h,r):i.bind(h,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?n===!0||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}}),t.widget;var u=!1;t(document).mouseup(function(){u=!1}),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!u){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,s=1===e.which,n="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return s&&!n&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),u=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||9>document.documentMode)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),u=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),function(){function e(t,e,i){return[parseFloat(t[0])*(p.test(t[0])?e/100:1),parseFloat(t[1])*(p.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.ui=t.ui||{};var n,o,a=Math.max,r=Math.abs,l=Math.round,h=/left|center|right/,c=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,s=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return t("body").append(s),e=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,e===i&&(i=s[0].clientWidth),s.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),s=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth,o="scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight;return{width:o?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:s||n?i.width():i.outerWidth(),height:s||n?i.height():i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return f.apply(this,arguments);n=t.extend({},n);var p,g,m,_,v,b,y=t(n.of),w=t.position.getWithinInfo(n.within),k=t.position.getScrollInfo(w),x=(n.collision||"flip").split(" "),C={};return b=s(y),y[0].preventDefault&&(n.at="left top"),g=b.width,m=b.height,_=b.offset,v=t.extend({},_),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=h.test(i[0])?i.concat(["center"]):c.test(i[0])?["center"].concat(i):["center","center"]),i[0]=h.test(i[0])?i[0]:"center",i[1]=c.test(i[1])?i[1]:"center",t=u.exec(i[0]),e=u.exec(i[1]),C[this]=[t?t[0]:0,e?e[0]:0],n[this]=[d.exec(i[0])[0],d.exec(i[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===n.at[0]?v.left+=g:"center"===n.at[0]&&(v.left+=g/2),"bottom"===n.at[1]?v.top+=m:"center"===n.at[1]&&(v.top+=m/2),p=e(C.at,g,m),v.left+=p[0],v.top+=p[1],this.each(function(){var s,h,c=t(this),u=c.outerWidth(),d=c.outerHeight(),f=i(this,"marginLeft"),b=i(this,"marginTop"),D=u+f+i(this,"marginRight")+k.width,T=d+b+i(this,"marginBottom")+k.height,I=t.extend({},v),M=e(C.my,c.outerWidth(),c.outerHeight());"right"===n.my[0]?I.left-=u:"center"===n.my[0]&&(I.left-=u/2),"bottom"===n.my[1]?I.top-=d:"center"===n.my[1]&&(I.top-=d/2),I.left+=M[0],I.top+=M[1],o||(I.left=l(I.left),I.top=l(I.top)),s={marginLeft:f,marginTop:b},t.each(["left","top"],function(e,i){t.ui.position[x[e]]&&t.ui.position[x[e]][i](I,{targetWidth:g,targetHeight:m,elemWidth:u,elemHeight:d,collisionPosition:s,collisionWidth:D,collisionHeight:T,offset:[p[0]+M[0],p[1]+M[1]],my:n.my,at:n.at,within:w,elem:c})}),n.using&&(h=function(t){var e=_.left-I.left,i=e+g-u,s=_.top-I.top,o=s+m-d,l={target:{element:y,left:_.left,top:_.top,width:g,height:m},element:{element:c,left:I.left,top:I.top,width:u,height:d},horizontal:0>i?"left":e>0?"right":"center",vertical:0>o?"top":s>0?"bottom":"middle"};u>g&&g>r(e+i)&&(l.horizontal="center"),d>m&&m>r(s+o)&&(l.vertical="middle"),l.important=a(r(e),r(i))>a(r(s),r(o))?"horizontal":"vertical",n.using.call(this,t,l)}),c.offset(t.extend(I,{using:h}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,o=s.width,r=t.left-e.collisionPosition.marginLeft,l=n-r,h=r+e.collisionWidth-o-n;e.collisionWidth>o?l>0&&0>=h?(i=t.left+l+e.collisionWidth-o-n,t.left+=l-i):t.left=h>0&&0>=l?n:l>h?n+o-e.collisionWidth:n:l>0?t.left+=l:h>0?t.left-=h:t.left=a(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,o=e.within.height,r=t.top-e.collisionPosition.marginTop,l=n-r,h=r+e.collisionHeight-o-n;e.collisionHeight>o?l>0&&0>=h?(i=t.top+l+e.collisionHeight-o-n,t.top+=l-i):t.top=h>0&&0>=l?n:l>h?n+o-e.collisionHeight:n:l>0?t.top+=l:h>0?t.top-=h:t.top=a(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,o=n.offset.left+n.scrollLeft,a=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,h=t.left-e.collisionPosition.marginLeft,c=h-l,u=h+e.collisionWidth-a-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(i=t.left+d+p+f+e.collisionWidth-a-o,(0>i||r(c)>i)&&(t.left+=d+p+f)):u>0&&(s=t.left-e.collisionPosition.marginLeft+d+p+f-l,(s>0||u>r(s))&&(t.left+=d+p+f))},top:function(t,e){var i,s,n=e.within,o=n.offset.top+n.scrollTop,a=n.height,l=n.isWindow?n.scrollTop:n.offset.top,h=t.top-e.collisionPosition.marginTop,c=h-l,u=h+e.collisionHeight-a-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(s=t.top+p+f+g+e.collisionHeight-a-o,(0>s||r(c)>s)&&(t.top+=p+f+g)):u>0&&(i=t.top-e.collisionPosition.marginTop+p+f+g-l,(i>0||u>r(i))&&(t.top+=p+f+g))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,s,n,a,r=document.getElementsByTagName("body")[0],l=document.createElement("div");e=document.createElement(r?"div":"body"),s={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&t.extend(s,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in s)e.style[a]=s[a];e.appendChild(l),i=r||document.documentElement,i.insertBefore(e,i.firstChild),l.style.cssText="position: absolute; left: 10.7432222px;",n=t(l).offset().left,o=n>10&&11>n,e.innerHTML="",i.removeChild(e)}()}(),t.ui.position,t.widget("ui.draggable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),this._mouseDestroy(),void 0)},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(s){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",e,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,s=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(s=t.ui.ddmanager.drop(this,e)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper),n=s?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return n.parents("body").length||n.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s&&n[0]===this.element[0]&&this._setPositionRelative(),n[0]===this.element[0]||/(fixed|absolute)/.test(n.css("position"))||n.css("position","absolute"),n},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options,o=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===n.containment?(this.containment=[0,0,t(o).width()-this.helperProportions.width-this.margins.left,(t(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):n.containment.constructor===Array?(this.containment=n.containment,void 0):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),i=t(n.containment),s=i[0],s&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i),void 0):(this.containment=null,void 0)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,s,n,o,a=this.options,r=this._isRootNode(this.scrollParent[0]),l=t.pageX,h=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}
},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),s.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,s){var n=t.extend({},i,{item:s.element});s.sortables=[],t(s.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,n))})},stop:function(e,i,s){var n=t.extend({},i,{item:s.element});s.cancelHelperRemoval=!1,t.each(s.sortables,function(){var t=this;t.isOver?(t.isOver=0,s.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,n))})},drag:function(e,i,s){t.each(s.sortables,function(){var n=!1,o=this;o.positionAbs=s.positionAbs,o.helperProportions=s.helperProportions,o.offset.click=s.offset.click,o._intersectsWith(o.containerCache)&&(n=!0,t.each(s.sortables,function(){return this.positionAbs=s.positionAbs,this.helperProportions=s.helperProportions,this.offset.click=s.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&t.contains(o.element[0],this.element[0])&&(n=!1),n})),n?(o.isOver||(o.isOver=1,s._parent=i.helper.parent(),o.currentItem=i.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return i.helper[0]},e.target=o.currentItem[0],o._mouseCapture(e,!0),o._mouseStart(e,!0,!0),o.offset.click.top=s.offset.click.top,o.offset.click.left=s.offset.click.left,o.offset.parent.left-=s.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=s.offset.parent.top-o.offset.parent.top,s._trigger("toSortable",e),s.dropped=o.element,t.each(s.sortables,function(){this.refreshPositions()}),s.currentItem=s.element,o.fromOutside=s),o.currentItem&&(o._mouseDrag(e),i.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",e,o._uiHash(o)),o._mouseStop(e,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),i.helper.appendTo(s._parent),s._refreshOffsets(e),i.position=s._generatePosition(e,!0),s._trigger("fromSortable",e),s.dropped=!1,t.each(s.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,s){var n=t("body"),o=s.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(e,i,s){var n=s.options;n._cursor&&t("body").css("cursor",n._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(e,i,s){var n=s.options;n._opacity&&t(i.helper).css("opacity",n._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,s){var n=s.options,o=!1,a=s.scrollParentNotHidden[0],r=s.document[0];a!==r&&"HTML"!==a.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+a.offsetHeight-e.pageY<n.scrollSensitivity?a.scrollTop=o=a.scrollTop+n.scrollSpeed:e.pageY-s.overflowOffset.top<n.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+a.offsetWidth-e.pageX<n.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+n.scrollSpeed:e.pageX-s.overflowOffset.left<n.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(e.pageY-t(r).scrollTop()<n.scrollSensitivity?o=t(r).scrollTop(t(r).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<n.scrollSensitivity&&(o=t(r).scrollTop(t(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(e.pageX-t(r).scrollLeft()<n.scrollSensitivity?o=t(r).scrollLeft(t(r).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<n.scrollSensitivity&&(o=t(r).scrollLeft(t(r).scrollLeft()+n.scrollSpeed)))),o!==!1&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,s){var n=s.options;s.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,s){var n,o,a,r,l,h,c,u,d,p,f=s.options,g=f.snapTolerance,m=i.offset.left,_=m+s.helperProportions.width,v=i.offset.top,b=v+s.helperProportions.height;for(d=s.snapElements.length-1;d>=0;d--)l=s.snapElements[d].left-s.margins.left,h=l+s.snapElements[d].width,c=s.snapElements[d].top-s.margins.top,u=c+s.snapElements[d].height,l-g>_||m>h+g||c-g>b||v>u+g||!t.contains(s.snapElements[d].item.ownerDocument,s.snapElements[d].item)?(s.snapElements[d].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(n=g>=Math.abs(c-b),o=g>=Math.abs(u-v),a=g>=Math.abs(l-_),r=g>=Math.abs(h-m),n&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left)),p=n||o||a||r,"outer"!==f.snapMode&&(n=g>=Math.abs(c-v),o=g>=Math.abs(u-b),a=g>=Math.abs(l-m),r=g>=Math.abs(h-_),n&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top),o&&(i.position.top=s._convertPositionTo("relative",{top:u-s.helperProportions.height,left:0}).top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left)),!s.snapElements[d].snapping&&(n||o||a||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=n||o||a||r||p)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,s){var n,o=s.options,a=t.makeArray(t(o.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});a.length&&(n=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each(function(e){t(this).css("zIndex",n+e)}),this.css("zIndex",n+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,s){var n=t(i.helper),o=s.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(e,i,s){var n=s.options;n._zIndex&&t(i.helper).css("zIndex",n._zIndex)}}),t.ui.draggable,t.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,s=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(s)?s:function(t){return t.is(s)},this.proportions=function(){return arguments.length?(e=arguments[0],void 0):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;t.length>e;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var s=t.ui.ddmanager.droppables[this.options.scope];this._splice(s),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current,n=!1;return s&&(s.currentItem||s.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===s.options.scope&&i.accept.call(i.element[0],s.currentItem||s.element)&&t.ui.intersect(s,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(n=!0,!1):void 0}),n?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(s)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,s,n){if(!i.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,a=(e.positionAbs||e.position.absolute).top+e.margins.top,r=o+e.helperProportions.width,l=a+e.helperProportions.height,h=i.offset.left,c=i.offset.top,u=h+i.proportions().width,d=c+i.proportions().height;switch(s){case"fit":return o>=h&&u>=r&&a>=c&&d>=l;case"intersect":return o+e.helperProportions.width/2>h&&u>r-e.helperProportions.width/2&&a+e.helperProportions.height/2>c&&d>l-e.helperProportions.height/2;case"pointer":return t(n.pageY,c,i.proportions().height)&&t(n.pageX,h,i.proportions().width);case"touch":return(a>=c&&d>=a||l>=c&&d>=l||c>a&&l>d)&&(o>=h&&u>=o||r>=h&&u>=r||h>o&&r>u);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var s,n,o=t.ui.ddmanager.droppables[e.options.scope]||[],a=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(s=0;o.length>s;s++)if(!(o[s].options.disabled||e&&!o[s].accept.call(o[s].element[0],e.currentItem||e.element))){for(n=0;r.length>n;n++)if(r[n]===o[s].element[0]){o[s].proportions().height=0;continue t}o[s].visible="none"!==o[s].element.css("display"),o[s].visible&&("mousedown"===a&&o[s]._activate.call(o[s],i),o[s].offset=o[s].element.offset(),o[s].proportions({width:o[s].element[0].offsetWidth,height:o[s].element[0].offsetHeight}))}},drop:function(e,i){var s=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)&&(s=this._drop.call(this,i)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),s},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,n,o,a=t.ui.intersect(e,this,this.options.tolerance,i),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(n=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===n}),o.length&&(s=t(o[0]).droppable("instance"),s.greedyChild="isover"===r)),s&&"isover"===r&&(s.isover=!1,s.isout=!0,s._out.call(s,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),s&&"isout"===r&&(s.isout=!1,s.isover=!0,s._over.call(s,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.ui.droppable,t.widget("ui.resizable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseInt(t,10)||0},_isNumber:function(t){return!isNaN(parseInt(t,10))},_hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var s=i&&"left"===i?"scrollLeft":"scrollTop",n=!1;return e[s]>0?!0:(e[s]=1,n=e[s]>0,e[s]=0,n)},_create:function(){var e,i,s,n,o,a=this,r=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!r.aspectRatio,aspectRatio:r.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:r.helper||r.ghost||r.animate?r.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(t("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=r.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=t(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},i=0;e.length>i;i++)s=t.trim(e[i]),o="ui-resizable-"+s,n=t("<div class='ui-resizable-handle "+o+"'></div>"),n.css({zIndex:r.zIndex}),"se"===s&&n.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[s]=".ui-resizable-"+s,this.element.append(n);this._renderAxis=function(e){var i,s,n,o;e=e||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=t(this.handles[i]),this._on(this.handles[i],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=t(this.handles[i],this.element),o=/sw|ne|nw|se|n|s/.test(i)?s.outerHeight():s.outerWidth(),n=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),e.css(n,o),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")}),r.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").mouseenter(function(){r.disabled||(t(this).removeClass("ui-resizable-autohide"),a._handles.show())}).mouseleave(function(){r.disabled||a.resizing||(t(this).addClass("ui-resizable-autohide"),a._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e,i=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this},_mouseCapture:function(e){var i,s,n=!1;for(i in this.handles)s=t(this.handles[i])[0],(s===e.target||t.contains(s,e.target))&&(n=!0);return!this.options.disabled&&n},_mouseStart:function(e){var i,s,n,o=this.options,a=this.element;return this.resizing=!0,this._renderProxy(),i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),o.containment&&(i+=t(o.containment).scrollLeft()||0,s+=t(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=t(".ui-resizable-"+this.axis).css("cursor"),t("body").css("cursor","auto"===n?this.axis+"-resize":n),a.addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(e){var i,s,n=this.originalMousePosition,o=this.axis,a=e.pageX-n.left||0,r=e.pageY-n.top||0,l=this._change[o];return this._updatePrevProperties(),l?(i=l.apply(this,[e,a,r]),this._updateVirtualBoundaries(e.shiftKey),(this._aspectRatio||e.shiftKey)&&(i=this._updateRatio(i,e)),i=this._respectSize(i,e),this._updateCache(i),this._propagate("resize",e),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),t.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",e,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(e){this.resizing=!1;var i,s,n,o,a,r,l,h=this.options,c=this;return this._helper&&(i=this._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),n=s&&this._hasScroll(i[0],"left")?0:c.sizeDiff.height,o=s?0:c.sizeDiff.width,a={width:c.helper.width()-o,height:c.helper.height()-n},r=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,l=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,h.animate||this.element.css(t.extend(a,{top:l,left:r})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!h.animate&&this._proportionallyResize()),t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},_updateVirtualBoundaries:function(t){var e,i,s,n,o,a=this.options;o={minWidth:this._isNumber(a.minWidth)?a.minWidth:0,maxWidth:this._isNumber(a.maxWidth)?a.maxWidth:1/0,minHeight:this._isNumber(a.minHeight)?a.minHeight:0,maxHeight:this._isNumber(a.maxHeight)?a.maxHeight:1/0},(this._aspectRatio||t)&&(e=o.minHeight*this.aspectRatio,s=o.minWidth/this.aspectRatio,i=o.maxHeight*this.aspectRatio,n=o.maxWidth/this.aspectRatio,e>o.minWidth&&(o.minWidth=e),s>o.minHeight&&(o.minHeight=s),o.maxWidth>i&&(o.maxWidth=i),o.maxHeight>n&&(o.maxHeight=n)),this._vBoundaries=o},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=e.left+(i.width-t.width),t.top=null),"nw"===s&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,h=/sw|nw|w/.test(i),c=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),o&&h&&(t.left=r-e.minWidth),s&&h&&(t.left=r-e.maxWidth),a&&c&&(t.top=l-e.minHeight),n&&c&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],n=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];4>e;e++)i[e]=parseInt(s[e],10)||0,i[e]+=parseInt(n[e],10)||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;this._proportionallyResizeElements.length>e;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,i=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||t("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize,s=this.originalPosition;return{left:s.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize,n=this.originalPosition;return{top:n.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!==e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),t.ui.plugin.add("resizable","animate",{stop:function(e){var i=t(this).resizable("instance"),s=i.options,n=i._proportionallyResizeElements,o=n.length&&/textarea/i.test(n[0].nodeName),a=o&&i._hasScroll(n[0],"left")?0:i.sizeDiff.height,r=o?0:i.sizeDiff.width,l={width:i.size.width-r,height:i.size.height-a},h=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,c=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(t.extend(l,c&&h?{top:c,left:h}:{}),{duration:s.animateDuration,easing:s.animateEasing,step:function(){var s={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};n&&n.length&&t(n[0]).css({width:s.width,height:s.height}),i._updateCache(s),i._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(){var e,i,s,n,o,a,r,l=t(this).resizable("instance"),h=l.options,c=l.element,u=h.containment,d=u instanceof t?u.get(0):/parent/.test(u)?c.parent().get(0):u;d&&(l.containerElement=t(d),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight}):(e=t(d),i=[],t(["Top","Right","Left","Bottom"]).each(function(t,s){i[t]=l._num(e.css("padding"+s))}),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-i[3],width:e.innerWidth()-i[1]},s=l.containerOffset,n=l.containerSize.height,o=l.containerSize.width,a=l._hasScroll(d,"left")?d.scrollWidth:o,r=l._hasScroll(d)?d.scrollHeight:n,l.parentData={element:d,left:s.left,top:s.top,width:a,height:r}))},resize:function(e){var i,s,n,o,a=t(this).resizable("instance"),r=a.options,l=a.containerOffset,h=a.position,c=a._aspectRatio||e.shiftKey,u={top:0,left:0},d=a.containerElement,p=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=l),h.left<(a._helper?l.left:0)&&(a.size.width=a.size.width+(a._helper?a.position.left-l.left:a.position.left-u.left),c&&(a.size.height=a.size.width/a.aspectRatio,p=!1),a.position.left=r.helper?l.left:0),h.top<(a._helper?l.top:0)&&(a.size.height=a.size.height+(a._helper?a.position.top-l.top:a.position.top),c&&(a.size.width=a.size.height*a.aspectRatio,p=!1),a.position.top=a._helper?l.top:0),n=a.containerElement.get(0)===a.element.parent().get(0),o=/relative|absolute/.test(a.containerElement.css("position")),n&&o?(a.offset.left=a.parentData.left+a.position.left,a.offset.top=a.parentData.top+a.position.top):(a.offset.left=a.element.offset().left,a.offset.top=a.element.offset().top),i=Math.abs(a.sizeDiff.width+(a._helper?a.offset.left-u.left:a.offset.left-l.left)),s=Math.abs(a.sizeDiff.height+(a._helper?a.offset.top-u.top:a.offset.top-l.top)),i+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-i,c&&(a.size.height=a.size.width/a.aspectRatio,p=!1)),s+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-s,c&&(a.size.width=a.size.height*a.aspectRatio,p=!1)),p||(a.position.left=a.prevPosition.left,a.position.top=a.prevPosition.top,a.size.width=a.prevSize.width,a.size.height=a.prevSize.height)},stop:function(){var e=t(this).resizable("instance"),i=e.options,s=e.containerOffset,n=e.containerPosition,o=e.containerElement,a=t(e.helper),r=a.offset(),l=a.outerWidth()-e.sizeDiff.width,h=a.outerHeight()-e.sizeDiff.height;e._helper&&!i.animate&&/relative/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:l,height:h}),e._helper&&!i.animate&&/static/.test(o.css("position"))&&t(this).css({left:r.left-n.left-s.left,width:l,height:h})}}),t.ui.plugin.add("resizable","alsoResize",{start:function(){var e=t(this).resizable("instance"),i=e.options;t(i.alsoResize).each(function(){var e=t(this);e.data("ui-resizable-alsoresize",{width:parseInt(e.width(),10),height:parseInt(e.height(),10),left:parseInt(e.css("left"),10),top:parseInt(e.css("top"),10)})})},resize:function(e,i){var s=t(this).resizable("instance"),n=s.options,o=s.originalSize,a=s.originalPosition,r={height:s.size.height-o.height||0,width:s.size.width-o.width||0,top:s.position.top-a.top||0,left:s.position.left-a.left||0};t(n.alsoResize).each(function(){var e=t(this),s=t(this).data("ui-resizable-alsoresize"),n={},o=e.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];t.each(o,function(t,e){var i=(s[e]||0)+(r[e]||0);i&&i>=0&&(n[e]=i||null)}),e.css(n)})},stop:function(){t(this).removeData("resizable-alsoresize")}}),t.ui.plugin.add("resizable","ghost",{start:function(){var e=t(this).resizable("instance"),i=e.options,s=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:s.height,width:s.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof i.ghost?i.ghost:""),e.ghost.appendTo(e.helper)},resize:function(){var e=t(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=t(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(){var e,i=t(this).resizable("instance"),s=i.options,n=i.size,o=i.originalSize,a=i.originalPosition,r=i.axis,l="number"==typeof s.grid?[s.grid,s.grid]:s.grid,h=l[0]||1,c=l[1]||1,u=Math.round((n.width-o.width)/h)*h,d=Math.round((n.height-o.height)/c)*c,p=o.width+u,f=o.height+d,g=s.maxWidth&&p>s.maxWidth,m=s.maxHeight&&f>s.maxHeight,_=s.minWidth&&s.minWidth>p,v=s.minHeight&&s.minHeight>f;s.grid=l,_&&(p+=h),v&&(f+=c),g&&(p-=h),m&&(f-=c),/^(se|s|e)$/.test(r)?(i.size.width=p,i.size.height=f):/^(ne)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.top=a.top-d):/^(sw)$/.test(r)?(i.size.width=p,i.size.height=f,i.position.left=a.left-u):((0>=f-c||0>=p-h)&&(e=i._getPaddingPlusBorderDimensions(this)),f-c>0?(i.size.height=f,i.position.top=a.top-d):(f=c-e.height,i.size.height=f,i.position.top=a.top+o.height-f),p-h>0?(i.size.width=p,i.position.left=a.left-u):(p=h-e.width,i.size.width=p,i.position.left=a.left+o.width-p))}}),t.ui.resizable,t.widget("ui.selectable",t.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;
this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,s=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(s.filter,this.element[0]),this._trigger("start",e),t(s.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),s.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var s=t.data(this,"selectable-item");s.startselected=!0,e.metaKey||e.ctrlKey||(s.$element.removeClass("ui-selected"),s.selected=!1,s.$element.addClass("ui-unselecting"),s.unselecting=!0,i._trigger("unselecting",e,{unselecting:s.element}))}),t(e.target).parents().addBack().each(function(){var s,n=t.data(this,"selectable-item");return n?(s=!e.metaKey&&!e.ctrlKey||!n.$element.hasClass("ui-selected"),n.$element.removeClass(s?"ui-unselecting":"ui-selected").addClass(s?"ui-selecting":"ui-unselecting"),n.unselecting=!s,n.selecting=s,n.selected=s,s?i._trigger("selecting",e,{selecting:n.element}):i._trigger("unselecting",e,{unselecting:n.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,s=this,n=this.options,o=this.opos[0],a=this.opos[1],r=e.pageX,l=e.pageY;return o>r&&(i=r,r=o,o=i),a>l&&(i=l,l=a,a=i),this.helper.css({left:o,top:a,width:r-o,height:l-a}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),h=!1;i&&i.element!==s.element[0]&&("touch"===n.tolerance?h=!(i.left>r||o>i.right||i.top>l||a>i.bottom):"fit"===n.tolerance&&(h=i.left>o&&r>i.right&&i.top>a&&l>i.bottom),h?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,s._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),s._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,s._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");s.$element.removeClass("ui-unselecting"),s.unselecting=!1,s.startselected=!1,i._trigger("unselected",e,{unselected:s.element})}),t(".ui-selecting",this.element[0]).each(function(){var s=t.data(this,"selectable-item");s.$element.removeClass("ui-selecting").addClass("ui-selected"),s.selecting=!1,s.selected=!0,s.startselected=!0,i._trigger("selected",e,{selected:s.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),t.widget("ui.sortable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var s=null,n=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(s=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(s=t(e.target)),s?!this.options.handle||i||(t(this.options.handle,s).find("*").addBack().each(function(){this===e.target&&(n=!0)}),n)?(this.currentItem=s,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(e,i,s){var n,o,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(o)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,s,n,o,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(s=this.items[i],n=s.item[0],o=this._intersectsWithPointer(s),o&&s.instance===this.currentContainer&&n!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==n&&!t.contains(this.placeholder[0],n)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],n):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(s))break;this._rearrange(e,s),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,n=this.placeholder.offset(),o=this.options.axis,a={};o&&"x"!==o||(a.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(a.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,l=r+t.height,h=this.offset.click.top,c=this.offset.click.left,u="x"===this.options.axis||s+h>r&&l>s+h,d="y"===this.options.axis||e+c>o&&a>e+c,p=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:e+this.helperProportions.width/2>o&&a>i-this.helperProportions.width/2&&s+this.helperProportions.height/2>r&&l>n-this.helperProportions.height/2},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),s=e&&i,n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return s?this.floating?o&&"right"===o||"down"===n?2:1:n&&("down"===n?2:1):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),s=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return this.floating&&n?"right"===n&&i||"left"===n&&!i:s&&("down"===s&&e||"up"===s&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var s,n,o,a,r=[],l=[],h=this._connectWith();if(h&&e)for(s=h.length-1;s>=0;s--)for(o=t(h[s],this.document[0]),n=o.length-1;n>=0;n--)a=t.data(o[n],this.widgetFullName),a&&a!==this&&!a.options.disabled&&l.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),s=l.length-1;s>=0;s--)l[s][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;e.length>i;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,s,n,o,a,r,l,h,c=this.items,u=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(n=t(d[i],this.document[0]),s=n.length-1;s>=0;s--)o=t.data(n[s],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(u.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(i=u.length-1;i>=0;i--)for(a=u[i][1],r=u[i][0],s=0,h=r.length;h>s;s++)l=t(r[s]),l.data(this.widgetName+"-item",a),c.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,s,n,o;for(i=this.items.length-1;i>=0;i--)s=this.items[i],s.instance!==this.currentContainer&&this.currentContainer&&s.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item,e||(s.width=n.outerWidth(),s.height=n.outerHeight()),o=n.offset(),s.left=o.left,s.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,s=e.options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,s.placeholder={element:function(){var s=e.currentItem[0].nodeName.toLowerCase(),n=t("<"+s+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===s?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(n)):"tr"===s?e._createTrPlaceholder(e.currentItem,n):"img"===s&&n.attr("src",e.currentItem.attr("src")),i||n.css("visibility","hidden"),n},update:function(t,n){(!i||s.forcePlaceholderSize)&&(n.height()||n.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),n.width()||n.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var s=this;e.children().each(function(){t("<td>&#160;</td>",s.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,s,n,o,a,r,l,h,c,u,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(n=1e4,o=null,c=d.floating||this._isFloating(this.currentItem),a=c?"left":"top",r=c?"width":"height",u=c?"clientX":"clientY",s=this.items.length-1;s>=0;s--)t.contains(this.containers[p].element[0],this.items[s].item[0])&&this.items[s].item[0]!==this.currentItem[0]&&(l=this.items[s].item.offset()[a],h=!1,e[u]-l>this.items[s][r]/2&&(h=!0),n>Math.abs(e[u]-l)&&(n=Math.abs(e[u]-l),o=this.items[s],this.direction=h?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1),void 0;o?this._rearrange(e,o,null,!0):this._rearrange(e,null,this.containers[p].element,!0),this._trigger("change",e,this._uiHash()),this.containers[p]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",e,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(!s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,s,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),("document"===n.containment||"window"===n.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=t(n.containment)[0],i=t(n.containment).offset(),s="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(s?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(s?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"===e?1:-1,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:n.scrollTop())*s,left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())*s}},_generatePosition:function(e){var i,s,n=this.options,o=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),n.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/n.grid[1])*n.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-n.grid[1]:i+n.grid[1]:i,s=this.originalPageX+Math.round((o-this.originalPageX)/n.grid[0])*n.grid[0],o=this.containment?s-this.offset.click.left>=this.containment[0]&&s-this.offset.click.left<=this.containment[2]?s:s-this.offset.click.left>=this.containment[0]?s-n.grid[0]:s+n.grid[0]:s)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,e){function i(t,e,i){return function(s){i._trigger(t,s,e._uiHash(e))}}this.reverting=!1;var s,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(s in this._storedCSS)("auto"===this._storedCSS[s]||"static"===this._storedCSS[s])&&(this._storedCSS[s]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&n.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(n.push(function(t){this._trigger("remove",t,this._uiHash())}),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),s=this.containers.length-1;s>=0;s--)e||n.push(i("deactivate",this,this.containers[s])),this.containers[s].containerCache.over&&(n.push(i("out",this,this.containers[s])),this.containers[s].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(s=0;n.length>s;s++)n[s].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.widget("ui.accordion",{version:"1.11.4",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var e=this.options;this.prevShow=this.prevHide=t(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),e.collapsible||e.active!==!1&&null!=e.active||(e.active=0),this._processPanels(),0>e.active&&(e.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():t()}},_createIcons:function(){var e=this.options.icons;e&&(t("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},_setOption:function(t,e){return"active"===t?(this._activate(e),void 0):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||this.options.active!==!1||this._activate(0),"icons"===t&&(this._destroyIcons(),e&&this._createIcons()),"disabled"===t&&(this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!e)),void 0)},_keydown:function(e){if(!e.altKey&&!e.ctrlKey){var i=t.ui.keyCode,s=this.headers.length,n=this.headers.index(e.target),o=!1;switch(e.keyCode){case i.RIGHT:case i.DOWN:o=this.headers[(n+1)%s];break;case i.LEFT:case i.UP:o=this.headers[(n-1+s)%s];break;case i.SPACE:case i.ENTER:this._eventHandler(e);break;case i.HOME:o=this.headers[0];break;case i.END:o=this.headers[s-1]}o&&(t(e.target).attr("tabIndex",-1),t(o).attr("tabIndex",0),o.focus(),e.preventDefault())}},_panelKeyDown:function(e){e.keyCode===t.ui.keyCode.UP&&e.ctrlKey&&t(e.currentTarget).prev().focus()},refresh:function(){var e=this.options;this._processPanels(),e.active===!1&&e.collapsible===!0||!this.headers.length?(e.active=!1,this.active=t()):e.active===!1?this._activate(0):this.active.length&&!t.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(e.active=!1,this.active=t()):this._activate(Math.max(0,e.active-1)):e.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.panels=this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide(),e&&(this._off(t.not(this.headers)),this._off(e.not(this.panels)))
},_refresh:function(){var e,i=this.options,s=i.heightStyle,n=this.element.parent();this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var e=t(this),i=e.uniqueId().attr("id"),s=e.next(),n=s.uniqueId().attr("id");e.attr("aria-controls",n),s.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===s?(e=n.height(),this.element.siblings(":visible").each(function(){var i=t(this),s=i.css("position");"absolute"!==s&&"fixed"!==s&&(e-=i.outerHeight(!0))}),this.headers.each(function(){e-=t(this).outerHeight(!0)}),this.headers.next().each(function(){t(this).height(Math.max(0,e-t(this).innerHeight()+t(this).height()))}).css("overflow","auto")):"auto"===s&&(e=0,this.headers.next().each(function(){e=Math.max(e,t(this).css("height","").height())}).height(e))},_activate:function(e){var i=this._findActive(e)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return"number"==typeof e?this.headers.eq(e):t()},_setupEvents:function(e){var i={keydown:"_keydown"};e&&t.each(e.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var i=this.options,s=this.active,n=t(e.currentTarget),o=n[0]===s[0],a=o&&i.collapsible,r=a?t():n.next(),l=s.next(),h={oldHeader:s,oldPanel:l,newHeader:a?t():n,newPanel:r};e.preventDefault(),o&&!i.collapsible||this._trigger("beforeActivate",e,h)===!1||(i.active=a?!1:this.headers.index(n),this.active=o?t():n,this._toggle(h),s.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&s.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),o||(n.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&n.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),n.next().addClass("ui-accordion-content-active")))},_toggle:function(e){var i=e.newPanel,s=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=s,this.options.animate?this._animate(i,s,e):(s.hide(),i.show(),this._toggleComplete(e)),s.attr({"aria-hidden":"true"}),s.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&s.length?s.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(t(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,e,i){var s,n,o,a=this,r=0,l=t.css("box-sizing"),h=t.length&&(!e.length||t.index()<e.index()),c=this.options.animate||{},u=h&&c.down||c,d=function(){a._toggleComplete(i)};return"number"==typeof u&&(o=u),"string"==typeof u&&(n=u),n=n||u.easing||c.easing,o=o||u.duration||c.duration,e.length?t.length?(s=t.show().outerHeight(),e.animate(this.hideProps,{duration:o,easing:n,step:function(t,e){e.now=Math.round(t)}}),t.hide().animate(this.showProps,{duration:o,easing:n,complete:d,step:function(t,i){i.now=Math.round(t),"height"!==i.prop?"content-box"===l&&(r+=i.now):"content"!==a.options.heightStyle&&(i.now=Math.round(s-e.outerHeight()-r),r=0)}}),void 0):e.animate(this.hideProps,o,n,d):t.animate(this.showProps,o,n,d)},_toggleComplete:function(t){var e=t.oldPanel;e.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),t.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target);!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&t(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.currentTarget);i.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(e,i)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){t.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=t(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(e){var i,s,n,o,a=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:a=!1,s=this.previousFilter||"",n=String.fromCharCode(e.keyCode),o=!1,clearTimeout(this.filterTimer),n===s?o=!0:n=s+n,i=this._filterMenuItems(n),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(e.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(e,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}a&&e.preventDefault()},_activate:function(t){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(t):this.select(t))},refresh:function(){var e,i,s=this,n=this.options.icons.submenu,o=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),o.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),i=e.parent(),s=t("<span>").addClass("ui-menu-icon ui-icon "+n).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(s),e.attr("aria-labelledby",i.attr("id"))}),e=o.add(this.element),i=e.find(this.options.items),i.not(".ui-menu-item").each(function(){var e=t(this);s._isDivider(e)&&e.addClass("ui-widget-content ui-menu-divider")}),i.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){"icons"===t&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(e.submenu),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},focus:function(t,e){var i,s;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,s,n,o,a,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),r=e.outerHeight(),0>n?this.activeMenu.scrollTop(o+n):n+r>a&&this.activeMenu.scrollTop(o+n-a+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",t,{item:this.active}))},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]())),void 0):(this.next(e),void 0)},previousPage:function(e){var i,s,n;return this.active?(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first())),void 0):(this.next(e),void 0)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(t.trim(t(this).text()))})}}),t.widget("ui.autocomplete",{version:"1.11.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;this.isMultiLine=o?!0:a?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,i=!0,void 0;e=!1,s=!1,i=!1;var o=t.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:e=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case o.UP:e=!0,this._keyEvent("previous",n);break;case o.DOWN:e=!0,this._keyEvent("next",n);break;case o.ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault(),void 0;if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,t.preventDefault(),void 0):(this._searchTimeout(t),void 0)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(clearTimeout(this.searching),this.close(t),this._change(t),void 0)}}),this._initSource(),this.menu=t("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];t(e.target).closest(".ui-menu-item").length||this._delay(function(){var e=this;this.document.one("mousedown",function(s){s.target===e.element[0]||s.target===i||t.contains(i,s.target)||e.close()})})},menufocus:function(e,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)}),void 0):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:n})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value),s=i.item.attr("aria-label")||n.value,s&&t.trim(s).length&&(this.liveRegion.children().hide(),t("<div>").text(s).appendTo(this.liveRegion)),void 0)},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),this.liveRegion=t("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),s=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!s)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):this._trigger("search",e)!==!1?this._search(t):void 0},_search:function(t){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this.element.removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").text(i.label).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),this.menu.blur(),void 0):(this.menu[t](e),void 0):(this.search(null,e),void 0)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete;var d,p="ui-button ui-widget ui-state-default ui-corner-all",f="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",g=function(){var e=t(this);setTimeout(function(){e.find(":ui-button").button("refresh")},1)},m=function(e){var i=e.name,s=e.form,n=t([]);return i&&(i=i.replace(/'/g,"\\'"),n=s?t(s).find("[name='"+i+"'][type=radio]"):t("[name='"+i+"'][type=radio]",e.ownerDocument).filter(function(){return!this.form})),n};t.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,g),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,i=this.options,s="checkbox"===this.type||"radio"===this.type,n=s?"":"ui-state-active";null===i.label&&(i.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(p).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){i.disabled||this===d&&t(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){i.disabled||t(this).removeClass(n)}).bind("click"+this.eventNamespace,function(t){i.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),s&&this.element.bind("change"+this.eventNamespace,function(){e.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return i.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(i.disabled)return!1;t(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var s=e.element[0];m(s).not(s).map(function(){return t(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return i.disabled?!1:(t(this).addClass("ui-state-active"),d=this,e.document.one("mouseup",function(){d=null}),void 0)}).bind("mouseup"+this.eventNamespace,function(){return i.disabled?!1:(t(this).removeClass("ui-state-active"),void 0)}).bind("keydown"+this.eventNamespace,function(e){return i.disabled?!1:((e.keyCode===t.ui.keyCode.SPACE||e.keyCode===t.ui.keyCode.ENTER)&&t(this).addClass("ui-state-active"),void 0)}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){t(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()})),this._setOption("disabled",i.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(p+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){return this._super(t,e),"disabled"===t?(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),e&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")),void 0):(this._resetButton(),void 0)},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?m(this.element[0]).each(function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return this.options.label&&this.element.val(this.options.label),void 0;var e=this.buttonElement.removeClass(f),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),s=this.options.icons,n=s.primary&&s.secondary,o=[];s.primary||s.secondary?(this.options.text&&o.push("ui-button-text-icon"+(n?"s":s.primary?"-primary":"-secondary")),s.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+s.primary+"'></span>"),s.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+s.secondary+"'></span>"),this.options.text||(o.push(n?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):o.push("ui-button-text-only"),e.addClass(o.join(" "))}}),t.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction"),i=this.element.find(this.options.items),s=i.filter(":ui-button");i.not(":ui-button").button(),s.button("refresh"),this.buttons=i.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return t(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),t.ui.button,t.extend(t.ui,{datepicker:{version:"1.11.4"}});var _;t.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return r(this._defaults,t||{}),this},_attachDatepicker:function(e,i){var s,n,o;s=e.nodeName.toLowerCase(),n="div"===s||"span"===s,e.id||(this.uuid+=1,e.id="dp"+this.uuid),o=this._newInst(t(e),n),o.settings=t.extend({},i||{}),"input"===s?this._connectDatepicker(e,o):n&&this._inlineDatepicker(e,o)},_newInst:function(e,i){var s=e[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:s,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?o(t("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(e,i){var s=t(e);i.append=t([]),i.trigger=t([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),t.data(e,"datepicker",i),i.settings.disabled&&this._disableDatepicker(e))},_attachments:function(e,i){var s,n,o,a=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=t("<span class='"+this._appendClass+"'>"+a+"</span>"),e[r?"before":"after"](i.append)),e.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&e.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=t(this._get(i,"buttonImageOnly")?t("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):t("<button type='button'></button>").addClass(this._triggerClass).html(o?t("<img/>").attr({src:o,alt:n,title:n}):n)),e[r?"before":"after"](i.trigger),i.trigger.click(function(){return t.datepicker._datepickerShowing&&t.datepicker._lastInput===e[0]?t.datepicker._hideDatepicker():t.datepicker._datepickerShowing&&t.datepicker._lastInput!==e[0]?(t.datepicker._hideDatepicker(),t.datepicker._showDatepicker(e[0])):t.datepicker._showDatepicker(e[0]),!1}))},_autoSize:function(t){if(this._get(t,"autoSize")&&!t.inline){var e,i,s,n,o=new Date(2009,11,20),a=this._get(t,"dateFormat");a.match(/[DM]/)&&(e=function(t){for(i=0,s=0,n=0;t.length>n;n++)t[n].length>i&&(i=t[n].length,s=n);return s},o.setMonth(e(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length)}},_inlineDatepicker:function(e,i){var s=t(e);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),t.data(e,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(e),i.dpDiv.css("display","block"))},_dialogDatepicker:function(e,i,s,n,o){var a,l,h,c,u,d=this._dialogInst;return d||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=t("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),t("body").append(this._dialogInput),d=this._dialogInst=this._newInst(this._dialogInput,!1),d.settings={},t.data(this._dialogInput[0],"datepicker",d)),r(d.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+c,h/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),t.blockUI&&t.blockUI(this.dpDiv),t.data(this._dialogInput[0],"datepicker",d),this
},_destroyDatepicker:function(e){var i,s=t(e),n=t.data(e,"datepicker");s.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),t.removeData(e,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty(),_===n&&(_=null))},_enableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var i,s,n=t(e),o=t.data(e,"datepicker");n.hasClass(this.markerClassName)&&(i=e.nodeName.toLowerCase(),"input"===i?(e.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=t.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;this._disabledInputs.length>e;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(e){try{return t.data(e,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,i,s){var n,o,a,l,h=this._getInst(e);return 2===arguments.length&&"string"==typeof i?"defaults"===i?t.extend({},t.datepicker._defaults):h?"all"===i?t.extend({},h.settings):this._get(h,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),h&&(this._curInst===h&&this._hideDatepicker(),o=this._getDateDatepicker(e,!0),a=this._getMinMaxDate(h,"min"),l=this._getMinMaxDate(h,"max"),r(h.settings,n),null!==a&&void 0!==n.dateFormat&&void 0===n.minDate&&(h.settings.minDate=this._formatDate(h,a)),null!==l&&void 0!==n.dateFormat&&void 0===n.maxDate&&(h.settings.maxDate=this._formatDate(h,l)),"disabled"in n&&(n.disabled?this._disableDatepicker(e):this._enableDatepicker(e)),this._attachments(t(e),h),this._autoSize(h),this._setDate(h,o),this._updateAlternate(h),this._updateDatepicker(h)),void 0)},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e){var i=this._getInst(t);i&&(this._setDate(i,e),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(t,e){var i=this._getInst(t);return i&&!i.inline&&this._setDateFromField(i,e),i?this._getDate(i):null},_doKeyDown:function(e){var i,s,n,o=t.datepicker._getInst(e.target),a=!0,r=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,t.datepicker._datepickerShowing)switch(e.keyCode){case 9:t.datepicker._hideDatepicker(),a=!1;break;case 13:return n=t("td."+t.datepicker._dayOverClass+":not(."+t.datepicker._currentClass+")",o.dpDiv),n[0]&&t.datepicker._selectDay(e.target,o.selectedMonth,o.selectedYear,n[0]),i=t.datepicker._get(o,"onSelect"),i?(s=t.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[s,o])):t.datepicker._hideDatepicker(),!1;case 27:t.datepicker._hideDatepicker();break;case 33:t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 34:t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&t.datepicker._clearDate(e.target),a=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&t.datepicker._gotoToday(e.target),a=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?1:-1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?-t.datepicker._get(o,"stepBigMonths"):-t.datepicker._get(o,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,-7,"D"),a=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,r?-1:1,"D"),a=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&t.datepicker._adjustDate(e.target,e.ctrlKey?+t.datepicker._get(o,"stepBigMonths"):+t.datepicker._get(o,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&t.datepicker._adjustDate(e.target,7,"D"),a=e.ctrlKey||e.metaKey;break;default:a=!1}else 36===e.keyCode&&e.ctrlKey?t.datepicker._showDatepicker(this):a=!1;a&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var i,s,n=t.datepicker._getInst(e.target);return t.datepicker._get(n,"constrainInput")?(i=t.datepicker._possibleChars(t.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),e.ctrlKey||e.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(e){var i,s=t.datepicker._getInst(e.target);if(s.input.val()!==s.lastVal)try{i=t.datepicker.parseDate(t.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,t.datepicker._getFormatConfig(s)),i&&(t.datepicker._setDateFromField(s),t.datepicker._updateAlternate(s),t.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(e){if(e=e.target||e,"input"!==e.nodeName.toLowerCase()&&(e=t("input",e.parentNode)[0]),!t.datepicker._isDisabledDatepicker(e)&&t.datepicker._lastInput!==e){var i,n,o,a,l,h,c;i=t.datepicker._getInst(e),t.datepicker._curInst&&t.datepicker._curInst!==i&&(t.datepicker._curInst.dpDiv.stop(!0,!0),i&&t.datepicker._datepickerShowing&&t.datepicker._hideDatepicker(t.datepicker._curInst.input[0])),n=t.datepicker._get(i,"beforeShow"),o=n?n.apply(e,[e,i]):{},o!==!1&&(r(i.settings,o),i.lastVal=null,t.datepicker._lastInput=e,t.datepicker._setDateFromField(i),t.datepicker._inDialog&&(e.value=""),t.datepicker._pos||(t.datepicker._pos=t.datepicker._findPos(e),t.datepicker._pos[1]+=e.offsetHeight),a=!1,t(e).parents().each(function(){return a|="fixed"===t(this).css("position"),!a}),l={left:t.datepicker._pos[0],top:t.datepicker._pos[1]},t.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),t.datepicker._updateDatepicker(i),l=t.datepicker._checkOffset(i,l,a),i.dpDiv.css({position:t.datepicker._inDialog&&t.blockUI?"static":a?"fixed":"absolute",display:"none",left:l.left+"px",top:l.top+"px"}),i.inline||(h=t.datepicker._get(i,"showAnim"),c=t.datepicker._get(i,"duration"),i.dpDiv.css("z-index",s(t(e))+1),t.datepicker._datepickerShowing=!0,t.effects&&t.effects.effect[h]?i.dpDiv.show(h,t.datepicker._get(i,"showOptions"),c):i.dpDiv[h||"show"](h?c:null),t.datepicker._shouldFocusInput(i)&&i.input.focus(),t.datepicker._curInst=i))}},_updateDatepicker:function(e){this.maxRows=4,_=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var i,s=this._getNumberOfMonths(e),n=s[1],o=17,r=e.dpDiv.find("."+this._dayOverClass+" a");r.length>0&&a.apply(r.get(0)),e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),n>1&&e.dpDiv.addClass("ui-datepicker-multi-"+n).css("width",o*n+"em"),e.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e===t.datepicker._curInst&&t.datepicker._datepickerShowing&&t.datepicker._shouldFocusInput(e)&&e.input.focus(),e.yearshtml&&(i=e.yearshtml,setTimeout(function(){i===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),i=e.yearshtml=null},0))},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(e,i,s){var n=e.dpDiv.outerWidth(),o=e.dpDiv.outerHeight(),a=e.input?e.input.outerWidth():0,r=e.input?e.input.outerHeight():0,l=document.documentElement.clientWidth+(s?0:t(document).scrollLeft()),h=document.documentElement.clientHeight+(s?0:t(document).scrollTop());return i.left-=this._get(e,"isRTL")?n-a:0,i.left-=s&&i.left===e.input.offset().left?t(document).scrollLeft():0,i.top-=s&&i.top===e.input.offset().top+r?t(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0),i.top-=Math.min(i.top,i.top+o>h&&h>o?Math.abs(o+r):0),i},_findPos:function(e){for(var i,s=this._getInst(e),n=this._get(s,"isRTL");e&&("hidden"===e.type||1!==e.nodeType||t.expr.filters.hidden(e));)e=e[n?"previousSibling":"nextSibling"];return i=t(e).offset(),[i.left,i.top]},_hideDatepicker:function(e){var i,s,n,o,a=this._curInst;!a||e&&a!==t.data(e,"datepicker")||this._datepickerShowing&&(i=this._get(a,"showAnim"),s=this._get(a,"duration"),n=function(){t.datepicker._tidyDialog(a)},t.effects&&(t.effects.effect[i]||t.effects[i])?a.dpDiv.hide(i,t.datepicker._get(a,"showOptions"),s,n):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),t.blockUI&&(t.unblockUI(),t("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(t.datepicker._curInst){var i=t(e.target),s=t.datepicker._getInst(i[0]);(i[0].id!==t.datepicker._mainDivId&&0===i.parents("#"+t.datepicker._mainDivId).length&&!i.hasClass(t.datepicker.markerClassName)&&!i.closest("."+t.datepicker._triggerClass).length&&t.datepicker._datepickerShowing&&(!t.datepicker._inDialog||!t.blockUI)||i.hasClass(t.datepicker.markerClassName)&&t.datepicker._curInst!==s)&&t.datepicker._hideDatepicker()}},_adjustDate:function(e,i,s){var n=t(e),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===s?this._get(o,"showCurrentAtPos"):0),s),this._updateDatepicker(o))},_gotoToday:function(e){var i,s=t(e),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(e,i,s){var n=t(e),o=this._getInst(n[0]);o["selected"+("M"===s?"Month":"Year")]=o["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(e,i,s,n){var o,a=t(e);t(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=t("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=s,this._selectDate(e,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(e){var i=t(e);this._selectDate(i,"")},_selectDate:function(e,i){var s,n=t(e),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),s=this._get(o,"onSelect"),s?s.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var i,s,n,o=this._get(e,"altField");o&&(i=this._get(e,"altFormat")||this._get(e,"dateFormat"),s=this._getDate(e),n=this.formatDate(i,s,this._getFormatConfig(e)),t(o).each(function(){t(this).val(n)}))},noWeekends:function(t){var e=t.getDay();return[e>0&&6>e,""]},iso8601Week:function(t){var e,i=new Date(t.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),e=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((e-i)/864e5)/7)+1},parseDate:function(e,i,s){if(null==e||null==i)throw"Invalid arguments";if(i="object"==typeof i?""+i:i+"",""===i)return null;var n,o,a,r,l=0,h=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),u=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,d=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,_=-1,v=-1,b=!1,y=function(t){var i=e.length>n+1&&e.charAt(n+1)===t;return i&&n++,i},w=function(t){var e=y(t),s="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,n="y"===t?s:1,o=RegExp("^\\d{"+n+","+s+"}"),a=i.substring(l).match(o);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},k=function(e,s,n){var o=-1,a=t.map(y(e)?n:s,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(t.each(a,function(t,e){var s=e[1];return i.substr(l,s.length).toLowerCase()===s.toLowerCase()?(o=e[0],l+=s.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+l},x=function(){if(i.charAt(l)!==e.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;e.length>n;n++)if(b)"'"!==e.charAt(n)||y("'")?x():b=!1;else switch(e.charAt(n)){case"d":_=w("d");break;case"D":k("D",u,d);break;case"o":v=w("o");break;case"m":m=w("m");break;case"M":m=k("M",p,f);break;case"y":g=w("y");break;case"@":r=new Date(w("@")),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"!":r=new Date((w("!")-this._ticksTo1970)/1e4),g=r.getFullYear(),m=r.getMonth()+1,_=r.getDate();break;case"'":y("'")?x():b=!0;break;default:x()}if(i.length>l&&(a=i.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=g?0:-100)),v>-1)for(m=1,_=v;;){if(o=this._getDaysInMonth(g,m-1),o>=_)break;m++,_-=o}if(r=this._daylightSavingAdjust(new Date(g,m-1,_)),r.getFullYear()!==g||r.getMonth()+1!==m||r.getDate()!==_)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:1e7*60*60*24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(t,e,i){if(!e)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(e){var i=t.length>s+1&&t.charAt(s+1)===e;return i&&s++,i},h=function(t,e,i){var s=""+e;if(l(t))for(;i>s.length;)s="0"+s;return s},c=function(t,e,i,s){return l(t)?s[e]:i[e]},u="",d=!1;if(e)for(s=0;t.length>s;s++)if(d)"'"!==t.charAt(s)||l("'")?u+=t.charAt(s):d=!1;else switch(t.charAt(s)){case"d":u+=h("d",e.getDate(),2);break;case"D":u+=c("D",e.getDay(),n,o);break;case"o":u+=h("o",Math.round((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()-new Date(e.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=h("m",e.getMonth()+1,2);break;case"M":u+=c("M",e.getMonth(),a,r);break;case"y":u+=l("y")?e.getFullYear():(10>e.getYear()%100?"0":"")+e.getYear()%100;break;case"@":u+=e.getTime();break;case"!":u+=1e4*e.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":d=!0;break;default:u+=t.charAt(s)}return u},_possibleChars:function(t){var e,i="",s=!1,n=function(i){var s=t.length>e+1&&t.charAt(e+1)===i;return s&&e++,s};for(e=0;t.length>e;e++)if(s)"'"!==t.charAt(e)||n("'")?i+=t.charAt(e):s=!1;else switch(t.charAt(e)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=t.charAt(e)}return i},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),o=n,a=this._getFormatConfig(t);try{o=this.parseDate(i,s,a)||n}catch(r){s=e?"":s}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=s?o.getDate():0,t.currentMonth=s?o.getMonth():0,t.currentYear=s?o.getFullYear():0,this._adjustInstDate(t)}},_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(e,i,s){var n=function(t){var e=new Date;return e.setDate(e.getDate()+t),e},o=function(i){try{return t.datepicker.parseDate(t.datepicker._get(e,"dateFormat"),i,t.datepicker._getFormatConfig(e))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?t.datepicker._getDate(e):null)||new Date,o=n.getFullYear(),a=n.getMonth(),r=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=l.exec(i);h;){switch(h[2]||"d"){case"d":case"D":r+=parseInt(h[1],10);break;case"w":case"W":r+=7*parseInt(h[1],10);break;case"m":case"M":a+=parseInt(h[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(h[1],10),r=Math.min(r,t.datepicker._getDaysInMonth(o,a))}h=l.exec(i)}return new Date(o,a,r)},a=null==i||""===i?s:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return a=a&&"Invalid Date"==""+a?s:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,o=t.selectedYear,a=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=a.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=a.getMonth(),t.drawYear=t.selectedYear=t.currentYear=a.getFullYear(),n===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){var e=!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return e},_attachHandlers:function(e){var i=this._get(e,"stepMonths"),s="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){t.datepicker._adjustDate(s,-i,"M")},next:function(){t.datepicker._adjustDate(s,+i,"M")},hide:function(){t.datepicker._hideDatepicker()},today:function(){t.datepicker._gotoToday(s)},selectDay:function(){return t.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return t.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return t.datepicker._selectMonthYear(s,this,"Y"),!1}};t(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,o,a,r,l,h,c,u,d,p,f,g,m,_,v,b,y,w,k,x,C,D,T,I,M,P,S,N,H,z,A,O,E,W,F,L,R=new Date,Y=this._daylightSavingAdjust(new Date(R.getFullYear(),R.getMonth(),R.getDate())),B=this._get(t,"isRTL"),j=this._get(t,"showButtonPanel"),q=this._get(t,"hideIfNoPrevNext"),K=this._get(t,"navigationAsDateFormat"),U=this._getNumberOfMonths(t),V=this._get(t,"showCurrentAtPos"),X=this._get(t,"stepMonths"),$=1!==U[0]||1!==U[1],G=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),J=this._getMinMaxDate(t,"min"),Q=this._getMinMaxDate(t,"max"),Z=t.drawMonth-V,te=t.drawYear;if(0>Z&&(Z+=12,te--),Q)for(e=this._daylightSavingAdjust(new Date(Q.getFullYear(),Q.getMonth()-U[0]*U[1]+1,Q.getDate())),e=J&&J>e?J:e;this._daylightSavingAdjust(new Date(te,Z,1))>e;)Z--,0>Z&&(Z=11,te--);for(t.drawMonth=Z,t.drawYear=te,i=this._get(t,"prevText"),i=K?this.formatDate(i,this._daylightSavingAdjust(new Date(te,Z-X,1)),this._getFormatConfig(t)):i,s=this._canAdjustMonth(t,-1,te,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":q?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>",n=this._get(t,"nextText"),n=K?this.formatDate(n,this._daylightSavingAdjust(new Date(te,Z+X,1)),this._getFormatConfig(t)):n,o=this._canAdjustMonth(t,1,te,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>":q?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+n+"</span></a>",a=this._get(t,"currentText"),r=this._get(t,"gotoCurrent")&&t.currentDay?G:Y,a=K?this.formatDate(a,r,this._getFormatConfig(t)):a,l=t.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(t,"closeText")+"</button>",h=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?l:"")+(this._isInRange(t,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(B?"":l)+"</div>":"",c=parseInt(this._get(t,"firstDay"),10),c=isNaN(c)?0:c,u=this._get(t,"showWeek"),d=this._get(t,"dayNames"),p=this._get(t,"dayNamesMin"),f=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),m=this._get(t,"beforeShowDay"),_=this._get(t,"showOtherMonths"),v=this._get(t,"selectOtherMonths"),b=this._getDefaultDate(t),y="",k=0;U[0]>k;k++){for(x="",this.maxRows=4,C=0;U[1]>C;C++){if(D=this._daylightSavingAdjust(new Date(te,Z,t.selectedDay)),T=" ui-corner-all",I="",$){if(I+="<div class='ui-datepicker-group",U[1]>1)switch(C){case 0:I+=" ui-datepicker-group-first",T=" ui-corner-"+(B?"right":"left");break;case U[1]-1:I+=" ui-datepicker-group-last",T=" ui-corner-"+(B?"left":"right");break;default:I+=" ui-datepicker-group-middle",T=""}I+="'>"}for(I+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===k?B?o:s:"")+(/all|right/.test(T)&&0===k?B?s:o:"")+this._generateMonthYearHeader(t,Z,te,J,Q,k>0||C>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",M=u?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",w=0;7>w;w++)P=(w+c)%7,M+="<th scope='col'"+((w+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+d[P]+"'>"+p[P]+"</span></th>";for(I+=M+"</tr></thead><tbody>",S=this._getDaysInMonth(te,Z),te===t.selectedYear&&Z===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,S)),N=(this._getFirstDayOfMonth(te,Z)-c+7)%7,H=Math.ceil((N+S)/7),z=$?this.maxRows>H?this.maxRows:H:H,this.maxRows=z,A=this._daylightSavingAdjust(new Date(te,Z,1-N)),O=0;z>O;O++){for(I+="<tr>",E=u?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(A)+"</td>":"",w=0;7>w;w++)W=m?m.apply(t.input?t.input[0]:null,[A]):[!0,""],F=A.getMonth()!==Z,L=F&&!v||!W[0]||J&&J>A||Q&&A>Q,E+="<td class='"+((w+c+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(A.getTime()===D.getTime()&&Z===t.selectedMonth&&t._keyEvent||b.getTime()===A.getTime()&&b.getTime()===D.getTime()?" "+this._dayOverClass:"")+(L?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!_?"":" "+W[1]+(A.getTime()===G.getTime()?" "+this._currentClass:"")+(A.getTime()===Y.getTime()?" ui-datepicker-today":""))+"'"+(F&&!_||!W[2]?"":" title='"+W[2].replace(/'/g,"&#39;")+"'")+(L?"":" data-handler='selectDay' data-event='click' data-month='"+A.getMonth()+"' data-year='"+A.getFullYear()+"'")+">"+(F&&!_?"&#xa0;":L?"<span class='ui-state-default'>"+A.getDate()+"</span>":"<a class='ui-state-default"+(A.getTime()===Y.getTime()?" ui-state-highlight":"")+(A.getTime()===G.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+A.getDate()+"</a>")+"</td>",A.setDate(A.getDate()+1),A=this._daylightSavingAdjust(A);I+=E+"</tr>"}Z++,Z>11&&(Z=0,te++),I+="</tbody></table>"+($?"</div>"+(U[0]>0&&C===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=I}y+=x}return y+=h,t._keyEvent=!1,y},_generateMonthYearHeader:function(t,e,i,s,n,o,a,r){var l,h,c,u,d,p,f,g,m=this._get(t,"changeMonth"),_=this._get(t,"changeYear"),v=this._get(t,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",y="";if(o||!m)y+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(l=s&&s.getFullYear()===i,h=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",c=0;12>c;c++)(!l||c>=s.getMonth())&&(!h||n.getMonth()>=c)&&(y+="<option value='"+c+"'"+(c===e?" selected='selected'":"")+">"+r[c]+"</option>");y+="</select>"}if(v||(b+=y+(!o&&m&&_?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!_)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(t,"yearRange").split(":"),d=(new Date).getFullYear(),p=function(t){var e=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?d+parseInt(t,10):parseInt(t,10);return isNaN(e)?d:e},f=p(u[0]),g=Math.max(f,p(u[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,t.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)t.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),v&&(b+=(!o&&m&&_?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.drawYear+("Y"===i?e:0),n=t.drawMonth+("M"===i?e:0),o=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),a=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,n,o)));t.selectedDay=a.getDate(),t.drawMonth=t.selectedMonth=a.getMonth(),t.drawYear=t.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),s=this._getMinMaxDate(t,"max"),n=i&&i>e?i:e;return s&&n>s?s:n},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),o=this._daylightSavingAdjust(new Date(i,s+(0>e?e:n[0]*n[1]),1));return 0>e&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(t,o)},_isInRange:function(t,e){var i,s,n=this._getMinMaxDate(t,"min"),o=this._getMinMaxDate(t,"max"),a=null,r=null,l=this._get(t,"yearRange");return l&&(i=l.split(":"),s=(new Date).getFullYear(),a=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||e.getTime()>=n.getTime())&&(!o||e.getTime()<=o.getTime())&&(!a||e.getFullYear()>=a)&&(!r||r>=e.getFullYear())},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),{shortYearCutoff:e,dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),t.fn.datepicker=function(e){if(!this.length)return this;t.datepicker.initialized||(t(document).mousedown(t.datepicker._checkExternalClick),t.datepicker.initialized=!0),0===t("#"+t.datepicker._mainDivId).length&&t("body").append(t.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof e||"isDisabled"!==e&&"getDate"!==e&&"widget"!==e?"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof e?t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this].concat(i)):t.datepicker._attachDatepicker(this,e)}):t.datepicker["_"+e+"Datepicker"].apply(t.datepicker,[this[0]].concat(i))},t.datepicker=new n,t.datepicker.initialized=!1,t.datepicker.uuid=(new Date).getTime(),t.datepicker.version="1.11.4",t.datepicker,t.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var i=t(this).css(e).offset().top;0>i&&t(this).css("top",e.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&t.fn.draggable&&this._makeDraggable(),this.options.resizable&&t.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var e=this.options.appendTo;return e&&(e.jquery||e.nodeType)?t(e):this.document.find(e||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),t=e.parent.children().eq(e.index),t.length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:t.noop,enable:t.noop,close:function(e){var i,s=this;if(this._isOpen&&this._trigger("beforeClose",e)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{i=this.document[0].activeElement,i&&"body"!==i.nodeName.toLowerCase()&&t(i).blur()}catch(n){}this._hide(this.uiDialog,this.options.hide,function(){s._trigger("close",e)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(e,i){var s=!1,n=this.uiDialog.siblings(".ui-front:visible").map(function(){return+t(this).css("z-index")}).get(),o=Math.max.apply(null,n);return o>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",o+1),s=!0),s&&!i&&this._trigger("focus",e),s},open:function(){var e=this;
return this._isOpen?(this._moveToTop()&&this._focusTabbable(),void 0):(this._isOpen=!0,this.opener=t(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){e._focusTabbable(),e._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"),void 0)},_focusTabbable:function(){var t=this._focusedElement;t||(t=this.element.find("[autofocus]")),t.length||(t=this.element.find(":tabbable")),t.length||(t=this.uiDialogButtonPane.find(":tabbable")),t.length||(t=this.uiDialogTitlebarClose.filter(":tabbable")),t.length||(t=this.uiDialog),t.eq(0).focus()},_keepFocus:function(e){function i(){var e=this.document[0].activeElement,i=this.uiDialog[0]===e||t.contains(this.uiDialog[0],e);i||this._focusTabbable()}e.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=t("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(e){if(this.options.closeOnEscape&&!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE)return e.preventDefault(),this.close(e),void 0;if(e.keyCode===t.ui.keyCode.TAB&&!e.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),s=i.filter(":first"),n=i.filter(":last");e.target!==n[0]&&e.target!==this.uiDialog[0]||e.shiftKey?e.target!==s[0]&&e.target!==this.uiDialog[0]||!e.shiftKey||(this._delay(function(){n.focus()}),e.preventDefault()):(this._delay(function(){s.focus()}),e.preventDefault())}},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var e;this.uiDialogTitlebar=t("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(e){t(e.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=t("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),e=t("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(e),this.uiDialog.attr({"aria-labelledby":e.attr("id")})},_title:function(t){this.options.title||t.html("&#160;"),t.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=t("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=t("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var e=this,i=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),t.isEmptyObject(i)||t.isArray(i)&&!i.length?(this.uiDialog.removeClass("ui-dialog-buttons"),void 0):(t.each(i,function(i,s){var n,o;s=t.isFunction(s)?{click:s,text:i}:s,s=t.extend({type:"button"},s),n=s.click,s.click=function(){n.apply(e.element[0],arguments)},o={icons:s.icons,text:s.showText},delete s.icons,delete s.showText,t("<button></button>",s).button(o).appendTo(e.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog),void 0)},_makeDraggable:function(){function e(t){return{position:t.position,offset:t.offset}}var i=this,s=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(s,n){t(this).addClass("ui-dialog-dragging"),i._blockFrames(),i._trigger("dragStart",s,e(n))},drag:function(t,s){i._trigger("drag",t,e(s))},stop:function(n,o){var a=o.offset.left-i.document.scrollLeft(),r=o.offset.top-i.document.scrollTop();s.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" "+"top"+(r>=0?"+":"")+r,of:i.window},t(this).removeClass("ui-dialog-dragging"),i._unblockFrames(),i._trigger("dragStop",n,e(o))}})},_makeResizable:function(){function e(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}var i=this,s=this.options,n=s.resizable,o=this.uiDialog.css("position"),a="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:s.maxWidth,maxHeight:s.maxHeight,minWidth:s.minWidth,minHeight:this._minHeight(),handles:a,start:function(s,n){t(this).addClass("ui-dialog-resizing"),i._blockFrames(),i._trigger("resizeStart",s,e(n))},resize:function(t,s){i._trigger("resize",t,e(s))},stop:function(n,o){var a=i.uiDialog.offset(),r=a.left-i.document.scrollLeft(),l=a.top-i.document.scrollTop();s.height=i.uiDialog.height(),s.width=i.uiDialog.width(),s.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" "+"top"+(l>=0?"+":"")+l,of:i.window},t(this).removeClass("ui-dialog-resizing"),i._unblockFrames(),i._trigger("resizeStop",n,e(o))}}).css("position",o)},_trackFocus:function(){this._on(this.widget(),{focusin:function(e){this._makeFocusTarget(),this._focusedElement=t(e.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),i=t.inArray(this,e);-1!==i&&e.splice(i,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");return t||(t=[],this.document.data("ui-dialog-instances",t)),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(e){var i=this,s=!1,n={};t.each(e,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(s=!0),t in i.resizableRelatedOptions&&(n[t]=e)}),s&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(t,e){var i,s,n=this.uiDialog;"dialogClass"===t&&n.removeClass(this.options.dialogClass).addClass(e),"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:""+e}),"draggable"===t&&(i=n.is(":data(ui-draggable)"),i&&!e&&n.draggable("destroy"),!i&&e&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&(s=n.is(":data(ui-resizable)"),s&&!e&&n.resizable("destroy"),s&&"string"==typeof e&&n.resizable("option","handles",e),s||e===!1||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var e=t(this);return t("<div>").css({position:"absolute",width:e.outerWidth(),height:e.outerHeight()}).appendTo(e.parent()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(e){return t(e.target).closest(".ui-dialog").length?!0:!!t(e.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var e=!0;this._delay(function(){e=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(t){e||this._allowInteraction(t)||(t.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=t("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var t=this.document.data("ui-dialog-overlays")-1;t?this.document.data("ui-dialog-overlays",t):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}}),t.widget("ui.progressbar",{version:"1.11.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=t("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(t){return void 0===t?this.options.value:(this.options.value=this._constrainedValue(t),this._refreshValue(),void 0)},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=t===!1,"number"!=typeof t&&(t=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,t))},_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!e).attr("aria-disabled",e),this._super(t,e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var e=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||e>this.min).toggleClass("ui-corner-right",e===this.options.max).width(i.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=t("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":e}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),e===this.options.max&&this._trigger("complete")}}),t.widget("ui.selectmenu",{version:"1.11.4",defaultElement:"<select>",options:{appendTo:null,disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:null,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this.options.disabled&&this.disable()},_drawButton:function(){var e=this;this.label=t("label[for='"+this.ids.element+"']").attr("for",this.ids.button),this._on(this.label,{click:function(t){this.button.focus(),t.preventDefault()}}),this.element.hide(),this.button=t("<span>",{"class":"ui-selectmenu-button ui-widget ui-state-default ui-corner-all",tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true"}).insertAfter(this.element),t("<span>",{"class":"ui-icon "+this.options.icons.button}).prependTo(this.button),this.buttonText=t("<span>",{"class":"ui-selectmenu-text"}).appendTo(this.button),this._setText(this.buttonText,this.element.find("option:selected").text()),this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e.menuItems||e._refreshMenu()}),this._hoverable(this.button),this._focusable(this.button)},_drawMenu:function(){var e=this;this.menu=t("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=t("<div>",{"class":"ui-selectmenu-menu ui-front"}).append(this.menu).appendTo(this._appendTo()),this.menuInstance=this.menu.menu({role:"listbox",select:function(t,i){t.preventDefault(),e._setSelection(),e._select(i.item.data("ui-selectmenu-item"),t)},focus:function(t,i){var s=i.item.data("ui-selectmenu-item");null!=e.focusIndex&&s.index!==e.focusIndex&&(e._trigger("focus",t,{item:s}),e.isOpen||e._select(s,t)),e.focusIndex=s.index,e.button.attr("aria-activedescendant",e.menuItems.eq(s.index).attr("id"))}}).menu("instance"),this.menu.addClass("ui-corner-bottom").removeClass("ui-corner-all"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this._setText(this.buttonText,this._getSelectedItem().text()),this.options.width||this._resizeButton()},_refreshMenu:function(){this.menu.empty();var t,e=this.element.find("option");e.length&&(this._parseOptions(e),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup"),t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this.menuItems?(this.menu.find(".ui-state-focus").removeClass("ui-state-focus"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t))},_position:function(){this.menuWrap.position(t.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderMenu:function(e,i){var s=this,n="";t.each(i,function(i,o){o.optgroup!==n&&(t("<li>",{"class":"ui-selectmenu-optgroup ui-menu-divider"+(o.element.parent("optgroup").prop("disabled")?" ui-state-disabled":""),text:o.optgroup}).appendTo(e),n=o.optgroup),s._renderItemData(e,o)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(e,i){var s=t("<li>");return i.disabled&&s.addClass("ui-state-disabled"),this._setText(s,i.label),s.appendTo(e)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,s,n=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex):(i=this.menuItems.eq(this.element[0].selectedIndex),n+=":not(.ui-state-disabled)"),s="first"===t||"last"===t?i["first"===t?"prevAll":"nextAll"](n).eq(-1):i[t+"All"](n).eq(0),s.length&&this.menuInstance.focus(e,s)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex)},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?(t=window.getSelection(),t.removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(e){this.isOpen&&(t(e.target).closest(".ui-selectmenu-menu, #"+this.ids.button).length||this.close(e))}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection(),t.rangeCount&&(this.range=t.getRangeAt(0))):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(e){var i=!0;switch(e.keyCode){case t.ui.keyCode.TAB:case t.ui.keyCode.ESCAPE:this.close(e),i=!1;break;case t.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(e);break;case t.ui.keyCode.UP:e.altKey?this._toggle(e):this._move("prev",e);break;case t.ui.keyCode.DOWN:e.altKey?this._toggle(e):this._move("next",e);break;case t.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(e):this._toggle(e);break;case t.ui.keyCode.LEFT:this._move("prev",e);break;case t.ui.keyCode.RIGHT:this._move("next",e);break;case t.ui.keyCode.HOME:case t.ui.keyCode.PAGE_UP:this._move("first",e);break;case t.ui.keyCode.END:case t.ui.keyCode.PAGE_DOWN:this._move("last",e);break;default:this.menu.trigger(e),i=!1}i&&e.preventDefault()}},_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex);e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this._setText(this.buttonText,t.label),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){var e=this.menuItems.eq(t.index).attr("id");this.button.attr({"aria-labelledby":e,"aria-activedescendant":e}),this.menu.attr("aria-activedescendant",e)},_setOption:function(t,e){"icons"===t&&this.button.find("span.ui-icon").removeClass(this.options.icons.button).addClass(e.button),this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"disabled"===t&&(this.menuInstance.option("disabled",e),this.button.toggleClass("ui-state-disabled",e).attr("aria-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)),"width"===t&&this._resizeButton()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front")),e.length||(e=this.document[0].body),e},_toggleAttr:function(){this.button.toggleClass("ui-corner-top",this.isOpen).toggleClass("ui-corner-all",!this.isOpen).attr("aria-expanded",this.isOpen),this.menuWrap.toggleClass("ui-selectmenu-open",this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;t||(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){return{disabled:this.element.prop("disabled")}},_parseOptions:function(e){var i=[];e.each(function(e,s){var n=t(s),o=n.parent("optgroup");i.push({element:n,index:e,value:n.val(),label:n.text(),optgroup:o.attr("label")||"",disabled:o.prop("disabled")||n.prop("disabled")})}),this.items=i},_destroy:function(){this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.label.attr("for",this.ids.element)}}),t.widget("ui.slider",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,s=this.options,n=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<span class='ui-slider-handle ui-state-default ui-corner-all' tabindex='0'></span>",a=[];for(i=s.values&&s.values.length||1,n.length>i&&(n.slice(i).remove(),n=n.slice(0,i)),e=n.length;i>e;e++)a.push(o);this.handles=n.add(t(a.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,i="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,s,n,o,a,r,l,h,c=this,u=this.options;return u.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},s=this._normValueFromMouse(i),n=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var i=Math.abs(s-c.values(e));(n>i||n===i&&(e===c._lastChangedValue||c.values(e)===u.min))&&(n=i,o=t(this),a=e)}),r=this._start(e,a),r===!1?!1:(this._mouseSliding=!0,this._handleIndex=a,o.addClass("ui-state-active").focus(),l=o.offset(),h=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=h?{left:0,top:0}:{left:e.pageX-l.left-o.width()/2,top:e.pageY-l.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,a,s),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,s,n,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),s=i/e,s>1&&(s=1),0>s&&(s=0),"vertical"===this.orientation&&(s=1-s),n=this._valueMax()-this._valueMin(),o=this._valueMin()+s*n,this._trimAlignValue(o)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var s,n,o;this.options.values&&this.options.values.length?(s=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&i>s||1===e&&s>i)&&(i=s),i!==this.values(e)&&(n=this.values(),n[e]=i,o=this._trigger("slide",t,{handle:this.handles[e],value:i,values:n}),s=this.values(e?0:1),o!==!1&&this.values(e,i))):i!==this.value()&&(o=this._trigger("slide",t,{handle:this.handles[e],value:i}),o!==!1&&this.value(i))},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(e,i){var s,n,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),this._change(null,e),void 0;if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(s=this.options.values,n=arguments[0],o=0;s.length>o;o+=1)s[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var s,n=0;switch("range"===e&&this.options.range===!0&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(n=this.options.values.length),"disabled"===e&&this.element.toggleClass("ui-state-disabled",!!i),this._super(e,i),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue(),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),s=0;n>s;s+=1)this._change(null,s);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,s;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),s=0;i.length>s;s+=1)i[s]=this._trimAlignValue(i[s]);return i}return[]},_trimAlignValue:function(t){if(this._valueMin()>=t)return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=i>0?e:-e),parseFloat(s.toFixed(5))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step,s=Math.floor(+(t-e).toFixed(this._precision())/i)*i;t=s+e,this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var e,i,s,n,o,a=this.options.range,r=this.options,l=this,h=this._animateOff?!1:r.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(s){i=100*((l.values(s)-l._valueMin())/(l._valueMax()-l._valueMin())),c["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[h?"animate":"css"](c,r.animate),l.options.range===!0&&("horizontal"===l.orientation?(0===s&&l.range.stop(1,1)[h?"animate":"css"]({left:i+"%"},r.animate),1===s&&l.range[h?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:r.animate})):(0===s&&l.range.stop(1,1)[h?"animate":"css"]({bottom:i+"%"},r.animate),1===s&&l.range[h?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:r.animate}))),e=i}):(s=this.value(),n=this._valueMin(),o=this._valueMax(),i=o!==n?100*((s-n)/(o-n)):0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[h?"animate":"css"](c,r.animate),"min"===a&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:i+"%"},r.animate),"max"===a&&"horizontal"===this.orientation&&this.range[h?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:r.animate}),"min"===a&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:i+"%"},r.animate),"max"===a&&"vertical"===this.orientation&&this.range[h?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:r.animate}))},_handleEvents:{keydown:function(e){var i,s,n,o,a=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass("ui-state-active"),i=this._start(e,a),i===!1))return}switch(o=this.options.step,s=n=this.options.values&&this.options.values.length?this.values(a):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(s+(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(s-(this._valueMax()-this._valueMin())/this.numPages);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(s===this._valueMax())return;n=this._trimAlignValue(s+o);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(s===this._valueMin())return;n=this._trimAlignValue(s-o)}this._slide(e,a,n)},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}}),t.widget("ui.spinner",{version:"1.11.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},i=this.element;return t.each(["min","max","step"],function(t,s){var n=i.attr(s);void 0!==n&&n.length&&(e[s]=n)}),e},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){return this.cancelBlur?(delete this.cancelBlur,void 0):(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",t),void 0)},mousewheel:function(t,e){if(e){if(!this.spinning&&!this._start(t))return!1;this._spin((e>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(e){function i(){var t=this.element[0]===this.document[0].activeElement;t||(this.element.focus(),this.previous=s,this._delay(function(){this.previous=s}))}var s;s=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),this._start(e)!==!1&&this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){return t(e.currentTarget).hasClass("ui-state-active")?this._start(e)===!1?!1:(this._repeat(null,t(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e),void 0):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var t=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=t.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*t.height())&&t.height()>0&&t.height(t.height()),this.options.disabled&&this.disable()
},_keydown:function(e){var i=this.options,s=t.ui.keyCode;switch(e.keyCode){case s.UP:return this._repeat(null,1,e),!0;case s.DOWN:return this._repeat(null,-1,e),!0;case s.PAGE_UP:return this._repeat(null,i.page,e),!0;case s.PAGE_DOWN:return this._repeat(null,-i.page,e),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span>"+"</a>"+"<a class='ui-spinner-button ui-spinner-down ui-corner-br'>"+"<span class='ui-icon "+this.options.icons.down+"'>&#9660;</span>"+"</a>"},_start:function(t){return this.spinning||this._trigger("start",t)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&this._trigger("spin",e,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(e){var i=this.options.incremental;return i?t.isFunction(i)?i(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},_precisionOf:function(t){var e=""+t,i=e.indexOf(".");return-1===i?0:e.length-i-1},_adjustValue:function(t){var e,i,s=this.options;return e=null!==s.min?s.min:0,i=t-e,i=Math.round(i/s.step)*s.step,t=e+i,t=parseFloat(t.toFixed(this._precision())),null!==s.max&&t>s.max?s.max:null!==s.min&&s.min>t?s.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,e){if("culture"===t||"numberFormat"===t){var i=this._parse(this.element.val());return this.options[t]=e,this.element.val(this._format(i)),void 0}("max"===t||"min"===t||"step"===t)&&"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(e.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(e.down)),this._super(t,e),"disabled"===t&&(this.widget().toggleClass("ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable"))},_setOptions:l(function(t){this._super(t)}),_parse:function(t){return"string"==typeof t&&""!==t&&(t=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t),""===t||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null===t?!1:t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&(i=this._parse(t),null!==i&&(e||(i=this._adjustValue(i)),t=this._format(i))),this.element.val(t),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:l(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:l(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:l(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:l(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){return arguments.length?(l(this._value).call(this,t),void 0):this._parse(this.element.val())},widget:function(){return this.uiSpinner}});var v="ui-effects-",b=t;t.effects={effect:{}},function(t,e){function i(t,e,i){var s=u[e.type]||{};return null==t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:0>t?0:t>s.max?s.max:t)}function s(i){var s=h(),n=s._rgba=[];return i=i.toLowerCase(),f(l,function(t,o){var a,r=o.re.exec(i),l=r&&o.parse(r),h=o.space||"rgba";return l?(a=s[h](l),s[c[h].cache]=a[c[h].cache],n=s._rgba=a._rgba,!1):e}),n.length?("0,0,0,0"===n.join()&&t.extend(n,o.transparent),s):o[i]}function n(t,e,i){return i=(i+1)%1,1>6*i?t+6*(e-t)*i:1>2*i?e:2>3*i?t+6*(e-t)*(2/3-i):t}var o,a="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",r=/^([\-+])=\s*(\d+\.?\d*)/,l=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],h=t.Color=function(e,i,s,n){return new t.Color.fn.parse(e,i,s,n)},c={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},u={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},d=h.support={},p=t("<p>")[0],f=t.each;p.style.cssText="background-color:rgba(1,1,1,.5)",d.rgba=p.style.backgroundColor.indexOf("rgba")>-1,f(c,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),h.fn=t.extend(h.prototype,{parse:function(n,a,r,l){if(n===e)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=t(n).css(a),a=e);var u=this,d=t.type(n),p=this._rgba=[];return a!==e&&(n=[n,a,r,l],d="array"),"string"===d?this.parse(s(n)||o._default):"array"===d?(f(c.rgba.props,function(t,e){p[e.idx]=i(n[e.idx],e)}),this):"object"===d?(n instanceof h?f(c,function(t,e){n[e.cache]&&(u[e.cache]=n[e.cache].slice())}):f(c,function(e,s){var o=s.cache;f(s.props,function(t,e){if(!u[o]&&s.to){if("alpha"===t||null==n[t])return;u[o]=s.to(u._rgba)}u[o][e.idx]=i(n[t],e,!0)}),u[o]&&0>t.inArray(null,u[o].slice(0,3))&&(u[o][3]=1,s.from&&(u._rgba=s.from(u[o])))}),this):e},is:function(t){var i=h(t),s=!0,n=this;return f(c,function(t,o){var a,r=i[o.cache];return r&&(a=n[o.cache]||o.to&&o.to(n._rgba)||[],f(o.props,function(t,i){return null!=r[i.idx]?s=r[i.idx]===a[i.idx]:e})),s}),s},_space:function(){var t=[],e=this;return f(c,function(i,s){e[s.cache]&&t.push(i)}),t.pop()},transition:function(t,e){var s=h(t),n=s._space(),o=c[n],a=0===this.alpha()?h("transparent"):this,r=a[o.cache]||o.to(a._rgba),l=r.slice();return s=s[o.cache],f(o.props,function(t,n){var o=n.idx,a=r[o],h=s[o],c=u[n.type]||{};null!==h&&(null===a?l[o]=h:(c.mod&&(h-a>c.mod/2?a+=c.mod:a-h>c.mod/2&&(a-=c.mod)),l[o]=i((h-a)*e+a,n)))}),this[n](l)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),s=i.pop(),n=h(e)._rgba;return h(t.map(i,function(t,e){return(1-s)*n[e]+s*t}))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),s=i.pop();return e&&i.push(~~(255*s)),"#"+t.map(i,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),h.fn.parse.prototype=h.fn,c.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,s=t[0]/255,n=t[1]/255,o=t[2]/255,a=t[3],r=Math.max(s,n,o),l=Math.min(s,n,o),h=r-l,c=r+l,u=.5*c;return e=l===r?0:s===r?60*(n-o)/h+360:n===r?60*(o-s)/h+120:60*(s-n)/h+240,i=0===h?0:.5>=u?h/c:h/(2-c),[Math.round(e)%360,i,u,null==a?1:a]},c.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],s=t[2],o=t[3],a=.5>=s?s*(1+i):s+i-s*i,r=2*s-a;return[Math.round(255*n(r,a,e+1/3)),Math.round(255*n(r,a,e)),Math.round(255*n(r,a,e-1/3)),o]},f(c,function(s,n){var o=n.props,a=n.cache,l=n.to,c=n.from;h.fn[s]=function(s){if(l&&!this[a]&&(this[a]=l(this._rgba)),s===e)return this[a].slice();var n,r=t.type(s),u="array"===r||"object"===r?s:arguments,d=this[a].slice();return f(o,function(t,e){var s=u["object"===r?t:e.idx];null==s&&(s=d[e.idx]),d[e.idx]=i(s,e)}),c?(n=h(c(d)),n[a]=d,n):h(d)},f(o,function(e,i){h.fn[e]||(h.fn[e]=function(n){var o,a=t.type(n),l="alpha"===e?this._hsla?"hsla":"rgba":s,h=this[l](),c=h[i.idx];return"undefined"===a?c:("function"===a&&(n=n.call(this,c),a=t.type(n)),null==n&&i.empty?this:("string"===a&&(o=r.exec(n),o&&(n=c+parseFloat(o[2])*("+"===o[1]?1:-1))),h[i.idx]=n,this[l](h)))})})}),h.hook=function(e){var i=e.split(" ");f(i,function(e,i){t.cssHooks[i]={set:function(e,n){var o,a,r="";if("transparent"!==n&&("string"!==t.type(n)||(o=s(n)))){if(n=h(o||n),!d.rgba&&1!==n._rgba[3]){for(a="backgroundColor"===i?e.parentNode:e;(""===r||"transparent"===r)&&a&&a.style;)try{r=t.css(a,"backgroundColor"),a=a.parentNode}catch(l){}n=n.blend(r&&"transparent"!==r?r:"_default")}n=n.toRgbaString()}try{e.style[i]=n}catch(l){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=h(e.elem,i),e.end=h(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}})},h.hook(a),t.cssHooks.borderColor={expand:function(t){var e={};return f(["Top","Right","Bottom","Left"],function(i,s){e["border"+s+"Color"]=t}),e}},o=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(b),function(){function e(e){var i,s,n=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,o={};if(n&&n.length&&n[0]&&n[n[0]])for(s=n.length;s--;)i=n[s],"string"==typeof n[i]&&(o[t.camelCase(i)]=n[i]);else for(i in n)"string"==typeof n[i]&&(o[i]=n[i]);return o}function i(e,i){var s,o,a={};for(s in i)o=i[s],e[s]!==o&&(n[s]||(t.fx.step[s]||!isNaN(parseFloat(o)))&&(a[s]=o));return a}var s=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(b.style(t.elem,i,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(n,o,a,r){var l=t.speed(o,a,r);return this.queue(function(){var o,a=t(this),r=a.attr("class")||"",h=l.children?a.find("*").addBack():a;h=h.map(function(){var i=t(this);return{el:i,start:e(this)}}),o=function(){t.each(s,function(t,e){n[e]&&a[e+"Class"](n[e])})},o(),h=h.map(function(){return this.end=e(this.el[0]),this.diff=i(this.start,this.end),this}),a.attr("class",r),h=h.map(function(){var e=this,i=t.Deferred(),s=t.extend({},l,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,s),i.promise()}),t.when.apply(t,h.get()).done(function(){o(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),l.complete.call(a[0])})})},t.fn.extend({addClass:function(e){return function(i,s,n,o){return s?t.effects.animateClass.call(this,{add:i},s,n,o):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(i,s,n,o){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},s,n,o):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,s,n,o,a){return"boolean"==typeof s||void 0===s?n?t.effects.animateClass.call(this,s?{add:i}:{remove:i},n,o,a):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},s,n,o)}}(t.fn.toggleClass),switchClass:function(e,i,s,n,o){return t.effects.animateClass.call(this,{add:i,remove:e},s,n,o)}})}(),function(){function e(e,i,s,n){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(n=i,s=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(n=s,s=i,i={}),t.isFunction(s)&&(n=s,s=null),i&&t.extend(e,i),s=s||i.duration,e.duration=t.fx.off?0:"number"==typeof s?s:s in t.fx.speeds?t.fx.speeds[s]:t.fx.speeds._default,e.complete=n||i.complete,e}function i(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}t.extend(t.effects,{version:"1.11.4",save:function(t,e){for(var i=0;e.length>i;i++)null!==e[i]&&t.data(v+e[i],t[0].style[e[i]])},restore:function(t,e){var i,s;for(s=0;e.length>s;s++)null!==e[s]&&(i=t.data(v+e[s]),void 0===i&&(i=""),t.css(e[s],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,s;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":s=0;break;case"center":s=.5;break;case"right":s=1;break;default:s=t[1]/e.width}return{x:s,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},s=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),n={width:e.width(),height:e.height()},o=document.activeElement;try{o.id}catch(a){o=document.body}return e.wrap(s),(e[0]===o||t.contains(e[0],o))&&t(o).focus(),s=e.parent(),"static"===e.css("position")?(s.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,s){i[s]=e.css(s),isNaN(parseInt(i[s],10))&&(i[s]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(n),s.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,s,n){return n=n||{},t.each(i,function(t,i){var o=e.cssUnit(i);o[0]>0&&(n[i]=o[0]*s+o[1])}),n}}),t.fn.extend({effect:function(){function i(e){function i(){t.isFunction(o)&&o.call(n[0]),t.isFunction(e)&&e()}var n=t(this),o=s.complete,r=s.mode;(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),i()):a.call(n[0],s,i)}var s=e.apply(this,arguments),n=s.mode,o=s.queue,a=t.effects.effect[s.effect];return t.fx.off||!a?n?this[n](s.duration,s.complete):this.each(function(){s.complete&&s.complete.call(this)}):o===!1?this.each(i):this.queue(o||"fx",i)},show:function(t){return function(s){if(i(s))return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(t.fn.show),hide:function(t){return function(s){if(i(s))return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(t.fn.hide),toggle:function(t){return function(s){if(i(s)||"boolean"==typeof s)return t.apply(this,arguments);var n=e.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),s=[];return t.each(["em","px","%","pt"],function(t,e){i.indexOf(e)>0&&(s=[parseFloat(i),e])}),s}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,i){e[i]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;((e=Math.pow(2,--i))-1)/11>t;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?i(2*t)/2:1-i(-2*t+2)/2}})}(),t.effects,t.effects.effect.blind=function(e,i){var s,n,o,a=t(this),r=/up|down|vertical/,l=/up|left|vertical|horizontal/,h=["position","top","bottom","left","right","height","width"],c=t.effects.setMode(a,e.mode||"hide"),u=e.direction||"up",d=r.test(u),p=d?"height":"width",f=d?"top":"left",g=l.test(u),m={},_="show"===c;a.parent().is(".ui-effects-wrapper")?t.effects.save(a.parent(),h):t.effects.save(a,h),a.show(),s=t.effects.createWrapper(a).css({overflow:"hidden"}),n=s[p](),o=parseFloat(s.css(f))||0,m[p]=_?n:0,g||(a.css(d?"bottom":"right",0).css(d?"top":"left","auto").css({position:"absolute"}),m[f]=_?o:n+o),_&&(s.css(p,0),g||s.css(f,o+n)),s.animate(m,{duration:e.duration,easing:e.easing,queue:!1,complete:function(){"hide"===c&&a.hide(),t.effects.restore(a,h),t.effects.removeWrapper(a),i()}})},t.effects.effect.bounce=function(e,i){var s,n,o,a=t(this),r=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(a,e.mode||"effect"),h="hide"===l,c="show"===l,u=e.direction||"up",d=e.distance,p=e.times||5,f=2*p+(c||h?1:0),g=e.duration/f,m=e.easing,_="up"===u||"down"===u?"top":"left",v="up"===u||"left"===u,b=a.queue(),y=b.length;for((c||h)&&r.push("opacity"),t.effects.save(a,r),a.show(),t.effects.createWrapper(a),d||(d=a["top"===_?"outerHeight":"outerWidth"]()/3),c&&(o={opacity:1},o[_]=0,a.css("opacity",0).css(_,v?2*-d:2*d).animate(o,g,m)),h&&(d/=Math.pow(2,p-1)),o={},o[_]=0,s=0;p>s;s++)n={},n[_]=(v?"-=":"+=")+d,a.animate(n,g,m).animate(o,g,m),d=h?2*d:d/2;h&&(n={opacity:0},n[_]=(v?"-=":"+=")+d,a.animate(n,g,m)),a.queue(function(){h&&a.hide(),t.effects.restore(a,r),t.effects.removeWrapper(a),i()}),y>1&&b.splice.apply(b,[1,0].concat(b.splice(y,f+1))),a.dequeue()},t.effects.effect.clip=function(e,i){var s,n,o,a=t(this),r=["position","top","bottom","left","right","height","width"],l=t.effects.setMode(a,e.mode||"hide"),h="show"===l,c=e.direction||"vertical",u="vertical"===c,d=u?"height":"width",p=u?"top":"left",f={};t.effects.save(a,r),a.show(),s=t.effects.createWrapper(a).css({overflow:"hidden"}),n="IMG"===a[0].tagName?s:a,o=n[d](),h&&(n.css(d,0),n.css(p,o/2)),f[d]=h?o:0,f[p]=h?0:o/2,n.animate(f,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){h||a.hide(),t.effects.restore(a,r),t.effects.removeWrapper(a),i()}})},t.effects.effect.drop=function(e,i){var s,n=t(this),o=["position","top","bottom","left","right","opacity","height","width"],a=t.effects.setMode(n,e.mode||"hide"),r="show"===a,l=e.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l?"pos":"neg",u={opacity:r?1:0};t.effects.save(n,o),n.show(),t.effects.createWrapper(n),s=e.distance||n["top"===h?"outerHeight":"outerWidth"](!0)/2,r&&n.css("opacity",0).css(h,"pos"===c?-s:s),u[h]=(r?"pos"===c?"+=":"-=":"pos"===c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===a&&n.hide(),t.effects.restore(n,o),t.effects.removeWrapper(n),i()}})},t.effects.effect.explode=function(e,i){function s(){b.push(this),b.length===u*d&&n()}function n(){p.css({visibility:"visible"}),t(b).remove(),g||p.hide(),i()}var o,a,r,l,h,c,u=e.pieces?Math.round(Math.sqrt(e.pieces)):3,d=u,p=t(this),f=t.effects.setMode(p,e.mode||"hide"),g="show"===f,m=p.show().css("visibility","hidden").offset(),_=Math.ceil(p.outerWidth()/d),v=Math.ceil(p.outerHeight()/u),b=[];for(o=0;u>o;o++)for(l=m.top+o*v,c=o-(u-1)/2,a=0;d>a;a++)r=m.left+a*_,h=a-(d-1)/2,p.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-a*_,top:-o*v}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:_,height:v,left:r+(g?h*_:0),top:l+(g?c*v:0),opacity:g?0:1}).animate({left:r+(g?0:h*_),top:l+(g?0:c*v),opacity:g?1:0},e.duration||500,e.easing,s)},t.effects.effect.fade=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"toggle");s.animate({opacity:n},{queue:!1,duration:e.duration,easing:e.easing,complete:i})},t.effects.effect.fold=function(e,i){var s,n,o=t(this),a=["position","top","bottom","left","right","height","width"],r=t.effects.setMode(o,e.mode||"hide"),l="show"===r,h="hide"===r,c=e.size||15,u=/([0-9]+)%/.exec(c),d=!!e.horizFirst,p=l!==d,f=p?["width","height"]:["height","width"],g=e.duration/2,m={},_={};t.effects.save(o,a),o.show(),s=t.effects.createWrapper(o).css({overflow:"hidden"}),n=p?[s.width(),s.height()]:[s.height(),s.width()],u&&(c=parseInt(u[1],10)/100*n[h?0:1]),l&&s.css(d?{height:0,width:c}:{height:c,width:0}),m[f[0]]=l?n[0]:c,_[f[1]]=l?n[1]:0,s.animate(m,g,e.easing).animate(_,g,e.easing,function(){h&&o.hide(),t.effects.restore(o,a),t.effects.removeWrapper(o),i()})},t.effects.effect.highlight=function(e,i){var s=t(this),n=["backgroundImage","backgroundColor","opacity"],o=t.effects.setMode(s,e.mode||"show"),a={backgroundColor:s.css("backgroundColor")};"hide"===o&&(a.opacity=0),t.effects.save(s,n),s.show().css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(a,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===o&&s.hide(),t.effects.restore(s,n),i()}})},t.effects.effect.size=function(e,i){var s,n,o,a=t(this),r=["position","top","bottom","left","right","width","height","overflow","opacity"],l=["position","top","bottom","left","right","overflow","opacity"],h=["width","height","overflow"],c=["fontSize"],u=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],p=t.effects.setMode(a,e.mode||"effect"),f=e.restore||"effect"!==p,g=e.scale||"both",m=e.origin||["middle","center"],_=a.css("position"),v=f?r:l,b={height:0,width:0,outerHeight:0,outerWidth:0};"show"===p&&a.show(),s={height:a.height(),width:a.width(),outerHeight:a.outerHeight(),outerWidth:a.outerWidth()},"toggle"===e.mode&&"show"===p?(a.from=e.to||b,a.to=e.from||s):(a.from=e.from||("show"===p?b:s),a.to=e.to||("hide"===p?b:s)),o={from:{y:a.from.height/s.height,x:a.from.width/s.width},to:{y:a.to.height/s.height,x:a.to.width/s.width}},("box"===g||"both"===g)&&(o.from.y!==o.to.y&&(v=v.concat(u),a.from=t.effects.setTransition(a,u,o.from.y,a.from),a.to=t.effects.setTransition(a,u,o.to.y,a.to)),o.from.x!==o.to.x&&(v=v.concat(d),a.from=t.effects.setTransition(a,d,o.from.x,a.from),a.to=t.effects.setTransition(a,d,o.to.x,a.to))),("content"===g||"both"===g)&&o.from.y!==o.to.y&&(v=v.concat(c).concat(h),a.from=t.effects.setTransition(a,c,o.from.y,a.from),a.to=t.effects.setTransition(a,c,o.to.y,a.to)),t.effects.save(a,v),a.show(),t.effects.createWrapper(a),a.css("overflow","hidden").css(a.from),m&&(n=t.effects.getBaseline(m,s),a.from.top=(s.outerHeight-a.outerHeight())*n.y,a.from.left=(s.outerWidth-a.outerWidth())*n.x,a.to.top=(s.outerHeight-a.to.outerHeight)*n.y,a.to.left=(s.outerWidth-a.to.outerWidth)*n.x),a.css(a.from),("content"===g||"both"===g)&&(u=u.concat(["marginTop","marginBottom"]).concat(c),d=d.concat(["marginLeft","marginRight"]),h=r.concat(u).concat(d),a.find("*[width]").each(function(){var i=t(this),s={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};f&&t.effects.save(i,h),i.from={height:s.height*o.from.y,width:s.width*o.from.x,outerHeight:s.outerHeight*o.from.y,outerWidth:s.outerWidth*o.from.x},i.to={height:s.height*o.to.y,width:s.width*o.to.x,outerHeight:s.height*o.to.y,outerWidth:s.width*o.to.x},o.from.y!==o.to.y&&(i.from=t.effects.setTransition(i,u,o.from.y,i.from),i.to=t.effects.setTransition(i,u,o.to.y,i.to)),o.from.x!==o.to.x&&(i.from=t.effects.setTransition(i,d,o.from.x,i.from),i.to=t.effects.setTransition(i,d,o.to.x,i.to)),i.css(i.from),i.animate(i.to,e.duration,e.easing,function(){f&&t.effects.restore(i,h)})})),a.animate(a.to,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){0===a.to.opacity&&a.css("opacity",a.from.opacity),"hide"===p&&a.hide(),t.effects.restore(a,v),f||("static"===_?a.css({position:"relative",top:a.to.top,left:a.to.left}):t.each(["top","left"],function(t,e){a.css(e,function(e,i){var s=parseInt(i,10),n=t?a.to.left:a.to.top;return"auto"===i?n+"px":s+n+"px"})})),t.effects.removeWrapper(a),i()}})},t.effects.effect.scale=function(e,i){var s=t(this),n=t.extend(!0,{},e),o=t.effects.setMode(s,e.mode||"effect"),a=parseInt(e.percent,10)||(0===parseInt(e.percent,10)?0:"hide"===o?0:100),r=e.direction||"both",l=e.origin,h={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()},c={y:"horizontal"!==r?a/100:1,x:"vertical"!==r?a/100:1};n.effect="size",n.queue=!1,n.complete=i,"effect"!==o&&(n.origin=l||["middle","center"],n.restore=!0),n.from=e.from||("show"===o?{height:0,width:0,outerHeight:0,outerWidth:0}:h),n.to={height:h.height*c.y,width:h.width*c.x,outerHeight:h.outerHeight*c.y,outerWidth:h.outerWidth*c.x},n.fade&&("show"===o&&(n.from.opacity=0,n.to.opacity=1),"hide"===o&&(n.from.opacity=1,n.to.opacity=0)),s.effect(n)},t.effects.effect.puff=function(e,i){var s=t(this),n=t.effects.setMode(s,e.mode||"hide"),o="hide"===n,a=parseInt(e.percent,10)||150,r=a/100,l={height:s.height(),width:s.width(),outerHeight:s.outerHeight(),outerWidth:s.outerWidth()};t.extend(e,{effect:"scale",queue:!1,fade:!0,mode:n,complete:i,percent:o?a:100,from:o?l:{height:l.height*r,width:l.width*r,outerHeight:l.outerHeight*r,outerWidth:l.outerWidth*r}}),s.effect(e)},t.effects.effect.pulsate=function(e,i){var s,n=t(this),o=t.effects.setMode(n,e.mode||"show"),a="show"===o,r="hide"===o,l=a||"hide"===o,h=2*(e.times||5)+(l?1:0),c=e.duration/h,u=0,d=n.queue(),p=d.length;for((a||!n.is(":visible"))&&(n.css("opacity",0).show(),u=1),s=1;h>s;s++)n.animate({opacity:u},c,e.easing),u=1-u;n.animate({opacity:u},c,e.easing),n.queue(function(){r&&n.hide(),i()}),p>1&&d.splice.apply(d,[1,0].concat(d.splice(p,h+1))),n.dequeue()},t.effects.effect.shake=function(e,i){var s,n=t(this),o=["position","top","bottom","left","right","height","width"],a=t.effects.setMode(n,e.mode||"effect"),r=e.direction||"left",l=e.distance||20,h=e.times||3,c=2*h+1,u=Math.round(e.duration/c),d="up"===r||"down"===r?"top":"left",p="up"===r||"left"===r,f={},g={},m={},_=n.queue(),v=_.length;for(t.effects.save(n,o),n.show(),t.effects.createWrapper(n),f[d]=(p?"-=":"+=")+l,g[d]=(p?"+=":"-=")+2*l,m[d]=(p?"-=":"+=")+2*l,n.animate(f,u,e.easing),s=1;h>s;s++)n.animate(g,u,e.easing).animate(m,u,e.easing);n.animate(g,u,e.easing).animate(f,u/2,e.easing).queue(function(){"hide"===a&&n.hide(),t.effects.restore(n,o),t.effects.removeWrapper(n),i()}),v>1&&_.splice.apply(_,[1,0].concat(_.splice(v,c+1))),n.dequeue()},t.effects.effect.slide=function(e,i){var s,n=t(this),o=["position","top","bottom","left","right","width","height"],a=t.effects.setMode(n,e.mode||"show"),r="show"===a,l=e.direction||"left",h="up"===l||"down"===l?"top":"left",c="up"===l||"left"===l,u={};t.effects.save(n,o),n.show(),s=e.distance||n["top"===h?"outerHeight":"outerWidth"](!0),t.effects.createWrapper(n).css({overflow:"hidden"}),r&&n.css(h,c?isNaN(s)?"-"+s:-s:s),u[h]=(r?c?"+=":"-=":c?"-=":"+=")+s,n.animate(u,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){"hide"===a&&n.hide(),t.effects.restore(n,o),t.effects.removeWrapper(n),i()}})},t.effects.effect.transfer=function(e,i){var s=t(this),n=t(e.to),o="fixed"===n.css("position"),a=t("body"),r=o?a.scrollTop():0,l=o?a.scrollLeft():0,h=n.offset(),c={top:h.top-r,left:h.left-l,height:n.innerHeight(),width:n.innerWidth()},u=s.offset(),d=t("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(e.className).css({top:u.top-r,left:u.left-l,height:s.innerHeight(),width:s.innerWidth(),position:o?"fixed":"absolute"}).animate(c,e.duration,e.easing,function(){d.remove(),i()})}});
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
/*
* jQuery timepicker addon
* By: Trent Richardson [http://trentrichardson.com]
* Version 0.7
* Last Modified: 10/7/2010
* 
* Copyright 2010 Trent Richardson
* Dual licensed under the MIT and GPL licenses.
* http://trentrichardson.com/Impromptu/GPL-LICENSE.txt
* http://trentrichardson.com/Impromptu/MIT-LICENSE.txt
* 
* HERES THE CSS:
* .ui-timepicker-div .ui-widget-header{ margin-bottom: 8px; }
* .ui-timepicker-div dl{ text-align: left; }
* .ui-timepicker-div dl dt{ height: 25px; }
* .ui-timepicker-div dl dd{ margin: -25px 0 10px 65px; }
* .ui-timepicker-div .ui_tpicker_hour div { padding-right: 2px; }
* .ui-timepicker-div .ui_tpicker_minute div { padding-right: 6px; }
* .ui-timepicker-div .ui_tpicker_second div { padding-right: 6px; }
* .ui-timepicker-div td { font-size: 90%; }
*/
(function($){
    if ($.timepicker) return;
    function Timepicker(singleton){
        if(typeof(singleton)==='boolean'&&singleton==true){this.regional=[];this.regional['']={currentText:'Now',ampm:false,timeFormat:'hh:mm tt',timeOnlyTitle:'Choose Time',timeText:'Time',hourText:'Hour',minuteText:'Minute',secondText:'Second'};this.defaults={showButtonPanel:true,timeOnly:false,showHour:true,showMinute:true,showSecond:false,showTime:true,stepHour:0.05,stepMinute:0.05,stepSecond:0.05,hour:0,minute:0,second:0,hourMin:0,minuteMin:0,secondMin:0,hourMax:23,minuteMax:59,secondMax:59,hourGrid:0,minuteGrid:0,secondGrid:0,alwaysSetTime:true};$.extend(this.defaults,this.regional['']);}else{this.defaults=$.extend({},$.timepicker.defaults);}};Timepicker.prototype={$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,hour:0,minute:0,second:0,ampm:'',formattedDate:'',formattedTime:'',formattedDateTime:'',addTimePicker:function(dp_inst){var tp_inst=this;var currDT;if((this.$altInput)&&this.$altInput!=null){currDT=this.$input.val()+' '+this.$altInput.val();}else{currDT=this.$input.val();}var regstr=this.defaults.timeFormat.toString().replace(/h{1,2}/ig,'(\\d?\\d)').replace(/m{1,2}/ig,'(\\d?\\d)').replace(/s{1,2}/ig,'(\\d?\\d)').replace(/t{1,2}/ig,'(am|pm|a|p)?').replace(/\s/g,'\\s?')+'$';if(!this.defaults.timeOnly){var dp_dateFormat=$.datepicker._get(dp_inst,'dateFormat');regstr='.{'+dp_dateFormat.length+',}\\s+'+regstr;}var order=this.getFormatPositions();var treg=currDT.match(new RegExp(regstr,'i'));if(treg){if(order.t!==-1){this.ampm=((treg[order.t]===undefined||treg[order.t].length===0)?'':(treg[order.t].charAt(0).toUpperCase()=='A')?'AM':'PM').toUpperCase();}if(order.h!==-1){if(this.ampm=='AM'&&treg[order.h]=='12'){this.hour=0;}else if(this.ampm=='PM'&&treg[order.h]!='12'){this.hour=(parseFloat(treg[order.h])+12).toFixed(0);}else{this.hour=treg[order.h];}}if(order.m!==-1){this.minute=treg[order.m];}if(order.s!==-1){this.second=treg[order.s];}}tp_inst.timeDefined=(treg)?true:false;if(typeof(dp_inst.stay_open)!=='boolean'||dp_inst.stay_open===false){setTimeout(function(){tp_inst.injectTimePicker(dp_inst,tp_inst);},10);}else{tp_inst.injectTimePicker(dp_inst,tp_inst);}},getFormatPositions:function(){var finds=this.defaults.timeFormat.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|t{1,2})/g);var orders={h:-1,m:-1,s:-1,t:-1};if(finds){for(var i=0;i<finds.length;i++){if(orders[finds[i].toString().charAt(0)]==-1){orders[finds[i].toString().charAt(0)]=i+1;}}}return orders;},injectTimePicker:function(dp_inst,tp_inst){var $dp=dp_inst.dpDiv;var opts=tp_inst.defaults;var hourMax=opts.hourMax-(opts.hourMax%opts.stepHour);var minMax=opts.minuteMax-(opts.minuteMax%opts.stepMinute);var secMax=opts.secondMax-(opts.secondMax%opts.stepSecond);if($dp.find("div#ui-timepicker-div-"+dp_inst.id).length===0){var noDisplay=' style="display:none;"';var html='<div class="ui-timepicker-div" id="ui-timepicker-div-'+dp_inst.id+'"><dl>'+'<dt class="ui_tpicker_time_label" id="ui_tpicker_time_label_'+dp_inst.id+'"'+((opts.showTime)?'':noDisplay)+'>'+opts.timeText+'</dt>'+'<dd class="ui_tpicker_time" id="ui_tpicker_time_'+dp_inst.id+'"'+((opts.showTime)?'':noDisplay)+'></dd>'+'<dt class="ui_tpicker_hour_label" id="ui_tpicker_hour_label_'+dp_inst.id+'"'+((opts.showHour)?'':noDisplay)+'>'+opts.hourText+'</dt>';if(opts.hourGrid>0){html+='<dd class="ui_tpicker_hour ui_tpicker_hour_'+opts.hourGrid+'">'+'<div id="ui_tpicker_hour_'+dp_inst.id+'"'+((opts.showHour)?'':noDisplay)+'></div>'+'<div><table><tr>';for(var h=0;h<hourMax;h+=opts.hourGrid){var tmph=h;if(opts.ampm&&h>12)tmph=h-12;else tmph=h;if(tmph<10)tmph='0'+tmph;if(opts.ampm){if(h==0)tmph=12+'a';else if(h<12)tmph+='a';else tmph+='p';}html+='<td>'+tmph+'</td>';}html+='</tr></table></div>'+'</dd>';}else{html+='<dd class="ui_tpicker_hour" id="ui_tpicker_hour_'+dp_inst.id+'"'+((opts.showHour)?'':noDisplay)+'></dd>';}html+='<dt class="ui_tpicker_minute_label" id="ui_tpicker_minute_label_'+dp_inst.id+'"'+((opts.showMinute)?'':noDisplay)+'>'+opts.minuteText+'</dt>';if(opts.minuteGrid>0){html+='<dd class="ui_tpicker_minute ui_tpicker_minute_'+opts.minuteGrid+'">'+'<div id="ui_tpicker_minute_'+dp_inst.id+'"'+((opts.showMinute)?'':noDisplay)+'></div>'+'<div><table><tr>';for(var m=0;m<minMax;m+=opts.minuteGrid){html+='<td>'+((m<10)?'0':'')+m+'</td>';}html+='</tr></table></div>'+'</dd>';}else{html+='<dd class="ui_tpicker_minute" id="ui_tpicker_minute_'+dp_inst.id+'"'+((opts.showMinute)?'':noDisplay)+'></dd>'}html+='<dt class="ui_tpicker_second_label" id="ui_tpicker_second_label_'+dp_inst.id+'"'+((opts.showSecond)?'':noDisplay)+'>'+opts.secondText+'</dt>';if(opts.secondGrid>0){html+='<dd class="ui_tpicker_second ui_tpicker_second_'+opts.secondGrid+'">'+'<div id="ui_tpicker_second_'+dp_inst.id+'"'+((opts.showSecond)?'':noDisplay)+'></div>'+'<table><table><tr>';for(var s=0;s<secMax;s+=opts.secondGrid){html+='<td>'+((s<10)?'0':'')+s+'</td>';}html+='</tr></table></table>'+'</dd>';}else{html+='<dd class="ui_tpicker_second" id="ui_tpicker_second_'+dp_inst.id+'"'+((opts.showSecond)?'':noDisplay)+'></dd>';}html+='</dl></div>';$tp=$(html);if(opts.timeOnly===true){$tp.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all">'+'<div class="ui-datepicker-title">'+opts.timeOnlyTitle+'</div>'+'</div>');$dp.find('.ui-datepicker-header, .ui-datepicker-calendar').hide();}tp_inst.hour_slider=$tp.find('#ui_tpicker_hour_'+dp_inst.id).slider({orientation:"horizontal",value:tp_inst.hour,min:opts.hourMin,max:hourMax,step:opts.stepHour,slide:function(event,ui){tp_inst.hour_slider.slider("option","value",ui.value);tp_inst.onTimeChange(dp_inst,tp_inst);}});tp_inst.minute_slider=$tp.find('#ui_tpicker_minute_'+dp_inst.id).slider({orientation:"horizontal",value:tp_inst.minute,min:opts.minuteMin,max:minMax,step:opts.stepMinute,slide:function(event,ui){tp_inst.minute_slider.slider("option","value",ui.value);tp_inst.onTimeChange(dp_inst,tp_inst);}});tp_inst.second_slider=$tp.find('#ui_tpicker_second_'+dp_inst.id).slider({orientation:"horizontal",value:tp_inst.second,min:opts.secondMin,max:secMax,step:opts.stepSecond,slide:function(event,ui){tp_inst.second_slider.slider("option","value",ui.value);tp_inst.onTimeChange(dp_inst,tp_inst);}});$tp.find(".ui_tpicker_hour td").each(function(index){$(this).click(function(){var h=$(this).html();if(opts.ampm){var ap=h.substring(2).toLowerCase();var aph=new Number(h.substring(0,2));if(ap=='a'){if(aph==12)h=0;else h=aph;}else{if(aph==12)h=12;else h=aph+12;}}tp_inst.hour_slider.slider("option","value",h);tp_inst.onTimeChange(dp_inst,tp_inst);});$(this).css({'cursor':"pointer",'width':'1%','text-align':'left'});});$tp.find(".ui_tpicker_minute td").each(function(index){$(this).click(function(){tp_inst.minute_slider.slider("option","value",$(this).html());tp_inst.onTimeChange(dp_inst,tp_inst);});$(this).css({'cursor':"pointer",'width':'1%','text-align':'left'});});$tp.find(".ui_tpicker_second td").each(function(index){$(this).click(function(){tp_inst.second_slider.slider("option","value",$(this).html());tp_inst.onTimeChange(dp_inst,tp_inst);});$(this).css({'cursor':"pointer",'width':'1%','text-align':'left'});});$dp.find('.ui-datepicker-calendar').after($tp);tp_inst.$timeObj=$('#ui_tpicker_time_'+dp_inst.id);if(dp_inst!==null){var timeDefined=tp_inst.timeDefined;tp_inst.onTimeChange(dp_inst,tp_inst);tp_inst.timeDefined=timeDefined;}}},onTimeChange:function(dp_inst,tp_inst){var hour=tp_inst.hour_slider.slider('value');var minute=tp_inst.minute_slider.slider('value');var second=tp_inst.second_slider.slider('value');var ampm=(hour<11.5)?'AM':'PM';hour=(hour>=11.5&&hour<12)?12:hour;var hasChanged=false;if(tp_inst.hour!=hour||tp_inst.minute!=minute||tp_inst.second!=second||(tp_inst.ampm.length>0&&tp_inst.ampm!=ampm)){hasChanged=true;}tp_inst.hour=parseFloat(hour).toFixed(0);tp_inst.minute=parseFloat(minute).toFixed(0);tp_inst.second=parseFloat(second).toFixed(0);tp_inst.ampm=ampm;tp_inst.formatTime(tp_inst);tp_inst.$timeObj.text(tp_inst.formattedTime);if(hasChanged){tp_inst.updateDateTime(dp_inst,tp_inst);tp_inst.timeDefined=true;}},formatTime:function(tp_inst){var tmptime=tp_inst.defaults.timeFormat.toString();var hour12=((tp_inst.ampm=='AM')?(tp_inst.hour):(tp_inst.hour%12));hour12=(Number(hour12)===0)?12:hour12;if(tp_inst.defaults.ampm===true){tmptime=tmptime.toString().replace(/hh/g,((hour12<10)?'0':'')+hour12).replace(/h/g,hour12).replace(/mm/g,((tp_inst.minute<10)?'0':'')+tp_inst.minute).replace(/m/g,tp_inst.minute).replace(/ss/g,((tp_inst.second<10)?'0':'')+tp_inst.second).replace(/s/g,tp_inst.second).replace(/TT/g,tp_inst.ampm.toUpperCase()).replace(/tt/g,tp_inst.ampm.toLowerCase()).replace(/T/g,tp_inst.ampm.charAt(0).toUpperCase()).replace(/t/g,tp_inst.ampm.charAt(0).toLowerCase());}else{tmptime=tmptime.toString().replace(/hh/g,((tp_inst.hour<10)?'0':'')+tp_inst.hour).replace(/h/g,tp_inst.hour).replace(/mm/g,((tp_inst.minute<10)?'0':'')+tp_inst.minute).replace(/m/g,tp_inst.minute).replace(/ss/g,((tp_inst.second<10)?'0':'')+tp_inst.second).replace(/s/g,tp_inst.second);tmptime=$.trim(tmptime.replace(/t/gi,''));}tp_inst.formattedTime=tmptime;return tp_inst.formattedTime;},updateDateTime:function(dp_inst,tp_inst){var dt=new Date(dp_inst.selectedYear,dp_inst.selectedMonth,dp_inst.selectedDay);var dateFmt=$.datepicker._get(dp_inst,'dateFormat');var formatCfg=$.datepicker._getFormatConfig(dp_inst);this.formattedDate=$.datepicker.formatDate(dateFmt,(dt===null?new Date():dt),formatCfg);var formattedDateTime=this.formattedDate;var timeAvailable=dt!==null&&tp_inst.timeDefined;if(this.defaults.timeOnly===true){formattedDateTime=this.formattedTime;}else if(this.defaults.timeOnly!==true&&(this.defaults.alwaysSetTime||timeAvailable)){if((this.$altInput)&&this.$altInput!=null){this.$altInput.val(this.formattedTime);}else{formattedDateTime+=' '+this.formattedTime;}}this.formattedDateTime=formattedDateTime;this.$input.val(formattedDateTime);this.$input.trigger("change");},setDefaults:function(settings){extendRemove(this.defaults,settings||{});return this;}};jQuery.fn.datetimepicker=function(o){var opts=(o===undefined?{}:o);var input=$(this);var tp=new Timepicker();var inlineSettings={};for(var attrName in tp.defaults){var attrValue=input.attr('time:'+attrName);if(attrValue){try{inlineSettings[attrName]=eval(attrValue);}catch(err){inlineSettings[attrName]=attrValue;}}}tp.defaults=$.extend(tp.defaults,inlineSettings);var beforeShowFunc=function(input,inst){tp.hour=tp.defaults.hour;tp.minute=tp.defaults.minute;tp.second=tp.defaults.second;tp.ampm='';tp.$input=$(input);if(opts.altField!=undefined&&opts.altField!='')tp.$altInput=$($.datepicker._get(inst,'altField'));tp.inst=inst;tp.addTimePicker(inst);if($.isFunction(opts.beforeShow)){opts.beforeShow(input,inst);}};var onChangeMonthYearFunc=function(year,month,inst){tp.updateDateTime(inst,tp);if($.isFunction(opts.onChangeMonthYear)){opts.onChangeMonthYear(year,month,inst);}};var onCloseFunc=function(dateText,inst){if(tp.timeDefined===true&&input.val()!=''){tp.updateDateTime(inst,tp);}if($.isFunction(opts.onClose)){opts.onClose(dateText,inst);}};tp.defaults=$.extend({},tp.defaults,opts,{beforeShow:beforeShowFunc,onChangeMonthYear:onChangeMonthYearFunc,onClose:onCloseFunc,timepicker:tp});$(this).datepicker(tp.defaults);};jQuery.fn.timepicker=function(opts){opts=$.extend(opts,{timeOnly:true});$(this).datetimepicker(opts);};$.datepicker._base_selectDate=$.datepicker._selectDate;$.datepicker._selectDate=function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);var tp_inst=$.datepicker._get(inst,'timepicker');if(tp_inst){inst.inline=true;inst.stay_open=true;$.datepicker._base_selectDate(id,dateStr);inst.stay_open=false;inst.inline=false;this._notifyChange(inst);this._updateDatepicker(inst);}else{$.datepicker._base_selectDate(id,dateStr);}};$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker;$.datepicker._updateDatepicker=function(inst){if(typeof(inst.stay_open)!=='boolean'||inst.stay_open===false){this._base_updateDatepicker(inst);this._beforeShow(inst.input,inst);}};$.datepicker._beforeShow=function(input,inst){var beforeShow=this._get(inst,'beforeShow');if(beforeShow){inst.stay_open=true;beforeShow.apply((inst.input?inst.input[0]:null),[inst.input,inst]);inst.stay_open=false;}};$.datepicker._base_doKeyPress=$.datepicker._doKeyPress;$.datepicker._doKeyPress=function(event){var inst=$.datepicker._getInst(event.target);var tp_inst=$.datepicker._get(inst,'timepicker');if(tp_inst){if($.datepicker._get(inst,'constrainInput')){var dateChars=$.datepicker._possibleChars($.datepicker._get(inst,'dateFormat'));var chr=String.fromCharCode(event.charCode===undefined?event.keyCode:event.charCode);var chrl=chr.toLowerCase();return event.ctrlKey||(chr<' '||!dateChars||dateChars.indexOf(chr)>-1||event.keyCode==58||event.keyCode==32||chr==':'||chr==' '||chrl=='a'||chrl=='p'||chrl=='m');}}else{return $.datepicker._base_doKeyPress(event);}};$.datepicker._base_gotoToday=$.datepicker._gotoToday;$.datepicker._gotoToday=function(id){$.datepicker._base_gotoToday(id);var target=$(id);var dp_inst=this._getInst(target[0]);var tp_inst=$.datepicker._get(dp_inst,'timepicker');if(tp_inst){var date=new Date();var hour=date.getHours();var minute=date.getMinutes();var second=date.getSeconds();if((hour<tp_inst.defaults.hourMin||hour>tp_inst.defaults.hourMax)||(minute<tp_inst.defaults.minuteMin||minute>tp_inst.defaults.minuteMax)||(second<tp_inst.defaults.secondMin||second>tp_inst.defaults.secondMax)){hour=tp_inst.defaults.hourMin;minute=tp_inst.defaults.minuteMin;second=tp_inst.defaults.secondMin;}tp_inst.hour_slider.slider('value',hour);tp_inst.minute_slider.slider('value',minute);tp_inst.second_slider.slider('value',second);tp_inst.onTimeChange(dp_inst,tp_inst);}};function extendRemove(target,props){$.extend(target,props);for(var name in props)if(props[name]==null||props[name]==undefined)target[name]=props[name];return target;};$.timepicker=new Timepicker(true);
})(jQuery);

/**
* Русифицированная и настроенная функция datetimepicker
*/
;(function($) {
    if ($.fn.datetime) return;
    
    $.fn.extend({
        dateselector: function() {
            return this.each(function () {
                $(this).datepicker({
                        showSecond: true,
                        dateFormat: 'yy-mm-dd',
                        timeFormat: 'hh:mm:ss',
                        showAnim: '',
                        firstDay: 1,
                        monthNames: lang.t('Январь,Февраль,Март,Апрель,Май,Июнь,Июль,Август,Сентябрь,Октябрь,Ноябрь,Декабрь').split(','),
                        dayNamesMin: lang.t('Вс,Пн,Вт,Ср,Чт,Пт,Сб').split(','),
                        dayNames: lang.t('Воскресенье,Понедельник,Вторник,Среда,Четверг,Пятница,Суббота').split(','),
                        nextText: lang.t('Следующий месяц'),
                        prevText: lang.t('Предыдущий месяц'),
                        currentText: lang.t('Сегодня'),
                        closeText: lang.t('Закрыть'),
                        beforeShow: function(element, options) {
                            var widget = $(this).datepicker('widget');
                            if (!widget.parent().hasClass('admin-body')) {
                                widget.appendTo('.admin-body');
                            }
                            options.dpDiv.off('.listenclick').on('click.listenclick', function() {
                                return false;
                            });
                        }
                    });
            });            
            
        },
        datetime: function(){
            return this.each(function () {

                $(this).datetimepicker({
                        showSecond: true,
                        dateFormat: 'yy-mm-dd',
                        timeFormat: 'hh:mm:ss',
                        showAnim: '',
                        firstDay: 1,
                        monthNames: lang.t('Январь,Февраль,Март,Апрель,Май,Июнь,Июль,Август,Сентябрь,Октябрь,Ноябрь,Декабрь').split(','),
                        dayNamesMin: lang.t('Вс,Пн,Вт,Ср,Чт,Пт,Сб').split(','),
                        dayNames: lang.t('Воскресенье,Понедельник,Вторник,Среда,Четверг,Пятница,Суббота').split(','),
                        nextText: lang.t('Следующий месяц'),
                        prevText: lang.t('Предыдущий месяц'),
                        currentText: lang.t('Сегодня'),
                        closeText: lang.t('Закрыть'),
                        timeText: lang.t('Время'),
                        hourText: lang.t('Часы'),
                        minuteText: lang.t('Минуты'),
                        secondText: lang.t('Секунды'),
                        beforeShow: function(element, options) {
                            var widget = $(this).datepicker('widget');
                            if (!widget.parent().hasClass('admin-body')) {
                                widget.appendTo('.admin-body');
                            }
                            options.dpDiv.off('.listenclick').on('click.listenclick', function() {
                                return false;
                            });
                        }
                    });
            });
        }
    });
})(jQuery);
/*! LABjs
	v$3.0 (c) $2017 Kyle Simpson
	MIT License: http://getify.mit-license.org
*/
(function UMD(name,context,definition){
    if (typeof define === "function" && define.amd) { define(definition); }
    else { context[name] = definition(name,context); }
})("$LAB",this,function DEF(name,context){
    "use strict";

    var old$LAB = context.$LAB;

    // placeholders for console output
    var logMsg = function NOOP(){};
    var logError = logMsg;
    // define console wrapper functions if applicable
    if (context.console && context.console.log) {
        if (!context.console.error) context.console.error = context.console.log;
        logMsg = function logMsg(msg) { context.console.log(msg); };
        logError = function logError(msg,err) { context.console.error(msg,err); };
    }
    var linkElems = document.getElementsByTagName( "link" );

    // options keys
    var optAlwaysPreserveOrder = "AlwaysPreserveOrder";
    var optCacheBust = "CacheBust";
    var optDebug = "Debug";
    var optBasePath = "BasePath";

    // stateless variables used across all $LAB instances
    var rootPageDir = /^[^?#]*\//.exec( location.href )[0];
    var rootURL = /^[\w\-]+\:\/\/\/?[^\/]+/.exec( rootPageDir )[0];
    var appendTo = document.head;

    // feature detections (yay!)
    var realPreloading = (function featureTest(){
        // Adapted from: https://gist.github.com/igrigorik/a02f2359f3bc50ca7a9c
        var tokenList = document.createElement( "link" ).relList;
        try {
            if (tokenList && tokenList.supports) {
                return tokenList.supports( "preload" );
            }
        }
        catch (err) {}
        return false;
    })();
    var scriptOrderedAsync = document.createElement( "script" ).async === true;
    var perfTiming = context.performance && context.performance.getEntriesByName;

    // create the main instance of $LAB
    return createSandbox();


    // **************************************

    function preloadResource(registryEntry) {
        var elem = document.createElement( "link" );
        elem.setAttribute( "href", registryEntry.src );
        if (registryEntry.type == "script" || registryEntry.type == "module") {
            elem.setAttribute( "as", "script" );
        }
        // TODO: handle more resource types
        elem.setAttribute( "rel", "preload" );
        elem.setAttribute( "data-requested-with", "LABjs" );
        document.head.appendChild( elem );
        registryEntry.preloadRequested = true;
        return elem;
    }

    function loadResource(registryEntry) {
        if (registryEntry.type == "script" || registryEntry.type == "module") {
            var elem = document.createElement( "script" );
            elem.setAttribute( "src", registryEntry.src );
            elem.setAttribute( "data-requested-with", "LABjs" );
            elem.async = false;		// ensure ordered execution
            if (registryEntry.type == "module") {
                elem.setAttribute( "type", "module" );
            }
        }
        if (registryEntry.opts) {
            // TODO
        }
        document.head.appendChild( elem );
        registryEntry.loadRequested = true;
        return elem;
    }

    function throwGlobalError(err) {
        setTimeout( function globalError(){ throw err; }, 0 );
    }

    function assign(target,source) {
        for (var k in source) { target[k] = source[k]; }
        return target;
    }

    // make resource URL absolute (canonical)
    function canonicalURL(src,basePath) {
        var absoluteRegex = /^[\w\-]+:\/\/\/?/;

        // `src` protocol-relative (begins with `//` or `///`)?
        if (/^\/\/\/?/.test( src )) {
            src = location.protocol + src;
        }
        // `src` page-relative (neither absolute nor domain-relative beginning with `/`)?
        else if (!absoluteRegex.test( src ) && src[0] != "/") {
            src = (basePath || "") + src;
        }

        // `src` still not absolute?
        if (!absoluteRegex.test( src )) {
            // domain-relative (begins with `/`)?
            if (src[0] == "/") {
                src = rootURL + src;
            }
            // otherwise, assume page-relative
            else {
                src = rootPageDir + src;
            }
        }

        return src;
    }

    // create an instance of $LAB
    function createSandbox() {
        var registry = {};
        var defaults = {};

        defaults[optAlwaysPreserveOrder] = false;
        defaults[optCacheBust] = false;
        defaults[optDebug] = false;
        defaults[optBasePath] = "";

        if (perfTiming) {
            registerMarkupLinks();
        }

        // API for each initial $LAB instance (before chaining starts)
        var publicAPI = {
            setGlobalDefaults: setGlobalDefaults,
            setOptions: setOptions,
            script: script,
            wait: wait,
            sandbox: createSandbox,
            noConflict: noConflict,
        };

        return publicAPI;


        // **************************************

        function registerMarkupLinks() {
            for (var i = 0; i < linkElems.length; i++) {
                (function loopScope(elem){
                    if (
                        elem &&
                        /\bpreload\b/i.test( elem.getAttribute( "rel" ) )
                    ) {
                        // must have the `as` attribute
                        var preloadAs = elem.getAttribute( "as" );
                        if (!preloadAs) return;

                        // canonicalize resource URL and look it up in the global performance table
                        var href = elem.getAttribute( "href" );
                        href = canonicalURL( href, document.baseURI );	// TODO: fix document.baseURI here
                        var perfEntries = context.performance.getEntriesByName( href );

                        // already registered this resource?
                        if (href in registry) return;

                        // add global registry entry
                        var registryEntry = new createRegistryEntry( null, href );
                        registryEntry.preloadRequested = true;
                        registry[href] = registryEntry;

                        // resource already (pre)loaded?
                        if (perfEntries.length > 0) {
                            registryEntry.preloaded = true;
                            // logMsg( "markup link already preloaded", href );
                        }
                        else {
                            // logMsg( "listening for markup link preload", href );
                            // listen for preload to complete
                            elem.addEventListener( "load", function resourcePreloaded(){
                                // logMsg("markup link preloaded!",href);
                                elem.removeEventListener( "load", resourcePreloaded );
                                registryEntry.preloaded = true;
                                notifyRegistryListeners( registryEntry );
                            } );
                        }
                    }
                })( linkElems[i] );
            }
        }

        // rollback `context.$LAB` to what it was before this file
        // was loaded, then return this current instance of $LAB
        function noConflict() {
            context.$LAB = old$LAB;
            return publicAPI;
        }

        function setGlobalDefaults(opts) {
            defaults = assign( defaults, opts );
            return publicAPI;
        }

        function setOptions() {
            return createChainInstance().setOptions.apply( null, arguments );
        }

        function script() {
            return createChainInstance().script.apply( null, arguments );
        }

        function wait() {
            return createChainInstance().wait.apply( null, arguments );
        }

        function createGroupEntry(check) {
            this.isGroup = true;
            this.resources = [];
            this.ready = false;
            this.complete = false;
            this.check = check || function(){};
        }

        function createRegistryEntry(type,src) {
            this.type = type;
            this.src = src;
            this.listeners = [];
            this.preloadRequested = false;
            this.preloaded = false;
            this.loadRequested = false;
            this.complete = false;
            this.opts = null;
        }

        function registerResource(resourceRecord) {
            // registry entry doesn't exist yet?
            if (!(resourceRecord.src in registry)) {
                registry[resourceRecord.src] = new createRegistryEntry( resourceRecord.type, resourceRecord.src );
            }

            var registryEntry = registry[resourceRecord.src];

            // still need to set the type for this entry?
            if (!registryEntry.type) {
                registryEntry.type = resourceRecord.type;
            }

            // any `resourceRecord` options to store?
            if (!registryEntry.opts) {
                registryEntry.opts = resourceRecord.opts;
            }

            // need to add `resourceRecord` as a listener for registry entry updates?
            if (!~registryEntry.listeners.indexOf( resourceRecord )) {
                registryEntry.listeners.push( resourceRecord );
            }

            return registryEntry;
        }

        function notifyRegistryListeners(registryEntry) {
            var groups = [];

            // collect all of the affected groups
            for (var i = 0; i < registryEntry.listeners.length; i++) {
                if (!~groups.indexOf( registryEntry.listeners[i].group )) {
                    groups.push( registryEntry.listeners[i].group );
                }
            }

            // schedule all the group checks
            for (var i = 0; i < groups.length; i++) {
                groups[i].check();
            }
        }

        function createChainInstance() {
            var chainOpts = assign( {}, defaults );
            var chain = [];
            var checkHook;

            var chainAPI = {
                setOptions: setOptions,
                script: script,
                wait: wait,
            };

            return chainAPI;


            // **************************************

            function setOptions(opts) {
                chainOpts = assign( chainOpts, opts );
                return chainAPI;
            }

            function script() {
                for (var i = 0; i < arguments.length; i++) {
                    addChainResource( "script", arguments[i] );
                }
                scheduleChainCheck();

                return chainAPI;
            }

            function wait() {
                if (arguments.length > 0) {
                    for (var i = 0; i < arguments.length; i++) {
                        addChainWait( arguments[i] );
                    }
                }
                else {
                    // placeholder wait entry
                    addChainWait( /*waitEntry=*/true );
                }
                scheduleChainCheck();

                return chainAPI;
            }

            function addChainResource(resourceType,resourceRecord) {
                // need to add next group to chain?
                if (
                    chain.length == 0 ||
                    !chain[chain.length - 1].isGroup ||
                    chain[chain.length - 1].complete ||
                    (!realPreloading && !scriptOrderedAsync) ||		// TODO: only apply these checks for scripts
                    (chainOpts[optAlwaysPreserveOrder] && !scriptOrderedAsync)
                ) {
                    var groupEntry = new createGroupEntry( scheduleChainCheck );
                    chain.push( groupEntry );
                }

                var currentGroup = chain[chain.length - 1];
                currentGroup.complete = false;

                // format resource record and canonicalize URL
                if (typeof resourceRecord == "string") {
                    resourceRecord = {
                        type: resourceType,
                        src: canonicalURL( resourceRecord, chainOpts[optBasePath] ),
                        group: currentGroup,
                    };
                }
                else {
                    resourceRecord = {
                        type: resourceType,
                        src: canonicalURL( resourceRecord.src, chainOpts[optBasePath] ),
                        opts: resourceRecord,
                        group: currentGroup,
                    };
                }

                // add resource to current group
                currentGroup.resources.push( resourceRecord );

                // add/lookup resource in the global registry
                var registryEntry = registerResource( resourceRecord );

                // need to start preloading this resource?
                if (realPreloading && !registryEntry.preloadRequested) {
                    var elem = preloadResource( registryEntry );

                    // listen for preload to complete
                    elem.addEventListener( "load", function resourcePreloaded(){
                        // logMsg("resource preloaded!",resourceRecord.src);
                        elem.removeEventListener( "load", resourcePreloaded );
                        elem.parentNode.removeChild( elem );
                        registryEntry.preloaded = true;
                        notifyRegistryListeners( registryEntry );
                    } );
                }
            }

            function addChainWait(waitEntry) {
                // need empty group placeholder at beginning of chain?
                if (chain.length == 0) {
                    var groupEntry = new createGroupEntry();
                    groupEntry.ready = groupEntry.complete = true;
                    chain.push( groupEntry );
                }

                chain.push( {wait: waitEntry} );
            }

            function scheduleChainCheck() {
                if (checkHook == null) {
                    checkHook = setTimeout( advanceChain, 0 );
                }
            }

            function advanceChain() {
                checkHook = null;

                for (var i = 0; i < chain.length; i++) {
                    if (!chain[i].complete) {
                        if (chain[i].isGroup) {
                            checkGroupStatus( chain[i] );

                            if (!chain[i].complete) {
                                break;
                            }
                        }
                        else if (typeof chain[i].wait == "function") {
                            try {
                                chain[i].wait();
                                chain[i].complete = true;
                            }
                            catch (err) {
                                if (chainOpts[optDebug]) {
                                    throwGlobalError( err );
                                }
                                else {
                                    logError( err );
                                }
                                break;
                            }
                        }
                        else {
                            chain[i].complete = true;
                        }
                    }
                }
            }

            function checkGroupStatus(group) {
                // is group in need of potential preload processing?
                if (!group.ready && !group.complete) {
                    if (realPreloading) {
                        var groupReady = true;
                        for (var i = 0; i < group.resources.length; i++) {
                            if (!registry[group.resources[i].src].preloaded) {
                                groupReady = false;
                                break;
                            }
                        }
                        group.ready = groupReady;
                    }
                    else {
                        group.ready = true;
                    }
                }

                if (!group.complete && group.ready) {
                    var groupComplete = true;

                    for (var i = 0; i < group.resources.length; i++) {
                        (function loopScope(resourceRecord){
                            var registryEntry = registry[resourceRecord.src];

                            // resource loading not yet requested?
                            if (!registryEntry.loadRequested) {
                                var elem = loadResource( registryEntry );

                                // listen for load to complete
                                elem.addEventListener( "load", function resourceLoaded(){
                                    // logMsg("resource loaded!",resourceRecord.src);
                                    elem.removeEventListener( "load", resourceLoaded );
                                    registryEntry.complete = true;
                                    notifyRegistryListeners( registryEntry );
                                } );

                                groupComplete = false;
                            }
                            // resource loading already complete?
                            else if (registryEntry.complete) {
                                return;
                            }
                            else {
                                groupComplete = false;

                                // need to register `resourceRecord` as a listener for currently
                                // loading (not yet complete) resource?
                                if (!~registryEntry.listeners.indexOf( resourceRecord )) {
                                    registryEntry.listeners.push( resourceRecord );
                                }
                            }
                        })( group.resources[i] );
                    }

                    if (groupComplete) {
                        group.complete = true;
                    }
                }
            }
        }
    }
});
/*!
 * jQuery Form Plugin
 * version: 3.35.0-2013.05.23
 * @requires jQuery v1.5 or later
 * Copyright (c) 2013 M. Alsup
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses.
 * https://github.com/malsup/form#copyright-and-license
 */
/*global ActiveXObject */
;(function($) {
"use strict";

/*
    Usage Note:
    -----------
    Do not use both ajaxSubmit and ajaxForm on the same form.  These
    functions are mutually exclusive.  Use ajaxSubmit if you want
    to bind your own submit handler to the form.  For example,

    $(document).ready(function() {
        $('#myForm').on('submit', function(e) {
            e.preventDefault(); // <-- important
            $(this).ajaxSubmit({
                target: '#output'
            });
        });
    });

    Use ajaxForm when you want the plugin to manage all the event binding
    for you.  For example,

    $(document).ready(function() {
        $('#myForm').ajaxForm({
            target: '#output'
        });
    });

    You can also use ajaxForm with delegation (requires jQuery v1.7+), so the
    form does not have to exist when you invoke ajaxForm:

    $('#myForm').ajaxForm({
        delegation: true,
        target: '#output'
    });

    When using ajaxForm, the ajaxSubmit function will be invoked for you
    at the appropriate time.
*/

/**
 * Feature detection
 */
var feature = {};
feature.fileapi = $("<input type='file'/>").get(0).files !== undefined;
feature.formdata = window.FormData !== undefined;

var hasProp = !!$.fn.prop;

// attr2 uses prop when it can but checks the return type for
// an expected string.  this accounts for the case where a form 
// contains inputs with names like "action" or "method"; in those
// cases "prop" returns the element
$.fn.attr2 = function() {
    if ( ! hasProp )
        return this.attr.apply(this, arguments);
    var val = this.prop.apply(this, arguments);
    if ( ( val && val.jquery ) || typeof val === 'string' )
        return val;
    return this.attr.apply(this, arguments);
};

/**
 * ajaxSubmit() provides a mechanism for immediately submitting
 * an HTML form using AJAX.
 */
$.fn.ajaxSubmit = function(options) {
    /*jshint scripturl:true */

    // fast fail if nothing selected (http://dev.jquery.com/ticket/2752)
    if (!this.length) {
        log('ajaxSubmit: skipping submit process - no element selected');
        return this;
    }

    var method, action, url, $form = this;

    if (typeof options == 'function') {
        options = { success: options };
    }

    method = options.type || this.attr2('method');
    action = options.url  || this.attr2('action');

    url = (typeof action === 'string') ? $.trim(action) : '';
    url = url || window.location.href || '';
    if (url) {
        // clean url (don't include hash vaue)
        url = (url.match(/^([^#]+)/)||[])[1];
    }

    options = $.extend(true, {
        url:  url,
        success: $.ajaxSettings.success,
        type: method || 'GET',
        iframeSrc: /^https/i.test(window.location.href || '') ? 'javascript:false' : 'about:blank'
    }, options);

    // hook for manipulating the form data before it is extracted;
    // convenient for use with rich editors like tinyMCE or FCKEditor
    var veto = {};
    this.trigger('form-pre-serialize', [this, options, veto]);
    if (veto.veto) {
        log('ajaxSubmit: submit vetoed via form-pre-serialize trigger');
        return this;
    }

    // provide opportunity to alter form data before it is serialized
    if (options.beforeSerialize && options.beforeSerialize(this, options) === false) {
        log('ajaxSubmit: submit aborted via beforeSerialize callback');
        return this;
    }

    var traditional = options.traditional;
    if ( traditional === undefined ) {
        traditional = $.ajaxSettings.traditional;
    }

    var elements = [];
    var qx, a = this.formToArray(options.semantic, elements);
    if (options.data) {
        options.extraData = options.data;
        qx = $.param(options.data, traditional);
    }

    // give pre-submit callback an opportunity to abort the submit
    if (options.beforeSubmit && options.beforeSubmit(a, this, options) === false) {
        log('ajaxSubmit: submit aborted via beforeSubmit callback');
        return this;
    }

    // fire vetoable 'validate' event
    this.trigger('form-submit-validate', [a, this, options, veto]);
    if (veto.veto) {
        log('ajaxSubmit: submit vetoed via form-submit-validate trigger');
        return this;
    }

    var q = $.param(a, traditional);
    if (qx) {
        q = ( q ? (q + '&' + qx) : qx );
    }
    if (options.type.toUpperCase() == 'GET') {
        options.url += (options.url.indexOf('?') >= 0 ? '&' : '?') + q;
        options.data = null;  // data is null for 'get'
    }
    else {
        options.data = q; // data is the query string for 'post'
    }

    var callbacks = [];
    if (options.resetForm) {
        callbacks.push(function() { $form.resetForm(); });
    }
    if (options.clearForm) {
        callbacks.push(function() { $form.clearForm(options.includeHidden); });
    }

    // perform a load on the target only if dataType is not provided
    if (!options.dataType && options.target) {
        var oldSuccess = options.success || function(){};
        callbacks.push(function(data) {
            var fn = options.replaceTarget ? 'replaceWith' : 'html';
            $(options.target)[fn](data).each(oldSuccess, arguments);
        });
    }
    else if (options.success) {
        callbacks.push(options.success);
    }

    options.success = function(data, status, xhr) { // jQuery 1.4+ passes xhr as 3rd arg
        var context = options.context || this ;    // jQuery 1.4+ supports scope context
        for (var i=0, max=callbacks.length; i < max; i++) {
            callbacks[i].apply(context, [data, status, xhr || $form, $form]);
        }
    };

    if (options.error) {
        var oldError = options.error;
        options.error = function(xhr, status, error) {
            var context = options.context || this;
            oldError.apply(context, [xhr, status, error, $form]);
        };
    }

     if (options.complete) {
        var oldComplete = options.complete;
        options.complete = function(xhr, status) {
            var context = options.context || this;
            oldComplete.apply(context, [xhr, status, $form]);
        };
    }

    // are there files to upload?

    // [value] (issue #113), also see comment:
    // https://github.com/malsup/form/commit/588306aedba1de01388032d5f42a60159eea9228#commitcomment-2180219
    var fileInputs = $('input[type=file]:enabled[value!=""]', this);

    var hasFileInputs = fileInputs.length > 0;
    var mp = 'multipart/form-data';
    var multipart = ($form.attr('enctype') == mp || $form.attr('encoding') == mp);

    var fileAPI = feature.fileapi && feature.formdata;
    log("fileAPI :" + fileAPI);
    var shouldUseFrame = (hasFileInputs || multipart) && !fileAPI;

    var jqxhr;

    // options.iframe allows user to force iframe mode
    // 06-NOV-09: now defaulting to iframe mode if file input is detected
    if (options.iframe !== false && (options.iframe || shouldUseFrame)) {
        // hack to fix Safari hang (thanks to Tim Molendijk for this)
        // see:  http://groups.google.com/group/jquery-dev/browse_thread/thread/36395b7ab510dd5d
        if (options.closeKeepAlive) {
            $.get(options.closeKeepAlive, function() {
                jqxhr = fileUploadIframe(a);
            });
        }
        else {
            jqxhr = fileUploadIframe(a);
        }
    }
    else if ((hasFileInputs || multipart) && fileAPI) {
        jqxhr = fileUploadXhr(a);
    }
    else {
        jqxhr = $.ajax(options);
    }

    $form.removeData('jqxhr').data('jqxhr', jqxhr);

    // clear element array
    for (var k=0; k < elements.length; k++)
        elements[k] = null;

    // fire 'notify' event
    this.trigger('form-submit-notify', [this, options]);
    return this;

    // utility fn for deep serialization
    function deepSerialize(extraData){
        var serialized = $.param(extraData, options.traditional).split('&');
        var len = serialized.length;
        var result = [];
        var i, part;
        for (i=0; i < len; i++) {
            // #252; undo param space replacement
            serialized[i] = serialized[i].replace(/\+/g,' ');
            part = serialized[i].split('=');
            // #278; use array instead of object storage, favoring array serializations
            result.push([decodeURIComponent(part[0]), decodeURIComponent(part[1])]);
        }
        return result;
    }

     // XMLHttpRequest Level 2 file uploads (big hat tip to francois2metz)
    function fileUploadXhr(a) {
        var formdata = new FormData();

        for (var i=0; i < a.length; i++) {
            formdata.append(a[i].name, a[i].value);
        }

        if (options.extraData) {
            var serializedData = deepSerialize(options.extraData);
            for (i=0; i < serializedData.length; i++)
                if (serializedData[i])
                    formdata.append(serializedData[i][0], serializedData[i][1]);
        }

        options.data = null;

        var s = $.extend(true, {}, $.ajaxSettings, options, {
            contentType: false,
            processData: false,
            cache: false,
            type: method || 'POST'
        });

        if (options.uploadProgress) {
            // workaround because jqXHR does not expose upload property
            s.xhr = function() {
                var xhr = jQuery.ajaxSettings.xhr();
                if (xhr.upload) {
                    xhr.upload.addEventListener('progress', function(event) {
                        var percent = 0;
                        var position = event.loaded || event.position; /*event.position is deprecated*/
                        var total = event.total;
                        if (event.lengthComputable) {
                            percent = Math.ceil(position / total * 100);
                        }
                        options.uploadProgress(event, position, total, percent);
                    }, false);
                }
                return xhr;
            };
        }

        s.data = null;
            var beforeSend = s.beforeSend;
            s.beforeSend = function(xhr, o) {
                o.data = formdata;
                if(beforeSend)
                    beforeSend.call(this, xhr, o);
        };
        return $.ajax(s);
    }

    // private function for handling file uploads (hat tip to YAHOO!)
    function fileUploadIframe(a) {
        var form = $form[0], el, i, s, g, id, $io, io, xhr, sub, n, timedOut, timeoutHandle;
        var deferred = $.Deferred();

        if (a) {
            // ensure that every serialized input is still enabled
            for (i=0; i < elements.length; i++) {
                el = $(elements[i]);
                if ( hasProp )
                    el.prop('disabled', false);
                else
                    el.removeAttr('disabled');
            }
        }

        s = $.extend(true, {}, $.ajaxSettings, options);
        s.context = s.context || s;
        id = 'jqFormIO' + (new Date().getTime());
        if (s.iframeTarget) {
            $io = $(s.iframeTarget);
            n = $io.attr2('name');
            if (!n)
                 $io.attr2('name', id);
            else
                id = n;
        }
        else {
            $io = $('<iframe name="' + id + '" src="'+ s.iframeSrc +'" />');
            $io.css({ position: 'absolute', top: '-1000px', left: '-1000px' });
        }
        io = $io[0];


        xhr = { // mock object
            aborted: 0,
            responseText: null,
            responseXML: null,
            status: 0,
            statusText: 'n/a',
            getAllResponseHeaders: function() {},
            getResponseHeader: function() {},
            setRequestHeader: function() {},
            abort: function(status) {
                var e = (status === 'timeout' ? 'timeout' : 'aborted');
                log('aborting upload... ' + e);
                this.aborted = 1;

                try { // #214, #257
                    if (io.contentWindow.document.execCommand) {
                        io.contentWindow.document.execCommand('Stop');
                    }
                }
                catch(ignore) {}

                $io.attr('src', s.iframeSrc); // abort op in progress
                xhr.error = e;
                if (s.error)
                    s.error.call(s.context, xhr, e, status);
                if (g)
                    $.event.trigger("ajaxError", [xhr, s, e]);
                if (s.complete)
                    s.complete.call(s.context, xhr, e);
            }
        };

        g = s.global;
        // trigger ajax global events so that activity/block indicators work like normal
        if (g && 0 === $.active++) {
            $.event.trigger("ajaxStart");
        }
        if (g) {
            $.event.trigger("ajaxSend", [xhr, s]);
        }

        if (s.beforeSend && s.beforeSend.call(s.context, xhr, s) === false) {
            if (s.global) {
                $.active--;
            }
            deferred.reject();
            return deferred;
        }
        if (xhr.aborted) {
            deferred.reject();
            return deferred;
        }

        // add submitting element to data if we know it
        sub = form.clk;
        if (sub) {
            n = sub.name;
            if (n && !sub.disabled) {
                s.extraData = s.extraData || {};
                s.extraData[n] = sub.value;
                if (sub.type == "image") {
                    s.extraData[n+'.x'] = form.clk_x;
                    s.extraData[n+'.y'] = form.clk_y;
                }
            }
        }

        var CLIENT_TIMEOUT_ABORT = 1;
        var SERVER_ABORT = 2;
                
        function getDoc(frame) {
            /* it looks like contentWindow or contentDocument do not
             * carry the protocol property in ie8, when running under ssl
             * frame.document is the only valid response document, since
             * the protocol is know but not on the other two objects. strange?
             * "Same origin policy" http://en.wikipedia.org/wiki/Same_origin_policy
             */
            
            var doc = null;
            
            // IE8 cascading access check
            try {
                if (frame.contentWindow) {
                    doc = frame.contentWindow.document;
                }
            } catch(err) {
                // IE8 access denied under ssl & missing protocol
                log('cannot get iframe.contentWindow document: ' + err);
            }

            if (doc) { // successful getting content
                return doc;
            }

            try { // simply checking may throw in ie8 under ssl or mismatched protocol
                doc = frame.contentDocument ? frame.contentDocument : frame.document;
            } catch(err) {
                // last attempt
                log('cannot get iframe.contentDocument: ' + err);
                doc = frame.document;
            }
            return doc;
        }

        // Rails CSRF hack (thanks to Yvan Barthelemy)
        var csrf_token = $('meta[name=csrf-token]').attr('content');
        var csrf_param = $('meta[name=csrf-param]').attr('content');
        if (csrf_param && csrf_token) {
            s.extraData = s.extraData || {};
            s.extraData[csrf_param] = csrf_token;
        }

        // take a breath so that pending repaints get some cpu time before the upload starts
        function doSubmit() {
            // make sure form attrs are set
            var t = $form.attr2('target'), a = $form.attr2('action');

            // update form attrs in IE friendly way
            form.setAttribute('target',id);
            if (!method) {
                form.setAttribute('method', 'POST');
            }
            if (a != s.url) {
                form.setAttribute('action', s.url);
            }

            // ie borks in some cases when setting encoding
            if (! s.skipEncodingOverride && (!method || /post/i.test(method))) {
                $form.attr({
                    encoding: 'multipart/form-data',
                    enctype:  'multipart/form-data'
                });
            }

            // support timout
            if (s.timeout) {
                timeoutHandle = setTimeout(function() { timedOut = true; cb(CLIENT_TIMEOUT_ABORT); }, s.timeout);
            }

            // look for server aborts
            function checkState() {
                try {
                    var state = getDoc(io).readyState;
                    log('state = ' + state);
                    if (state && state.toLowerCase() == 'uninitialized')
                        setTimeout(checkState,50);
                }
                catch(e) {
                    log('Server abort: ' , e, ' (', e.name, ')');
                    cb(SERVER_ABORT);
                    if (timeoutHandle)
                        clearTimeout(timeoutHandle);
                    timeoutHandle = undefined;
                }
            }

            // add "extra" data to form if provided in options
            var extraInputs = [];
            try {
                if (s.extraData) {
                    for (var n in s.extraData) {
                        if (s.extraData.hasOwnProperty(n)) {
                           // if using the $.param format that allows for multiple values with the same name
                           if($.isPlainObject(s.extraData[n]) && s.extraData[n].hasOwnProperty('name') && s.extraData[n].hasOwnProperty('value')) {
                               extraInputs.push(
                               $('<input type="hidden" name="'+s.extraData[n].name+'">').val(s.extraData[n].value)
                                   .appendTo(form)[0]);
                           } else {
                               extraInputs.push(
                               $('<input type="hidden" name="'+n+'">').val(s.extraData[n])
                                   .appendTo(form)[0]);
                           }
                        }
                    }
                }

                if (!s.iframeTarget) {
                    // add iframe to doc and submit the form
                    $io.appendTo('body');
                    if (io.attachEvent)
                        io.attachEvent('onload', cb);
                    else
                        io.addEventListener('load', cb, false);
                }
                setTimeout(checkState,15);

                try {
                    form.submit();
                } catch(err) {
                    // just in case form has element with name/id of 'submit'
                    var submitFn = document.createElement('form').submit;
                    submitFn.apply(form);
                }
            }
            finally {
                // reset attrs and remove "extra" input elements
                form.setAttribute('action',a);
                if(t) {
                    form.setAttribute('target', t);
                } else {
                    $form.removeAttr('target');
                }
                $(extraInputs).remove();
            }
        }

        if (s.forceSync) {
            doSubmit();
        }
        else {
            setTimeout(doSubmit, 10); // this lets dom updates render
        }

        var data, doc, domCheckCount = 50, callbackProcessed;

        function cb(e) {
            if (xhr.aborted || callbackProcessed) {
                return;
            }
            
            doc = getDoc(io);
            if(!doc) {
                log('cannot access response document');
                e = SERVER_ABORT;
            }
            if (e === CLIENT_TIMEOUT_ABORT && xhr) {
                xhr.abort('timeout');
                deferred.reject(xhr, 'timeout');
                return;
            }
            else if (e == SERVER_ABORT && xhr) {
                xhr.abort('server abort');
                deferred.reject(xhr, 'error', 'server abort');
                return;
            }

            if (!doc || doc.location.href == s.iframeSrc) {
                // response not received yet
                if (!timedOut)
                    return;
            }
            if (io.detachEvent)
                io.detachEvent('onload', cb);
            else
                io.removeEventListener('load', cb, false);

            var status = 'success', errMsg;
            try {
                if (timedOut) {
                    throw 'timeout';
                }

                var isXml = s.dataType == 'xml' || doc.XMLDocument || $.isXMLDoc(doc);
                log('isXml='+isXml);
                if (!isXml && window.opera && (doc.body === null || !doc.body.innerHTML)) {
                    if (--domCheckCount) {
                        // in some browsers (Opera) the iframe DOM is not always traversable when
                        // the onload callback fires, so we loop a bit to accommodate
                        log('requeing onLoad callback, DOM not available');
                        setTimeout(cb, 250);
                        return;
                    }
                    // let this fall through because server response could be an empty document
                    //log('Could not access iframe DOM after mutiple tries.');
                    //throw 'DOMException: not available';
                }

                //log('response detected');
                var docRoot = doc.body ? doc.body : doc.documentElement;
                xhr.responseText = docRoot ? docRoot.innerHTML : null;
                xhr.responseXML = doc.XMLDocument ? doc.XMLDocument : doc;
                if (isXml)
                    s.dataType = 'xml';
                xhr.getResponseHeader = function(header){
                    var headers = {'content-type': s.dataType};
                    return headers[header];
                };
                // support for XHR 'status' & 'statusText' emulation :
                if (docRoot) {
                    xhr.status = Number( docRoot.getAttribute('status') ) || xhr.status;
                    xhr.statusText = docRoot.getAttribute('statusText') || xhr.statusText;
                }

                var dt = (s.dataType || '').toLowerCase();
                var scr = /(json|script|text)/.test(dt);
                if (scr || s.textarea) {
                    // see if user embedded response in textarea
                    var ta = doc.getElementsByTagName('textarea')[0];
                    if (ta) {
                        xhr.responseText = ta.value;
                        // support for XHR 'status' & 'statusText' emulation :
                        xhr.status = Number( ta.getAttribute('status') ) || xhr.status;
                        xhr.statusText = ta.getAttribute('statusText') || xhr.statusText;
                    }
                    else if (scr) {
                        // account for browsers injecting pre around json response
                        var pre = doc.getElementsByTagName('pre')[0];
                        var b = doc.getElementsByTagName('body')[0];
                        if (pre) {
                            xhr.responseText = pre.textContent ? pre.textContent : pre.innerText;
                        }
                        else if (b) {
                            xhr.responseText = b.textContent ? b.textContent : b.innerText;
                        }
                    }
                }
                else if (dt == 'xml' && !xhr.responseXML && xhr.responseText) {
                    xhr.responseXML = toXml(xhr.responseText);
                }

                try {
                    data = httpData(xhr, dt, s);
                }
                catch (err) {
                    status = 'parsererror';
                    xhr.error = errMsg = (err || status);
                }
            }
            catch (err) {
                log('error caught: ',err);
                status = 'error';
                xhr.error = errMsg = (err || status);
            }

            if (xhr.aborted) {
                log('upload aborted');
                status = null;
            }

            if (xhr.status) { // we've set xhr.status
                status = (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) ? 'success' : 'error';
            }

            // ordering of these callbacks/triggers is odd, but that's how $.ajax does it
            if (status === 'success') {
                if (s.success)
                    s.success.call(s.context, data, 'success', xhr);
                deferred.resolve(xhr.responseText, 'success', xhr);
                if (g)
                    $.event.trigger("ajaxSuccess", [xhr, s]);
            }
            else if (status) {
                if (errMsg === undefined)
                    errMsg = xhr.statusText;
                if (s.error)
                    s.error.call(s.context, xhr, status, errMsg);
                deferred.reject(xhr, 'error', errMsg);
                if (g)
                    $.event.trigger("ajaxError", [xhr, s, errMsg]);
            }

            if (g)
                $.event.trigger("ajaxComplete", [xhr, s]);

            if (g && ! --$.active) {
                $.event.trigger("ajaxStop");
            }

            if (s.complete)
                s.complete.call(s.context, xhr, status);

            callbackProcessed = true;
            if (s.timeout)
                clearTimeout(timeoutHandle);

            // clean up
            setTimeout(function() {
                if (!s.iframeTarget)
                    $io.remove();
                xhr.responseXML = null;
            }, 100);
        }

        var toXml = $.parseXML || function(s, doc) { // use parseXML if available (jQuery 1.5+)
            if (window.ActiveXObject) {
                doc = new ActiveXObject('Microsoft.XMLDOM');
                doc.async = 'false';
                doc.loadXML(s);
            }
            else {
                doc = (new DOMParser()).parseFromString(s, 'text/xml');
            }
            return (doc && doc.documentElement && doc.documentElement.nodeName != 'parsererror') ? doc : null;
        };
        var parseJSON = $.parseJSON || function(s) {
            /*jslint evil:true */
            return window['eval']('(' + s + ')');
        };

        var httpData = function( xhr, type, s ) { // mostly lifted from jq1.4.4

            var ct = xhr.getResponseHeader('content-type') || '',
                xml = type === 'xml' || !type && ct.indexOf('xml') >= 0,
                data = xml ? xhr.responseXML : xhr.responseText;

            if (xml && data.documentElement.nodeName === 'parsererror') {
                if ($.error)
                    $.error('parsererror');
            }
            if (s && s.dataFilter) {
                data = s.dataFilter(data, type);
            }
            if (typeof data === 'string') {
                if (type === 'json' || !type && ct.indexOf('json') >= 0) {
                    data = parseJSON(data);
                } else if (type === "script" || !type && ct.indexOf("javascript") >= 0) {
                    $.globalEval(data);
                }
            }
            return data;
        };

        return deferred;
    }
};

/**
 * ajaxForm() provides a mechanism for fully automating form submission.
 *
 * The advantages of using this method instead of ajaxSubmit() are:
 *
 * 1: This method will include coordinates for <input type="image" /> elements (if the element
 *    is used to submit the form).
 * 2. This method will include the submit element's name/value data (for the element that was
 *    used to submit the form).
 * 3. This method binds the submit() method to the form for you.
 *
 * The options argument for ajaxForm works exactly as it does for ajaxSubmit.  ajaxForm merely
 * passes the options argument along after properly binding events for submit elements and
 * the form itself.
 */
$.fn.ajaxForm = function(options) {
    options = options || {};
    options.delegation = options.delegation && $.isFunction($.fn.on);

    // in jQuery 1.3+ we can fix mistakes with the ready state
    if (!options.delegation && this.length === 0) {
        var o = { s: this.selector, c: this.context };
        if (!$.isReady && o.s) {
            log('DOM not ready, queuing ajaxForm');
            $(function() {
                $(o.s,o.c).ajaxForm(options);
            });
            return this;
        }
        // is your DOM ready?  http://docs.jquery.com/Tutorials:Introducing_$(document).ready()
        log('terminating; zero elements found by selector' + ($.isReady ? '' : ' (DOM not ready)'));
        return this;
    }

    if ( options.delegation ) {
        $(document)
            .off('submit.form-plugin', this.selector, doAjaxSubmit)
            .off('click.form-plugin', this.selector, captureSubmittingElement)
            .on('submit.form-plugin', this.selector, options, doAjaxSubmit)
            .on('click.form-plugin', this.selector, options, captureSubmittingElement);
        return this;
    }

    return this.ajaxFormUnbind()
        .bind('submit.form-plugin', options, doAjaxSubmit)
        .bind('click.form-plugin', options, captureSubmittingElement);
};

// private event handlers
function doAjaxSubmit(e) {
    /*jshint validthis:true */
    var options = e.data;
    if (!e.isDefaultPrevented()) { // if event has been canceled, don't proceed
        e.preventDefault();
        $(this).ajaxSubmit(options);
    }
}

function captureSubmittingElement(e) {
    /*jshint validthis:true */
    var target = e.target;
    var $el = $(target);
    if (!($el.is("[type=submit],[type=image]"))) {
        // is this a child element of the submit el?  (ex: a span within a button)
        var t = $el.closest('[type=submit]');
        if (t.length === 0) {
            return;
        }
        target = t[0];
    }
    var form = this;
    form.clk = target;
    if (target.type == 'image') {
        if (e.offsetX !== undefined) {
            form.clk_x = e.offsetX;
            form.clk_y = e.offsetY;
        } else if (typeof $.fn.offset == 'function') {
            var offset = $el.offset();
            form.clk_x = e.pageX - offset.left;
            form.clk_y = e.pageY - offset.top;
        } else {
            form.clk_x = e.pageX - target.offsetLeft;
            form.clk_y = e.pageY - target.offsetTop;
        }
    }
    // clear form vars
    setTimeout(function() { form.clk = form.clk_x = form.clk_y = null; }, 100);
}


// ajaxFormUnbind unbinds the event handlers that were bound by ajaxForm
$.fn.ajaxFormUnbind = function() {
    return this.unbind('submit.form-plugin click.form-plugin');
};

/**
 * formToArray() gathers form element data into an array of objects that can
 * be passed to any of the following ajax functions: $.get, $.post, or load.
 * Each object in the array has both a 'name' and 'value' property.  An example of
 * an array for a simple login form might be:
 *
 * [ { name: 'username', value: 'jresig' }, { name: 'password', value: 'secret' } ]
 *
 * It is this array that is passed to pre-submit callback functions provided to the
 * ajaxSubmit() and ajaxForm() methods.
 */
$.fn.formToArray = function(semantic, elements) {
    var a = [];
    if (this.length === 0) {
        return a;
    }

    var form = this[0];
    var els = semantic ? form.getElementsByTagName('*') : form.elements;
    if (!els) {
        return a;
    }

    var i,j,n,v,el,max,jmax;
    for(i=0, max=els.length; i < max; i++) {
        el = els[i];
        n = el.name;
        if (!n || el.disabled) {
            continue;
        }

        if (semantic && form.clk && el.type == "image") {
            // handle image inputs on the fly when semantic == true
            if(form.clk == el) {
                a.push({name: n, value: $(el).val(), type: el.type });
                a.push({name: n+'.x', value: form.clk_x}, {name: n+'.y', value: form.clk_y});
            }
            continue;
        }

        v = $.fieldValue(el, true);
        if (v && v.constructor == Array) {
            if (elements)
                elements.push(el);
            for(j=0, jmax=v.length; j < jmax; j++) {
                a.push({name: n, value: v[j]});
            }
        }
        else if (feature.fileapi && el.type == 'file') {
            if (elements)
                elements.push(el);
            var files = el.files;
            if (files.length) {
                for (j=0; j < files.length; j++) {
                    a.push({name: n, value: files[j], type: el.type});
                }
            }
            else {
                // #180
                a.push({ name: n, value: '', type: el.type });
            }
        }
        else if (v !== null && typeof v != 'undefined') {
            if (elements)
                elements.push(el);
            a.push({name: n, value: v, type: el.type, required: el.required});
        }
    }

    if (!semantic && form.clk) {
        // input type=='image' are not found in elements array! handle it here
        var $input = $(form.clk), input = $input[0];
        n = input.name;
        if (n && !input.disabled && input.type == 'image') {
            a.push({name: n, value: $input.val()});
            a.push({name: n+'.x', value: form.clk_x}, {name: n+'.y', value: form.clk_y});
        }
    }
    return a;
};

/**
 * Serializes form data into a 'submittable' string. This method will return a string
 * in the format: name1=value1&amp;name2=value2
 */
$.fn.formSerialize = function(semantic) {
    //hand off to jQuery.param for proper encoding
    return $.param(this.formToArray(semantic));
};

/**
 * Serializes all field elements in the jQuery object into a query string.
 * This method will return a string in the format: name1=value1&amp;name2=value2
 */
$.fn.fieldSerialize = function(successful) {
    var a = [];
    this.each(function() {
        var n = this.name;
        if (!n) {
            return;
        }
        var v = $.fieldValue(this, successful);
        if (v && v.constructor == Array) {
            for (var i=0,max=v.length; i < max; i++) {
                a.push({name: n, value: v[i]});
            }
        }
        else if (v !== null && typeof v != 'undefined') {
            a.push({name: this.name, value: v});
        }
    });
    //hand off to jQuery.param for proper encoding
    return $.param(a);
};

/**
 * Returns the value(s) of the element in the matched set.  For example, consider the following form:
 *
 *  <form><fieldset>
 *      <input name="A" type="text" />
 *      <input name="A" type="text" />
 *      <input name="B" type="checkbox" value="B1" />
 *      <input name="B" type="checkbox" value="B2"/>
 *      <input name="C" type="radio" value="C1" />
 *      <input name="C" type="radio" value="C2" />
 *  </fieldset></form>
 *
 *  var v = $('input[type=text]').fieldValue();
 *  // if no values are entered into the text inputs
 *  v == ['','']
 *  // if values entered into the text inputs are 'foo' and 'bar'
 *  v == ['foo','bar']
 *
 *  var v = $('input[type=checkbox]').fieldValue();
 *  // if neither checkbox is checked
 *  v === undefined
 *  // if both checkboxes are checked
 *  v == ['B1', 'B2']
 *
 *  var v = $('input[type=radio]').fieldValue();
 *  // if neither radio is checked
 *  v === undefined
 *  // if first radio is checked
 *  v == ['C1']
 *
 * The successful argument controls whether or not the field element must be 'successful'
 * (per http://www.w3.org/TR/html4/interact/forms.html#successful-controls).
 * The default value of the successful argument is true.  If this value is false the value(s)
 * for each element is returned.
 *
 * Note: This method *always* returns an array.  If no valid value can be determined the
 *    array will be empty, otherwise it will contain one or more values.
 */
$.fn.fieldValue = function(successful) {
    for (var val=[], i=0, max=this.length; i < max; i++) {
        var el = this[i];
        var v = $.fieldValue(el, successful);
        if (v === null || typeof v == 'undefined' || (v.constructor == Array && !v.length)) {
            continue;
        }
        if (v.constructor == Array)
            $.merge(val, v);
        else
            val.push(v);
    }
    return val;
};

/**
 * Returns the value of the field element.
 */
$.fieldValue = function(el, successful) {
    var n = el.name, t = el.type, tag = el.tagName.toLowerCase();
    if (successful === undefined) {
        successful = true;
    }

    if (successful && (!n || el.disabled || t == 'reset' || t == 'button' ||
        (t == 'checkbox' || t == 'radio') && !el.checked ||
        (t == 'submit' || t == 'image') && el.form && el.form.clk != el ||
        tag == 'select' && el.selectedIndex == -1)) {
            return null;
    }

    if (tag == 'select') {
        var index = el.selectedIndex;
        if (index < 0) {
            return null;
        }
        var a = [], ops = el.options;
        var one = (t == 'select-one');
        var max = (one ? index+1 : ops.length);
        for(var i=(one ? index : 0); i < max; i++) {
            var op = ops[i];
            if (op.selected) {
                var v = op.value;
                if (!v) { // extra pain for IE...
                    v = (op.attributes && op.attributes['value'] && !(op.attributes['value'].specified)) ? op.text : op.value;
                }
                if (one) {
                    return v;
                }
                a.push(v);
            }
        }
        return a;
    }
    return $(el).val();
};

/**
 * Clears the form data.  Takes the following actions on the form's input fields:
 *  - input text fields will have their 'value' property set to the empty string
 *  - select elements will have their 'selectedIndex' property set to -1
 *  - checkbox and radio inputs will have their 'checked' property set to false
 *  - inputs of type submit, button, reset, and hidden will *not* be effected
 *  - button elements will *not* be effected
 */
$.fn.clearForm = function(includeHidden) {
    return this.each(function() {
        $('input,select,textarea', this).clearFields(includeHidden);
    });
};

/**
 * Clears the selected form elements.
 */
$.fn.clearFields = $.fn.clearInputs = function(includeHidden) {
    var re = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i; // 'hidden' is not in this list
    return this.each(function() {
        var t = this.type, tag = this.tagName.toLowerCase();
        if (re.test(t) || tag == 'textarea') {
            this.value = '';
        }
        else if (t == 'checkbox' || t == 'radio') {
            this.checked = false;
        }
        else if (tag == 'select') {
            this.selectedIndex = -1;
        }
		else if (t == "file") {
			if (/MSIE/.test(navigator.userAgent)) {
				$(this).replaceWith($(this).clone(true));
			} else {
				$(this).val('');
			}
		}
        else if (includeHidden) {
            // includeHidden can be the value true, or it can be a selector string
            // indicating a special test; for example:
            //  $('#myForm').clearForm('.special:hidden')
            // the above would clean hidden inputs that have the class of 'special'
            if ( (includeHidden === true && /hidden/.test(t)) ||
                 (typeof includeHidden == 'string' && $(this).is(includeHidden)) )
                this.value = '';
        }
    });
};

/**
 * Resets the form data.  Causes all form elements to be reset to their original value.
 */
$.fn.resetForm = function() {
    return this.each(function() {
        // guard against an input with the name of 'reset'
        // note that IE reports the reset function as an 'object'
        if (typeof this.reset == 'function' || (typeof this.reset == 'object' && !this.reset.nodeType)) {
            this.reset();
        }
    });
};

/**
 * Enables or disables any matching elements.
 */
$.fn.enable = function(b) {
    if (b === undefined) {
        b = true;
    }
    return this.each(function() {
        this.disabled = !b;
    });
};

/**
 * Checks/unchecks any matching checkboxes or radio buttons and
 * selects/deselects and matching option elements.
 */
$.fn.selected = function(select) {
    if (select === undefined) {
        select = true;
    }
    return this.each(function() {
        var t = this.type;
        if (t == 'checkbox' || t == 'radio') {
            this.checked = select;
        }
        else if (this.tagName.toLowerCase() == 'option') {
            var $sel = $(this).parent('select');
            if (select && $sel[0] && $sel[0].type == 'select-one') {
                // deselect all other options
                $sel.find('option').selected(false);
            }
            this.selected = select;
        }
    });
};

// expose debug var
$.fn.ajaxSubmit.debug = false;

// helper fn for console logging
function log() {
    if (!$.fn.ajaxSubmit.debug)
        return;
    var msg = '[jquery.form] ' + Array.prototype.join.call(arguments,'');
    if (window.console && window.console.log) {
        window.console.log(msg);
    }
    else if (window.opera && window.opera.postError) {
        window.opera.postError(msg);
    }
}

})(jQuery);

/**
 * Cookie plugin
 *
 * Copyright (c) 2006 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */

/**
 * Create a cookie with the given name and value and other optional parameters.
 *
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Set the value of a cookie.
 * @example $.cookie('the_cookie', 'the_value', { expires: 7, path: '/', domain: 'jquery.com', secure: true });
 * @desc Create a cookie with all available options.
 * @example $.cookie('the_cookie', 'the_value');
 * @desc Create a session cookie.
 * @example $.cookie('the_cookie', null);
 * @desc Delete a cookie by passing null as value. Keep in mind that you have to use the same path and domain
 *       used when the cookie was set.
 *
 * @param String name The name of the cookie.
 * @param String value The value of the cookie.
 * @param Object options An object literal containing key/value pairs to provide optional cookie attributes.
 * @option Number|Date expires Either an integer specifying the expiration date from now on in days or a Date object.
 *                             If a negative value is specified (e.g. a date in the past), the cookie will be deleted.
 *                             If set to null or omitted, the cookie will be a session cookie and will not be retained
 *                             when the the browser exits.
 * @option String path The value of the path atribute of the cookie (default: path of page that created the cookie).
 * @option String domain The value of the domain attribute of the cookie (default: domain of page that created the cookie).
 * @option Boolean secure If true, the secure attribute of the cookie will be set and the cookie transmission will
 *                        require a secure protocol (like HTTPS).
 * @type undefined
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */

/**
 * Get the value of a cookie with the given name.
 *
 * @example $.cookie('the_cookie');
 * @desc Get the value of a cookie.
 *
 * @param String name The name of the cookie.
 * @return The value of the cookie.
 * @type String
 *
 * @name $.cookie
 * @cat Plugins/Cookie
 * @author Klaus Hartl/klaus.hartl@stilbuero.de
 */
jQuery.cookie = function(name, value, options) {
    if (typeof value != 'undefined') { // name and value given, set cookie
        options = options || {};
        if (value === null) {
            value = '';
            options.expires = -1;
        }
        var expires = '';
        if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
            var date;
            if (typeof options.expires == 'number') {
                date = new Date();
                date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000));
            } else {
                date = options.expires;
            }
            expires = '; expires=' + date.toUTCString(); // use expires attribute, max-age is not supported by IE
        }
        // CAUTION: Needed to parenthesize options.path and options.domain
        // in the following expressions, otherwise they evaluate to undefined
        // in the packed version for some reason...
        var path = options.path ? '; path=' + (options.path) : '';
        var domain = options.domain ? '; domain=' + (options.domain) : '';
        var secure = options.secure ? '; secure' : '';
        document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');
    } else { // only name given, get cookie
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
};
/* Данный файл содержит JavaScript плагины ReadyScript, необходимые для работы функций административной панели.
 * Также данные функции используются в режиме отладки в клиентской части сайта
 *
 * @author ReadyScript lab.
 */
(function($) {
    /**
     * Содержит touchstart или click в зависимости от типа устройства
     */
    $.rs = {};
    $.rs.hasTouch = ('ontouchstart' in document.documentElement && navigator.userAgent.match(/Mobi/));
    $.rs.clickEventName = $.rs.hasTouch ? 'touchstart' : 'click';

    $.extend({
        /**
         * Вызывает callback, когда весь DOM загружен и когда DOM обновлен.
         */
        contentReady: function(callback) {
            if (callback) {
                $(function() {
                    if (typeof($LAB) == 'undefined' || !$LAB.loading) {
                        callback.call($('body').get(0));
                    }
                });
                $(window).bind('new-content', function(e) {
                    var _this = e.target;
                    if ($LAB.loading) {
                        $(window).one('LAB-loading-complete', function(e) {
                            callback.call(_this);
                        });
                    } else {
                        callback.call(_this);
                    }
                });
            }
        },
        /**
         * Вызывается, когда загружен весь DOM и динамически загружены все скрипты
         * Расширяет стандартный $(document).ready
         */
        allReady: function(callback) {
            $(function() {
                if ($LAB.loading) {
                    var _this = this;
                    $(window).one('LAB-loading-complete', function(e) {
                        callback.call(_this);
                    });
                } else {
                    callback.call(this);
                }
            });
        },

        /**
         * jQuery.ajax с настроенными обработчиками по-умолчанию
         */
        ajaxQuery: function(options) {
            options = $.extend({
                loadingProgress: true,
                checkAuthorization: true,
                checkMessages: true,
                checkWindowRedirect:true,
                checkMeters:true,
                dataType: 'json'
            }, options);

            var clone_options = jQuery.extend({}, options);
            return $.ajax( $.extend(clone_options,
                {
                    beforeSend: function(jqXHR, settings) {
                        if (options.loadingProgress) $.rs.loading.show();
                        if (options.beforeSend) options.beforeSend.call(this, jqXHR, settings);
                    },
                    success: function(data, textStatus, jqXHR) {
                        if (options.loadingProgress) $.rs.loading.hide();
                        
                        if (options.dataType == 'json') {
                            if (options.checkAuthorization) 
                                $.rs.checkAuthorization(data);
                            
                            if (options.checkWindowRedirect)    
                                $.rs.checkWindowRedirect(data);
                                
                            if (options.checkMessages) 
                                $.rs.checkMessages(data);
                            
                            if (options.checkMeters)    
                                $.rs.checkMeters(data);
                        }
                        if (options.success) options.success.call(this, data, textStatus, jqXHR);
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        if (options.loadingProgress) $.rs.loading.error();
                        if (options.error) options.error.call(this, jqXHR, textStatus, errorThrown);
                    },
                    complete: function(jqXHR, textStatus) {
                        if (options.complete) options.complete.call(this, jqXHR, textStatus);
                    }
                }));
        }

    });


    /**
     * Инициализирует обновляемые блоки на странице в административной панели
     */
    $.rs.updatable = {
        initialized: false,
        dom: {
            defaultContainer: '.default-updatable:first', //Контейер, который будет обновлен по умолчанию
            container: '.updatable',
            callUpdate: '.call-update',
            formCallUpdate: 'form.form-call-update'
        },

        init: function() {
            $('body')
                .on('rs-update.updatable', $.rs.updatable.dom.container, $.rs.updatable.updateContainer)
                .on('click.updatable', $.rs.updatable.dom.callUpdate, $.rs.updatable.callUpdate)
                .on('submit.updatable', $.rs.updatable.dom.formCallUpdate, $.rs.updatable.formCallUpdate);

            $.rs.updatable.initState();
            $.rs.updatable.initialized = true;

            $(window).on('popstate', function(event) {
                //Инициализируем обновление при нажатии кнопки "назад"
                var state = event.originalEvent.state;
                if (state && state.rsUpdatableUrl) {
                    $($.rs.updatable.dom.defaultContainer).trigger('rs-update', [state.rsUpdatableUrl, null, {noUpdateHash: true}]);
                }
            });
        },

        initState: function() {
            if ($.rs.updatable.initialized) return;
            var blocksUrl = $.rs.updatable.getParsedHash();

            $.each(blocksUrl, function(block, url) {
                var div = '.updatable[data-update-block-id="'+block+'"]';
                $(div).trigger('rs-update', [decodeURIComponent(url), null, {noUpdateHash:true}]);
            });
        },

        getParsedHash: function() {
            var result = {};
            var hash = decodeURIComponent(location.hash.slice(1));

            if (hash.match(/([\w-]+='.*?')/g)) {
                var parts = hash.match(/([\w-]+='.*?')/g);
                $.each(parts, function(i, value) {
                    var item = value.match(/([\w-]+)='(.*?)'/);
                    result[item[1]] = item[2];
                });
            }
            return result;
        },

        /**
         * Устанавливает хэш страницы или меняет её URL
         *
         * @param blocksUrl - блок с параметрами для адреса
         */
        setHash: function(blocksUrl) {
            var hash = [];
            var newUrl;

            $.each(blocksUrl, function(block, url) {
                if (block == 'u') {
                    newUrl = url;
                } else {
                    //Остальное идет в хэш
                    hash.push( block+"='"+encodeURIComponent(url)+"'");
                }
            });

            if (newUrl) {
                var newHash = hash.length ? '#'.hash.join(';') : '';

                history.pushState({
                    rsUpdatableUrl: newUrl,
                    rsUpdatableHash: newHash
                }, '', newUrl + newHash);

            } else {
                location.hash = hash.join(';');
            }
        },

        /**
         * Обновление контейнера
         *
         * @param e - объект события
         * @param {string} url - Адрес для запроса
         * @param data - Передаваемые данные
         * @param ajaxParams - параметры для передачи ajax
         * @return {boolean}
         */
        updateContainer: function(e, url, data, ajaxParams) {
            if (!ajaxParams) ajaxParams = {};

            if (!url) {
                url = $(this).data('url');
            }
            if (url == '') return false;

            var $frame = $(this);
            var url_get = url;
            if (data) {
                url_get = url+(url.indexOf('?') > -1 ? '&'+$.param(data) : '?'+$.param(data));
            }
            $frame.data('url', url_get); //Устанавливаем последний

            $.ajaxQuery($.extend({
                url: url,
                dataType: 'json',
                data: data,
                success: function(response) {
                    if (response.close_dialog) { //Закрываем внешнее окно, если оно присутствует.
                        $frame.closest('.dialog-window').dialog('close');
                    } else {
                        //Изменяем URL
                        if (!ajaxParams.noUpdateHash && !$frame.is('[data-no-update-hash]')) {
                            var blockId = $frame.data('updateBlockId') ? $frame.data('updateBlockId') : 'u';
                            var blocks = $.rs.updatable.getParsedHash();
                            blocks[blockId] = url;
                            $.rs.updatable.setHash(blocks);
                        }

                        if ($frame.data('updateReplace')) {
                            var newFrame = $(response.html);

                            if ($frame.data('updateParse')) {
                                var parseFrame = $('.updatable', newFrame);
                                if (parseFrame.length) {
                                    newFrame = parseFrame;
                                }
                            }
                            $frame.replaceWith(newFrame);
                            $frame = newFrame;
                        } else {
                            $frame.html(response.html);
                        }
                        $frame.trigger('new-content');
                    }
                }
            }, ajaxParams));

            e.stopPropagation();
        },

        /**
         * Вызов обновления формы
         *
         * @param e
         * @return {boolean}
         */
        callUpdate: function(e) {
            var href = $(this).data('updateUrl') ? $(this).data('updateUrl') : $(this).attr('href'),
                ajaxParams = {};

            if ($(this).hasClass('no-update-hash')) ajaxParams.noUpdateHash = true;
            $.rs.updatable.updateTarget(e.target, href, null, ajaxParams);
            return false;
        },

        /**
         * Вызов обновления формы из самой формы
         * @param e
         * @return {boolean}
         */
        formCallUpdate: function(e) {
            var data = $(this).serializeArray();
            var url  = $(this).attr('action') ? $(this).attr('action') : location.pathname;


            if ($(this).attr('method').toUpperCase() == 'GET') {
                data = data.filter(function(value) {
                    //Исключаем параметр, который
                    return value['name'] != 'mod_controller' && value['value'] != '';
                });
                url = '?' + $.param(data);
                data = {};
            }

            var ajaxParams = {};
            if ($(this).hasClass('no-update-hash')) ajaxParams.noUpdateHash = true;
            $.rs.updatable.updateTarget(e.target, url, data, ajaxParams);
            return false;
        },

        /**
         * Обновляет контейнер, на который указывает элемент или контейнер по умолчанию
         */
        updateTarget: function(element, url, data, ajaxParams) {
            var $el = $(element), targetContainer;

            if ($el.data('updateContainer')) {
                targetContainer = $el.data('updateContainer');
            } else if ($el.closest($.rs.updatable.dom.container).length) {
                targetContainer = $el.closest($.rs.updatable.dom.container);
            } else {
                targetContainer = $.rs.updatable.dom.defaultContainer;
            }

            var target = $(targetContainer);

            if (target.length && (url || target.data('url'))) {
                target.trigger('rs-update', [url, data, ajaxParams]);
                return true;
            }
            return false;
        }
    };


    $.fn.extend({
        /**
         * Вызывает callback, когда был произведен клик вне зоны элемента или по нажатию Esc.
         * @param function callback - функция, которую необходимо вызвать при возникновении события
         * @param except - элемент исключения, при нажатии на который не будет происходить вызов callback
         */
        rsCheckOutClick: function( callback, except ) {
            return $(this).each(function() {
                var _this = this;
                $(this).on('click.checkout', function(e){e.stopPropagation();});
                $('html').on('click.checkout', function(e) {
                    if (e.target != except) {
                        callback.call(_this, e)
                    }
                });
                $('html').on('keypress.checkout', function(e) {if (e.keyCode == 27 ) callback.call(_this, e)} );
            });
        },
        /**
         * Активирует кнопки сортировки в диалоге настройки таблицы
         */
        tableOptions: function() {
            var $context = this;
            $('.ch-sort', $context).off('click').on('click', function() {
                var set_sortn;
                $('.current-sort', $context).remove();
                if ($(this).hasClass('asc') && $(this).data('canBe') != 'ASC') {
                    set_sortn = 'desc';
                }
                if ($(this).hasClass('desc') && $(this).data('canBe') != 'DESC') {
                    set_sortn = 'asc';
                }
                if ($(this).hasClass('no')) {
                    if ($(this).data('canBe') != 'BOTH') {
                        set_sortn = $(this).data('canBe').toLowerCase();
                    } else {
                        set_sortn = 'asc';
                    }
                }
                if (set_sortn) {
                    $('.ch-sort', $context).removeClass('asc desc').addClass('no');
                    $(this).removeClass('no').addClass(set_sortn);
                }
            });
        },

        /**
         * Добавляет HTML ошибок формы
         *
         * @param errors - объект ошибок
         * @param $form - jquery Объект формы, в которой нахзоятся input
         * @param _options
         */
        fillError: function(errors, $form, _options) {
            var defaults = {
                    containerClass: 'error-list',
                    fieldError: '.field-error'
                },
                options = $.extend(defaults, _options);

            var ul = $('<ul></ul>').addClass(options.containerClass);

            for(var key in errors) {
                var marker = $('<div></div>')
                    .addClass(errors[key]['class'])
                    .append(errors[key]['fieldname']+'<i class="cor"></i>')

                var err_msg = '';
                for(var n in errors[key]['errors']) {
                    err_msg = err_msg + errors[key]['errors'][n]+'<br>';
                }
                ul.append( $('<li></li>').append(marker, $('<div class="text"></div>').append(err_msg)) );

                if (key[0] != '@' && $form) {
                    $('[name="'+key+'"]', $form)
                        .addClass('has-error')
                        .on({
                            'focus.formerror': function() {
                                $(options.fieldError+'[data-field="'+$(this).attr('name')+'"]', $form).show();
                            },
                            'blur.formerror': function() {
                                $(options.fieldError+'[data-field="'+$(this).attr('name')+'"]', $form).hide();
                            }
                        });

                    $(options.fieldError+'[data-field="'+key+'"]', $form).html(
                        $('<span class="text"></span>').append('<i class="cor"></i>'+err_msg)
                    );

                    if ($('[name="'+key+'"]', $form).is(':focus')) {
                        $('[name="'+key+'"]', $form).focus(); //Посылаем событие
                    }
                }
            }
            $(this).html(ul);
        }

    });

    /**
     * Обрабатывает информацию о счетчиках, если таковая
     * присутствует в ответе от сервера
     */
    $.rs.checkMeters = function(response) {
        if (response.meters) {
            $.rsMeters('update', response.meters);
        }

        if (response.markViewed) {
            for(var meterId in response.markViewed) {

                if (response.markViewed[meterId] == 'all') {
                    var markViewedSelector = '';
                } else {
                    var markViewedSelector = '[data-id="'+response.markViewed[meterId]+'"]';
                }

                $('.item-is-viewed[data-meter-id="'+meterId+'"]' + markViewedSelector).each(function() {
                    $(this)
                        .removeClass('new')
                        .attr('data-original-title', $(this).data('viewedText'));
                });

            }
        }
        return true;
    };

    /**
     * Возвращает true, если требуется выполнить повторный произвольный запрос на сервер
     *
     * @param response
     * @returns {boolean}
     */
    $.rs.checkRepeat = function(response) {
        if (response.repeat && !response.needAuthorization) {
            return true;
        }
        return false;
    };

    /**
     * Возвращает true, если требуется повторно отправить всю форму
     * @param response
     * @returns {boolean}
     */
    $.rs.checkRepeatPost = function(response) {
        if (response.repeatPost && !response.needAuthorization) {
            return true;
        }
        return false;
    };

    /**
     * Возвращает true, если не требуется выполнять редирект на другую страницу
     *
     * @param response
     * @returns {boolean}
     */
    $.rs.checkWindowRedirect = function(response) {
        if (typeof(response) == 'object' && response.windowRedirect) {
            location.href = response.windowRedirect;
            return false;
        }
        return true;
    };

    /**
     * Отключает scroll у основного контента в body
     */
    $.rs.lockBody = function() {
        var $wrap = $('#content');
        if ($wrap.length) {
            if (window.pageYOffset) {
                $wrap[0].oldScrollTop = window.pageYOffset;
                $wrap.css({
                    top: -($wrap[0].oldScrollTop)
                });
            }

            $('html, body').css({
                height: "100%",
                overflow: "hidden"
            });
        }
    };

    /**
     * Возвращает scroll основному контенту в body
     */
    $.rs.unlockBody = function() {
        var $wrap = $('#content');
        if ($wrap.length) {
            $('html, body').css({
                height: "",
                overflow: ""
            });

            $wrap.css({
                top: ''
            });

            window.scrollTo(0, $wrap[0].oldScrollTop);
            window.setTimeout(function () {
                $wrap[0].oldScrollTop = null;
            }, 0);
        }
    };

    /**
     * Отображает сообщения, если данная инструкция была направлена с сервера
     *
     * @param response
     * @returns {boolean}
     */
    $.rs.checkMessages = function(response) {
        try {
            if (typeof(response) == 'object' && response.messages) {
                for(var i in response.messages) {
                    messageObject = {
                        text: response.messages[i].text
                    }
                    if (typeof(response.messages[i].options) == 'object') {
                        messageObject = $.extend(response.messages[i].options, messageObject);
                    }
                    $.messenger('show', messageObject);
                }
            }
        } catch(err) {};
        return true;
    };

    /**
     * Выполняет редирект на страницу авторизации, в случае необходимости.
     * Возвращает false, если произошел редирект
     *
     * @param response ответ сервера от ajax запроса
     * @returns {boolean}
     */
    $.rs.checkAuthorization = function(response)
    {
        if (typeof(response) == 'object' && response.needAuthorization) {
            var param = (global.authUrl.indexOf('?') == -1) ? '?referrer='+location.href : '&referer='+location.href;
            location.href = global.authUrl + param;
            return false;
        }
        return true;
    };

    /**
     * Отвечает за отображение полосы загрузки, ошибок во время Ajax операций
     */
    $.rs.loading = {
        stackLength: 0,
        element: null,
        inProgress: false,
        /**
         * Отображает индикатор загрузки
         */
        show: function() {
            this.hide(true);
            this.inProgress = true;
            if (!this.element) {
                this.element = $('<div class="rs-loading"></div>');

                var currentWindowTitle = $('.ui-dialog-titlebar:last:visible');
                var targetZone = (currentWindowTitle.length) ? currentWindowTitle : '.header-panel';

                this.element.appendTo(targetZone);
            }
            this.stackLength++;
        },

        /**
         * Скрывает индикатор загрузки
         */
        hide: function(noDec) {
            if (this.stackLength>0 && !noDec) {
                this.stackLength--;
            }

            if (this.element && this.stackLength == 0) {
                this.inProgress = false;
                this.element.remove();
                this.element = null;
            }
        },

        /**
         * Отображает текст ошибки загрузки отправки данных
         */
        error: function(errtext) {
            this.stackLength = 0;
            this.hide();
            if (!errtext) {
                errtext = lang.t('Ошибка передачи данных. Повторите попытку еще раз');
            }

            var currentWindowTitle = $('.ui-dialog-titlebar:last:visible');
            var targetZone = (currentWindowTitle.length) ? currentWindowTitle : '.header-panel';

            this.element = $('<div class="rs-loading-error"></div>')
                .append( $('<span></span>').html(errtext) )
                .append('&nbsp;')
                .append( $('<a class="zmdi zmdi-close"></a>').on('click', function() {
                    $(this).parent().remove();
                }))
                .appendTo(targetZone);
        }
    };

    /**
     * Открывает определенный url в диалоговом окне
     *
     * @param {Object} options - опции диалогового окна
     */
    $.rs.openDialog = function(options)
    {
        options = $.extend({
            url: '',
            ajaxOptions: {},
            dialogOptions: {},
            close: function() {},
            afterOpen: function() {},
            dialogId: null,
            extraParams: {}
        }, options);

        if (options.ajaxOptions && options.ajaxOptions.data) {
            if (typeof(options.ajaxOptions.data) == 'object' && options.ajaxOptions.data instanceof Array) {
                options.ajaxOptions.data.push({name: 'ajax', value: '1'}, {name: 'ajaxDialog', value: '1'});
            }
            if (typeof(options.ajaxOptions.data) == 'object') {
                options.ajaxOptions.data = $.extend(options.ajaxOptions.data, {ajax:1, dialogMode:1});
            }
        }

        if (options.dialogId) {
            var dialog = $('#'+options.dialogId);
            if (!dialog.length) {
                var dialog = $('<div>').attr('id', options.dialogId);
            }
        } else {
            var dialog = $('<div>');
        }

        var initDialog = function(response) {
            if (!response || !response.needAuthorization) {

                if (response) {
                    try{
                        if (options.dialogOptions.crudOptions.onLoadTrigger) {
                            $(window).trigger(options.dialogOptions.crudOptions.onLoadTrigger, response);
                        }
                    } catch(e) {}
                    if (response.close_dialog) return;
                }

                $(dialog)
                    .addClass('dialog-window')
                    .dialog($.extend({
                        modal: true,
                        resizable:false,
                        draggable:false,
                        responsive:true,
                        clickOut:false,
                        closeText:false,
                        closeX:false,

                        width:'auto',
                        create: function() {
                            //Оборачиваем диалог, чтобы сохранить его стили
                            var wrapper = $('.admin-dialog-wrapper:first');
                            if (!wrapper.length) {
                                wrapper = $('<div class="admin-style admin-dialog-wrapper" />').appendTo('body');
                            }

                            $(this).closest('.ui-dialog').appendTo(wrapper);
                            $(this).data('dialogWrapper', wrapper);

                            var initContent = function() {
                                //Устанавливаем заголовок окна
                                var titleElement = $('.titlebox:first', dialog).hide();
                                if (titleElement.length) {
                                    dialog.dialog('option', 'title', titleElement.length ? titleElement.html() : '');
                                }
                                var dataLocalOptions = {};

                                var localOptions = $('[data-dialog-options]', dialog);
                                if (localOptions.length) {
                                    dataLocalOptions = $.extend(dataLocalOptions, localOptions.data('dialogOptions'));
                                }

                                for (var property in dataLocalOptions) {
                                    dialog.dialog('option', property, dataLocalOptions[property]);
                                    //Обновляем данные для корректной адаптации Диалогового окна
                                    if (property == 'width') {
                                        dialog.dialog('option', 'originalWidth', dataLocalOptions[property]);
                                    }
                                    if (property == 'height') {
                                        dialog.dialog('option', 'originalHeight', dataLocalOptions[property]);
                                    }
                                }
                            };

                            if (response) {
                                $(this).html(response.html);
                                $(this).bind('initContent', initContent);
                                initContent.call(this);
                            }
                        },
                        open: function() {
                            options.afterOpen($(this));

                            $('.ui-widget-overlay:last').appendTo( $(this).data('dialogWrapper') );

                            if (!$(this).data('dialogAlreadyLoaded')) {
                                $(this).data('dialogAlreadyLoaded', true);

                                if (typeof($LAB) != 'undefined' && $LAB.loading) {
                                    $(window).one('LAB-loading-complete', function() {
                                        //Если идет загрузка скриптов, то откладываем событие,
                                        //чтобы код с криптах мог подписаться на события
                                        $(dialog).trigger('new-content');
                                    });
                                } else {
                                    $(dialog).trigger('new-content');
                                }
                            }
                        },
                        close: function(e, ui) {
                            options.close.call(dialog, dialog);
                            if (!options.dialogId) {
                                $(this).dialog('destroy');
                            }
                        },
                        beforeDestroy: function(e, ui) {
                            $(dialog).trigger('dialogBeforeDestroy');
                        },
                        afterDestroy: function(e, ui) {
                            if ($(this).data('dialogWrapper') && $(this).data('dialogWrapper').is(':empty')) {
                                $(this).data('dialogWrapper').remove();
                            }
                        }
                    }, options.dialogOptions))
                    .on('close-dialog', function(event, originalEvent) {
                        $(this).dialog('close');
                        if (originalEvent) {
                            originalEvent.preventDefault();
                        }
                    });
            }
        };

        try{
            if (options.dialogOptions.crudOptions.beforeCallback) {
                var result = eval(options.dialogOptions.crudOptions.beforeCallback+'(options)');
                if (result) options = result;
            }
        } catch(e) {}

        if (!dialog.data('dialogAlreadyLoaded')) {
            $.ajaxQuery($.extend({
                url: options.url,
                dataType: 'json',
                data: $.extend({ajax:1, dialogMode:1}, options.extraParams),
                success: initDialog
            }, options.ajaxOptions));
        } else {
            initDialog(null);
        }

        return false;
    };


    /**
     * Plugin инициализирует отображение форм редактирования во весь экран
     */
    $.widget('rs.rsFullScreenDialog', {
        options: {
            onShow:function(event, data) {},
            onDestroy:function(event, data) {}
        },
        _create: function() {
            $(' > :visible',this.document[ 0 ].body).addClass('hide-important');

            this._createWrapper();
            this.element.appendTo(this.fsDialog);
            this.fsDialog.appendTo(this.document[ 0 ].body);
            this._trigger('onShow', {dialog: this.fsDialog});

            this._on('body', {
                keyup: function(e) {
                    if (e.keyCode == 27) this.destroy();
                }
            });

            this._on(this.fsDialog, {
                'closeFsDialog': function(event, sourceEvent) {
                    if (sourceEvent) {
                        sourceEvent.preventDefault();
                    }
                    this.destroy();
                }
            });
        },
        _createWrapper: function() {
            this.fsDialog = $('<div>').addClass('rs-fs-dlg');
            return this.fsDialog;
        },
        _destroy:function() {
            this._trigger('onDestroy', {dialog: this.fsDialog});
            $(' > .hide-important', this.document[ 0 ].body).removeClass('hide-important');

            this.element.detach();
            this.fsDialog.remove();
        },
        widget:function() {
            return this.fsDialog;
        }
    });

    /* Plugin инициализирует микроразметку административных функций ReadyScript */
    $.widget('rs.rsAdminFunctions', {
        options: {

        },
        _create:function() {
            var self = this;
            this.bottomDisableStack = [];
            this.element
                .on('click', '.crud-add', function(e) { return self._runManager(e, 'add') })
                .on('click', '.crud-edit', function(e) { return  self._runManager(e, 'edit') })
                .on('click', '.crud-remove', function(e) { return  self._runManager(e, 'remove')})
                .on('submit','.crud-form', function(e) { return self._runManager(e, 'formsave')})
                .on('click', '.crud-form-save', function(e) { return self._runManager(e, 'formsave') })
                .on('click', '.crud-form-apply', function(e) { return self._runManager(e, 'formsave') })
                .on('click', '.crud-form-cancel', function(e) { return self._runManager(e, 'cancel') })
                .on('click', '.crud-list-save', function(e) { return self._runManager(e, 'listsave') })
                .on('click', '.crud-post, .crud-post-selected', function(e) { return self._runManager(e, 'post') })
                .on('click', '.crud-remove-one', function(e) { return self._runManager(e, 'removeone') })
                .on('click', '.crud-multiedit', function(e) { return self._runManager(e, 'multiedit') })
                .on('click', '.crud-multiaction', function(e) { return self._runManager(e, 'multiaction') })
                .on('click', '.crud-dialog', function(e) { return self._runManager(e, 'dialog') })
                .on('click', '.crud-switch', function(e) { return self._runManager(e, 'itemswitch') })
                .on('click', '.crud-get', function(e) { return self._runManager(e, 'get')})
                .on({
                    'disableBottomToolbar.crud': function(e, key) {
                        $('.crud-form-save, .crud-form-apply, .btn.delete', $('.bottom-toolbar')).addClass('disabled');
                        if (self.bottomDisableStack.indexOf(key) == -1) {
                            self.bottomDisableStack.push(key);
                        }
                    },
                    'enableBottomToolbar.crud': function(e, key) {
                        var index = self.bottomDisableStack.indexOf(key);
                        if (index != -1) {
                            self.bottomDisableStack.splice(index, 1);
                        }
                        //Разблокируем кнопки, только если не осталось ни одного блокирующего элемента
                        if (!self.bottomDisableStack.length) {
                            $('.crud-form-save, .crud-form-apply, .btn.delete', $('.bottom-toolbar')).removeClass('disabled');
                        }
                    }
                });
        },

        /**
         *
         */
        _runManager: function(event, action) {
            if (event.ctrlKey)
                return true;

            if ($.rs.loading.inProgress)
                return false;

            if ($(event.currentTarget).is('.disabled'))
                return false;

            return this['_action_' + action](event);
        },

        /**
         * Открывает окно редактирования объекта
         */
        _action_add: function(e, checked) {
            var self = this,
                button = e.currentTarget,
                url = $(button).data('url') ? $(button).data('url') : $(button).attr('href');

            var crudOptions = $(button).data('crudOptions');

            if (typeof(crudOptions) != 'object') crudOptions = {};
            crudOptions.openerElement = $(button).closest('.updatable');

            var extendOptions = {};
            try {
                if (crudOptions.updateBlockId) {
                    crudOptions.updateElement = $('[data-update-block-id="'+crudOptions.updateBlockId+'"]').get(0);
                }
                if (crudOptions.updateThis) {
                    crudOptions.updateElement = button;
                }
                if (crudOptions.dialogId) {
                    extendOptions.dialogId = crudOptions.dialogId;
                }
            } catch(err) {}

            //Маленькое окно по умолчанию
            var widthParam = {
                width:600,
                height:500
            };

            //Большое окно
            if (!$(button).hasClass('crud-sm-dialog')) {
                widthParam = {
                    width:'95%', //  0.95 * $(window).width(),
                    height:0.95 * $(window).height()
                };
            }
            // Свои размеры
            if ($(button).data('crud-dialog-width')) {
                widthParam.width = $(button).data('crud-dialog-width');
            }
            if ($(button).data('crud-dialog-height')) {
                widthParam.height = $(button).data('crud-dialog-height');
            }

            $.rs.openDialog($.extend({
                dialogOptions: $.extend({//Передаем в диалоговое окно дополнительные данные инициатора действия
                    crudOptions: crudOptions,
                }, widthParam),
                url: url,
                button: button,
                ajaxOptions: {
                    data: checked
                },
                afterOpen: function(dialog) {
                    if ($(button).hasClass('crud-replace-dialog')) {
                        $(button).trigger('close-dialog');
                    }

                    dialog.on('dialogclose', function() {
                         //Очищаем стек запретов, если окно закроется
                         self.bottomDisableStack = [];
                    });
                }
            }, extendOptions));

            return false;
        },

        /**
         * Открывает диалог редактирования записи
         */
        _action_edit: function(e, checked) {
            return this._action_add.call(this, e, checked);
        },

        _action_cancel: function(e) {
            $(e.currentTarget).trigger('close-dialog', e);
        },

        _action_formsave: function(e) {
            e.preventDefault();
            var self = this;
            if (self.bottomDisableStack.length) return false;

            var button = e.currentTarget;
            var is_apply = $(button).is('.crud-form-apply');

            //Если Submit был по нажатию Enter, эмитируем нажатие кнопки "Сохранить"
            if ($(button).is('form')) {
                button = $('.crud-form-save:first', self._getGroup(button));
                if (!button.length) return false;
            }

            var $group = self._getGroup(button);
            var $form = self._getForm(button);
            var dialog = self._getMyDialog(button);

            var afterSubmit = function() {
                $('button[type="submit"], input[type="submit"]', $form)
                    .removeAttr('disabled'); //Защита от двойного клика
            };

            /**
             * Отображает всплывающую подсказку возле кнопки "Сохранить"
             *
             * @param text
             * @param className
             */
            var showPopOver = function(text, className) {
                var content = $('<span>').addClass(className).html(text);
                content.find('.scroll-to-top').click(function() {
                    if (self._getMyDialog(button) !== false) {
                        self._getGroup(button).find('.contentbox').scrollTop(0);
                    } else {
                        $(window).scrollTop(0);
                    }
                });

                $(button).popover({
                    content: content,
                    viewport:self._getGroup(button),
                    trigger:'manual',
                    placement:'top',
                    html:true
                }).popover('show');

                var timeout = setTimeout(function() {
                    $(button).popover('destroy');
                }, 7000);

                content.on('click', function() {
                    clearTimeout(timeout);
                    $(button).popover('destroy');
                });
            };

            /**
             * Финальная обработка пришедшего запроса
             *
             * @param object dialog   - объект диалогового окна
             * @param object responce - объект ответа с сервера
             */
            var finalProcess = function (dialog, response){
                if ($.rs.checkAuthorization(response)
                    && $.rs.checkWindowRedirect(response)
                    && $.rs.checkMessages(response)                    
                    && $.rs.checkMeters(response)) {
                    
                    var crudOptions = dialog ? dialog.dialog('option', 'crudOptions') : {};
                    
                    if (response.success) {
                        $form.trigger('crudSaveSuccess', [response, crudOptions]);
                        var redirect = response.redirect ? response.redirect : null;
                        //Сохранение прошло успешно
                        if (dialog && !is_apply) { //Если всё было в диалоговом окне
                            if (response.html && response.html != '') {
                                //Обновляем контент в диалоге
                                dialog.html(response.html)
                                    .trigger('new-content')
                                    .trigger('initContent')
                                    .trigger('contentSizeChanged');
                                return;
                            }

                            //Редактирование в диалоге
                            if (response.callCrudAdd) {
                                var a = $('<a />').data('url', response.callCrudAdd);
                                if (response.crudDialogWidth) {a.data('crud-dialog-width', response.crudDialogWidth)}
                                if (response.crudDialogHeight) {a.data('crud-dialog-height', response.crudDialogHeight)}
                                self._action_add({currentTarget: a});
                            } else {
                                if (!response.noUpdateTarget){ //Если нет флага о том, что нужно перезагрузить область
                                    if (crudOptions && crudOptions.openerElement) {
                                        self._updateTarget(crudOptions.openerElement, redirect, crudOptions); //обновляем область с опциями
                                    }
                                }
                            }
                            dialog.dialog('close');

                        } else {
                            //Редактирование на отдельной странице
                            if (!is_apply && !dialog) {
                                //Если нажали "сохранить и закрыть" на отдельной странице
                                //то нажимаем после сохранения кнопку Закрыть
                                if (response.callCrudAdd) {
                                    location.href = response.callCrudAdd;
                                } else {
                                    var cancel = $('.crud-form-cancel', $group);
                                    if (cancel.length) {
                                        cancel[0].click();
                                    }
                                }
                            } else {
                                //Нажали "сохранить" в диалоговом окне
                                $('.crud-form-success', $group).html(response.formdata.success_text).show();
                                if (response.success_text_timeout) {
                                    setTimeout(function () {
                                        $('.crud-form-success', $group).slideUp();
                                    }, response.success_text_timeout ? response.success_text_timeout : 7000);
                                }

                                showPopOver(lang.t('Изменения успешно сохранены'), 'c-green text-nowrap');

                                if (!response.noUpdateTarget){ //Если нет флага о том, что нужно перезагрузить область

                                    //Перезагрузим область, из которой произошел переход
                                    if (crudOptions && crudOptions.openerElement) {
                                        self._updateTarget(crudOptions.openerElement, redirect, crudOptions); //обновляем область с опциями
                                    }
                                }
                            }
                        }

                    } else {
                        $form.trigger('crudSaveFail', [response, crudOptions]);
                        //Во время сохранения возникли ошибки
                        if (response.formdata) {

                            showPopOver(lang.t('<a class="scroll-to-top c-red">Во время сохранения возникла ошибка</a>'), 'c-red');

                            $('.crud-form-error', $group).fillError(response.formdata.errors, $form);
                            if (dialog) {
                                dialog.trigger('contentSizeChanged');
                            }
                        }
                    }
                }
            };

            var ajaxOptions = {
                data: {ajax: 1},
                dataType:'json',
                beforeSerialize: function(form, options) {
                    $('select.selectAllBeforeSubmit option', form).prop('selected', true);
                    form.trigger('beforeAjaxSubmit', form, options);
                },
                beforeSubmit: function(arr, form, options) {
                    $('button[type="submit"], input[type="submit"]',$form).attr('disabled','disabled'); //Защита от двойного клика
                    $.rs.loading.show();
                },
                success: function(response) {
                    $('.crud-form-error, .crud-form-success', $group).html('');
                    $('.has-error', $form).removeClass('has-error');
                    $('.field-error', $form).hide();
                    $('[name]', $form).off('.formerror');

                    //Данные успешно отправлены
                    if ($.rs.checkRepeat(response)){
                        var params = $.extend({
                            type:'POST',
                            dataType:'json',
                            data: {},
                            url:'',
                            success: ajaxOptions.success,
                            error: ajaxOptions.error,
                            checkAuthorization: false,
                            checkMessages: false,
                            checkWindowRedirect: false,
                            checkMeters: false,
                        }, response.queryParams);

                        $.ajaxQuery(params);
                    } else if ($.rs.checkRepeatPost(response)) {
                        let newAjaxOptions = ajaxOptions;
                        if (response.queryParams) {
                            newAjaxOptions = $.extend(newAjaxOptions, {
                                data: response.queryParams
                            });
                        }
                        $.rs.loading.hide();
                        $form.ajaxSubmit(newAjaxOptions);
                    } else {
                        $.rs.loading.hide();
                        finalProcess(dialog, response);
                        afterSubmit();
                    }
                },
                error: function() {
                    //Ошибка отправки формы
                    $.rs.loading.error();
                    afterSubmit();
                }
            };

            if ($(button).data('url')) {
                ajaxOptions.url = $(button).data('url');
            }

            $form.ajaxSubmit(ajaxOptions);

        },

        _action_remove: function(e)
        {
            var target = $(e.currentTarget);
            if (!target.data('confirmText')) {
                target.data('confirmText', lang.t('Вы действительно хотите удалить выбранные элементы (%count)?'));
            }
            return this._action_post(e);
        },

        /**
         * Выполняет Ajax'ом POST запрос и передает все сведения, представленные внутри формы
         */
        _action_listsave: function(e) {
            var button = e.currentTarget;
            var $form = this._getListForm(button);
            var url = $(button).data('url') ? $(button).data('url') : $(button).attr('href');
            var confirmText = $(button).data('confirmText');

            if (confirmText && !confirm( confirmText )) {
                return false;
            }

            $.rs.loading.show();
            $form.ajaxSubmit({
                dataType: 'json',
                data: {
                    ajax: 1
                },
                url: url,
                success: function(response) {
                    $.rs.loading.hide();
                    $.rs.checkAuthorization(response);
                    $.rs.checkWindowRedirect(response);
                    $.rs.checkMessages(response);
                    $.rs.checkMeters(response);

                    if (response.success) {
                        $.rs.updatable.updateTarget(e.currentTarget);
                    }
                },
                error: function() {
                    $.rs.loading.error();
                }
            });

            return false;
        },

        /**
         * Выполняет Ajax'ом POST запрос для выбранных элементов
         */
        _action_post: function(e) {
            var self = this;
            var button = e.currentTarget;
            var $form = this._getListForm(button);
            var url = $(button).data('url') ? $(button).data('url') : $(button).attr('href');
            var confirmText = $(button).data('confirmText');

            if ($('.select-all:checked', $form).length && $('.total_value', $form.parent()).length) {
                var total = $('.total_value', $form.parent()).text();
            } else {
                var total = $('input[name="chk[]"]:checked', $form).length;
            }
            
            if (confirmText) {
                confirmText = confirmText.replace('%count', total);
            }
            if (!total || (confirmText && !confirm( confirmText )) ) {
                return false;
            }

            $.rs.loading.show();

            var ajaxOptions = {
                dataType: 'json',
                data: {
                    ajax: 1
                },
                url: url,
                success: function(response) {
                    $.rs.checkAuthorization(response);
                    $.rs.checkWindowRedirect(response);
                    $.rs.checkMessages(response);
                    $.rs.checkMeters(response);

                    if ($.rs.checkRepeat(response)) {
                        var params = $.extend({
                            type: 'POST',
                            dataType: 'json',
                            data: {},
                            url: url,
                            success: ajaxOptions.success,
                            error: ajaxOptions.error,
                            checkAuthorization: false,
                            checkMessages: false,
                            checkWindowRedirect: false,
                            checkMeters: false,
                        }, response.queryParams);

                        $.ajaxQuery(params);

                    } else if ($.rs.checkRepeatPost(response)) {
                        let newAjaxOptions = ajaxOptions;
                        if (response.queryParams) {
                            newAjaxOptions = $.extend(newAjaxOptions, {
                                data: response.queryParams
                            });
                        }
                        $form.ajaxSubmit(newAjaxOptions);
                    } else {
                        $.rs.loading.hide();
                        if (response.success) {
                            var crudOptions = $(button).data('crudOptions');
                            self._updateTarget(button, null, crudOptions ? crudOptions : null);
                        }
                    }
                },
                error: function() {
                    $.rs.loading.error();
                }
            };

            $form.ajaxSubmit(ajaxOptions);

            return false;
        },

        /**
         * Удаляет один элемент
         */
        _action_removeone: function(e) {
            var self = this;
            if (!confirm(lang.t('Вы действительно хотите удалить выбранный элемент?'))) {
                return false;
            }

            var button = $(e.currentTarget),
                crudOptions = button.data('crudOptions'),
                url = button.data('url') ? button.data('url') : button.attr('href');

            $.ajaxQuery({
                url : url,
                data: {
                    ajax: 1
                },
                success: function() {
                    self._updateTarget(button, null, crudOptions ? crudOptions : null);
                }
            });

            return false;
        },

        _action_multiedit: function(e) {
            var $form = this._getListForm(e.currentTarget);
            var data = $form.serializeArray();

            var forbid = $('input.firbid-miltiedit[name="chk[]"]:checked', $form);
            if (forbid.length) {
                let alertText = $('[data-forbid-multiedit-alert]').data('forbidMultieditAlert');
                if (!alertText) {
                    alertText = lang.t('Выбраны недопустимые для мультиредактирования элементы');
                }
                alert(alertText);
                return false;
            }

            var checked = $('input[name="chk[]"]:checked', $form);
            if (!checked.length) {
                return false;
            }

            if (checked.length == 1) { //Перебрасываем на обычное редактирование
                var edit_one = $('.crud-edit[data-id="'+checked[0]['value']+'"]', $form);
                if (edit_one.length) {
                    edit_one.click();
                } else {
                    alert(lang.t('Выберите как минимум 2 элемента для мультиредактирования'));
                }
                return false;
            } else {
                return this._action_edit(e, data);
            }
        },

        _action_multiaction: function(e) {
            var $form = this._getListForm(e.currentTarget);
            var data = $form.serializeArray();

            var checked = $('input[name="chk[]"]:checked', $form);

            if (!checked.length) {
                return false;
            }
            return this._action_edit(e, data);

        },

        /**
         * Открывает диалог и загружает в него контент, при закрытии диалога обновляет содержимое основного поля
         */
        _action_dialog: function(e)
        {
            var button = $(e.currentTarget);
            $.rs.openDialog({
                url: button.data('url') ? button.data('url') : button.attr('href'),
                button: e.currentTarget,
                dialogOptions: {
                    title: button.attr('title'),
                    close: function() {
                        $.rs.updatable.updateTarget(e.currentTarget);
                    }
                }
            });
            return false;
        },

        /**
         * Отправляет запрос на сервер, после действия выключателя
         */
        _action_itemswitch: function(e) {
            var url = $(e.currentTarget).data('url');
            $.ajaxQuery({
                loadingProgress: false,
                url:url
            });
        },

        /**
         * Выполняет get запрос (url берется из data-url) и обновляет содержимое видимой области
         */
        _action_get: function(e) {
            var button = e.currentTarget;
            var self = this;

            if (this._checkConfirm(button)) {
                var url = $(button).data('url') ? $(button).data('url') : $(button).attr('href');
                var dialog = this._getMyDialog(button);

                var ajaxOptions = {
                    url: url,
                    success: function(response) {
                        //Данные успешно отправлены

                        if ($.rs.checkRepeat(response)){
                            var params = $.extend({
                                type:'POST',
                                dataType:'json',
                                data: {},
                                url:url,
                                success: ajaxOptions.success,
                                error: ajaxOptions.error,
                            }, response.queryParams);

                            $.ajaxQuery(params);

                        } else {
                            if (typeof(response) == 'object' && !response.noUpdate) {
                                self._updateTarget(button, null, dialog ? dialog.dialog('option', 'crudOptions') : null);
                            }

                            if ($(button).hasClass('crud-close-dialog') && dialog) {
                                dialog.dialog('close');
                            }
                        }

                    }
                };

                $.ajaxQuery(ajaxOptions);
            }
            return false;
        },


        /**
         * Возвращает элемент окна, в котором находится элемент или false
         *
         * @param element
         */
        _getMyDialog: function(element)
        {
            var $win = $(element).closest('.dialog-window');
            return $win.length ? $win : false;
        },

        /**
         * Возвращает элемент, который оборачивает
         */
        _getGroup: function(element)
        {
            return $(element).closest('.crud-ajax-group');
        },

        /**
         * Возвращает форму, которую будет использовать element
         */
        _getForm: function(element) {
            if ($(element).data('form')) {
                var $form = $( $(element).data('form') );
            } else if (element.tagName == 'FORM') {
                var $form = $(element);
            } else if ($(element).closest('form').length) {
                var $form = $(element).closest('form');
            } else {
                var $form = $('.crud-form', this._getGroup(element));
            }
            return $form;
        },

        /**
         * Возвращает форму, которую будет использовать element
         */
        _getListForm: function(element) {
            if ($(element).data('form')) {
                var $form = $( $(element).data('form') ); //Если форма явно задана в атрибуте элемента
            } else if ($(element).closest('[data-linked-form]').length) {
                var $form = $($(element).closest('[data-linked-form]').data('linkedForm')); //Если элемент обернут в блок с атрибутом data-linked-form
            } else if ($(element).closest('form').length) {
                var $form = $(element).closest('form'); //Если выше есть какая-нибудь форма
            } else {
                var $form = $('.crud-list-form', this._getGroup(element)); //Ищем в ajax-group элемент с классом crud-list-form
            }
            return $form;
        },

        /**
         * Спрашивает у пользователя подтверждение, если это необходимо
         */
        _checkConfirm: function(element)
        {
            if ($(element).data('confirmText')) {
                return confirm($(element).data('confirmText'));
            }
            return true;
        },

        /**
         * Обновляет необходимый контейнер возле элемента element
         */
        _updateTarget: function(element, redirect, crudOptions)
        {
            if (crudOptions && crudOptions.updateElement) {
                element = crudOptions.updateElement;
            }

            var ajaxParam = (crudOptions && crudOptions.ajaxParam) ? crudOptions.ajaxParam : null;

            if (!$.rs.updatable.updateTarget(element, redirect, null, ajaxParam)) {
                location.reload(true);
            }
        }

    });

    /**
     * Строит диапозон чисел
     *
     * @param low - первая цифра
     * @param high - последняя цифра
     * @param step - шаг числа
     * @return {Array}
     */
    function range (low, high, step) {
        var matrix = [];
        var plus;
        var walker = step || 1;
        if (!isNaN(low) && !isNaN(high)) {
            iVal = low;
            endval = high;
        } else {
            iVal = (isNaN(low) ? 0 : low);
            endval = (isNaN(high) ? 0 : high);
        }
        plus = !(iVal > endval);
        if (plus) {
            while (iVal <= endval) {
                matrix.push(iVal);
                iVal += walker;
            }
        } else {
            while (iVal >= endval) {
                matrix.push(iVal);
                iVal -= walker;
            }
        }
        return matrix;
    }

    $.rs.checkboxChange = function() {

        var checkChange = function() {
            if (this.checked) {
                $(this).closest('.chk').addClass('checked');
            } else {
                var $parentform = $(this).closest('form');
                $(this).closest('.chk').removeClass('checked');
                $('.select-all', $parentform).prop('checked', false);
                $('.select-page', $parentform).prop('checked', false);
                $('thead .chk', $parentform).removeClass('checked-all checked');
            }
        };

        //Инициализируем подсветку выбранных чекбоксов
        $('body').on('change.chk', '.chk input:checkbox', checkChange);

        //Инициализируем подсветку выбранных чекбоксов
        $('body').on('click.chk', '.chk', function(e) {
            var checkbox = $('input:checkbox', this).get(0);
            var tag; //Тег для подсчета
            var wrapper; //Обёртка
            //В зависимости от родителя смотрим обёртку и элемент для посчета
            var click_tag_name = $(this).parent().get(0).tagName;
            if (click_tag_name == 'TD' || click_tag_name == 'TR'){
                tag = "tr";
                wrapper = $(this).closest('tbody');
            }else{
                tag = "li";
                wrapper = $(this).closest('ul');
            }

            if (!checkbox.disabled) {
                if (e.target.tagName != 'INPUT') {
                    if (checkbox) {
                        checkbox.checked = !checkbox.checked;
                        $(checkbox).change();
                    }
                }
            }

            if (e.shiftKey){ //Если зажат SHIFT

                //Смотрим первый элемент и до последнего тянем
                var first_selected = $(".preShiftChecked:first", wrapper);
                if (click_tag_name != 'TD' && click_tag_name != 'TR'){
                    wrapper = first_selected.closest('ul');
                }

                if (first_selected.length){
                    var first = first_selected.closest(tag).index(); //Смотрим идекс
                    first_selected.addClass('checked');

                    var last = $(this).closest(tag).index(); //Последний нажатый элемента

                    var elements_range = range(last, first);
                    var need_be_selected = checkbox.checked; //Флаг нужно ли снимать нужный класс выделения или ставить
                    $.each(elements_range, function(k, key) {
                        var search_tag = ">" + tag + ":eq(" + key + ")";
                        if (need_be_selected){
                            $(search_tag + " .chk", wrapper).addClass('checked');
                            $(search_tag + " [type='checkbox']", wrapper).prop('checked', true).change();
                        }else{
                            $(search_tag + " .chk", wrapper).removeClass('checked');
                            $(search_tag + " [type='checkbox']", wrapper).prop('checked', false).change();
                        }
                    });
                }
            }
            $(".chk").removeClass('preShiftChecked');
            $(this).addClass('preShiftChecked');
        });

        var onSelectButton = function() {
            var name = $(this).data('name');
            var state = this.checked;

            var $parentform = $(this).closest('.localform');
            if (!$parentform.length) {
                $parentform = $(this).closest('form');
            }
            $('input:checkbox[name="'+name+'"]:enabled', $parentform).prop('checked', state);

            if (state) {
                $('.chk', $parentform).has("input:enabled").addClass('checked');
                $('.redmarker', $parentform).addClass('r_on');
            } else {
                $('.select-all', $parentform).prop('checked', false);
                $(this).closest('.chk').removeClass('checked-all');
                $('.chk', $parentform).has("input:enabled").removeClass('checked');
                $('.redmarker', $parentform).removeClass('r_on');
            }
        };

        $('body').on('change', '.select-page', onSelectButton);
        $('body').on('change', '.select-all', function() {
            var state = this.checked;
            var $parentform = $(this).closest('.localform');
            if (!$parentform.length) {
                $parentform = $(this).closest('form');
            }
            var selectPage = $('.select-page', $parentform).prop('checked', state).get(0);

            onSelectButton.call(selectPage);
            if (state) {
                $(this).closest('.chk').addClass('checked-all');
            } else {
                $(this).closest('.chk').removeClass('checked-all');
            }
        });

        //Подключаемся в самом конце, чтобы фиксировать наличие оставшихся включенных чекбоксов
        $('body').on('change.chk', '.chk input:checkbox', function() {
            var $parentform = $(this).closest('form');
            $(this).closest('.column')
                   .toggleClass('sticky-on', $parentform.find('.chk input:checked').length>0);
            $(this).trigger('stickyUpdate');
        });
    };

    $(function() {
        $.rs.updatable.init();

        $('body').rsAdminFunctions();

        //Дополнение к плагину bootstrap.tab, сообщает вкладке, что её открыли
        $('body').on('shown.bs.tab', 'a[data-toggle="tab"]', function (e) {
            var tabTarget = $(e.target).data('target');
            if (!tabTarget) {
                tabTarget = $(e.target).attr('href');
            }
            $(tabTarget).trigger('on-tab-open');
        });

        // Смена состояния поля при мультиредактировании в админ панели
        $('body').on('change.multiedit', '.doedit', function(){
            var row_block = $(this).closest('.editrow'); //Оборачивающий тег
            if ($(this).prop('checked')){
                $(".multi_edit_rightcol",row_block).removeClass('coveron');
            }else{
                $(".multi_edit_rightcol",row_block).addClass('coveron');
            }
        });
        $('body').on('click.multiedit', '.multi_edit_rightcol .cover', function() {
            $(this).closest('tr').find('.doedit').prop('checked', true).trigger('change');
        });

        /**
         * Кнопка очистить хэш
         *
         */
        $('.rs-clean-cache').on('click', function(e) {
            $.ajaxQuery({
                url: $(this).attr('href'),
                success: function() {
                    location.reload();
                }
            });
            e.preventDefault();
        });

        $('body').on($.rs.clickEventName, '.rs-switch', function() {
            $(this).toggleClass('on');
        });

        //Инициализируем подсветку checkbox'ов
        $.rs.checkboxChange();

        $('body')
            .on('clear.bs.fileinput', '[data-provides="fileinput"]', function(e) {
                $('input.remove', this).val(1);
            })
            .on('change.bs.fileinput', '[data-provides="fileinput"]', function(e) {
                $('input.remove', this).val(0);
            })
            //Скрываем всплывающие подсказки при наступлении события
            .on('keydown new-content', function() {
                $('.tooltip[role="tooltip"]').remove();
            })
            .on($.rs.clickEventName, '.rs-open-performance-report', function(e) {
                window.open($(this).attr('href'), 'report', 'width=1000,height=800');
                e.preventDefault();
            });

        //Эмулируем oncontextmenu на сенсорных устройствах
        if ($.rs.hasTouch)
        {
            var
                longPress = 500,
                startTime = 0,
                timer;

            $('body')
                .on('touchstart', '[data-debug-contextmenu]', function(e) {

                    if (!startTime) {
                        startTime = new Date().getTime();
                        var eventData = {
                            currentTarget: e.currentTarget,
                            type: 'contextmenu',
                            pageX: e.originalEvent.touches[0].pageX,
                            pageY: e.originalEvent.touches[0].pageY
                        };
                        timer = setTimeout(function () {
                            var event = $.Event(e, eventData);
                            $(eventData.currentTarget).trigger(event);
                        }, longPress);
                    }
                })
                .on('touchend', '[data-debug-contextmenu]', function(e) {
                    clearTimeout(timer);
                    if ( startTime && new Date().getTime() > startTime + longPress ) {
                        $(e.currentTarget).one('click', function(e) {
                            e.preventDefault();
                        });
                    }
                    startTime = 0;
                });

        }
    });

    $.contentReady(function() {
        //Инициализируем Bootstrap tooltip
        var container;
        if ($('body').hasClass('admin-style')){
            container = $('.admin-style:first');
        }
        else {
            container = $('.admin-style:eq(1)');
        }
        $('.admin-style .tooltip').remove();
        $('.admin-style [title]')
            .on('click remove', function() {
                $(this).tooltip('hide');
            })
            .tooltip({
                trigger:'hover',
                html:true,
                container:container
            });

        if ($.fn.lightGallery) {
            var gallery = $(this).data('lightGallery');
            if (gallery) {
                gallery.destroy(true);
            }
            $(this).lightGallery({
                selector: "[rel='lightbox-tour']",
                thumbnail: false,
                autoplay: false,
                autoplayControls: false
            });
        }

        //Устанавливаем нужный scroll, чтобы активный таб попал в зону видимости
        $('.tab-nav[role="tablist"] > .active', this).each(function() {
            var ul = $(this).parent();
            var offset = $(this).position().left + $(this).width();
            var width = ul.width();
            if (offset > width) {
                $(this).parent().scrollLeft( offset - width );
            }
        });
    });

})(jQuery);
/**
* Данный файл подключается только в административной части сайта и содержит
* компоненты, необходимые для административной части сайта.
*
* @author ReadyScript lab.
*/

(function($) {

    /**
     * Plugin, активирующий отображение элемента в боковой панели
     */
    $.widget("rs.sidePanel", {
        options: {
            title: '', //Заголовок сайд бара. Может быть переназначен через параметр title в ответе на ajax запрос
            className: '', //Имя класса, добавляемого к панели
            position: 'left', //Позиция сайд бара. Возможны значения left, right
            htmlHead: null, //Html, который будет добавлен после заголовка
            activateCustomScroll: true,
            closeOnOverlayClick: true,
            ajaxQuery: null, //параметры для плагина ajaxQuery (выполняет загрузку содержимого через Ajax)
            onLoad: function (e, data) {
            },
            onClose: function (e, data) {
            },
            onShow: function (e, data) {
            }
        },

        _create: function () {
            if (this.options.ajaxQuery) {
                this._load();
            } else {
                this._show();
            }
        },

        close: function () {
            if (!this._trigger('onClose', null, {element: this.element})) return false;
            var self = this;

            if (this.panel) {
                this.panel.removeClass('show');
                setTimeout(function () {
                    self._hideOverlay();
                    self.panel.remove();
                }, 200);
            }
        },

        _load: function () {
            var self = this;
            $.ajaxQuery($.extend(this.options.ajaxQuery, {
                success: function (response) {
                    self.element.html(response.html)
                    self._trigger('onLoad', null, {
                        element: self.element,
                        response: response
                    });
                    self._show(response);
                }
            }));
        },

        _show: function (response) {
            var self = this;

            this._showOverlay();

            var title = (response && response.title) ? response.title : this.options.title;

            this.panel = $('<div class="rs-side-panel">\
                        <div class="rs-side-panel__title">\
                            <a class="rs-side-close"><i class="zmdi zmdi-close"><!----></i>' + title + '</a>\
                        </div>\
                        <div class="rs-side-panel__body">\
                        </div>')
                .addClass(this.options.className)
                .addClass('rs-side-panel_' + this.options.position);

            this.panel.find('.rs-side-close').click(function () {
                self.close()
            });

            if ((response && response.html_head) || this.options.htmlHead) {
                this.panel.find('.rs-side-panel__title')
                    .append(this.options.htmlHead ? this.options.htmlHead : response.html_head);
            }

            var content = this.panel.appendTo('body')
                .find('.rs-side-panel__body')
                .append(this.element);

            $('body').on('keypress.rsSidePanel', function (e) {
                if (e.keyCode == 27) self.close();
            });

            if (this.options.activateCustomScroll) {
                content.mCustomScrollbar({
                    theme: 'minimal-dark',
                    autoHideScrollbar: false,
                    mouseWheel: {preventDefault: true},
                    scrollInertia: 0
                });
            }

            setTimeout(function () {
                self.panel.addClass('show');
            }, 0);
            this.panel.trigger('new-content');

            this._trigger('onShow', null, {
                element: this.element,
                panel: this.panel,
                response: response
            });
        },

        _destroy: function () {
            $('body').off('.rsSidePanel');
        },

        _showOverlay: function () {
            var self = this;
            if (!$('#rs-slide-overlay').length) {
                this.overlay = $('<div id="rs-slide-overlay">').addClass('rs-overlay').appendTo('body');
                if (this.options.closeOnOverlayClick) {
                    this.overlay.click(function () {
                        self.close()
                    });
                }
            }
        },

        _hideOverlay: function () {
            if (this.overlay) {
                this.overlay.remove();
                this.overlay = null;
            }
        }
    });

    /**
     * Plugin, активирующий отображение системных уведомлений
     */
    $.widget("rs.rsAlerts", {
        options: {
            onLoad: function (e, data) {
            }
        },
        _create: function () {
            var self = this;
            this.element.click(function () {
                self.show()
            });
        },
        show: function () {
            if ($.rs.loading.inProgress) return;

            var _this = this;
            this.panel = $('<div>').sidePanel({
                position: 'right',
                ajaxQuery: {
                    url: this.element.data('urls').list
                },
                onLoad: function (e, data) {
                    _this._trigger('onLoad', data);
                }
            }).on('click', '.rs-alert-close', function() {
                var item = $(this).closest('.list-group-item').css('opacity', 0.5);
                var url = $(this).data('url');

                var closeItem = function() {
                    item.remove();
                    var notice_counter = $('.rs-alerts i[data-meter="rs-notice"]');
                    notice_counter.text( notice_counter.text()-1 );
                };

                if (url) {
                    $.ajaxQuery({
                        url: url,
                        loadingProgress: false,
                        success: function (response) {
                            if (response.success) {
                                closeItem();
                            } else {
                                item.css('opacity', 1);
                            }
                        }
                    });
                }

                return false;
            });
        },
        close: function () {
            if (this.panel)
                this.panel.sidePanel('close');
        }
    });

    /**
     * Plugin, активирующий пересчет счетчиков
     */
    $.rsMeters = function (method) {
        var defaults = {
                group: '.rs-meter-group',
                node: '> a .rs-meter-node',
                counter: '.hi-count',
                nextRecalculation: global.meterNextRecalculation,
                recalculationUrl: global.meterRecalculationUrl
            },
            $this = $('body');

        var
            data = $this.data('rsMeters'),
            timeout;

        if (!data) { //Инициализация
            data = {
                options: defaults
            };
            $this.data('rsMeters', data);
        }

        //public
        var methods = {
            init: function (parameters) {
                $(data.options.group).each(function () {
                    calculateNode(this);
                });

                recalculate(data.options.nextRecalculation);
            },

            /**
             * Обновляет счетчик на странице
             * @param params
             */
            update: function (key, value) {
                var arr = {};
                if (typeof(key) != 'object') {
                    arr[key] = value;
                } else {
                    arr = key;
                }

                $.each(arr, function (key, value) {
                    var counter = $(data.options.counter + '[data-meter="' + key + '"]');
                    if (counter.length) {
                        counter.text(formatValue(value))
                            .data('number', value)
                            .toggleClass('visible', value > 0)
                            .parents(data.options.group).each(function () {
                            calculateNode(this);
                        });
                    }
                });
            },

            refresh: function () {
                recalculate(0);
            },

            setOptions: function (options) {
                data.options = $.extend(data.options, options);
            }
        }

        //private
        var
            formatValue = function (sum) {
                return sum > 99 ? '99+' : sum;
            },

            calculateNode = function (node) {
                var sum = 0;
                $(data.options.counter, node).each(function () {
                    if ($(this).data('number')) {
                        sum += parseInt($(this).data('number'));
                    }
                });
                var visibleSum = formatValue(sum);
                $(data.options.node, node).text(visibleSum).toggleClass('visible', sum > 0);
            },
            recalculate = function (timeoutSec) {
                timeout = setTimeout(function () {
                    $.ajax({
                        dataType: 'json',
                        url: data.options.recalculationUrl,
                        success: function (response) {
                            if (response.success) {
                                $.each(response.numbers, function (key, value) {
                                    methods.update(key, value);
                                });

                                //Планируем следующий вызов
                                if (response.nextRecalculation > 0) {
                                    recalculate(response.nextRecalculation);
                                }
                            }
                        }
                    })

                }, timeoutSec * 1000);
            }


        if (methods[method]) {
            methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
        } else if (typeof(method) === 'object' || typeof(method) == 'undefined') {
            return methods.init.apply(this, arguments);
        }
    }

    $.widget("rs.rsBottomSticky", {
        options: {
            wrapper: '.column',
            placeholderClass: 'sticky-placeholder',
            stickyOnClass: 'sticky-on'
        },

        _create: function () {
            var self = this;

            if (this.element.data('bottomSticky')
                || this.element.hasClass(this.options.placeholderClass))
                return false;

            this.isSticky = false;
            this.placeholder = null;
            this.element.data('bottomSticky', this);
            this.wrapper = this.element.closest(this.options.wrapper);
            this.startClass = this.element.attr('class');

            //this.resize();

            $(window)
                .on('scroll.rsBT', function () {
                    self._scroll();
                })
                .on('resize.rsBT', function () {
                    self.resize();
                });

            this._on(this.wrapper, {
                'stickyUpdate': function () {
                    self.resize()
                }
            });
        },

        _calculatePoints: function () {
            var element = this.placeholder ? this.placeholder : this.element;
            this.bottomToolbarPoint = element.offset().top + element.outerHeight();
        },

        _scroll: function () {
            if (this.wrapper.hasClass(this.options.stickyOnClass)) {
                var bottomBrowserPoint = $(window).height() + $(window).scrollTop();
                var isSticky = bottomBrowserPoint < this.bottomToolbarPoint
                    && bottomBrowserPoint > this.wrapper.offset().top;
            } else {
                var isSticky = false;
            }
            var width = false;

            if (isSticky) {
                //Создаем placeholder
                if (!this.placeholder) {
                    this.placeholder = $('<div>').addClass(this.options.placeholderClass)
                        .addClass(this.startClass)
                        .height(this.element.outerHeight())
                        .insertAfter(this.element);

                    var width = this.placeholder.width();
                }
            } else {
                if (this.placeholder) {
                    this.placeholder.remove();
                    this.placeholder = null;

                    var width = 'auto';
                }
            }

            this.element.toggleClass('sticky', isSticky);
            if (width !== false) {
                this.element.width(width);
            }

            return isSticky;
        },

        resize: function () {
            this._calculatePoints();
            var isSticky = this._scroll();

            if (isSticky) {
                if (this.placeholder) {
                    var width = this.placeholder.width();
                    this.element.width(width);
                } else {
                    this.element.width('auto');
                }
            }
        }
    });


    $(function () {
        $.rsMeters(); //Инициализируем плагин, который будет показывать кол-во новых объектов в админ.панели
        $('.rs-alerts').rsAlerts(); //Инициализируем плагин, который будут показывать системные уведомления в админ.панели

        //Активируем стандартную разметку для переключателей
        var findTarget = function (target) {
            if($(target).data('targetClosest')){
                return $(target).closest($(target).data('targetClosest'));
            }else if($(target).data('targetNext')){
                return $(target).next($(target).data('targetNext'));
            }else{
                return $(target).data('target');
            }
        };

        $('body')
            .on('click', '[data-toggle-class]', function () {
                var element = findTarget(this);
                var state = $(element)
                    .toggleClass($(this).data('toggleClass'))
                    .hasClass($(this).data('toggleClass'));

                $(element).trigger('resize', {source: this});

                var cookieName = $(this).data('toggle-cookie');
                if (cookieName) {
                    $.cookie(cookieName, state ? 1 : null, {
                        expires: 365 * 5,
                        path: '/'
                    });
                }
            })

            .on('click', '[data-add-class]', function () {
                var element = findTarget(this);

                $(element).addClass($(this).data('addClass'));
                $(element).trigger('resize');
            })

            .on('click', '[data-remove-class]', function () {
                var element = findTarget(this);

                $(element).removeClass($(this).data('removeClass'));
                $(element).trigger('resize');
            })

            .on('click', '[data-set-cookie]', function () {
                var cookieName = $(this).data('setCookie'),
                    cookieValue = $(this).data('setCookieValue'),
                    path = $(this).data('setCookiePath');

                if (cookieName) {
                    $.cookie(cookieName, cookieValue ? cookieValue : null, {
                        expires: 365 * 5,
                        path: typeof(path) != 'undefined' ? path : '/'
                    });
                }
            })
            .on('click', '.treebody  a.call-update', function () {
                $(this).closest('.crud-view-table-tree').one('new-content', function () {
                    $(this).removeClass('left-open');
                });
            })
            .on('click', '.categorybody  a.call-update', function () {
                $(this).closest('.crud-view-table-category').one('new-content', function () {
                    $(this).removeClass('left-open');
                });
            })
            .on('click', '[data-side-panel]', function () {
                //Защита от двойного срабатывания
                if ($(this).data('side-panel-lading')) return false;

                var self = this;
                var url = $(this).data('sidePanel');
                var options = $(this).data('sidePanelOptions') ? $(this).data('sidePanelOptions') : {};
                $(this).data('side-panel-lading', true);

                $('<div>').sidePanel($.extend({
                    "ajaxQuery": {
                        url: url
                    },
                    "onClose": function () {
                        $(self).removeData('side-panel-lading');
                    }
                }, options));
            })
            .on('click', '.visible-alerts-block .close', function() {
                //Записываем в cookie информацию о времни закрытия блока уведомлений
                var cookieName = $(this).data('cookieName');
                if (cookieName) {
                    $.cookie(cookieName, $(this).data('cookieValue'), {
                        expires: 365 * 5,
                        path: '/'
                    });
                }

                $(this).closest('.visible-alerts-block').remove();
            })
            .on('click', '.go-to-menu[data-main-menu-index]', function(event) {
                $('#menu-trigger').addClass('toggled');
                $('#sidebar').addClass('sm-opened toggled');
                $('#sidebar .side-main > li').removeClass('open');
                $('#sidebar .side-main > li:eq('+$(this).data('mainMenuIndex')+')').addClass('open');
            });
    });

    $.contentReady(function () {

        //Активируем изменение размера колонок в представлении tree-table
        $('.admin-style .columns .left-column, .resizable-column').resizable({
            handles: 'e',
            create: function (e, ui) {
                this.parentElement = $(this).closest('.columns');
                if (!this.parentElement.length) {
                    this.parentElement = $(this).parent();
                }

                this.dependColumn = $(this.parentElement).find('.depend-resizable-column');

                //Установим ширину по-умолчанию
                if (defaultWidth = +($.cookie('columnResizer-width'))) {
                    $(this).css('flex-basis', defaultWidth);
                }

                if (this.dependColumn.length && defaultWidth) {
                    this.dependColumn
                        .css('flex', 'auto')
                        .css('width', 'calc(100% - '+defaultWidth+'px)');
                }
            },
            resize: function (e, ui) {
                var maxWidth = parseInt($(this.parentElement).width() * 0.5);
                var minWidth = parseInt($(ui.element).data('min-width') ? $(ui.element).data('min-width') : 0);
                if (ui.size.width > maxWidth) {
                    ui.size.width = maxWidth;
                }
                else if (ui.size.width < minWidth) {
                    ui.size.width = maxWidth;
                } else {
                    ui.element.css('flex-basis', ui.size.width);

                    if (this.dependColumn.length) {
                        this.dependColumn
                            .css('flex', 'auto')
                            .css('width', 'calc(100% - ' + ui.size.width + 'px)');
                    }
                }
            },
            stop: function (e, ui) {
                var cookie_options = {
                    expires: new Date((new Date()).valueOf() + 1000 * 3600 * 24 * 365 * 5)
                };
                $.cookie('columnResizer-width', ui.size.width, cookie_options);
            }
        });

        //Активируем прилипающий toolbar
        $('body').off('.rsBT');
        $('.bottom-toolbar:not(.fixed)').rsBottomSticky();
    });

})(jQuery);
/*
* Скрипт обеспечивает работу полей редактирования и мультиредактирования объектов.
* Здесь должны располагаться инициализации сложных форм(выбор даты и времени, и т.д.)
*
* @author ReadyScript lab.
*/
(function($) {

    $.contentReady(function()
    {
        //Для группового редактирования
        checkOn = function() {
            var tr = $(this).parents('tr:first');
            if (this.checked) tr.addClass('editthis'); else tr.removeClass('editthis');
        };

        $('.multiedit .doedit', this).each(checkOn);
        $('.multiedit .doedit', this).click(checkOn);

        //Инициализируем поля "дата-время"
        $('input[datetime]', this).each(function() {
            $(this).attr('autocomplete','off').datetime();
        });

        //Инициализируем поля "дата"
        $('input[date]', this).each(function() {
            $(this).attr('autocomplete','off').dateselector();
        });
    });

})(jQuery);
class RsBarcodeScanner {
    constructor() {
        this.const = {
            keydownMaxInterval: 20,
            eventNameBarcodeScanned: 'barcode-scanned',
            keyCode: {
                enter: 13,
                shift: 16,
            },
            barcodeType: {
                oneDimensional: 'oneDimensional',
                twoDimensional: 'twoDimensional',
            },
        };

        this.buffer = '';
        this.lastTimeStamp = null;

        document.addEventListener('keydown', (event) => {
            this.keydown(event);
        });
    }

    /**
     * Обработчик нажатия клавиши
     *
     * @param event
     */
    keydown(event) {
        if (event.isTrusted && event.keyCode !== this.const.keyCode.shift) {
            if (event.keyCode === this.const.keyCode.enter) {
                this.getFormElement().dispatchEvent(this.getCodeScanEvent());

                this.buffer = '';
                this.lastTimeStamp = null;
            } else {
                let key = this.getKeyFromKeydownEvent(event);

                this.buffer = (event.timeStamp - this.lastTimeStamp < this.const.keydownMaxInterval) ? this.buffer + key : key;
                this.lastTimeStamp = event.timeStamp;
            }
        }
    }

    /**
     * Возвращает объект события сканирования штрихкода на основе текущего буфера
     *
     * @returns {Event}
     */
    getCodeScanEvent() {
        let event = new Event(this.const.eventNameBarcodeScanned, {
            bubbles: true,
            cancelable: true,
        });

        event.detail = {
            codeType: (this.buffer.length > 14) ? this.const.barcodeType.twoDimensional : this.const.barcodeType.oneDimensional,
            code: this.buffer,
        };

        return event;
    }

    /**
     * Возвращает элемент формы у котого будет брошено событие сканирования штрихкода
     *
     * @returns {Element}
     */
    getFormElement() {
        let formElement;
        document.querySelectorAll('.ui-dialog').forEach((element) => {
            if (element.style.display !== 'none') {
                formElement = element.querySelector('form');
            }
        });
        if (!formElement) {
            let mainForm = document.querySelector('#content .crud-form');
            formElement = (mainForm) ? mainForm : document;
        }

        return formElement;
    }

    /**
     * Корректирует введённый символ
     *
     * @param event - событие нажатия клавиши
     * @returns {string}
     */
    getKeyFromKeydownEvent(event) {
        let key;
        if (event.code.search('^Key') !== -1) {
            key = String.fromCharCode(event.keyCode);
            if (!event.shiftKey) {
                key = key.toLowerCase();
            }
        } else if (event.code.search('^Slash') !== -1) {
            key = (event.shiftKey) ? '?' : '/';
        } else {
            key = event.key;
        }

        return key;
    }

    static init() {
        if (!window.rsBarcodeScanner) {
            window.rsBarcodeScanner = new RsBarcodeScanner();
        }
    }
}

RsBarcodeScanner.init();
(function($){
    $.fn.selectTheme = function( method ) {  
        var defaults = {
            justSelect: false,
            themeBlock: '#theme-block',
            errorBlock: '.form-error',
            theme: '.theme',
            theme_selector: '.set-this',
            uploadForm: '.uploadTheme',
            uploadButton: '.upload-theme-file',
            mpContainer:'.theme-container.mp',
            fileinput: '#theme-file',
            img: '.image',
            colorContainer: '.colors',
            colorItem: '.colors .item',
            handler: '#selectTheme'
        }, 
        args = arguments;

        return this.each(function() {
            var $this = $(this), 
                context,
                data = $this.data('selectTheme');

            var methods = {
                init: function(initoptions) {
                    if (data) return;
                    data = {}; $this.data('selectTheme', data);
                    data.options = $.extend({}, defaults, initoptions);
                   $(data.options.handler).click(showDialog);
                },
                
            }
            
            //private
            var initEvents = function() {
                $('#templateManager .canselect').click(selectFile);
            },

            showDialog = function() {
                $(data.options.errorBlock, context).empty();
                $.rs.openDialog({
                    dialogOptions: {
                        dialogClass: 'themeManager',
                        width:900,
                        height:800
                    },
                    dialogId: 'themeManager',
                    url: data.options.dialogUrl,
                    afterOpen: initContent
                });
            },
            
            initContent = function(dialog) {
                context = dialog;
                if (!data.isInitialized) {
                    context
                        .on('click', data.options.colorItem, changeShade)
                        .on('change', data.options.fileinput, selectFile)
                        .on('click', data.options.theme_selector, selectTheme);

                    var initMarketplaceThemes = function() {
                        //Загружаем модули из Marketplace
                        var loadMpThemesUrl = $(data.options.mpContainer, context).data('url');
                        $.ajaxQuery({
                            url: loadMpThemesUrl,
                            success: function (response) {
                                var mpContainer = $(data.options.mpContainer, context)
                                    .html(response.html)
                                    .find(data.options.colorItem)
                                    .click(changeShade);
                            }
                        });
                    };

                    initMarketplaceThemes();
                    context.on('new-content', function() {
                        initMarketplaceThemes(); //Инициализируем повторно, если произошла загрузка новой темы
                    });

                    data.isInitialized = true;
                }
            },
            
            changeShade = function() {
                var $theme = $(this).closest(data.options.theme);
                var $image = $(data.options.img, $theme);
                var src = $(this).data('previewUrl');
                $(data.options.colorItem, $theme).removeClass('act');
                $(this).addClass('act');
                $image.attr('src', src);
                return false;
            },
            
            disableUploadButton = function() {
                $(data.options.uploadButton, context).addClass('disabled');
                $(data.options.fileinput, context).hide();                
            },
            
            enableUploadButton = function() {
                $(data.options.uploadButton, context).removeClass('disabled');
                $(data.options.fileinput, context).show();                
            },
            
            selectFile = function() {
                //Делаем кнопку неактивной
                disableUploadButton();
                $(data.options.errorBlock, context).empty();
                $.rs.loading.show();
                
                $(data.options.uploadForm, context).ajaxSubmit({
                    dataType:'json',
                    data: {
                        ajax:1
                    },
                    success: function(response, status, hxr, $form) {
                        $.rs.loading.hide();
                        enableUploadButton();
                        if (response.success) {
                            $.rs.updatable.updateTarget($form, null, null, {noUpdateHash: true});
                        } else {
                            $(data.options.errorBlock, context).fillError(response.formdata.errors);
                        }
                    },
                    error: function() {
                        loading.error();
                    }
                    
                });
            },
            
            selectTheme = function() {
                var theme = $(this).closest('.theme');

                var theme_id = theme.data('themeId');
                var shade_id = $('.act[data-shade-id]', theme).data('shadeId');
                if (typeof(shade_id) != 'undefined') {
                    var str = theme_id+'('+shade_id+')';
                } else {
                    var str = theme_id;
                }                

                var success = function(str) {
                    $this.val(str);
                    context.dialog('close');
                }                
                                
                    
                if (data.options.justSelect) {
                    success(str);
                } else {                
                    if (confirm(lang.t('Вместе с темой будет загружена информация о блоках. Вы действительно хотите сменить тему?'))) {
                        $(data.options.errorBlock, context).empty();                    
                            $.ajaxQuery({
                                url: data.options.setThemeUrl,
                                data: {
                                    theme: str
                                },
                                success: function(response) {
                                    if (response.success) {
                                        success(str);
                                    } else {
                                        $(data.options.errorBlock, context).fillError(response.formdata.errors);
                                    }
                                }
                            });
                        

                    }
                }
            };
            
            
            if ( methods[method] ) {
                methods[ method ].apply( this, Array.prototype.slice.call( args, 1 ));
            } else if ( typeof method === 'object' || ! method ) {
                return methods.init.apply( this, args );
            }
        });
    }    
})(jQuery);
/* ===========================================================
 * Bootstrap: fileinput.js v3.1.3
 * http://jasny.github.com/bootstrap/javascript/#fileinput
 * ===========================================================
 * Copyright 2012-2014 Arnold Daniels
 *
 * Licensed under the Apache License, Version 2.0 (the "License")
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */
+function(e){"use strict";var t="Microsoft Internet Explorer"==window.navigator.appName,i=function(t,i){if(this.$element=e(t),this.$input=this.$element.find(":file"),0!==this.$input.length){this.name=this.$input.attr("name")||i.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),0===this.$hidden.length&&(this.$hidden=e('<input type="hidden">').insertBefore(this.$input)),this.$preview=this.$element.find(".fileinput-preview");var n=this.$preview.css("height");"inline"!==this.$preview.css("display")&&"0px"!==n&&"none"!==n&&this.$preview.css("line-height",n),this.original={exists:this.$element.hasClass("fileinput-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.listen()}};i.prototype.listen=function(){this.$input.on("change.bs.fileinput",e.proxy(this.change,this)),e(this.$input[0].form).on("reset.bs.fileinput",e.proxy(this.reset,this)),this.$element.find('[data-trigger="fileinput"]').on("click.bs.fileinput",e.proxy(this.trigger,this)),this.$element.find('[data-dismiss="fileinput"]').on("click.bs.fileinput",e.proxy(this.clear,this))},i.prototype.change=function(t){var i=void 0===t.target.files?t.target&&t.target.value?[{name:t.target.value.replace(/^.+\\/,"")}]:[]:t.target.files;if(t.stopPropagation(),0===i.length)return void this.clear();this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name);var n=i[0];if(this.$preview.length>0&&("undefined"!=typeof n.type?n.type.match(/^image\/(gif|png|jpeg|svg\+xml)$/):n.name.match(/\.(svg\+xml|gif|png|jpe?g)$/i))&&"undefined"!=typeof FileReader){var s=new FileReader,a=this.$preview,l=this.$element;s.onload=function(t){var s=e("<img>");s[0].src=t.target.result,i[0].result=t.target.result,l.find(".fileinput-filename").text(n.name),"none"!=a.css("max-height")&&s.css("max-height",parseInt(a.css("max-height"),10)-parseInt(a.css("padding-top"),10)-parseInt(a.css("padding-bottom"),10)-parseInt(a.css("border-top"),10)-parseInt(a.css("border-bottom"),10)),a.html(s),l.addClass("fileinput-exists").removeClass("fileinput-new"),l.trigger("change.bs.fileinput",i)},s.readAsDataURL(n)}else this.$element.find(".fileinput-filename").text(n.name),this.$preview.text(n.name),this.$element.addClass("fileinput-exists").removeClass("fileinput-new"),this.$element.trigger("change.bs.fileinput")},i.prototype.clear=function(e){if(e&&e.preventDefault(),this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name",""),t){var i=this.$input.clone(!0);this.$input.after(i),this.$input.remove(),this.$input=i}else this.$input.val("");this.$preview.html(""),this.$element.find(".fileinput-filename").text(""),this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),void 0!==e&&(this.$input.trigger("change"),this.$element.trigger("clear.bs.fileinput"))},i.prototype.reset=function(){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.$element.find(".fileinput-filename").text(""),this.original.exists?this.$element.addClass("fileinput-exists").removeClass("fileinput-new"):this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),this.$element.trigger("reset.bs.fileinput")},i.prototype.trigger=function(e){this.$input.trigger("click"),e.preventDefault()};var n=e.fn.fileinput;e.fn.fileinput=function(t){return this.each(function(){var n=e(this),s=n.data("bs.fileinput");s||n.data("bs.fileinput",s=new i(this,t)),"string"==typeof t&&s[t]()})},e.fn.fileinput.Constructor=i,e.fn.fileinput.noConflict=function(){return e.fn.fileinput=n,this},e(document).on("click.fileinput.data-api",'[data-provides="fileinput"]',function(t){var i=e(this);if(!i.data("bs.fileinput")){i.fileinput(i.data());var n=e(t.target).closest('[data-dismiss="fileinput"],[data-trigger="fileinput"]');n.length>0&&(t.preventDefault(),n.trigger("click.bs.fileinput"))}})}(window.jQuery);
/*
 * jQuery Browser Plugin 0.0.7
 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],function(b){a(b)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=a(require("jquery")):a(window.jQuery)}(function(a){"use strict";function b(a){void 0===a&&(a=window.navigator.userAgent),a=a.toLowerCase();var b=/(edge)\/([\w.]+)/.exec(a)||/(opr)[\/]([\w.]+)/.exec(a)||/(chrome)[ \/]([\w.]+)/.exec(a)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[],c=/(ipad)/.exec(a)||/(ipod)/.exec(a)||/(iphone)/.exec(a)||/(kindle)/.exec(a)||/(silk)/.exec(a)||/(android)/.exec(a)||/(windows phone)/.exec(a)||/(win)/.exec(a)||/(mac)/.exec(a)||/(linux)/.exec(a)||/(cros)/.exec(a)||/(playbook)/.exec(a)||/(bb)/.exec(a)||/(blackberry)/.exec(a)||[],d={},e={browser:b[5]||b[3]||b[1]||"",version:b[2]||b[4]||"0",versionNumber:b[4]||b[2]||"0",platform:c[0]||""};if(e.browser&&(d[e.browser]=!0,d.version=e.version,d.versionNumber=parseInt(e.versionNumber,10)),e.platform&&(d[e.platform]=!0),(d.android||d.bb||d.blackberry||d.ipad||d.iphone||d.ipod||d.kindle||d.playbook||d.silk||d["windows phone"])&&(d.mobile=!0),(d.cros||d.mac||d.linux||d.win)&&(d.desktop=!0),(d.chrome||d.opr||d.safari)&&(d.webkit=!0),d.rv||d.edge){var f="msie";e.browser=f,d[f]=!0}if(d.safari&&d.blackberry){var g="blackberry";e.browser=g,d[g]=!0}if(d.safari&&d.playbook){var h="playbook";e.browser=h,d[h]=!0}if(d.bb){var i="blackberry";e.browser=i,d[i]=!0}if(d.opr){var j="opera";e.browser=j,d[j]=!0}if(d.safari&&d.android){var k="android";e.browser=k,d[k]=!0}if(d.safari&&d.kindle){var l="kindle";e.browser=l,d[l]=!0}if(d.safari&&d.silk){var m="silk";e.browser=m,d[m]=!0}return d.name=e.browser,d.platform=e.platform,d}return window.jQBrowser=b(window.navigator.userAgent),window.jQBrowser.uaMatch=b,a&&(a.browser=window.jQBrowser),window.jQBrowser});

/*
 * jQuery miniColors: A small color selector
 *
 * Copyright 2012 Cory LaViska for A Beautiful Site, LLC. (http://www.abeautifulsite.net/)
 *
 * Dual licensed under the MIT or GPL Version 2 licenses
 *
*/
if(jQuery)(function($){$.extend($.fn,{miniColors:function(o,data){var prefix=!o||typeof o.prefix==='undefined'?'#':o.prefix;function create(input,o,data){var color=expandHex(input.val())||'ffffff',hsb=hex2hsb(color),rgb=hsb2rgb(hsb),alpha=parseFloat(input.attr('data-opacity')).toFixed(2),opacity=false,trigger;if(alpha>1)alpha=1;if(alpha<0)alpha=0;if(input.attr('data-opacity')!==undefined||o.opacity===true){opacity=true;alpha=input.attr('data-opacity');if(alpha===''){alpha=1}else{alpha=parseFloat(alpha).toFixed(2)}if(alpha>1)alpha=1;if(alpha<0)alpha=0;input.attr('data-opacity',alpha)}trigger=$('<a class="miniColors-trigger" style="background-color: #'+color+'" href="#"></a>');trigger.insertAfter(input);trigger.wrap('<span class="miniColors-triggerWrap"></span>');if(o.opacity){trigger.css('backgroundColor','rgba('+rgb.r+', '+rgb.g+', '+rgb.b+', '+alpha+')')}input.addClass('miniColors').data('original-maxlength',input.attr('maxlength')||null).data('original-autocomplete',input.attr('autocomplete')||null).data('letterCase',o.letterCase==='uppercase'?'uppercase':'lowercase').data('opacity',opacity).data('alpha',alpha).data('trigger',trigger).data('hsb',hsb).data('change',o.change?o.change:null).data('close',o.close?o.close:null).data('open',o.open?o.open:null).attr('maxlength',7).attr('autocomplete','off').val(prefix+convertCase(color,o.letterCase));if(o.readonly||input.prop('readonly'))input.prop('readonly',true);if(o.disabled||input.prop('disabled'))disable(input);trigger.on('click.miniColors',function(event){event.preventDefault();if(input.val()==='')input.val(prefix);show(input)});input.on('focus.miniColors',function(event){if(input.val()==='')input.val(prefix);show(input)});input.on('blur.miniColors',function(event){var hex=expandHex(input.val());input.val(hex?prefix+convertCase(hex,input.data('letterCase')):'#'+hsb2hex(input.data('hsb')))});input.on('keydown.miniColors',function(event){if(event.keyCode===9||event.keyCode===27)hide(input)});input.on('keyup.miniColors',function(event){setColorFromInput(input)});input.on('paste.miniColors',function(event){setTimeout(function(){setColorFromInput(input)},5)})}function destroy(input){hide();input=$(input);input.data('trigger').parent().remove();input.attr('autocomplete',input.data('original-autocomplete')).attr('maxlength',input.data('original-maxlength')).removeData().removeClass('miniColors').off('.miniColors');$(document).off('.miniColors')}function enable(input){input.prop('disabled',false).data('trigger').parent().removeClass('disabled')}function disable(input){hide(input);input.prop('disabled',true).data('trigger').parent().addClass('disabled')}function show(input){var hex,colorPosition,huePosition,opacityPosition,hidden,top,left,trigger,triggerWidth,triggerHeight,selector,selectorWidth,selectorHeight,windowHeight,windowWidth,scrollTop,scrollLeft;if(input.prop('disabled'))return false;hide();selector=$('<div class="miniColors-selector"></div>').append('<div class="miniColors-hues"><div class="miniColors-huePicker"></div></div>').append('<div class="miniColors-colors" style="background-color: #FFF;"><div class="miniColors-colorPicker"><div class="miniColors-colorPicker-inner"></div></div>').css('display','none').addClass(input.attr('class'));if(input.data('opacity')){selector.addClass('opacity').prepend('<div class="miniColors-opacity"><div class="miniColors-opacityPicker"></div></div>')}hsb=input.data('hsb');selector.find('.miniColors-colors').css('backgroundColor','#'+hsb2hex({h:hsb.h,s:100,b:100})).end().find('.miniColors-opacity').css('backgroundColor','#'+hsb2hex({h:hsb.h,s:hsb.s,b:hsb.b})).end();colorPosition=input.data('colorPosition');if(!colorPosition)colorPosition=getColorPositionFromHSB(hsb);selector.find('.miniColors-colorPicker').css('top',colorPosition.y+'px').css('left',colorPosition.x+'px');huePosition=input.data('huePosition');if(!huePosition)huePosition=getHuePositionFromHSB(hsb);selector.find('.miniColors-huePicker').css('top',huePosition+'px');opacityPosition=input.data('opacityPosition');if(!opacityPosition)opacityPosition=getOpacityPositionFromAlpha(input.attr('data-opacity'));selector.find('.miniColors-opacityPicker').css('top',opacityPosition+'px');input.data('selector',selector).data('huePicker',selector.find('.miniColors-huePicker')).data('opacityPicker',selector.find('.miniColors-opacityPicker')).data('colorPicker',selector.find('.miniColors-colorPicker')).data('mousebutton',0);$('.admin-style').append(selector);trigger=input.data('trigger');hidden=!input.is(':visible');top=hidden?trigger.offset().top+trigger.outerHeight():input.offset().top+input.outerHeight();left=hidden?trigger.offset().left:input.offset().left;selectorWidth=selector.outerWidth();selectorHeight=selector.outerHeight();triggerWidth=trigger.outerWidth();triggerHeight=trigger.outerHeight();windowHeight=$(window).height();windowWidth=$(window).width();scrollTop=$(window).scrollTop();scrollLeft=$(window).scrollLeft();if((top+selectorHeight)>windowHeight+scrollTop)top=top-selectorHeight-triggerHeight;if((left+selectorWidth)>windowWidth+scrollLeft)left=left-selectorWidth+triggerWidth;selector.css({top:top,left:left}).fadeIn(100);selector.on('selectstart',function(){return false});if(!$.browser.msie||($.browser.msie&&$.browser.version>=9)){$(window).on('resize.miniColors',function(event){hide(input)})}$(document).on('mousedown.miniColors touchstart.miniColors',function(event){var testSubject=$(event.target).parents().andSelf();input.data('mousebutton',1);if(testSubject.hasClass('miniColors-colors')){event.preventDefault();input.data('moving','colors');moveColor(input,event)}if(testSubject.hasClass('miniColors-hues')){event.preventDefault();input.data('moving','hues');moveHue(input,event)}if(testSubject.hasClass('miniColors-opacity')){event.preventDefault();input.data('moving','opacity');moveOpacity(input,event)}if(testSubject.hasClass('miniColors-selector')){event.preventDefault();return}if(testSubject.hasClass('miniColors'))return;hide(input)}).on('mouseup.miniColors touchend.miniColors',function(event){event.preventDefault();input.data('mousebutton',0).removeData('moving')}).on('mousemove.miniColors touchmove.miniColors',function(event){event.preventDefault();if(input.data('mousebutton')===1){if(input.data('moving')==='colors')moveColor(input,event);if(input.data('moving')==='hues')moveHue(input,event);if(input.data('moving')==='opacity')moveOpacity(input,event)}});if(input.data('open')){input.data('open').call(input.get(0),'#'+hsb2hex(hsb),$.extend(hsb2rgb(hsb),{a:parseFloat(input.attr('data-opacity'))}))}}function hide(input){if(!input)input=$('.miniColors');input.each(function(){var selector=$(this).data('selector');$(this).removeData('selector');$(selector).fadeOut(100,function(){if(input.data('close')){var hsb=input.data('hsb'),hex=hsb2hex(hsb);input.data('close').call(input.get(0),'#'+hex,$.extend(hsb2rgb(hsb),{a:parseFloat(input.attr('data-opacity'))}))}$(this).remove()})});$(document).off('.miniColors')}function moveColor(input,event){var colorPicker=input.data('colorPicker'),position,s,b,hsb;colorPicker.hide();position={x:event.pageX,y:event.pageY};if(event.originalEvent.changedTouches){position.x=event.originalEvent.changedTouches[0].pageX;position.y=event.originalEvent.changedTouches[0].pageY}position.x=position.x-input.data('selector').find('.miniColors-colors').offset().left-6;position.y=position.y-input.data('selector').find('.miniColors-colors').offset().top-6;if(position.x<=-5)position.x=-5;if(position.x>=144)position.x=144;if(position.y<=-5)position.y=-5;if(position.y>=144)position.y=144;input.data('colorPosition',position);colorPicker.css('left',position.x).css('top',position.y).show();s=Math.round((position.x+5)*0.67);if(s<0)s=0;if(s>100)s=100;b=100-Math.round((position.y+5)*0.67);if(b<0)b=0;if(b>100)b=100;hsb=input.data('hsb');hsb.s=s;hsb.b=b;setColor(input,hsb,true)}function moveHue(input,event){var huePicker=input.data('huePicker'),position=event.pageY,h,hsb;huePicker.hide();if(event.originalEvent.changedTouches){position=event.originalEvent.changedTouches[0].pageY}position=position-input.data('selector').find('.miniColors-colors').offset().top-1;if(position<=-1)position=-1;if(position>=149)position=149;input.data('huePosition',position);huePicker.css('top',position).show();h=Math.round((150-position-1)*2.4);if(h<0)h=0;if(h>360)h=360;hsb=input.data('hsb');hsb.h=h;setColor(input,hsb,true)}function moveOpacity(input,event){var opacityPicker=input.data('opacityPicker'),position=event.pageY,alpha;opacityPicker.hide();if(event.originalEvent.changedTouches){position=event.originalEvent.changedTouches[0].pageY}position=position-input.data('selector').find('.miniColors-colors').offset().top-1;if(position<=-1)position=-1;if(position>=149)position=149;input.data('opacityPosition',position);opacityPicker.css('top',position).show();alpha=parseFloat((150-position-1)/150).toFixed(2);if(alpha<0)alpha=0;if(alpha>1)alpha=1;input.data('alpha',alpha).attr('data-opacity',alpha);setColor(input,input.data('hsb'),true)}function setColor(input,hsb,updateInput){var hex=hsb2hex(hsb),selector=$(input.data('selector')),rgb=hsb2rgb(hsb);input.data('hsb',hsb);if(updateInput)input.val(prefix+convertCase(hex,input.data('letterCase')));selector.find('.miniColors-colors').css('backgroundColor','#'+hsb2hex({h:hsb.h,s:100,b:100})).end().find('.miniColors-opacity').css('backgroundColor','#'+hex).end();input.data('trigger').css('backgroundColor','#'+hex);if(input.data('opacity')){input.data('trigger').css('backgroundColor','rgba('+rgb.r+', '+rgb.g+', '+rgb.b+', '+input.attr('data-opacity')+')')}if(input.data('change')){if((hex+','+input.attr('data-opacity'))===input.data('lastChange'))return;input.data('change').call(input.get(0),'#'+hex,$.extend(hsb2rgb(hsb),{a:parseFloat(input.attr('data-opacity'))}));input.data('lastChange',hex+','+input.attr('data-opacity'))}}function setColorFromInput(input){var hex,hsb,colorPosition,colorPicker,huePosition,huePicker,opacityPosition,opacityPicker;input.val(prefix+cleanHex(input.val()));hex=expandHex(input.val());if(!hex)return false;hsb=hex2hsb(hex);colorPosition=getColorPositionFromHSB(hsb);colorPicker=$(input.data('colorPicker'));colorPicker.css('top',colorPosition.y+'px').css('left',colorPosition.x+'px');input.data('colorPosition',colorPosition);huePosition=getHuePositionFromHSB(hsb);huePicker=$(input.data('huePicker'));huePicker.css('top',huePosition+'px');input.data('huePosition',huePosition);opacityPosition=getOpacityPositionFromAlpha(input.attr('data-opacity'));opacityPicker=$(input.data('opacityPicker'));opacityPicker.css('top',opacityPosition+'px');input.data('opacityPosition',opacityPosition);setColor(input,hsb);return true}function convertCase(string,letterCase){if(letterCase==='uppercase'){return string.toUpperCase()}else{return string.toLowerCase()}}function getColorPositionFromHSB(hsb){var x=Math.ceil(hsb.s/0.67);if(x<0)x=0;if(x>150)x=150;var y=150-Math.ceil(hsb.b/0.67);if(y<0)y=0;if(y>150)y=150;return{x:x-5,y:y-5}}function getHuePositionFromHSB(hsb){var y=150-(hsb.h/2.4);if(y<0)h=0;if(y>150)h=150;return y}function getOpacityPositionFromAlpha(alpha){var y=150*alpha;if(y<0)y=0;if(y>150)y=150;return 150-y}function cleanHex(hex){return hex.replace(/[^A-F0-9]/ig,'')}function expandHex(hex){hex=cleanHex(hex);if(!hex)return null;if(hex.length===3)hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2];return hex.length===6?hex:null}function hsb2rgb(hsb){var rgb={};var h=Math.round(hsb.h);var s=Math.round(hsb.s*255/100);var v=Math.round(hsb.b*255/100);if(s===0){rgb.r=rgb.g=rgb.b=v}else{var t1=v;var t2=(255-s)*v/255;var t3=(t1-t2)*(h%60)/60;if(h===360)h=0;if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3}else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3}else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3}else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3}else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3}else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3}else{rgb.r=0;rgb.g=0;rgb.b=0}}return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)}}function rgb2hex(rgb){var hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)];$.each(hex,function(nr,val){if(val.length===1)hex[nr]='0'+val});return hex.join('')}function hex2rgb(hex){hex=parseInt(((hex.indexOf('#')>-1)?hex.substring(1):hex),16);return{r:hex>>16,g:(hex&0x00FF00)>>8,b:(hex&0x0000FF)}}function rgb2hsb(rgb){var hsb={h:0,s:0,b:0};var min=Math.min(rgb.r,rgb.g,rgb.b);var max=Math.max(rgb.r,rgb.g,rgb.b);var delta=max-min;hsb.b=max;hsb.s=max!==0?255*delta/max:0;if(hsb.s!==0){if(rgb.r===max){hsb.h=(rgb.g-rgb.b)/delta}else if(rgb.g===max){hsb.h=2+(rgb.b-rgb.r)/delta}else{hsb.h=4+(rgb.r-rgb.g)/delta}}else{hsb.h=-1}hsb.h*=60;if(hsb.h<0){hsb.h+=360}hsb.s*=100/255;hsb.b*=100/255;return hsb}function hex2hsb(hex){var hsb=rgb2hsb(hex2rgb(hex));if(hsb.s===0)hsb.h=360;return hsb}function hsb2hex(hsb){return rgb2hex(hsb2rgb(hsb))}switch(o){case'readonly':$(this).each(function(){if(!$(this).hasClass('miniColors'))return;$(this).prop('readonly',data)});return $(this);case'disabled':$(this).each(function(){if(!$(this).hasClass('miniColors'))return;if(data){disable($(this))}else{enable($(this))}});return $(this);case'value':if(data===undefined){if(!$(this).hasClass('miniColors'))return;var hex=expandHex($(this).val());return hex?prefix+convertCase(hex,$(this).data('letterCase')):null}$(this).each(function(){if(!$(this).hasClass('miniColors'))return;$(this).val(data);setColorFromInput($(this))});return $(this);case'opacity':if(data===undefined){if(!$(this).hasClass('miniColors'))return;if($(this).data('opacity')){return parseFloat($(this).attr('data-opacity'))}else{return null}}$(this).each(function(){if(!$(this).hasClass('miniColors'))return;if(data<0)data=0;if(data>1)data=1;$(this).attr('data-opacity',data).data('alpha',data);setColorFromInput($(this))});return $(this);case'destroy':$(this).each(function(){if(!$(this).hasClass('miniColors'))return;destroy($(this))});return $(this);default:if(!o)o={};$(this).each(function(){if($(this)[0].tagName.toLowerCase()!=='input')return;if($(this).data('trigger'))return;create($(this),o,data)});return $(this)}}})})(jQuery);

$.contentReady(function()  {
    $(".colorpicker").miniColors();
    $(window).bind('dialogBeforeDestroy.miniColors', function(e) {
        $(".colorpicker", e.target).miniColors('destroy');
    });
});
/**
* Plugin, активирующий автоматическую транслитерацию поля
* @author ReadyScript lab.
*/
(function($){
    $.fn.autoTranslit = function(method) {
        var defaults = {
            formAction: 'form[action]',
            context:'form, .virtual-form',
            virtualForm: '.virtual-form',
            addPredicate: 'add',
            targetName: null,
            showUpdateButton: true
        }, 
        args = arguments;
        
        return this.each(function() {
            var $this = $(this), 
                data = $this.data('autoTranslit');
            
            var methods = {
                init: function(initoptions) {                    
                    if (data) return;
                    data = {}; $this.data('autoTranslit', data);
                    data.options = $.extend({}, defaults, initoptions);
                    if ($this.data('autotranslit')) {
                        data.options.targetName = $this.data('autotranslit');
                    }
                    data.options.target = $('input[name="'+data.options.targetName+'"]', $(this).closest(data.options.context));
                    if (data.options.target) {
                        //Подключаем автоматическую транслитерацию, если происходит создание объекта
                        var isAdd;
                        if ($this.closest(data.options.virtualForm).length) {
                            isAdd = $this.closest(data.options.virtualForm).data('isAdd');
                        } else {
                            let action = $this.closest(data.options.formAction).attr('action');
                            if (action) {
                                isAdd = action.toLowerCase().indexOf(data.options.addPredicate) > -1;
                            }

                        }
                        if (isAdd) {
                            $this.on('blur', onBlur);
                        }
                        if (data.options.showUpdateButton) {
                            var update = $('<a class="update-translit"></a>').click(onUpdateTranslit).attr('title', lang.t('Транслитерировать заново'));
                            $(data.options.target).after(update).parent().trigger('new-content');
                        }
                    }
                }
            };
            
            //private 
            var onBlur = function() {
                if (data.options.target.val() == '') {
                    onUpdateTranslit();
                }
            },
            onUpdateTranslit = function() {
                data.options.target.val( translit( $this.val() ) );
            },
            translit = function( text ) {
                let diacritical_characters = ('Ä ä À à Á á Â â Ã ã Å å Ǎ ǎ Ą ą Ă ă Æ æ Ā ā Ç ç Ć ć Ĉ ĉ Č č Ď đ Đ ď ð È'+
                    ' è É é Ê ê Ë ë Ě ě Ę ę Ė ė Ē ē Ĝ ĝ Ģ ģ Ğ ğ Ĥ ĥ Ì ì Í í Î î Ï ï ı Ī ī Į į Ĵ ĵ Ķ ķ Ĺ ĺ Ļ ļ Ł ł Ľ ľ '+
                    'Ñ ñ Ń ń Ň ň Ņ ņ Ö ö Ò ò Ó ó Ô ô Õ õ Ő ő Ø ø Œ œ Ŕ ŕ Ř ř ẞ ß Ś ś Ŝ ŝ Ş ş Š š Ș ș Ť ť Ţ ţ Þ þ Ț ț Ü'+
                    ' ü Ù ù Ú ú Û û Ű ű Ũ ũ Ų ų Ů ů Ū ū Ŵ ŵ Ý ý Ÿ ÿ Ŷ ŷ Ź ź Ž ž Ż ż').split(' '),
                    transform_characters   = ('a a a a a a a a a a a a a a a a a a ae ae a a c c c c c c c c d d d d d'+
                    ' e e e e e e e e e e e e e e e e g g g g g g h h i i i i i i i i i i i i i j j k k l l l l l l l '+
                    'l n n n n n n n n o o o o o o o o o o o o o o oe oe r r r r s s s s s s s s s s s s t t t t th th'+
                    ' t t u u u u u u u u u u u u u u u u u u w w y y y y y y z z z z z z').split(' ');

                var rus = ['а','б','в','г','д','е','ё','ж','з','и','й','к','л','м','н','о',
                    'п','р','с','т','у','ф','х','ц','ч','ш','щ','ь','ы','ъ','э','ю','я','+'].concat(diacritical_characters);

                var eng = ['a', 'b', 'v', 'g', 'd', 'e', 'e', 'zh', 'z', 'i', 'y', 'k',
                    'l', 'm', 'n', 'o', 'p', 'r', 's', 't', 'u', 'f', 'h', 'c', 'ch', 'sh',
                    'sch', '', 'y', '', 'e', 'yu', 'ya','-plus-'].concat(transform_characters);

                var result = '', char;
                var hyphen = false;
                for(var i=0; i<text.length; i++) {
                    char = text.toLowerCase().charAt(i);

                    if (char.match(/[a-z0-9]/gi)) {
                        result = result + char;
                        hyphen = false;
                    } else {
                        var pos = rus.indexOf(char);
                        if (pos > -1) {
                            result = result + eng[pos];
                            hyphen = false;
                        } else if (!hyphen) {
                            result = result + '-';
                            hyphen = true;
                        }
                    }
                }

                //Вырезаем по краям знак минуса "-"
                result = result.replace(/^\-+|\-+$/g, '');
                result = result.replace(/\-\-/g, '-');

                return result;
            };
            
            
            
            if ( methods[method] ) {
                methods[ method ].apply( this, Array.prototype.slice.call( args, 1 ));
            } else if ( typeof method === 'object' || ! method ) {
                return methods.init.apply( this, args );
            }
        });
    };

    $.contentReady(function() {
        $('input[data-autotranslit]', this).autoTranslit();
    });

})(jQuery);
/**
 * Плагин обеспечивает отображение всплывающих сообщений в адмнистративной панели.
 * Пример вызова:
 * $.messenger('hello!'); //Отобразит обычное сообщение
 * $.messenger('show', {text: 'Hello!', theme: 'error'}); //Отобразит сообщение в красном окне
 *
 * @author ReadyScript lab.
 */
(function($) {
    $.messenger = function(method) {
        var defaults = {
            offsetY: 70, //Стартовое смещение по Y
            msg: {
                timer: null,
                theme: '', //Класс сообщений
                distance: 10, //Расстояние между сообщениями
                expire: 20, //В секундах время отображения сообщения
                stopExpireOnClick: true
            }
        }, 
        args = arguments,
        
        $this = $('#messages-container');
        if (!$this.length) {
            $this = $('<div id="messages-container"></div>').appendTo('body');
        }
        var data = $this.data('messenger');
        if (!data) { //Инициализация
            data = {
                options: defaults
            }; 
            $this.data('messenger', data);
        }
        
        var methods = {
            
            show: function(parameters) {
                var $box = getMessageBox(parameters);
                var local_params = $.extend({}, data.options.msg, parameters);
                $box.data('messenger', local_params);
                
                var offset = +(defaults.offsetY);
                var messages = $('.message-box', $this);
                for( var i=messages.length-1; i>=0; i-- ) {
                    offset = offset + $(messages[i]).height() + (local_params.distance);
                }
                
                $box.css({
                    bottom: offset+'px'
                })
                $box
                    .hover(function() {
                        local_params.pause = true;
                    }, function() {
                        local_params.pause = false;
                    })
                    .on('messenger.close', closeBox)
                    .on('click.messenger', '.close', function() {
                        $(this).closest('.message-box').trigger('messenger.close');
                    })
                    .appendTo($this).fadeIn();
                    
                if (local_params.stopExpireOnClick) {
                    $box.on('mousedown.messenger', stopExpire);
                }
                
                if (local_params.expire) {                    
                    local_params.timer = setTimeout(function() {
                        $box.trigger('messenger.close');
                        if (!local_params.pause) {
                            $box.trigger('messenger.close');
                        } else {
                            $box.one('mouseleave.messengerOne', function() {
                                $box.trigger('messenger.close');
                            });
                        }
                    }, local_params.expire * 1000);
                }
            },
            
            update: function() {
                
                var messages = $('.message-box', $this);
                var newOffset = {};
                
                var offset = +(defaults.offsetY);
                newOffset["0"] = offset;
                for( var i=0; i<messages.length; i++ ) {
                    offset = offset + $(messages[i]).height() + ($(messages[i]).data('messenger').distance);
                    newOffset[i+1] = offset;
                }
                
                messages.each(function(i) {
                    $(this).animate({
                        bottom: newOffset[i]+'px'
                    }, 'fast');
                });
            },
            
            hideAll: function() {
                $('.message-box', $this).trigger('messenger.close');
            },
            
            setOptions: function(options) {
                data.options = $.extend(data.options, options);
            }
        }
        
        //private 
        var getMessageBox = function(parameters) {
            return $('<div class="message-box"></div>')
                    .append('<a class="close"></a>')
                    .append($('<div class="msg"></div>').html(parameters.text))
                    .addClass(parameters.theme)
                    .hide();
        },
        
        stopExpire = function() {
            var box = $(this);
            clearTimeout(box.data('messenger').timer);
            box.unbind('.messengerOne');
        },

        closeBox = function() {
            var box = $(this);
            clearTimeout(box.data('messenger').timer);
            box.fadeOut('fast', function() {
                box.remove();
                methods.update();
            });
        };
        
        
        if ( methods[method] ) {
            methods[ method ].apply( this, Array.prototype.slice.call( args, 1 ));
        } else if ( typeof method === 'object') {
            return methods.init.apply( this, args );
        } else {
            var params = Array.prototype.slice.call( args, 1 );
            var extend = {text: method};
            if (!params[0]) params[0] = {};
            params[0] = $.extend(params[0], extend);
            methods['show'].apply( this, params );
        }
    }

})(jQuery);
/**
 * Plugin позволяет проводить виртуальные обучающие туры по админ. панели ReadyScript
 *
 * @author ReadyScript lab.
 */
(function($) {
    $.tour = function(method) {
        var
            defaults = {
                startTourButton: '.start-tour',
                baseUrl: '/',
                folder: '',
                adminSection: global.adminSection,
                tipInfoCorrectionY:20,
            },
            args = arguments,
            timeoutHandler;

        var data = $('body').data('tour');
        if (!data) { //Инициализация
            data = {
                options: defaults
            };
            $('body').data('tour', data);
        }

        //public
        var
            methods = {
                init: function(tours, localOptions) {
                    data.tours = tours;
                    data.options = $.extend({}, data.options, localOptions);

                    $(data.options.startTourButton).click(function() {
                        methods.start($(this).data('tourId'), 'index', true);
                    });
                    //Если тур был запущен раннее, то пытаем определить действие
                    var tourId = $.cookie('tourId');
                    if (tourId) methods.start(tourId);

                },
                start: function(tour_id, startStep, force) {
                    if (!data.tours[tour_id]) {
                        console.log('Tour '+tour_id+' not found');
                        return;
                    };
                    $.cookie('tourId', tour_id, {path:'/'});
                    data.tour = data.tours[tour_id];
                    data.tourTotalSteps = getTotalSteps();
                    data.tourStepIndex = [];
                    $.each(data.tour, function(i, val) {
                        data.tourStepIndex.push(i);
                    });

                    var
                        step = findStep(data.tour, startStep, force);

                    //Проверка: если step = false, то значит стартовая страница не соответствует туру.
                    if (step) {
                        runStep(step);
                    } else {
                        if (step !== null) {
                            methods.stop();
                        }
                    }

                    $('body').bind('keypress.tour', function(e){
                        if (e.keyCode == 27) methods.stop();
                    });
                },
                stop: function() {
                    $.cookie('tourId', null, {path:'/'});
                    $.cookie('tourStep', null, {path:'/'});
                    hideStep();
                },
            }

        //private
        var
            /**
             * Выполняет поиск текущего шага в туре по принципу:
             * текущий URL должен совпадать с URL, заявленным в шаге
             *
             * @param tour
             */
            findStep = function(tour, step, force) {
                if (!step) step = $.cookie('tourStep');
                if (!step && !$('#debug-top-block').is('.debug-mobile')) {
                    step = 'index';
                }
                if (!data.tour[step]) return false;

                //Проверяем соответствует ли шаг тура текущей странице
                var a = $('<a />').attr('href', location.href).get(0);
                var relpath = ('/'+a.pathname.replace(/^([/])/gi, '')) + a.search;
                var relpath_mask = relpath.replace(data.options.adminSection, '%admin%').replace(/([/])$/gi, '');

                var steppath;
                if (step) {
                    steppath = data.options.folder + data.tour[step].url.replace(/([/])$/gi, '');
                }

                if (relpath_mask != steppath && !force) {
                    foundStep = false;
                    //Пытаемся найти шаг, по URL.
                    var before, found;
                    for(var key in data.tour) {
                        if (data.options.folder + data.tour[key].url.replace(/([/])$/gi, '') == relpath_mask) {
                            if (!before || before == step) { //Этот шаг идет вслед за предыдущим отображенным
                                //Мы нашли шаг по URL, возвращаем его
                                foundStep = key;
                                break;
                            }
                        }
                        before = key;
                    }

                    //Если не нашли, то выводим сообщение о прерывании тура
                    if (!foundStep) {
                        showDialog({
                            type: 'dialog',
                            message: lang.t('Вы перешли на страницу, не предусмотренную интерактивным курсом. <br>Вернуться и продолжить обучение?'),
                            buttons: {
                                yes: step,
                                no: false
                            }
                        });
                        return null;
                    }
                    step = foundStep;
                }

                return step;
            },

            getStepIndex = function(step) {
                var i = 1;
                for(var key in data.tour) {
                    if (key == step) return i;
                    i++;
                }
                return false;
            },

            getTotalSteps = function() {
                var i = 0;
                for(var key in data.tour) i++;
                return i;
            },

            runStep = function(step, noRedirect) {
                var tourStep = data.tour[step];
                hideStep();

                data.curStep = step;
                data.curStepIndex = getStepIndex(step);
                $.cookie('tourStep', step, {path:'/'});

                //Проверим, соответствует ли текущая страница шагу step
                var a = $('<a />').attr('href', location.href).get(0);
                var relpath = ('/'+a.pathname.replace(/^([/])/gi, '')) + a.search;
                var relpath_mask = relpath.replace(data.options.adminSection, '%admin%').replace(/([/])$/gi, '');
                if (relpath_mask != data.options.folder + tourStep.url.replace(/([/])$/gi, '') && !noRedirect) {
                    //Необходим переход на другую страницу
                    $.rs.loading.show();
                    location.href = data.options.folder + tourStep.url.replace('%admin%', data.options.adminSection);
                    return;
                }

                //Выполняет один шаг обучения
                var type = (tourStep.type) ? tourStep.type : 'tip';
                if (tourStep.onStart) tourStep.onStart();
                switch (type) {
                    case 'dialog': showDialog(tourStep); break;
                    case 'tip': showTip(step); break;
                    case 'info': showInfo(step); break;
                    case 'form': showForm(step); break;
                }

                //Выполняем watch
                if (tourStep.watch) {
                    $('body').on(tourStep.watch.event + '.tour', tourStep.watch.element, function() {
                        runAction(tourStep.watch.next, true);
                    });
                }

                $('a[data-step]').click(function() {
                    runAction( $(this).data('step') );
                });
            },

            overlayShow = function(blur) {
                if (blur) {
                    $('body > *').addClass('filterBlur');
                }
                $('<div id="tourOverlay"></div>').appendTo('body');

            },

            overlayHide = function() {
                $('#tourOverlay').remove();
                $('body > *').removeClass('filterBlur');
            },

            showDialog = function(tourStep) {
                overlayShow(true);
                var dialog = $('<div id="tipDialog" />').addClass('tipDialog').append('<a class="tipDialogClose" />')
                var content = $('<div class="tipContent" />').html(tourStep.message);
                var buttons = $('<div class="tipButtons" />');

                $.each(tourStep.buttons, function(key, val) {
                    var button = $('<a class="tipButton"/>');
                    var buttonText = (typeof(val) == 'object' && val.text) ? val.text : false;

                    switch(key) {
                        case 'no': {
                            button.text(buttonText ? buttonText : lang.t('Нет')).addClass('tipNo');
                            break;
                        }
                        case 'yes': {
                            button.text(buttonText ? buttonText : lang.t('Да')).addClass('tipYes');
                            break;
                        }
                        case 'finish': {
                            button.text(buttonText ? buttonText : lang.t('Завершить')).addClass('tipYes');
                            break;
                        }
                        default: {
                            button.text(buttonText).attr(val.attr);
                        }
                    }
                    button.click(hideDialog);

                    //Переход на следующий шаг
                    if (typeof(val) == 'string' || typeof(val) == 'boolean' || typeof(val) == 'object') {
                        button.click(function() {
                            var next = (typeof(val) == 'object') ? val.step : val;
                            runAction(next);
                        });
                    }

                    $('.tipDialogClose', dialog).click(methods.stop);
                    $('#tourOverlay').click(methods.stop);

                    button.appendTo(buttons);
                });

                dialog
                    .append(content)
                    .append(buttons)
                    .appendTo('body')
                    .addClass('flipInX animated');

                dialog.css({
                    marginLeft: -parseInt(dialog.width()/2),
                    marginTop:-parseInt(dialog.height()/2),
                });

            },

            showTip = function(step)
            {
                var
                    tourStep = data.tour[step];

                tourStep.tip = $.extend(true, {
                    correctionX: 0,
                    correctionY: 0,
                    animation: 'fadeInDown',
                    css: {
                        'minWidth': 280
                    }
                }, tourStep.tip);


                if (tourStep.tip.fixed) {
                    tourStep.tip.css['position'] = 'fixed';
                }

                var element = [];

                if (typeof(tourStep.tip.element) == 'object') {

                    for(var i=0; i<tourStep.tip.element.length; i++) {
                        var currentElement = tourStep.tip.element[i];

                        if (typeof(currentElement) == 'string') {
                            var selector = currentElement;
                        } else {
                            var selector = currentElement.selector;
                        }

                        element = $(selector).first();

                        if (currentElement.whenUse && currentElement.whenUse(element)) {
                            break;
                        } else if (!currentElement.whenUse && element.is(':visible')) {
                            break;
                        }
                    }

                    if (typeof(currentElement) == 'object') {
                        //Объединяем параметры конкретного элемента с общими
                        tourStep.tip = $.extend(tourStep.tip, currentElement);
                    }
                } else {
                    element = $(tourStep.tip.element).first();
                }

                if (!element.length) {
                    if (tourStep.tip.notFound) {
                        runAction(tourStep.tip.notFound);
                    }
                    return;
                }

                var tip = $('<div class="tipTour" />')
                tip.html('<div class="tipContent">'+tourStep.tip.tipText+'</div>')
                    .append(getStatusLine())
                    .append('<i class="corner"/>')
                    .css(tourStep.tip.css)
                    .appendTo('body')
                    .data('originalWidth', tip.width())
                    .width(tip.width())
                    .draggable();

                getTipPosition(element, tourStep.tip, tip);

                scrollWindow(tip);

                $(window).bind('resize.tour', function() {
                    getTipPosition(element, tourStep.tip, tip);
                });

                if (tourStep.tip.animation) {
                    tip.addClass(tourStep.tip.animation + ' animated');
                }

                if (tourStep.whileTrue) {
                    var whileTrue = function() {
                        if (!tourStep.whileTrue()) {
                            goNext();
                        } else {
                            timeoutHandler = setTimeout(whileTrue, 2000);
                        }
                    }();

                    timeoutHandler = setTimeout(whileTrue, 2000);
                }

                if (tourStep.checkTimeout) {
                    timeoutHandler = setTimeout(goNext, tourStep.checkTimeout);
                }
            },

            getTipPosition = function(element, tipData, tip)
            {

                var position = {
                        top: element.offset().top + element.innerHeight() + 10,
                        left: element.offset().left + element.width()/2,
                    },
                    bodyWidth = $('body').width();

                if (tipData.bottom) {
                    //Выноска находится внизу экрана
                    position.top = element.offset().top - getHeight(tip);
                    tip.addClass('bottom');
                }

                if (tipData.left) {
                    //Выноска находится внизу экрана
                    position.top = element.offset().top;
                    position.left = element.offset().left - getWidth(tip) - 10;
                    tip.addClass('left');
                }

                var tipWidth = getWidth(tip);

                if (tipWidth > bodyWidth-20) {
                    tip.width( bodyWidth-40 );
                    tipWidth = bodyWidth-20;
                }

                if (position.left + tipWidth > bodyWidth) {
                    position.marginLeft = -(position.left + tipWidth - bodyWidth + 10);
                } else {
                    position.marginLeft = 0;
                }
                position.left = position.left + tipData.correctionX;
                position.top = position.top + tipData.correctionY;

                if (position.left < 0) {
                    tip.width( tip.width() + position.left );
                    position.left = 0;
                }

                tip.css(position);

                //Устанавливаем смещение выноски
                tip.find('.corner').css('marginLeft', -position.marginLeft);


            },

            runAction = function(action, noRedirect) {

                switch(typeof(action)) {

                    case 'boolean': if (!action) {
                        methods.stop();
                    }; break;
                    case 'string': runStep(action, noRedirect); break;
                    case 'function': {
                        var result = action();
                        if (result) runStep(result, noRedirect);
                        if (result === false) return false;
                    }
                    default: return false;
                }
                return true;
            },

            closeFormDialog = function() {
                if (data.curStep && data.tour[data.curStep].type == 'form') {
                    //Пытаемся закрыть окно, если текущий шаг связан с формой
                    $('body').off('dialogBeforeDestroy.tour');
                    $('.dialog-window').dialog('close');
                }
            },

            goNext = function() {
                if (data.curStepIndex < data.tourTotalSteps) {
                    closeFormDialog();
                    runStep(data.tourStepIndex[data.curStepIndex]);
                }
            },

            goPrev = function() {
                if (data.curStepIndex > 1) {
                    closeFormDialog();
                    runStep(data.tourStepIndex[data.curStepIndex-2]);
                }
            },

            scrollWindow = function(oneTip) {

                if (oneTip.closest('.dialog-window').length) {
                    var $window = oneTip.closest('.contentbox');
                    var $windowHeight = $window.height() - 55;
                    var $scrollElement = $window;

                    var tipOffsetTop = oneTip.offset().top - 90 + $scrollElement.scrollTop();

                } else {
                    var $window = $(window);
                    var $windowHeight = $window.height();
                    var $scrollElement = $('html, body');

                    var tipOffsetTop = oneTip.offset().top - 90;
                }

                //Если tip не помещается на экран, то перемещаем scroll
                if ( tipOffsetTop < $window.scrollTop()
                    || tipOffsetTop > $window.scrollTop() + $windowHeight
                ) {
                    $scrollElement.animate({
                        scrollTop: tipOffsetTop - 50
                    });
                }
            },

            showForm = function(step)
            {
                var tourStep = data.tour[step],
                    checkTimeout,
                    tipMap = {};

                data.curSubStep = 0;
                data.totalSubSteps = 0;

                //Создаем массив tip.label => index, для быстрого нахождения index по label.
                $.each(tourStep.tips, function(i, tip) {
                    if (tip.label) {
                        tipMap[tip.label] = i;
                    }
                    data.totalSubSteps++;
                });

                //Запускает подшаги по событию
                $('body').on('new-content.tour', function() {
                    if (tourStep.tips[data.curSubStep].waitNewContent || data.curSubStep == 0) {
                        setTimeout(function() {
                            showSubTip(true);
                        }, 50);
                    }
                });

                //Возвращаемся на предыдущий шаг, если закрывается окно диалога
                $('body').on('dialogBeforeDestroy.tour', function() {
                    goPrev();
                });

                var showSubTip = function(skipCheckWait) {

                    $('.tipForm').each(function() {
                        if (tourStep.tips[ $(this).data('substep') ].onStop) {
                            tourStep.tips[ $(this).data('substep') ].onStop();
                        }
                        $(this).remove();
                        clearTimeout(checkTimeout);
                    });

                    tip = tourStep.tips[data.curSubStep];

                    if (!tip) return;

                    //Устанавливаем значения по умолчанию
                    tip = $.extend({
                        tipText: '',
                        css: {},
                        animation: null,
                        correctionX: 0,
                        correctionY: 0,
                        onStart: null,
                        onStop: null
                    }, tip);

                    var element = $(tip.element).first();

                    if ( (!skipCheckWait && tip.waitNewContent) ) return;

                    //Проверяем условие для отображения
                    if (typeof(tip.ifTrue) == 'function' ) {
                        if (!tip.ifTrue()) {
                            //Если отображать tip не следует, то перекидываем на другой tip
                            data.curSubStep = (tip.elseStep !== undefined) ? tipMap[tip.elseStep] : data.curSubStep + 1;
                            showSubTip();
                            return;
                        }
                    }

                    var goToNextSubStep = function() {
                        data.curSubStep = (tip.next) ? tipMap[tip.next] : data.curSubStep + 1;
                        showSubTip();
                    }

                    if ( !element.length  ) {
                        //Пытаемся перейти на следующий элемент
                        if (data.curSubStep>0) goToNextSubStep();
                        return;
                    }

                    var oneTip = $('<div class="tipTour tipForm" />')
                    oneTip.html('<div class="tipContent">'+tip.tipText+'</div>')
                        .data('substep', data.curSubStep)
                        .append('<i class="corner"><!----></i>')
                        .append(getStatusLine())
                        .css(tip.css);

                    if (tip.correctionX) {
                        oneTip
                            .css('marginLeft', tip.correctionX);

                        if (tip.correctionX<0) {
                            oneTip.find('.corner').css({
                                left: -tip.correctionX
                            });
                        }
                    }

                    if (tip.correctionY) {
                        oneTip.css('marginTop', tip.correctionY);
                    }

                    if (tip.bottom) {
                        oneTip
                            .addClass('bottom')
                            .appendTo('body');

                        updateTipFormPosition(element, tip, oneTip);
                        $(window).on('resize.tour', function() {
                            updateTipFormPosition(element, tip, oneTip);
                        });

                    } else {
                        if (tip.insertAfter) {
                            oneTip
                                .insertAfter(element);
                        } else {
                            oneTip
                                .appendTo(element.parent());
                        }
                    }

                    if (tip.onStart) tip.onStart();

                    scrollWindow(oneTip);

                    if (tip.checkPattern) {
                        if ( (element.is('input') && element.attr('type') == 'text')
                            || element.is('textarea')) {

                            var checkText = function() {
                                if (tip.checkPattern.test( $(element).val() )) {
                                    goToNextSubStep();
                                } else {
                                    checkTimeout = setTimeout(checkText, 1500);
                                }
                            }
                            checkTimeout = setTimeout(checkText, 1500);
                        }
                        if (element.is('input') && element.attr('type') == 'checkbox') {
                            element.off('.tour').on('change.tour', function(e) {
                                if ($(this).is(':checked') ==  tip.checkPattern) {
                                    element.off('.tour');
                                    goToNextSubStep();
                                }
                            });
                        }

                        if (element.is('select')) {
                            element.off('.tour').on('change.tour', function(e) {
                                if (tip.checkPattern.test( $(this).val() )) {
                                    element.off('.tour');
                                    goToNextSubStep();
                                }
                            });
                        }
                    }

                    if (tip.checkSelectValue) {
                        element.on('change.tour', function(e) {
                            if (tip.checkSelectValue.test( $('option:selected', e.currentTarget).html() )) {
                                element.off('.tour');
                                goToNextSubStep();
                            }

                        });
                    }

                    if (tip.watch) {
                        var watchElement = tip.watch.element ? $(tip.watch.element) : element;

                        watchElement.one(tip.watch.event+'.tour', function() {
                            if (tip.watch.next) {
                                runAction(tip.watch.next);
                            } else {
                                goToNextSubStep();
                            }
                        });
                    }

                    if (tip.tinymceTextarea) {
                        var textarea = $(tip.tinymceTextarea);

                        var checkText = function() {
                            if (tip.checkPattern.test( textarea.html() )) {
                                goToNextSubStep();
                            } else {
                                setTimeout(checkText, 1000);
                            }
                        };
                        setTimeout(checkText, 1000);
                    }

                    if (tip.checkTimeout) {
                        checkTimeout = setTimeout(function() {
                            goToNextSubStep();
                        }, tip.checkTimeout);
                    }
                }

                showSubTip();
            },

            updateTipFormPosition = function(element, tipData, oneTip)
            {
                var position = {
                    top: element.offset().top + getHeight(element),
                    left: element.offset().left
                }

                if (tipData.bottom) {
                    position.top = element.offset().top - getHeight(oneTip);
                }

                if (oneTip.css('position') == 'fixed') {
                    position.top = position.top - $(window).scrollTop();
                }

                oneTip.css(position);

                //Выставляем смещение выноски
                if (tipData.correctionX) {
                    oneTip.find('.corner').css({
                        left: tipData.correctionX
                    });
                }
            },

            showInfo = function(step)
            {
                var tourStep = data.tour[step];
                overlayShow();

                if (tourStep.tips)
                    $.each(tourStep.tips, function(i, tip) {

                        //Устанавливаем значения по умолчанию
                        tip = $.extend({
                            tipText: '',
                            css: {},
                            animation: null,
                            position:['left', 'bottom'],
                            correctionX: 0,
                            correctionY: 0
                        }, tip);

                        var element = $(tip.element).first();

                        var canShow = element.length && (!tip.whenUse || tip.whenUse(element));

                        if (canShow) {
                            var oneTip = $('<div class="tipInfoTour" />')
                            oneTip.html('<div class="tipInfoTourContent">'+tip.tipText+'</div>')
                                .append('<i class="corner"><span class="line"><span class="arrow"></span></span></i>')
                                .addClass( tip.position[0]+tip.position[1][0].toUpperCase()+tip.position[1].substring(1) )
                                .css(tip.css)
                                .appendTo('body');

                            updateTipInfoPosition(tip.element, tip, oneTip);

                            $(window).on('resize.tour', function() {
                                updateTipInfoPosition(tip.element, tip, oneTip);
                            });

                            if (tip.animation) {
                                oneTip.addClass(tip.animation + ' animated');
                            }
                        }
                    });
                var
                    text = $('<div class="contentTour">').html(tourStep.message);

                $('<div class="infoTour" />')
                    .append('<div class="infoBack"/>')
                    .append('<h2>'+lang.t('Информация')+'</h2>')
                    .append(text)
                    .append(getStatusLine())
                    .appendTo('body')
                    .css('marginTop', -$('.infoTour').height()/2)
                    .draggable({handle: 'h2'});

                $('.goNext').addClass('pulse animated infinite');
            },

            getWidth = function(element) {
                return element.width() + parseInt(element.css('paddingLeft')) + parseInt(element.css('paddingRight'));
            },

            getHeight = function(element) {
                return element.height() + parseInt(element.css('paddingTop')) + parseInt(element.css('paddingBottom'));
            },

            updateTipInfoPosition = function(elementString, tipData, oneTip) {
                var
                    element = $(elementString),
                    horiz = tipData.position[0],
                    vert = tipData.position[1],
                    cornerSourceY,
                    css = {};

                if (!element.is(':visible')) {
                    oneTip.css('visibility', 'hidden');
                    return false;
                } else {
                    oneTip.css('visibility', 'visible');
                }

                switch(horiz) {
                    case 'left': css.left = element.offset().left + getWidth(element) - getWidth(oneTip);
                        if (vert == 'middle') {
                            css.left = css.left - getWidth(element);
                        }
                        break;
                    case 'center': css.left = element.offset().left + getWidth(element)/2 - getWidth(oneTip)/2; break;
                    case 'right': css.left = element.offset().left;
                        if (vert == 'middle') {
                            css.left = css.left + getWidth(element);
                        }
                        break;
                }

                switch(vert) {
                    case 'top': css.top = element.offset().top - getHeight(oneTip) - data.options.tipInfoCorrectionY; cornerSourceY = element.offset().top; break;
                    case 'middle': css.top = element.offset().top + getHeight(element)/2 - getHeight(oneTip)/2; cornerSourceY = element.offset().top + getHeight(element)/2; break;
                    case 'bottom': css.top = element.offset().top + getHeight(element) + data.options.tipInfoCorrectionY; cornerSourceY = element.offset().top + getHeight(element);  break;
                }

                css.marginTop = tipData.correctionY;
                css.marginLeft = tipData.correctionX;

                if (tipData.fixed) {
                    oneTip.css('position', 'fixed');
                }

                oneTip.css(css);

                //Устанавливаем высоту выноски
                var cornerCss = {
                    left: 'auto',
                    right: 'auto',
                    top: 'auto',
                    bottom: 'auto',
                    width: 10,
                    height: 1,
                }
                if (vert == 'middle') {

                    //Выноска горизонтальная
                    cornerCss.top = cornerSourceY-css.top;

                    if (horiz == 'right') {
                        cornerCss.width = (css.left + tipData.correctionX) - (element.offset().left + getWidth(element));
                        cornerCss.left = -cornerCss.width;
                    }
                    if (horiz == 'left') {
                        cornerCss.width = element.offset().left - (css.left + getWidth(oneTip) + tipData.correctionX);
                        cornerCss.right = -cornerCss.width;
                    }

                } else {
                    //Выноска вертикальная
                    cornerCss.left = element.offset().left + getWidth(element)/2 - css.left;
                    if (vert == 'bottom') {
                        cornerCss.height = Math.abs(cornerSourceY - css.top) + css.marginTop;
                        cornerCss.top = -cornerCss.height;
                    }
                    if (vert == 'top') {
                        cornerCss.height = Math.abs(cornerSourceY - (css.top + getHeight(oneTip))) - css.marginTop;
                        cornerCss.bottom = -cornerCss.height;
                    }
                }

                oneTip.find('.corner').css(cornerCss);
            },

            getStatusLine = function()
            {
                var
                    tourStep = data.tour[data.curStep],
                    curSubStep = '',
                    showNext = false;

                if (tourStep.type == 'form') {
                    var
                        curSubStep = '<span class="tourSubStep">.'+(data.curSubStep)+'</span>',
                        showNext = curSubStep < data.totalSubSteps;
                }

                var infoline = $('<div class="infoLineTour">').html(
                    '<span class="infoLineStep">'+lang.t('шаг')+' <strong>'+data.curStepIndex+'</strong>'+curSubStep+' '+lang.t('из')+' '+data.tourTotalSteps+'</span>'
                );

                if (data.curStepIndex>1) {
                    infoline.prepend( $('<a class="goPrev"><i class="zmdi zmdi-arrow-left"><!----></i><span>'+lang.t('назад')+'</span></a>').on('click', goPrev) );
                    $('body').on('keydown.tour', function(e) {
                        if (e.ctrlKey && e.keyCode == 37) goPrev();
                    });
                }
                if (data.curStepIndex < data.tourTotalSteps || showNext) {
                    infoline.append( $('<a class="goNext"><span>'+lang.t('далее')+'</span><i class="zmdi zmdi-arrow-right"><!----></i></a>').on('click', goNext) );
                    $('body').on('keydown.tour', function(e) {
                        if (e.ctrlKey && e.keyCode == 39) goNext();
                    });
                }

                infoline.append( $('<a class="tourClose zmdi zmdi-close"></a>').on('click', methods.stop) );

                return infoline;
            },

            hideStep = function()
            {
                overlayHide();
                hideDialog();
                $('body').off('dialogBeforeDestroy.tour');
                $('.infoTour, .tipTour, .tipInfoTour').remove();
                $(window).off('.tour');
                $('*').off('.tour');
                clearTimeout(timeoutHandler);

                if (data.curStep && typeof(data.tour[data.curStep].onStop) == 'function') data.tour[data.curStep].onStop();
            },

            hideDialog = function()
            {
                overlayHide();
                $('#tipDialog').remove();
            };

        if ( methods[method] ) {
            methods[ method ].apply( this, Array.prototype.slice.call( args, 1 ));
        } else if ( typeof method === 'object') {
            return methods.init.apply( this, args );
        }
    };
})(jQuery);
/**
 * Файл с описанием схемы интерактивного тура по административной панели ReadyScript
 *
 * @author RedyScript lab.
 */
$(function() {

    var isCategoryExpanded = function(element) {
        return (!element.closest('.left-up').length
        && window.matchMedia('(min-width: 992px)').matches)
    };

    /**
    * Тур по первичной настройке сайта
    */
    var tourTopics = {
        'base': lang.t('Базовые настройки'),
        'products': lang.t('Категории и Товары'),
        'menu': lang.t('Меню'),
        'article': lang.t('Новости'),
        'delivery': lang.t('Способы доставки'),
        'payment': lang.t('Способы оплаты'),
        'debug': lang.t('Правка информации на сайте')
    };

    var welcomeTour = {};

    welcomeTour.commonStart =  {
        'index': {
                url: '/',
                topic: tourTopics.base,
                type: 'dialog',
                message: lang.t(`<div class="tourIndexWelcome">Рады приветствовать Вас!</div>
                    <div class="tourIndexBlock">
                        <div class="tourBorder"></div>
                        <p class="tourHello">Хотели бы Вы пройти<br> интерактивный курс обучения?</p>
                        <div class="tourLegend">
                            <a class="tourTop first indexTipToAdmin" data-step="index-tip-toadmin">Базовые настройки</a>
                            <a class="adminCatalogAddInfo" data-step="admin-catalog-add-info">Категории<br> и Товары</a>
                            <a class="tourTop menuCtrl" data-step="menu-ctrl">Текстовые<br> страницы<br> (Меню)</a>
                            <a class="articleCtrl" data-step="article-ctrl">Новости</a>`+
                            (global.scriptType != 'Shop.Base' ? `<a class="tourTop shopDeliveryCtrl" data-step="shop-deliveryctrl">Способы доставки</a>
                            <a class="shopPaymentCtrl" data-step="shop-paymentctrl">Способы оплаты</a>` : '') +
                            `<a class="tourTop debugIndex" data-step="debug-index">Правка информации на сайте</a>
                        </div>
                    </div>
                </div>`, null, 'tourWelcome'),
                buttons: {
                    yes: {
                        text: lang.t('Да, пройти курс с начала'),
                        step: 'index-tip-toadmin'
                    },
                    no: false
                }
            },
            
            'index-tip-toadmin': {
                url: '/',
                topic: tourTopics.base,            
                tip: {
                    element: '.header-panel .to-admin',
                    tipText: lang.t('Все настройки интернет-магазина располагаются в административной панели. Нажмите на кнопку быстрого перехода в панель администрирования.')
                }
            },
            
            'admin-index': {
                url: '%admin%/',
                topic: tourTopics.base,            
                type: 'info',
                message: lang.t('Это главный экран панели управления магазином. Здесь могут размещаться информационные виджеты с самой актуальной информацией по ключевым показателям магазина.'),
                tips: [
                    {
                        element: '.addwidget',
                        tipText: lang.t('Кнопка "Добавить виджет" откроет список имеющихся в системе виджетов'),
                        position: ['center', 'bottom'],  //Положение относительно element - [(left|center|right),(top|middle|bottom)]
                        fixed:true,
                        animation: 'bounceInDown'
                    },
                    {
                        element: '.action-zone .action.to-site',
                        tipText: lang.t('Быстрый переход на сайт'),
                        position: ['left', 'bottom'],
                        animation: 'slideInLeft'
                    },
                    {
                        element: '.action-zone .action.clean-cache',
                        tipText: lang.t('Кнопка для очистки кэша системы'),
                        position: ['left', 'bottom'],
                        correctionY: 50,
                        animation: 'slideInDown'
                    },
                    {
                        element: '.panel-menu .current',
                        tipText: lang.t('Показан текущий сайт. Если управление ведется несколькими сайтами, то при наведении будет показан список сайтов.'),
                        position: ['left', 'bottom'],
                        correctionY: 100,
                        css: {
                            width: 300
                        },
                        animation: 'bounceInDown'
                    }
                ]
            },
            
            'admin-index-to-siteoptions': {
                url: '%admin%/',
                topic: tourTopics.base,
                tip: {
                    element: ['a[data-url$="/menu-ctrl/"]', '#menu-trigger'],
                    tipText: lang.t('Перейдите в раздел <i>Веб-сайт &rarr; Настройка сайта</i>'),
                    correctionX: 40,
                    fixed: true
                },
                onStart: function() {
                    $('a[href$="/site-options/"]').addClass('menuTipHover');
                },
                onStop: function() {
                    $('a[href$="/site-options/"]').removeClass('menuTipHover');
                }
            },
            
            'admin-siteoptions': {
                url: '%admin%/site-options/',
                topic: tourTopics.base,            
                type: 'info',
                message: lang.t('В этом разделе необходимо настроить основные параметры текущего сайта, к которым относятся: '+
                '<ul><li>контактные данные администратора магазина (будут использоваться для уведомлений обо всех событиях в интернет-магазине);</li>'+
                '<li>реквизиты организации продавца (будут использоваться для формирования документов покупателям);</li>'+
                '<li>логотип интернет-магазина;</li>'+
                '<li>тема оформления сайта;</li>'+
                '<li>параметры писем, отправляемых интернет-магазином.</li></ul>', null, 'tourAdminSiteOptions'),
                tips:[
                    {
                        element: '.tab-nav li:eq(3)',
                        tipText: lang.t('Заполните сведения во всех вкладках. При наведении мыши на символ вопроса, расположенный справа от поля, отобразится подсказка по нзначению и заполнению поля.'),
                        position: ['center', 'bottom'],
                        correctionX:50,
                        css: {
                            width:300
                        },
                        animation: 'slideInDown'
                    }
                ],
                buttons: {
                    next: 'admin-siteoptions-save'
                }
            },
            
            'admin-siteoptions-save': {
                url: '%admin%/site-options/',
                topic: tourTopics.base,            
                tip: {
                    element: '.btn.crud-form-apply',
                    tipText: lang.t('Заполните сведения во всех вкладках, расположенных выше. Далее, нажмите на зеленую кнопку, чтобы сохранить изменения.'),
                    correctionY: -15,
                    bottom: true,
                    css: {
                        position: 'fixed'
                    }
                },
                watch: {
                    element: '.btn.crud-form-apply',
                    event: 'click',
                    next:'admin-siteoptions-to-products'
                }
            },
            
            'admin-siteoptions-to-products': {
                url: '%admin%/site-options/',
                topic: tourTopics.base,
                tip: {
                    element: ['a[data-url$="/catalog-ctrl/"]', '#menu-trigger'],
                    tipText: lang.t('Теперь необходимо добавить товары, для этого перейдите в раздел <i>Товары &rarr; Каталог товаров</i>'),
                    correctionX: 40,
                    css: {
                        zIndex: 50
                    }
                },
                onStart: function() {
                    $('.side-menu ul a[href$="/catalog-ctrl/"]').addClass('menuTipHover');
                },
                onStop: function() {
                    $('.side-menu ul a[href$="/catalog-ctrl/"]').removeClass('menuTipHover');
                }
            },
            
            'admin-catalog-add-info': {
                url: '%admin%/catalog-ctrl/',
                topic: tourTopics.products,
                type: 'info',
                message: lang.t(`В этом разделе происходит управление товарами и категориями товаров. 
                            Обратите внимание на расположение кнопок создания объектов.
                            <p>На следующем шаге мы попробуем создать, для примера, одну категорию и один товар. 
                            По аналогии вы сможете наполнить каталог собственными категориями и товарами.`, null, 'tourAdminCatalogAddInfo'),
                tips: [
                    {
                        element: '.treehead .addspec',
                        tipText: lang.t('Создать спец.категорию <br>(например: новинки, лидеры продаж,...)'),
                        position:['left', 'bottom'],
                        whenUse: isCategoryExpanded,
                        animation: 'slideInLeft'
                    },
                    {
                        element: '.treehead .add',
                        tipText: lang.t('Создать категорию товаров'),
                        whenUse: isCategoryExpanded,
                        position:['left', 'bottom'],
                        correctionY:60,
                        animation: 'slideInDown'
                    },
                    {
                        element: '.c-head .btn-group:contains("'+lang.t("добавить товар")+'")',
                        tipText: lang.t('Создать товар'),
                        position:['left', 'middle'],
                        correctionX:-30,
                        animation: 'fadeInLeft'
                    },
                    {
                        element: '.c-head .btn-group:contains("'+lang.t("Импорт/Экспорт")+'")',
                        tipText: lang.t('Через эти инструменты можно массово загрузить товары, <br>категории в систему через CSV файлы. Подробности в <a target="_blank" href="http://readyscript.ru/manual/catalog_csv_import_export.html">документации</a>.'),
                        animation: 'slideInDown'
                        
                    }
                ],
                buttons: {
                    next: 'admin-siteoptions-save'
                }
            },
            
            'admin-catalog-add-dir': {
                url: '%admin%/catalog-ctrl/',
                topic: tourTopics.products,
                tip: {
                    element: [
                        {
                            selector: '.treehead .add',
                            whenUse: isCategoryExpanded
                        },
                        {
                            selector: '.c-head .btn.btn-success',
                            left: true,
                            correctionX:-20
                        }],
                    tipText: lang.t('Перед добавлением товара нужно создать его категорию. Для примера, создадим тестовую категорию "<b>Холодильники</b>". Нажмите на кнопку <i>создать категорию</i> или найдите это действие в выпадающем списке зеленой кнопки вверху-справа.'),
                },
                watch: {
                    element: '.treehead .add, .c-head a:contains("добавить категорию")',
                    event: 'click',
                    next: 'admin-catalog-add-dir-form'
                }
            },
            
            //Шаги, связанные с добавлением категории
            
            'admin-catalog-add-dir-form': {
                url: '%admin%/catalog-ctrl/?pid=0&do=treeAdd',
                topic: tourTopics.products,
                type: 'form',
                tips: [
                    {
                        element: '.crud-form [name="name"]',
                        tipText: lang.t('Укажите название - <b>Холодильники</b>'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="alias"]',
                        tipText: lang.t('Укажите Псевдоним - это имя на английском языке, которое будет использоваться для построения URL-адреса страницы'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.formbox .tab-nav',
                        tipText: lang.t(`Перейдите на вкладку <i>Характеристики</i>. Для примера создадим 1 характеристику (мощность), <br>
                                  которая обязательно будет присутствовать у всех товаров создаваемой категории.`),
                        insertAfter:true,
                        correctionX:100,
                        watch: {
                            element: '.formbox .tab-nav li > a:contains("'+lang.t('Характеристики')+'")',
                            event: 'click'
                        }
                    },
                    {
                        element: '.property-actions .add-property',
                        tipText: lang.t('Нажмите добавить характеристику'),
                        watch: {
                            event: 'click',
                        },
                        onStart: function() {
                            $('.frame[data-name="tab2"]').append('<div style="height:110px" id="tourPlaceholder1"></div>');
                        }
                    },
                    {
                        element: '.property-form .p-title',
                        tipText: lang.t('Укажите название - <b>Мощность</b>'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.property-form .p-type',
                        tipText: lang.t('Укажите тип - <b>Список</b>, чтобы в дальнейшем включить фильтр по данной харктеристике'),
                        checkPattern: /^(list)$/gi
                    },
                    {
                        element: '.property-form .p-unit',
                        tipText: lang.t('Укажите единицу измерения - <b>Вт</b>'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.property-form .p-new-value',
                        tipText: lang.t('Укажите возможное значение мощности - <b>1000</b> и нажмите справа <b>добавить</b>'),
                        watch: {
                            element: '.p-add-new-value',
                            event: 'click'
                        }
                    },
                    {
                        element: '.property-form .p-new-value',
                        tipText: lang.t('Укажите еще одно возможное значение мощности - <b>2000</b> и нажмите справа <b>добавить</b>'),
                        watch: {
                            element: '.p-add-new-value',
                            event: 'click'
                        }
                    },
                    {
                        element: '.property-form .add',
                        tipText: lang.t('<i>Добавьте</i> характеристику к категории'),
                        css: {
                            marginTop:46
                        },
                        watch: {
                            event: 'click',
                        }
                    },
                    {
                        waitNewContent: true,
                        element: '.property-container .property-item .h-public',
                        tipText: lang.t('Установите флажок <i>Отображать в поиске на сайте</i>, чтобы по данной характеристике можно было отфильтровать товары на сайте. Подробности в <a href="http://readyscript.ru/manual/catalog_categories.html#cat_tab_characteristics" target="_blank">документации</a>.'),
                        checkPattern: true,
                        correctionX: -230,
                        css: {
                            width:300
                        }
                    },
                    {
                        element: '.bottom-toolbar .crud-form-save',
                        tipText: lang.t('Нажмите на кнопку <i>Сохранить</i>, чтобы создать категорию'),
                        bottom: true,
                        css: {
                            position: 'fixed'
                        },
                        correctionY: -20,
                        watch: {
                            element: 'body',
                            event: 'crudSaveSuccess',
                            next: 'admin-catalog-add-product'
                        }
                    }
                ]
            },        
            
            'admin-catalog-add-product': {
                url: '%admin%/catalog-ctrl/',
                topic: tourTopics.products,
                tip: {
                    element: '.c-head .btn.btn-success:contains("'+lang.t('добавить товар')+'")',
                    tipText: lang.t('Чтобы добавить товар, нажмите на зеленую кнопку <i>Добавить товар</i>'),
                },
                watch: {
                    element: '.c-head .btn.btn-success:contains("'+lang.t('добавить товар')+'")',
                    event: 'click',
                    next: 'admin-catalog-add-product-form'
                }
            },
            
            'admin-catalog-add-product-form': {
                url: '%admin%/catalog-ctrl/?dir=0&do=add',
                topic: tourTopics.products,
                type: 'form',
                tips: [
                    {
                        element: '.crud-form [name="title"]',
                        tipText: lang.t('Укажите название товара - <b>Холодильник ТОМАС</b>'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="alias"]',
                        tipText: lang.t('Укажите любое URL имя на англ.языке. <br>Будет использовано для создания адреса страницы товара'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '#tinymce-description_parent',
                        tinymceTextarea: '#tinymce-description',
                        tipText: lang.t('Укажите описание товара'),
                        bottom:true,
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="barcode"]',
                        tipText: lang.t('Укажите артикул товара'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name^="excost"]:first',
                        tipText: lang.t('Укажите стоимость товара'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name^="xdir[]"]',
                        tipText: lang.t('Выберите категорию - <b>Холодильники</b>'),
                        checkSelectValue: /^.*$/gi,
                        correctionX:150,
                    },
                    {
                        element: '.formbox .tab-nav',
                        tipText: lang.t('Теперь добавим характеристику товару, для этого перейдите на вкладку <i>Характеристики</i>'),
                        insertAfter:true,
                        correctionX:100,
                        watch: {
                            element: '.formbox .tab-nav li > a:contains('+lang.t('Характеристики')+')',
                            event: 'click',
                        }
                    },
                    {
                        ifTrue: function() {
                            return !$('.item-title:contains("' + lang.t('Мощность') + '")').length>0;
                        },
                        elseStep: 'myval_noajax',
                        element: '.property-actions .add-property',
                        tipText: lang.t('Нажмите <i>Добавить характеристику</i>'),
                        watch: {
                            event: 'click',
                        }
                    },
                    {
                        element: '.property-form .p-proplist',
                        tipText: lang.t('Выберите характеристику - <b>Мощность</b>'),
                        checkPattern: /^\d+$/gi
                    },
                    
                    {
                        element: '.property-form .add',
                        tipText: lang.t('<i>Добавьте</i> характеристику к товару'),
                        css: {
                            marginTop:46
                        },
                        watch: {
                            event: 'click',
                        }
                    },
                    {
                        label: 'myval_ajax',
                        waitNewContent: true,
                        ifTrue: function() {
                            //Если есть флажок - "задать персональное значение"
                            return $(lang.t('.property-item:contains("Мощность") .h-useval')).length>0;
                        },
                        element: lang.t('.property-item:contains("Мощность") .h-useval'),
                        tipText: lang.t('Отметьте флажок, чтобы задать индивидуальное значение характеристики для товара'),
                        checkPattern: true,
                        next: 'propval'
                    },
                                    
                    {
                        label: 'myval_noajax',
                        ifTrue: function() {
                            //Если есть флажок - "задать персональное значение"
                            return $('.property-item:contains("Мощность") .h-useval').length>0;
                        },
                        element: '.property-item:contains("Мощность") .h-useval',
                        tipText: lang.t('Отметьте флажок, чтобы задать индивидуальное значение характеристики для товара'),
                        checkPattern: true
                    },
                    {
                        label: 'propval',
                        element: '.property-item:contains("Мощность") .inline-item:contains("1000") input',
                        tipText: lang.t('Укажите, что мощность холодильника - 1000 Вт'),
                        checkPattern: true
                    },
                    {
                        element: '.formbox .tab-nav',
                        tipText: lang.t('На закладке <i>Комплектации</i> можно задать остатки, а также <a href="http://readyscript.ru/manual/catalog_products.html#catalog_products_tab_offers">вариации(комплектации)</a> товара.'),
                        insertAfter:true,
                        correctionX:100,
                        watch: {
                            element: '.formbox .tab-nav li > a:contains('+lang.t("Комплектации")+')',
                            event: 'click',
                        }
                    },
                    {
                        element: '.crud-form [name^="offers[main][stock_num]"]:first',
                        tipText: lang.t('Укажите остаток товара на всех складах - <i>10</i>'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.formbox .tab-nav',
                        tipText: lang.t('Загрузите фотографии на вкладке <i>Фото</i>'),
                        insertAfter:true,
                        correctionX:100,
                        watch: {
                            element: '.formbox .tab-nav li > a:contains(' + lang.t("Фото") + ')',
                            event: 'click',
                        }
                    },
                    {
                        element: '.bottom-toolbar .crud-form-save',
                        tipText: lang.t('При желании вы можете заполнить сведения на оставшихся вкладках товара.<br> Затем нажмите на кнопку <i>Сохранить</i>, чтобы создать товар'),
                        bottom: true,
                        css: {
                            position: 'fixed'
                        },
                        correctionY: -20,
                        watch: {
                            element: 'body',
                            event: 'crudSaveSuccess',
                            next: 'admin-catalog'
                        },
                        
                    }
                ],
            },
            
            'admin-catalog': {
                url: '%admin%/catalog-ctrl/',
                topic: tourTopics.products,
                type: 'info',
                message: lang.t(`Товар и категория добавлены. 
                          В дальнейшем Вы часто будете пользоваться данным разделом, чтобы корректировать описания товаров, цены, количество товаров, и т.д. 
                          Предлагаем ознакомиться с основными элементами управления, присутствующими на данной странице.`),
                tips: [
                    {
                        element: '.rs-table .options',
                        tipText: lang.t('Настройка состава колонок <br>таблицы и сортировки по-умолчанию'),
                        animation: 'slideInDown'
                    },
                    {
                        element: '.rs-table thead th:eq(4)',
                        tipText: lang.t('При нажатии на заголовок колонки <br>можно изменять сортировку данных в таблице'),
                        correctionY:70,
                        correctionX:40,
                        animation: 'slideInDown'
                    },
                    {
                        element: '.right-column .bottom-toolbar .crud-multiedit',
                        tipText: lang.t('В нижней панели представлены действия (редактировать, удалить), <br>которые можно применить ко всем <br>отмеченным элементам (товарам или категориям).'),
                        position: ['right', 'top'],
                        animation: 'bounceInDown',
                        css: {
                            position:'fixed'
                        }
                    },
                    {
                        element: '.treehead .showchilds-on, .showchilds-off',
                        tipText: lang.t('Включить/выключить показ товаров из вложенных категорий'),
                        whenUse:isCategoryExpanded,
                        position:['right', 'top'],
                        correctionY:-20,
                        animation: 'rotateIn'
                    },                
                    {
                        element: '.rs-table .chk',
                        tipText: lang.t('Можно отметить товары как на одной,<br> так и на всех страницах'),
                        position:['right', 'bottom'],
                        animation: 'slideInLeft'
                    },
                    {
                        element: '.treebody > li:eq(1) .move',
                        tipText: lang.t('Сортируйте категории с помощью перетаскивания'),
                        whenUse:isCategoryExpanded,
                        position:['right', 'bottom'],
                        animation: 'slideInDown'
                    }
                ],
                onStart: function() {
                    var act = function() {
                        $('.rs-table .chk').addClass('chk-over');
                        $('.treebody > li:eq(3)').addClass('over');
                        $('.treebody > li:eq(1)').addClass('drag');
                        $('.rs-table tbody tr:eq(7)').addClass('over');
                    }
                    
                    $('body').on('new-content.tour', act);
                    act();
                },
                onStop: function() {
                    $('.rs-table .chk').removeClass('chk-over');
                    $('.treebody > li:eq(3)').removeClass('over');
                    $('.treebody > li:eq(1)').removeClass('drag');
                    $('.rs-table tbody tr:eq(7)').removeClass('over');
                }
            },
            
            'to-menu-ctrl': {
                url: '%admin%/catalog-ctrl/',
                topic: tourTopics.products,
                tip: {
                    element: 'a[data-url$="/menu-ctrl/"]',
                    tipText: lang.t('Перейдите в раздел <i>Веб-сайт &rarr; Меню</i>'),
                    correctionX: 40,
                    css: {
                        zIndex:50
                    }
                },
                onStart: function() {
                    $('.side-menu ul a[href$="/menu-ctrl/"]').addClass('menuTipHover');
                },
                onStop: function() {
                    $('.side-menu ul a[href$="/menu-ctrl/"]').removeClass('menuTipHover');
                }
            },
            
            'menu-ctrl': {
                url: '%admin%/menu-ctrl/',
                topic: tourTopics.menu,
                type: 'info',
                message: lang.t(`В данном разделе можно создавать иерархию страниц сайта разных типов, которые могут быть доступны пользователям через меню. Каждой странице будет присвоен определенный URL адрес, по которому она будет доступна из браузера. 
                         <p>Например, если вы желаете: <ul>
                         <li>создать страницу с какой-либо текстовой информацией, то необходимо создать пункт меню с типом "<b>Статья</b>".</li>
                         <li>создать страницу, на которой должны быть представлены функциональные блоки с каким-либо более сложным поведением (например, форма обратной связи), то необходимо создать пункт меню с типом "<b>Страница</b>". 
                         Далее эту страницу можно будет настроить в разделе Веб-сайт &rarr; Конструктор сайта.</li>
                         <li>создать простую ссылку в меню, то используйте тип "<b>Ссылка</b>" для такого пункта меню.</li>
                         </ul><p>Ознакомьтесь с основными функциональными кнопками на данной странице. 
                         На следующем шаге, мы создадим для примера пункт меню с информацией о рекламной акции в интернет-магазине.`, null, 'tourMenuCtrlInfo'),
                tips: [
                    {
                        element: '.c-head .btn:contains("' + lang.t('добавить пункт меню') + '")',
                        tipText: lang.t('Создать новый пункт меню'),
                        animation: 'bounceInDown'
                    },
                    {
                        element: '.c-head .btn:contains("' + lang.t('Импорт/Экспорт') + '")',
                        tipText: lang.t('Через эти инструменты можно массово <br>загрузить пункты меню в систему через CSV файлы.'),
                        animation: 'slideInDown',
                        correctionY:60
                    },
                    {
                        element: '.activetree  .allplus',
                        tipText: lang.t('Развернуть отображение дерева пунктов меню'),
                        position:['right', 'bottom'],
                        animation: 'slideInLeft'
                        
                    },
                    {
                        element: '.activetree  .allminus',
                        tipText: lang.t('Свернуть отображение дерева пунктов меню'),
                        position:['right', 'middle'],
                        correctionX:40,
                        animation: 'slideInDown'
                    }
                ]
            },
            
            'menu-ctrl-add': {
                url: '%admin%/menu-ctrl/',
                topic: tourTopics.menu,
                tip: {
                    element: '.c-head .btn:contains("' + lang.t("добавить пункт меню") + '")',
                    tipText: lang.t(`Добавим на сайте раздел <b>Акция</b>, в котором будет представлена текстовая информация. 
                              Нажмите на кнопку <i>Добавить пункт меню</i>`)
                },
                watch: {
                    element: '.c-head .btn:contains("' + lang.t("добавить пункт меню") + '")',
                    event: 'click',
                    next: 'menu-ctrl-add-form'
                }
            },
            
            'menu-ctrl-add-form': {
                url: '%admin%/menu-ctrl/?do=add',
                topic: tourTopics.menu,
                type: 'form',
                tips: [
                    {
                        element: '.crud-form [name="title"]',
                        tipText: lang.t('Укажите название пункта меню - <b>Акция</b>'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="alias"]',
                        tipText: lang.t('Укажите любое название пункта меню на Англ. языке. <br>Оно будет использоваться для построения URL адреса раздела.'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form #tinymce-content_ifr',
                        tinymceTextarea: '#tinymce-content',
                        tipText: lang.t('Укажите информацию об акции'),
                        bottom:true,
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.mce-ico.mce-i-image',
                        tipText: lang.t('Используйте кнопку с лупой, чтобы добавить изображения к тексту'),
                        correctionY:10,
                        correctionX:-50,
                        checkTimeout: 5000
                    },
                    {
                        element: '.bottom-toolbar .crud-form-save',
                        tipText: lang.t(`После ввода всей необходимой текстовой информации, нажмите 
                                 <br>на кнопку <i>Сохранить</i>, чтобы создать раздел на сайте, который отобразится в меню`),
                        bottom: true,
                        css: {
                            position: 'fixed'
                        },
                        correctionY: -20,
                        watch: {
                            element: 'body',
                            event: 'crudSaveSuccess',
                            next: 'to-article-ctrl'
                        },
                        
                    }
                ]
            },
            
            'to-article-ctrl': {
                url: '%admin%/menu-ctrl/',
                topic: tourTopics.article,
                tip: {
                    element: '.side-menu a:contains("'+lang.t('Веб-сайт')+'")',
                    tipText: lang.t('Перейдите в раздел <i>Веб-сайт &rarr; Контент</i>'),
                    correctionX: 50,
                    css: {
                        zIndex: 50
                    }
                },
                onStart: function() {
                    $('.side-menu ul a[href$="/article-ctrl/"]').addClass('menuTipHover');
                },
                onStop: function() {
                    $('.side-menu ul a[href$="/article-ctrl/"]').removeClass('menuTipHover');
                }
            },
            
            'article-ctrl': {
                url: '%admin%/article-ctrl/',
                topic: tourTopics.article,
                type: 'info',
                message: lang.t(`На этой странице происходит управление списками текстовых материалов, например новостями.
                         <p>Для добавления новости на сайте, достаточно создать статью в соответствующей категории.
                         <p>Также в этом разделе административной панели могут размещаться статьи, используемые темой оформления на различных страницах.`),
                tips: [
                    {
                        element: '.treehead .add',
                        tipText: lang.t('Создать категорию статей'),
                        position:['right', 'top'],
                        whenUse: isCategoryExpanded,
                        animation: 'slideInDown'
                    },
                    {
                        element: '.c-head .btn:contains("' + lang.t('добавить статью') + '")',
                        tipText: lang.t('Создать статью'),
                        animation: 'slideInDown'
                    },
                    {
                        element: '.treebody > li:eq(0)',
                        tipText: lang.t('Категория статей'),
                        whenUse: isCategoryExpanded,
                        position:['right', 'middle'],
                        animation: 'slideInLeft',
                        correctionX:40
                    }
                ]
            }
    }

    welcomeTour.commonEnd = {
            'to-index': {
                url: global.scriptType != 'Shop.Base' ? '%admin%/shop-paymentctrl/' : '%admin%/article-ctrl/',
                topic: tourTopics.payment,
                tip: {
                    element: '.header-panel .to-site',
                    tipText: lang.t('Основные настройки в административной панели произведены. Желаете добавлять товары, категории, новости, и т.д., не заходя в панель администрирования? Нажмите на кнопку <i>Перейти на сайт</i>, чтобы узнать как.')
                },
                watch: {
                    element: '.header-panel .to-site',
                    event: 'click',
                    next: 'debug-index'
                }
            },
            
            'debug-index': {
                url: '/',
                topic: tourTopics.debug,
                tip: {
                    element: '.debug-mode-switcher .rs-switch',
                    tipText: lang.t('Включите режим отладки, чтобы редактировать элементы прямо на странице'),
                    correctionY:40
                },
                whileTrue: function() {
                    return $('.debug-mode-switcher .rs-switch:not(.on)').length;
                }            
            },
            
            'debug-text': {
                url: '/',
                topic: tourTopics.debug,
                tip: {
                    element: '.module-wrapper:has([data-debug-contextmenu]):first',
                    tipText: lang.t('Любой товар, категорию, пункт меню, и т.д. на данной странице можно отредактировать, удалить или создать, кликнув над ним правой кнопкой мыши и выбрав необходимое действие.'),
                    correctionY:10,
                    css: {
                        zIndex:3
                    },
                    notFound: 'finish'
                },
                watch: {
                    element: '',
                    event: 'showContextMenu',
                    next: 'debug-block-text'
                },
                checkTimeout: 15000
            },
            
            'debug-block-text': {
                url: '/',
                topic: tourTopics.debug,
                tip: {
                    element: '.module-wrapper:eq(0) .debug-icon-blockoptions',
                    tipText: lang.t('Любой блок можно настроить, нажав на иконку с изображением гаечного ключа.'),
                    correctionY:10,
                    notFound: 'finish',
                    css: {
                        zIndex:3
                    }
                },
                onStart: function() {
                    $('.module-wrapper:eq(0)').addClass('over');
                },                
                onStop:  function() {
                    $('.module-wrapper:eq(0)').removeClass('over');
                },      
                watch: {
                    element: '.debug-icon-blockoptions',
                    event: 'click',
                    next: 'finish'
                },
                checkTimeout: 15000
            },
            
            'finish': {
                url: '/',
                topic: tourTopics.debug,
                type:'dialog',
                message: lang.t('<span class="finishText">Интерактивный курс по базовым настройкам<br> интернет-магазина успешно завершен.</span> <br>Более подробную информацию по возможностям платформы ReadyScript можно найти в <a href="http://readyscript.ru/manual/" target="_blank"><u>документации</u></a>.'),
                buttons: {
                    finish: {
                        text: lang.t('Закрыть окно'),
                        step: false                        
                    },
                    docs: {
                        text: lang.t('Документация'),
                        attr: {
                            href: 'http://readyscript.ru/manual/',
                            target: '_blank'
                        },
                        step:false
                    }
                }
            }
    }

    welcomeTour.shop = {
        'to-shop-deliveryctrl': {
                url: '%admin%/article-ctrl/',
                topic: tourTopics.article,            
                tip: {
                    element: '.side-menu > li > a[data-url$="/shop-orderctrl/"]',
                    tipText: lang.t('Теперь перейдем к настройке параметров, связанных с заказами. Перейдите в раздел <i>Магазин &rarr; Доставка &rarr; Способы доставки</i>'),
                    position:['right', 'top'],
                    bottom:true,
                    css: {
                        zIndex:50
                    }
                },
                onStart: function() {
                    $('.side-menu a[href$="/shop-regionctrl/"]:first').addClass('menuTipHover');
                    $('.side-menu a[href$="/shop-deliveryctrl/"]').addClass('menuTipHover');
                },
                onStop: function() {
                    $('.side-menu a[href$="/shop-regionctrl/"]:first').removeClass('menuTipHover');
                    $('.side-menu a[href$="/shop-deliveryctrl/"]').removeClass('menuTipHover');
                }
            },
            
            'shop-deliveryctrl': {
                url: '%admin%/shop-deliveryctrl/',
                topic: tourTopics.delivery,
                type:'info',
                message: lang.t(`В этом разделе необходимо произвести настройку способов доставок, которые будут
                         предложены пользователю во время оформления заказа. 
                         <p>До настройки данного раздела, необходимо иметь представление о том, как вы будете доставлять товары вашим покупателям и по каким ценам.
                         <p>Ознакомьтесь с основными инструментами представленными на данной странице.
                         <p>На следующем шаге, создадим для примера, "доставку по городу", которая будет стоить 500 руб.`, null, 'tourShopDeliveryCtrlInfo'),
                tips: [
                    {
                        element: '.c-head .btn.btn-success',
                        tipText: lang.t('Добавить способ доставки'),
                        position:['center', 'top'],
                        animation: 'slideInLeft'
                    },
                    {
                        element: '.c-head .btn:contains("' + lang.t('Импорт/Экспорт') + '")',
                        tipText: lang.t('Через эти инструменты можно массово загрузить способы доставок через CSV файлы.'),
                        animation: 'slideInDown',
                        correctionY:60
                    },
                    {
                        element: '.rs-table .sortdot',
                        tipText: lang.t('Сортировать способы доставок можно с помощью перетаскивания'),
                        position: ['right', 'top'],
                        animation: 'slideInLeft'
                    }
                ]
            },
            
            'shop-deliveryctrl-add': {
                url: '%admin%/shop-deliveryctrl/',
                topic: tourTopics.delivery,
                tip: {
                    element: '.c-head .btn.btn-success',
                    tipText: lang.t('Добавим, для примера, способ доставки <b>по городу</b>. Нажмите на кнопку <i>Добавить способ доставки</i>')
                },
                watch: {
                    element: '.c-head .btn.btn-success',
                    event: 'click',
                    next: 'shop-deliveryctrl-add-form'
                }            
            },
            
            'shop-deliveryctrl-add-form': {
                url: '%admin%/shop-deliveryctrl/?do=add',
                topic: tourTopics.delivery,
                type: 'form',
                tips: [
                    {
                        element: '.crud-form [name="title"]',
                        tipText: lang.t('Укажите название доставки - <b>по городу</b>. Будет отображено во время оформления заказа в списке возможных способов доставки.'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="description"]',
                        tipText: lang.t('Укажите условия или подробности доставки, которые будут отображаться под названием'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="xzone[]"]',
                        tipText: lang.t('Выберите географические зоны или пункт <b>- все -</b>, <br>чтобы определить регионы пользователей, для которых <br>будет отображен данный способ доставки'),
                        checkPattern: /^(0)$/gi
                    },
                    {
                        element: '.crud-form [name="user_type"]',
                        tipText: lang.t('Выберите категорию пользователей, <br>для которых будет доступна доставка.'),
                        watch: {
                            event: 'click'
                        }
                    },
                    {
                        element: '.crud-form [name="class"]',
                        tipText: lang.t(`Расчетный класс отвечает за то, какой модуль <br>будет расчитывать стоимость и обрабатывать доставку. 
                                  Выберите <b>Фиксированная цена</b>. Подробнее о других расчетных классах можно узнать <a href="http://readyscript.ru/manual/shop_delivery.html#shop_delivery_add" target="_blank">в документации</a>`),
                        watch: {
                            event: 'click'
                        }
                    },
                    {
                        element: '.crud-form [name="data[cost]"]',
                        tipText: lang.t('Укажите стоимость доставки по городу'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.bottom-toolbar .crud-form-save',
                        tipText: lang.t(`После ввода всех необходимых параметров доставки, нажмите 
                                 <br>на кнопку <i>Сохранить</i>`),
                        bottom: true,
                        css: {
                            position: 'fixed'
                        },
                        correctionY: -20,
                        watch: {
                            element: 'body',
                            event: 'crudSaveSuccess',
                            next: 'to-shop-paymentctrl'
                        },
                        
                    }
                ]
            },
            
            'to-shop-paymentctrl': {
                url: '%admin%/shop-deliveryctrl/',
                topic: tourTopics.delivery,
                tip: {
                    element: '.side-menu > li > a[data-url$="/shop-orderctrl/"]',
                    tipText: lang.t('Перейдите в раздел <i>Магазин &rarr; Способы оплаты</i>'),
                    bottom:true,
                    css: {
                        zIndex:50
                    }
                },
                onStart: function() {
                    $('.side-menu a[href$="/shop-paymentctrl/"]').addClass('menuTipHover');
                },
                onStop: function() {
                    $('.side-menu a[href$="/shop-paymentctrl/"]').removeClass('menuTipHover');
                }
            },
            
            'shop-paymentctrl': {
                url: '%admin%/shop-paymentctrl/',
                topic: tourTopics.payment,
                type: 'info',
                message: lang.t(`Перед началом продаж следует настроить способы оплат, которые будут предложены пользователю во время оформления заказа.
                          <p>Если Вы желаете добавить возможность оплачивать заказы с помощью электроных денег или карт Visa, Mastercard, и т.д., то
                            Вам необходимо предварительно создать аккаунт магазина на одном из сервисов-агрегаторов платежей - Yandex.Касса, Robokassa, PayPal, ...
                          <p>На следующем шаге, добавим для примера, способ оплаты "Безналичный расчет". Это будет означать, что покупатель сможет получить счет сразу после оформления заказа.`, null, 'tourShopPaymentCtrlInfo'),
                tips: [
                    {
                        element: '.c-head .btn.btn-success',
                        tipText: lang.t('Добавить способ оплаты'),
                        position:['center', 'top'],
                        animation: 'slideInDown'
                    },
                    {
                        element: '.rs-table .sortdot',
                        tipText: lang.t('Сортировать способы оплаты можно с помощью перетаскивания'),
                        position: ['right', 'top'],
                        animation: 'slideInLeft'
                    }
                ]
            },
            
            'shop-paymentctrl-add': {
                url: '%admin%/shop-paymentctrl/',
                topic: tourTopics.payment,
                tip: {
                    element: '.c-head .btn.btn-success',
                    tipText: lang.t('Добавим, для примера, способ оплаты <b>Безналичный расчет</b>. Нажмите на кнопку <i>Добавить способ оплаты</i>')
                },
                watch: {
                    element: '.c-head .btn.btn-success',
                    event: 'click',
                    next: 'shop-paymentctrl-add-form'
                }  
            },
            
            'shop-paymentctrl-add-form': {
                url: '%admin%/shop-paymentctrl/?do=add',
                topic: tourTopics.payment,
                type:'form',
                tips: [
                    {
                        element: '.crud-form [name="title"]',
                        tipText: lang.t('Укажите название способа оплаты - <b>Безналичный расчет</b>. Будет отображено во время оформления заказа в списке возможных способов оплаты.'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="description"]',
                        tipText: lang.t('Укажите условия или подробности оплаты. Будут отображены под названием'),
                        checkPattern: /^(.+)$/gi
                    },
                    {
                        element: '.crud-form [name="first_status"]',
                        tipText: lang.t('Счет будет доступен пользователю только если заказ находится в статусе <i>Ожидает оплату</i>, поэтому выберите стартовый статус <b>Ожидает оплату</b>'),
                        checkSelectValue: /^(Ожидает оплату)$/gi
                    },
                    {
                        element: '.crud-form [name="class"]',
                        tipText: lang.t('Расчетный класс отвечает за то, какой модуль будет обрабатывать платежи <br>или предоставлять документы на оплату пользователю. Выберите <b>Безналичный расчет</b>'),
                        checkPattern: /^(bill)$/gi
                    },
                    {
                        waitNewContent: true,
                        element: '.crud-form [name="data[use_site_company]"]',
                        tipText: lang.t('Установите флажок, чтобы использовать реквизиты, которые были заполнены раннее в разделе <i>Веб-сайт &rarr; Настройка сайта</i>.'),
                        checkPattern: true
                    },
                    {
                        element: '.bottom-toolbar .crud-form-save',
                        tipText: lang.t('После ввода всех необходимых параметров оплаты, нажмите <br>на кнопку <i>Сохранить</i>'),
                        bottom: true,
                        css: {
                            position: 'fixed'
                        },
                        correctionY: -20,
                        watch: {
                            element: 'body',
                            event: 'crudSaveSuccess',
                            next: 'to-index'
                        },
                    }
                    
                ]
            }
     };

    var tours = 
    {
        'welcome': $.extend({}, 
                            welcomeTour.commonStart, 
                            global.scriptType != 'Shop.Base' ? welcomeTour.shop : {},
                            welcomeTour.commonEnd)
    };
    
    $.tour(tours, {
        baseUrl: global.folder+'/',
        folder: global.folder,
        adminSection: global.adminSection
    });
    
});
/**
 * Plugin, активирующий отображение новостей в боковой панели
 */
$.widget("rs.newsShow", {
    options: {
        elementTitle: '.side-news__title',
        elementItem: '.side-news__item',
        elementAllViewed: '.all-viewed',
        elementNewClass: 'new',
        elementDisabledClass: 'disabled',
        elementViewCircle: '.view-circle'
    },
    _create: function() {
        var _this = this;
        this.element.on('click', function() {
            _this.open();
        });
    },

    /**
     * Открывает SideBar со списком новостей
     */
    open: function() {
        if ($.rs.loading.inProgress) return;

        var _this = this;
        this.panel = $('<div>').sidePanel({
            position: 'right',
            ajaxQuery: {
                url: this.element.data('urls').newsList
            },
            onLoad: function(e, data) {
                $(data.element)
                    .on('click', _this.options.elementItem, function(e) {
                        return _this._markAsViewed(e);
                    });
            },
            onShow: function(e, data) {
                $(data.panel)
                    .on('click', _this.options.elementAllViewed, function(e) {
                            return _this._markAllAsViewed(e, data.panel);
                    });
            }
        });
    },

    /**
     * Сообщает серверу о прочтении новости
     *
     * @private
     */
    _markAsViewed: function(e) {
        var item = $(e.target).closest(this.options.elementItem);
        if (item.hasClass(this.options.elementNewClass)) {
            $.ajaxQuery({
                url: this.element.data('urls').markAsViewed,
                data: {
                    id: $(e.target).closest(this.options.elementItem).data('id')
                },
                success: function (response) {
                    if (response.success) {
                        $.rsMeters('update', response.meters);
                    }
                }
            });
            this._setItemViewed( item );
        }
    },

    /**
     * Помечает все новости как просмотренные
     *
     * @param e
     * @private
     */
    _markAllAsViewed: function(e, panel) {
        if (!$(e.target).hasClass(this.options.elementDisabledClass)) {
            $.ajaxQuery({
                url: this.element.data('urls').markAllAsViewed,
                success: function (response) {
                    if (response.success) {
                        $.rsMeters('update', response.meters);
                    }
                }
            });

            this._setItemViewed( $(this.options.elementItem, panel) );
            $(this.options.elementAllViewed, panel).addClass(this.options.elementDisabledClass);
        }
    },

    _setItemViewed: function(item) {
        item.removeClass(this.options.elementNewClass)
            .find(this.options.elementViewCircle)
            .attr('data-original-title', lang.t('Прочитано'));
    }

});

$(function() {
    $('.rs-news-show').newsShow();
});
(function($){

    var elems = $([]),
        defaults = {
            timeToTriggered            : 100,
            charsCountToTriggered      : 8,
        };

    $.event.special.barcodescanned = {
        setup: function(data){
            $(this)
                .data( 'barcodescanned', {
                    chars: [],
                    settings: $.extend({}, defaults, data)
                })
                .bind( 'keypress', keypress_handler );
        },
        teardown: function(){
            $(this)
                .removeData( 'barcodescanned' )
                .unbind( 'keypress', keypress_handler );
        }
    };

    function keypress_handler( event ) {

        var elem = $(event.target),
            data = $('body').data( 'barcodescanned' );
        var time_to_triggered               = data.settings.timeToTriggered,
            chars_count_to_triggered        = data.settings.charsCountToTriggered,
            key_code                        = (event.which) ? event.which : event.keyCode;

        if (elem.is('input') || elem.is('textarea')) {
            return;
        }
        if ((key_code >= 65 && key_code <= 90) ||
            (key_code >= 97 && key_code <= 122) ||
            (key_code >= 48 && key_code <= 57) || key_code == 13
        ) {
            data.chars.push(String.fromCharCode(key_code));
        }

        setTimeout(function() {
            if (data.chars.length >= chars_count_to_triggered) {
                    let sku_val = data.chars.join('');
                    $('body').triggerHandler( 'barcodescanned', sku = sku_val);
            }
            data.chars = [];

        }, time_to_triggered);
    }

})(jQuery);

$(function () {
    $('body').on('barcodescanned', function(event, sku) {
        var input = $('.ui-dialog:last input[data-sku]:first');
        if (!input.length) {
            input = $('[data-sku]:first');
        }

        if (input.length) {
            input.val(sku);
            if (input.hasClass('submit')) {
                input.closest('form').submit();
            } else {
                input.trigger($.Event('keypress', {which: 13}));
            }
        }
    });
});
/*
 * jQuery UI dialogOptions v1.0
 * @desc extending jQuery Ui Dialog - Responsive, click outside, class handling
 * @author Jason Day
 *
 * Dependencies:
 *		jQuery: http://jquery.com/
 *		jQuery UI: http://jqueryui.com/
 *		Modernizr: http://modernizr.com/
 *
 * MIT license:
 *              http://www.opensource.org/licenses/mit-license.php
 *
 * (c) Jason Day 2014
 *
 * New Options:
 *  clickOut: true          // closes dialog when clicked outside
 *  responsive: true        // fluid width & height based on viewport
 *                          // true: always responsive
 *                          // false: never responsive
 *                          // "touch": only responsive on touch device
 *  scaleH: 0.8             // responsive scale height percentage, 0.8 = 80% of viewport
 *  scaleW: 0.8             // responsive scale width percentage, 0.8 = 80% of viewport
 *  showTitleBar: true      // false: hide titlebar
 *  showCloseButton: true   // false: hide close button
 *
 * Added functionality:
 *  add & remove dialogClass to .ui-widget-overlay for scoping styles
 *	patch for: http://bugs.jqueryui.com/ticket/4671
 *	recenter dialog - ajax loaded content
 *
 */

// add new options with default values
$.ui.dialog.prototype.options.clickOut = false;
$.ui.dialog.prototype.options.responsive = true;
$.ui.dialog.prototype.options.scaleH = 0.95;
$.ui.dialog.prototype.options.scaleW = 0.95;
$.ui.dialog.prototype.options.showTitleBar = true;
$.ui.dialog.prototype.options.showCloseButton = true;
$.ui.dialog.prototype.options.beforeDestroy = function() {};
$.ui.dialog.prototype.options.afterDestroy = function() {};


// extend _init
var _init = $.ui.dialog.prototype._init;
$.ui.dialog.prototype._init = function () {
    var self = this;

    // apply original arguments
    _init.apply(this, arguments);

    //patch
    if ($.ui && $.ui.dialog && $.ui.dialog.overlay) {
        $.ui.dialog.overlay.events = $.map('focus,keydown,keypress'.split(','), function (event) {
           return event + '.dialog-overlay';
       }).join(' ');
    }
};
// end _init


// extend open function
var _open = $.ui.dialog.prototype.open;
$.ui.dialog.prototype.open = function () {
    var self = this;


    if ($.rs) {
        $.rs.lockBody();
    }

    //Если ширина задана в процентах
    self.optionWidth = self.element.dialog('option', 'width') + "";
    self.oParentWidth = self.element.parent().outerWidth();
    self.isPercentWidth = self.optionWidth.indexOf('%') > -1;
    // get dialog original size on open
    let optionHeight = self.element.dialog('option', 'height');
    if (typeof optionHeight != 'string' || optionHeight.indexOf('%') == -1) {
        optionHeight = parseInt(optionHeight);
    } else {
        optionHeight = Math.round(document.documentElement.clientHeight * parseInt(optionHeight) / 100);
    }
    self.oHeight = Math.max(optionHeight, self.element.parent().outerHeight());
    self.isTouch = $("html").hasClass("touch");

    // responsive width & height
    var resize = function () {
        // check if responsive
        // dependent on modernizr for device detection / html.touch
        if (self.options.responsive === true || (self.options.responsive === "touch" && self.isTouch)) {

            //Перерасчитываем максимально возможную ширину экрана
            if (self.isPercentWidth ) {
                var calculatedWidth = parseInt(self.optionWidth)/100 * $(window).width();
            } else {
                var calculatedWidth = self.optionWidth;
            }
            self.oWidth = Math.max(parseInt( calculatedWidth ), self.oParentWidth);

            var elem = self.element,
                wHeight = $(window).height(),
                wWidth = $(window).width(),
                dHeight = elem.parent().outerHeight(),
                dWidth = elem.parent().outerWidth(),
                setHeight = Math.min(wHeight * self.options.scaleH, self.oHeight),
                setWidth = Math.min(wWidth * self.options.scaleW, self.oWidth);

            // check & set height
            if ((self.oHeight + 100) > wHeight || elem.hasClass("resizedH")) {
                elem.dialog("option", "height", setHeight).parent().css("max-height", setHeight);
                elem.addClass("resizedH");
            }

            // check & set width
            if ((self.oWidth + 100) > wWidth || elem.hasClass("resizedW")) {
                elem.dialog("option", "width", setWidth).parent().css("max-width", setWidth);
                elem.addClass("resizedW");
            }

            // only recenter & add overflow if dialog has been resized
            if (elem.hasClass("resizedH") || elem.hasClass("resizedW")) {
                elem.dialog("option", "position", {my: "center", at: "center", of: window});
                elem.css("overflow", "auto");
            }
        }

        // add webkit scrolling to all dialogs for touch devices
        if (self.isTouch) {
            elem.css("-webkit-overflow-scrolling", "touch");
        }
    };

    // call resize()
    resize();

    // resize on window resize
    $(window).on("resize", resize);

    self.element.on('dialogclose', function() {
        $(window).off("resize", resize);
    });

    // resize on orientation change
     if (window.addEventListener) {  // Add extra condition because IE8 doesn't support addEventListener (or orientationchange)
        window.addEventListener("orientationchange", function () {
            resize();
        });
    }

    // hide titlebar
    if (!self.options.showTitleBar) {
        self.uiDialogTitlebar.css({
            "height": 0,
            "padding": 0,
            "background": "none",
            "border": 0
        });
        self.uiDialogTitlebar.find(".ui-dialog-title").css("display", "none");
    }

    //hide close button
    if (!self.options.showCloseButton) {
        self.uiDialogTitlebar.find(".ui-dialog-titlebar-close").css("display", "none");
    }

    // close on clickOut
    if (self.options.clickOut && !self.options.modal) {
        // use transparent div - simplest approach (rework)
        $('<div id="dialog-overlay"></div>').insertBefore(self.element.parent());
        $('#dialog-overlay').css({
            "position": "fixed",
            "top": 0,
            "right": 0,
            "bottom": 0,
            "left": 0,
            "background-color": "transparent"
        });
        $('#dialog-overlay').click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            self.close();
        });
        // else close on modal click
    } else if (self.options.clickOut && self.options.modal) {
        $('.ui-widget-overlay').click(function (e) {
            self.close();
        });
    }

    // add dialogClass to overlay
    if (self.options.dialogClass) {
        $('.ui-widget-overlay').addClass(self.options.dialogClass);
    }

    // apply original arguments
    _open.apply(this, arguments);
};
//end open


// extend close function
var _close = $.ui.dialog.prototype.close;
$.ui.dialog.prototype.close = function () {
    var self = this;

    // apply original arguments
    _close.apply(this, arguments);

    if ($.rs && $('.ui-widget-overlay').length == 0) {
        $.rs.unlockBody();
    }

    // remove dialogClass to overlay
    if (self.options.dialogClass) {
        $('.ui-widget-overlay').removeClass(self.options.dialogClass);
    }
    //remove clickOut overlay
    if ($("#dialog-overlay").length) {
        $("#dialog-overlay").remove();
    }
};
//end close

var _destroy = $.ui.dialog.prototype._destroy;
$.ui.dialog.prototype._destroy = function () {
    var element = this.element;
    this.options.beforeDestroy.apply(element);
    _destroy.apply(this, arguments);
    this.options.afterDestroy.apply(element);
};

var _setOption = $.ui.dialog.prototype._setOption;
$.ui.dialog.prototype._setOption = function (key, value) {
    if (key == 'originalWidth') {
        if (value.toString().indexOf('%') == -1) {
            this.oWidth = parseInt(value);
        } else {
            this.oWidth = Math.round(document.documentElement.clientWidth * parseInt(value) / 100);
        }
    }
    if (key == 'originalHeight') {
        if (value.toString().indexOf('%') == -1) {
            this.oHeight = parseInt(value);
        } else {
            this.oHeight = Math.round(document.documentElement.clientHeight * parseInt(value) / 100);
        }
    }
    _setOption.apply(this, arguments);
};

//Fix для TinyMCE
var _allowInteraction = $.ui.dialog.prototype._allowInteraction;
$.ui.dialog.prototype._allowInteraction = function( event ) {
    if ($(event.target).closest(".mce-window").length) {
        event.stopPropagation();
        return true;
    } else {
        return _allowInteraction.apply(this, arguments);
    }
};

//Разрешаем использовать html в title диалоговых окон
$.ui.dialog.prototype._title = function(title) {
    if (!this.options.title ) {
        title.html("&#160;");
    } else {
        title.html(this.options.title);
    }
};
/*!
 * Bootstrap v3.3.5 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under the MIT license
 */
if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){"use strict";var b=a.fn.jquery.split(" ")[0].split(".");if(b[0]<2&&b[1]<9||1==b[0]&&9==b[1]&&b[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){return a(b.target).is(this)?b.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var c=a(this),e=c.data("bs.alert");e||c.data("bs.alert",e=new d(this)),"string"==typeof b&&e[b].call(c)})}var c='[data-dismiss="alert"]',d=function(b){a(b).on("click",c,this.close)};d.VERSION="3.3.5",d.TRANSITION_DURATION=150,d.prototype.close=function(b){function c(){g.detach().trigger("closed.bs.alert").remove()}var e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,""));var g=a(f);b&&b.preventDefault(),g.length||(g=e.closest(".alert")),g.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(g.removeClass("in"),a.support.transition&&g.hasClass("fade")?g.one("bsTransitionEnd",c).emulateTransitionEnd(d.TRANSITION_DURATION):c())};var e=a.fn.alert;a.fn.alert=b,a.fn.alert.Constructor=d,a.fn.alert.noConflict=function(){return a.fn.alert=e,this},a(document).on("click.bs.alert.data-api",c,d.prototype.close)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof b&&b;e||d.data("bs.button",e=new c(this,f)),"toggle"==b?e.toggle():b&&e.setState(b)})}var c=function(b,d){this.$element=a(b),this.options=a.extend({},c.DEFAULTS,d),this.isLoading=!1};c.VERSION="3.3.5",c.DEFAULTS={loadingText:"loading..."},c.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",null==f.resetText&&d.data("resetText",d[e]()),setTimeout(a.proxy(function(){d[e](null==f[b]?this.options[b]:f[b]),"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},c.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")?(c.prop("checked")&&(a=!1),b.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==c.prop("type")&&(c.prop("checked")!==this.$element.hasClass("active")&&(a=!1),this.$element.toggleClass("active")),c.prop("checked",this.$element.hasClass("active")),a&&c.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var d=a.fn.button;a.fn.button=b,a.fn.button.Constructor=c,a.fn.button.noConflict=function(){return a.fn.button=d,this},a(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(c){var d=a(c.target);d.hasClass("btn")||(d=d.closest(".btn")),b.call(d,"toggle"),a(c.target).is('input[type="radio"]')||a(c.target).is('input[type="checkbox"]')||c.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(b){a(b.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(b.type))})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},c.DEFAULTS,d.data(),"object"==typeof b&&b),g="string"==typeof b?b:f.slide;e||d.data("bs.carousel",e=new c(this,f)),"number"==typeof b?e.to(b):g?e[g]():f.interval&&e.pause().cycle()})}var c=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",a.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",a.proxy(this.pause,this)).on("mouseleave.bs.carousel",a.proxy(this.cycle,this))};c.VERSION="3.3.5",c.TRANSITION_DURATION=600,c.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},c.prototype.keydown=function(a){if(!/input|textarea/i.test(a.target.tagName)){switch(a.which){case 37:this.prev();break;case 39:this.next();break;default:return}a.preventDefault()}},c.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},c.prototype.getItemIndex=function(a){return this.$items=a.parent().children(".item"),this.$items.index(a||this.$active)},c.prototype.getItemForDirection=function(a,b){var c=this.getItemIndex(b),d="prev"==a&&0===c||"next"==a&&c==this.$items.length-1;if(d&&!this.options.wrap)return b;var e="prev"==a?-1:1,f=(c+e)%this.$items.length;return this.$items.eq(f)},c.prototype.to=function(a){var b=this,c=this.getItemIndex(this.$active=this.$element.find(".item.active"));return a>this.$items.length-1||0>a?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){b.to(a)}):c==a?this.pause().cycle():this.slide(a>c?"next":"prev",this.$items.eq(a))},c.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},c.prototype.next=function(){return this.sliding?void 0:this.slide("next")},c.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},c.prototype.slide=function(b,d){var e=this.$element.find(".item.active"),f=d||this.getItemForDirection(b,e),g=this.interval,h="next"==b?"left":"right",i=this;if(f.hasClass("active"))return this.sliding=!1;var j=f[0],k=a.Event("slide.bs.carousel",{relatedTarget:j,direction:h});if(this.$element.trigger(k),!k.isDefaultPrevented()){if(this.sliding=!0,g&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var l=a(this.$indicators.children()[this.getItemIndex(f)]);l&&l.addClass("active")}var m=a.Event("slid.bs.carousel",{relatedTarget:j,direction:h});return a.support.transition&&this.$element.hasClass("slide")?(f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),e.one("bsTransitionEnd",function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger(m)},0)}).emulateTransitionEnd(c.TRANSITION_DURATION)):(e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger(m)),g&&this.cycle(),this}};var d=a.fn.carousel;a.fn.carousel=b,a.fn.carousel.Constructor=c,a.fn.carousel.noConflict=function(){return a.fn.carousel=d,this};var e=function(c){var d,e=a(this),f=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""));if(f.hasClass("carousel")){var g=a.extend({},f.data(),e.data()),h=e.attr("data-slide-to");h&&(g.interval=!1),b.call(f,g),h&&f.data("bs.carousel").to(h),c.preventDefault()}};a(document).on("click.bs.carousel.data-api","[data-slide]",e).on("click.bs.carousel.data-api","[data-slide-to]",e),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var c=a(this);b.call(c,c.data())})})}(jQuery),+function(a){"use strict";function b(b){var c,d=b.attr("data-target")||(c=b.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"");return a(d)}function c(b){return this.each(function(){var c=a(this),e=c.data("bs.collapse"),f=a.extend({},d.DEFAULTS,c.data(),"object"==typeof b&&b);!e&&f.toggle&&/show|hide/.test(b)&&(f.toggle=!1),e||c.data("bs.collapse",e=new d(this,f)),"string"==typeof b&&e[b]()})}var d=function(b,c){this.$element=a(b),this.options=a.extend({},d.DEFAULTS,c),this.$trigger=a('[data-toggle="collapse"][href="#'+b.id+'"],[data-toggle="collapse"][data-target="#'+b.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};d.VERSION="3.3.5",d.TRANSITION_DURATION=350,d.DEFAULTS={toggle:!0},d.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},d.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b,e=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(e&&e.length&&(b=e.data("bs.collapse"),b&&b.transitioning))){var f=a.Event("show.bs.collapse");if(this.$element.trigger(f),!f.isDefaultPrevented()){e&&e.length&&(c.call(e,"hide"),b||e.data("bs.collapse",null));var g=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[g](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var h=function(){this.$element.removeClass("collapsing").addClass("collapse in")[g](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return h.call(this);var i=a.camelCase(["scroll",g].join("-"));this.$element.one("bsTransitionEnd",a.proxy(h,this)).emulateTransitionEnd(d.TRANSITION_DURATION)[g](this.$element[0][i])}}}},d.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var e=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return a.support.transition?void this.$element[c](0).one("bsTransitionEnd",a.proxy(e,this)).emulateTransitionEnd(d.TRANSITION_DURATION):e.call(this)}}},d.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},d.prototype.getParent=function(){return a(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(a.proxy(function(c,d){var e=a(d);this.addAriaAndCollapsedClass(b(e),e)},this)).end()},d.prototype.addAriaAndCollapsedClass=function(a,b){var c=a.hasClass("in");a.attr("aria-expanded",c),b.toggleClass("collapsed",!c).attr("aria-expanded",c)};var e=a.fn.collapse;a.fn.collapse=c,a.fn.collapse.Constructor=d,a.fn.collapse.noConflict=function(){return a.fn.collapse=e,this},a(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(d){var e=a(this);e.attr("data-target")||d.preventDefault();var f=b(e),g=f.data("bs.collapse"),h=g?"toggle":e.data();c.call(f,h)})}(jQuery),+function(a){"use strict";function b(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}function c(c){c&&3===c.which||(a(e).remove(),a(f).each(function(){var d=a(this),e=b(d),f={relatedTarget:this};e.hasClass("open")&&(c&&"click"==c.type&&/input|textarea/i.test(c.target.tagName)&&a.contains(e[0],c.target)||(e.trigger(c=a.Event("hide.bs.dropdown",f)),c.isDefaultPrevented()||(d.attr("aria-expanded","false"),e.removeClass("open").trigger("hidden.bs.dropdown",f))))}))}function d(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new g(this)),"string"==typeof b&&d[b].call(c)})}var e=".dropdown-backdrop",f='[data-toggle="dropdown"]',g=function(b){a(b).on("click.bs.dropdown",this.toggle)};g.VERSION="3.3.5",g.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=b(e),g=f.hasClass("open");if(c(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(a(this)).on("click",c);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;e.trigger("focus").attr("aria-expanded","true"),f.toggleClass("open").trigger("shown.bs.dropdown",h)}return!1}},g.prototype.keydown=function(c){if(/(38|40|27|32)/.test(c.which)&&!/input|textarea/i.test(c.target.tagName)){var d=a(this);if(c.preventDefault(),c.stopPropagation(),!d.is(".disabled, :disabled")){var e=b(d),g=e.hasClass("open");if(!g&&27!=c.which||g&&27==c.which)return 27==c.which&&e.find(f).trigger("focus"),d.trigger("click");var h=" li:not(.disabled):visible a",i=e.find(".dropdown-menu"+h);if(i.length){var j=i.index(c.target);38==c.which&&j>0&&j--,40==c.which&&j<i.length-1&&j++,~j||(j=0),i.eq(j).trigger("focus")}}}};var h=a.fn.dropdown;a.fn.dropdown=d,a.fn.dropdown.Constructor=g,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=h,this},a(document).on("click.bs.dropdown.data-api",c).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",f,g.prototype.toggle).on("keydown.bs.dropdown.data-api",f,g.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",g.prototype.keydown)}(jQuery),+function(a){"use strict";function b(b,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},c.DEFAULTS,e.data(),"object"==typeof b&&b);f||e.data("bs.modal",f=new c(this,g)),"string"==typeof b?f[b](d):g.show&&f.show(d)})}var c=function(b,c){this.options=c,this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};c.VERSION="3.3.5",c.TRANSITION_DURATION=300,c.BACKDROP_TRANSITION_DURATION=150,c.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},c.prototype.toggle=function(a){return this.isShown?this.hide():this.show(a)},c.prototype.show=function(b){var d=this,e=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){d.$element.one("mouseup.dismiss.bs.modal",function(b){a(b.target).is(d.$element)&&(d.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=a.support.transition&&d.$element.hasClass("fade");d.$element.parent().length||d.$element.appendTo(d.$body),d.$element.show().scrollTop(0),d.adjustDialog(),e&&d.$element[0].offsetWidth,d.$element.addClass("in"),d.enforceFocus();var f=a.Event("shown.bs.modal",{relatedTarget:b});e?d.$dialog.one("bsTransitionEnd",function(){d.$element.trigger("focus").trigger(f)}).emulateTransitionEnd(c.TRANSITION_DURATION):d.$element.trigger("focus").trigger(f)}))},c.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",a.proxy(this.hideModal,this)).emulateTransitionEnd(c.TRANSITION_DURATION):this.hideModal())},c.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.trigger("focus")},this))},c.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},c.prototype.resize=function(){this.isShown?a(window).on("resize.bs.modal",a.proxy(this.handleUpdate,this)):a(window).off("resize.bs.modal")},c.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.$body.removeClass("modal-open"),a.resetAdjustments(),a.resetScrollbar(),a.$element.trigger("hidden.bs.modal")})},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.backdrop=function(b){var d=this,e=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var f=a.support.transition&&e;if(this.$backdrop=a(document.createElement("div")).addClass("modal-backdrop "+e).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),f&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;f?this.$backdrop.one("bsTransitionEnd",b).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):b()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var g=function(){d.removeBackdrop(),b&&b()};a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",g).emulateTransitionEnd(c.BACKDROP_TRANSITION_DURATION):g()}else b&&b()},c.prototype.handleUpdate=function(){this.adjustDialog()},c.prototype.adjustDialog=function(){var a=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&a?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!a?this.scrollbarWidth:""})},c.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},c.prototype.checkScrollbar=function(){var a=window.innerWidth;if(!a){var b=document.documentElement.getBoundingClientRect();a=b.right-Math.abs(b.left)}this.bodyIsOverflowing=document.body.clientWidth<a,this.scrollbarWidth=this.measureScrollbar()},c.prototype.setScrollbar=function(){var a=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",a+this.scrollbarWidth)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="modal-scrollbar-measure",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b};var d=a.fn.modal;a.fn.modal=b,a.fn.modal.Constructor=c,a.fn.modal.noConflict=function(){return a.fn.modal=d,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(e)&&e},f.data(),d.data());d.is("a")&&c.preventDefault(),f.one("show.bs.modal",function(a){a.isDefaultPrevented()||f.one("hidden.bs.modal",function(){d.is(":visible")&&d.trigger("focus")})}),b.call(f,g,this)})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.tooltip",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",a,b)};c.VERSION="3.3.5",c.TRANSITION_DURATION=150,c.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},c.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},c.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},c.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},c.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},c.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),c.isInStateTrue()?void 0:(clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide())},c.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var d=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!d)return;var e=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top"),f.detach().css({top:0,left:0,display:"block"}).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var k=this.getPosition(),l=f[0].offsetWidth,m=f[0].offsetHeight;if(j){var n=h,o=this.getPosition(this.$viewport);h="bottom"==h&&k.bottom+m>o.bottom?"top":"top"==h&&k.top-m<o.top?"bottom":"right"==h&&k.right+l>o.width?"left":"left"==h&&k.left-l<o.left?"right":h,f.removeClass(n).addClass(h)}var p=this.getCalculatedOffset(h,k,l,m);this.applyPlacement(p,h);var q=function(){var a=e.hoverState;e.$element.trigger("shown.bs."+e.type),e.hoverState=null,"out"==a&&e.leave(e)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",q).emulateTransitionEnd(c.TRANSITION_DURATION):q()}},c.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},c.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},c.prototype.hide=function(b){function d(){"in"!=e.hoverState&&f.detach(),e.$element.removeAttr("aria-describedby").trigger("hidden.bs."+e.type),b&&b()}var e=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);return this.$element.trigger(g),g.isDefaultPrevented()?void 0:(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",d).emulateTransitionEnd(c.TRANSITION_DURATION):d(),this.hoverState=null,this)},c.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},c.prototype.hasContent=function(){return this.getTitle()},c.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=d?{top:0,left:0}:b.offset(),g={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},h=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,g,h,f)},c.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},c.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?e.top=g.top-h:i>g.top+g.height&&(e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?e.left=g.left-j:k>g.right&&(e.left=g.left+g.width-k)}return e},c.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},c.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},c.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},c.prototype.enable=function(){this.enabled=!0},c.prototype.disable=function(){this.enabled=!1},c.prototype.toggleEnabled=function(){this.enabled=!this.enabled},c.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},c.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null})};var d=a.fn.tooltip;a.fn.tooltip=b,a.fn.tooltip.Constructor=c,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=d,this}}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof b&&b;(e||!/destroy|hide/.test(b))&&(e||d.data("bs.popover",e=new c(this,f)),"string"==typeof b&&e[b]())})}var c=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");c.VERSION="3.3.5",c.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),c.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),c.prototype.constructor=c,c.prototype.getDefaults=function(){return c.DEFAULTS},c.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},c.prototype.hasContent=function(){return this.getTitle()||this.getContent()},c.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},c.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var d=a.fn.popover;a.fn.popover=b,a.fn.popover.Constructor=c,a.fn.popover.noConflict=function(){return a.fn.popover=d,this}}(jQuery),+function(a){"use strict";function b(c,d){this.$body=a(document.body),this.$scrollElement=a(a(c).is(document.body)?window:c),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",a.proxy(this.process,this)),this.refresh(),this.process()}function c(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})}b.VERSION="3.3.5",b.DEFAULTS={offset:10},b.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},b.prototype.refresh=function(){var b=this,c="offset",d=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),a.isWindow(this.$scrollElement[0])||(c="position",d=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var b=a(this),e=b.data("target")||b.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[c]().top+d,e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){b.offsets.push(this[0]),b.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.getScrollHeight(),d=this.options.offset+c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(this.scrollHeight!=c&&this.refresh(),b>=d)return g!=(a=f[f.length-1])&&this.activate(a);if(g&&b<e[0])return this.activeTarget=null,this.clear();for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(void 0===e[a+1]||b<e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,this.clear();var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),
d.trigger("activate.bs.scrollspy")},b.prototype.clear=function(){a(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var d=a.fn.scrollspy;a.fn.scrollspy=c,a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=d,this},a(window).on("load.bs.scrollspy.data-api",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);c.call(b,b.data())})})}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new c(this)),"string"==typeof b&&e[b]()})}var c=function(b){this.element=a(b)};c.VERSION="3.3.5",c.TRANSITION_DURATION=150,c.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a"),f=a.Event("hide.bs.tab",{relatedTarget:b[0]}),g=a.Event("show.bs.tab",{relatedTarget:e[0]});if(e.trigger(f),b.trigger(g),!g.isDefaultPrevented()&&!f.isDefaultPrevented()){var h=a(d);this.activate(b.closest("li"),c),this.activate(h,h.parent(),function(){e.trigger({type:"hidden.bs.tab",relatedTarget:b[0]}),b.trigger({type:"shown.bs.tab",relatedTarget:e[0]})})}}},c.prototype.activate=function(b,d,e){function f(){g.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),b.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),h?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu").length&&b.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),e&&e()}var g=d.find("> .active"),h=e&&a.support.transition&&(g.length&&g.hasClass("fade")||!!d.find("> .fade").length);g.length&&h?g.one("bsTransitionEnd",f).emulateTransitionEnd(c.TRANSITION_DURATION):f(),g.removeClass("in")};var d=a.fn.tab;a.fn.tab=b,a.fn.tab.Constructor=c,a.fn.tab.noConflict=function(){return a.fn.tab=d,this};var e=function(c){c.preventDefault(),b.call(a(this),"show")};a(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',e).on("click.bs.tab.data-api",'[data-toggle="pill"]',e)}(jQuery),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof b&&b;e||d.data("bs.affix",e=new c(this,f)),"string"==typeof b&&e[b]()})}var c=function(b,d){this.options=a.extend({},c.DEFAULTS,d),this.$target=a(this.options.target).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(b),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};c.VERSION="3.3.5",c.RESET="affix affix-top affix-bottom",c.DEFAULTS={offset:0,target:window},c.prototype.getState=function(a,b,c,d){var e=this.$target.scrollTop(),f=this.$element.offset(),g=this.$target.height();if(null!=c&&"top"==this.affixed)return c>e?"top":!1;if("bottom"==this.affixed)return null!=c?e+this.unpin<=f.top?!1:"bottom":a-d>=e+g?!1:"bottom";var h=null==this.affixed,i=h?e:f.top,j=h?g:b;return null!=c&&c>=e?"top":null!=d&&i+j>=a-d?"bottom":!1},c.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(c.RESET).addClass("affix");var a=this.$target.scrollTop(),b=this.$element.offset();return this.pinnedOffset=b.top-a},c.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},c.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b=this.$element.height(),d=this.options.offset,e=d.top,f=d.bottom,g=Math.max(a(document).height(),a(document.body).height());"object"!=typeof d&&(f=e=d),"function"==typeof e&&(e=d.top(this.$element)),"function"==typeof f&&(f=d.bottom(this.$element));var h=this.getState(g,b,e,f);if(this.affixed!=h){null!=this.unpin&&this.$element.css("top","");var i="affix"+(h?"-"+h:""),j=a.Event(i+".bs.affix");if(this.$element.trigger(j),j.isDefaultPrevented())return;this.affixed=h,this.unpin="bottom"==h?this.getPinnedOffset():null,this.$element.removeClass(c.RESET).addClass(i).trigger(i.replace("affix","affixed")+".bs.affix")}"bottom"==h&&this.$element.offset({top:g-b-f})}};var d=a.fn.affix;a.fn.affix=b,a.fn.affix.Constructor=c,a.fn.affix.noConflict=function(){return a.fn.affix=d,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var c=a(this),d=c.data();d.offset=d.offset||{},null!=d.offsetBottom&&(d.offset.bottom=d.offsetBottom),null!=d.offsetTop&&(d.offset.top=d.offsetTop),b.call(c,d)})})}(jQuery);
/* == jquery mousewheel plugin == Version: 3.1.12, License: MIT License (MIT) */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
/* == malihu jquery custom scrollbar plugin == Version: 3.0.9, License: MIT License (MIT) */
!function(e){"undefined"!=typeof module&&module.exports?module.exports=e:e(jQuery,window,document)}(function(e){!function(t){var o="function"==typeof define&&define.amd,a="undefined"!=typeof module&&module.exports,n="https:"==document.location.protocol?"https:":"http:",i="cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.1.12/jquery.mousewheel.min.js";o||(a?require("jquery-mousewheel")(e):e.event.special.mousewheel||e("head").append(decodeURI("%3Cscript src="+n+"//"+i+"%3E%3C/script%3E"))),t()}(function(){var t,o="mCustomScrollbar",a="mCS",n=".mCustomScrollbar",i={setTop:0,setLeft:0,axis:"y",scrollbarPosition:"inside",scrollInertia:950,autoDraggerLength:!0,alwaysShowScrollbar:0,snapOffset:0,mouseWheel:{enable:!0,scrollAmount:"auto",axis:"y",deltaFactor:"auto",disableOver:["select","option","keygen","datalist","textarea"]},scrollButtons:{scrollType:"stepless",scrollAmount:"auto"},keyboard:{enable:!0,scrollType:"stepless",scrollAmount:"auto"},contentTouchScroll:25,advanced:{autoScrollOnFocus:"input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",updateOnContentResize:!0,updateOnImageLoad:!0,autoUpdateTimeout:60},theme:"light",callbacks:{onTotalScrollOffset:0,onTotalScrollBackOffset:0,alwaysTriggerOffsets:!0}},r=0,l={},s=window.attachEvent&&!window.addEventListener?1:0,c=!1,d=["mCSB_dragger_onDrag","mCSB_scrollTools_onDrag","mCS_img_loaded","mCS_disabled","mCS_destroyed","mCS_no_scrollbar","mCS-autoHide","mCS-dir-rtl","mCS_no_scrollbar_y","mCS_no_scrollbar_x","mCS_y_hidden","mCS_x_hidden","mCSB_draggerContainer","mCSB_buttonUp","mCSB_buttonDown","mCSB_buttonLeft","mCSB_buttonRight"],u={init:function(t){var t=e.extend(!0,{},i,t),o=f.call(this);if(t.live){var s=t.liveSelector||this.selector||n,c=e(s);if("off"===t.live)return void m(s);l[s]=setTimeout(function(){c.mCustomScrollbar(t),"once"===t.live&&c.length&&m(s)},500)}else m(s);return t.setWidth=t.set_width?t.set_width:t.setWidth,t.setHeight=t.set_height?t.set_height:t.setHeight,t.axis=t.horizontalScroll?"x":p(t.axis),t.scrollInertia=t.scrollInertia>0&&t.scrollInertia<17?17:t.scrollInertia,"object"!=typeof t.mouseWheel&&1==t.mouseWheel&&(t.mouseWheel={enable:!0,scrollAmount:"auto",axis:"y",preventDefault:!1,deltaFactor:"auto",normalizeDelta:!1,invert:!1}),t.mouseWheel.scrollAmount=t.mouseWheelPixels?t.mouseWheelPixels:t.mouseWheel.scrollAmount,t.mouseWheel.normalizeDelta=t.advanced.normalizeMouseWheelDelta?t.advanced.normalizeMouseWheelDelta:t.mouseWheel.normalizeDelta,t.scrollButtons.scrollType=g(t.scrollButtons.scrollType),h(t),e(o).each(function(){var o=e(this);if(!o.data(a)){o.data(a,{idx:++r,opt:t,scrollRatio:{y:null,x:null},overflowed:null,contentReset:{y:null,x:null},bindEvents:!1,tweenRunning:!1,sequential:{},langDir:o.css("direction"),cbOffsets:null,trigger:null});var n=o.data(a),i=n.opt,l=o.data("mcs-axis"),s=o.data("mcs-scrollbar-position"),c=o.data("mcs-theme");l&&(i.axis=l),s&&(i.scrollbarPosition=s),c&&(i.theme=c,h(i)),v.call(this),e("#mCSB_"+n.idx+"_container img:not(."+d[2]+")").addClass(d[2]),u.update.call(null,o)}})},update:function(t,o){var n=t||f.call(this);return e(n).each(function(){var t=e(this);if(t.data(a)){var n=t.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container"),l=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];if(!r.length)return;n.tweenRunning&&V(t),t.hasClass(d[3])&&t.removeClass(d[3]),t.hasClass(d[4])&&t.removeClass(d[4]),S.call(this),_.call(this),"y"===i.axis||i.advanced.autoExpandHorizontalScroll||r.css("width",x(r.children())),n.overflowed=B.call(this),O.call(this),i.autoDraggerLength&&b.call(this),C.call(this),k.call(this);var s=[Math.abs(r[0].offsetTop),Math.abs(r[0].offsetLeft)];"x"!==i.axis&&(n.overflowed[0]?l[0].height()>l[0].parent().height()?T.call(this):(Q(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}),n.contentReset.y=null):(T.call(this),"y"===i.axis?M.call(this):"yx"===i.axis&&n.overflowed[1]&&Q(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}))),"y"!==i.axis&&(n.overflowed[1]?l[1].width()>l[1].parent().width()?T.call(this):(Q(t,s[1].toString(),{dir:"x",dur:0,overwrite:"none"}),n.contentReset.x=null):(T.call(this),"x"===i.axis?M.call(this):"yx"===i.axis&&n.overflowed[0]&&Q(t,s[0].toString(),{dir:"y",dur:0,overwrite:"none"}))),o&&n&&(2===o&&i.callbacks.onImageLoad&&"function"==typeof i.callbacks.onImageLoad?i.callbacks.onImageLoad.call(this):3===o&&i.callbacks.onSelectorChange&&"function"==typeof i.callbacks.onSelectorChange?i.callbacks.onSelectorChange.call(this):i.callbacks.onUpdate&&"function"==typeof i.callbacks.onUpdate&&i.callbacks.onUpdate.call(this)),X.call(this)}})},scrollTo:function(t,o){if("undefined"!=typeof t&&null!=t){var n=f.call(this);return e(n).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l={trigger:"external",scrollInertia:r.scrollInertia,scrollEasing:"mcsEaseInOut",moveDragger:!1,timeout:60,callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},s=e.extend(!0,{},l,o),c=Y.call(this,t),d=s.scrollInertia>0&&s.scrollInertia<17?17:s.scrollInertia;c[0]=j.call(this,c[0],"y"),c[1]=j.call(this,c[1],"x"),s.moveDragger&&(c[0]*=i.scrollRatio.y,c[1]*=i.scrollRatio.x),s.dur=d,setTimeout(function(){null!==c[0]&&"undefined"!=typeof c[0]&&"x"!==r.axis&&i.overflowed[0]&&(s.dir="y",s.overwrite="all",Q(n,c[0].toString(),s)),null!==c[1]&&"undefined"!=typeof c[1]&&"y"!==r.axis&&i.overflowed[1]&&(s.dir="x",s.overwrite="none",Q(n,c[1].toString(),s))},s.timeout)}})}},stop:function(){var t=f.call(this);return e(t).each(function(){var t=e(this);t.data(a)&&V(t)})},disable:function(t){var o=f.call(this);return e(o).each(function(){var o=e(this);if(o.data(a)){{o.data(a)}X.call(this,"remove"),M.call(this),t&&T.call(this),O.call(this,!0),o.addClass(d[3])}})},destroy:function(){var t=f.call(this);return e(t).each(function(){var n=e(this);if(n.data(a)){var i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx),s=e("#mCSB_"+i.idx+"_container"),c=e(".mCSB_"+i.idx+"_scrollbar");r.live&&m(r.liveSelector||e(t).selector),X.call(this,"remove"),M.call(this),T.call(this),n.removeData(a),Z(this,"mcs"),c.remove(),s.find("img."+d[2]).removeClass(d[2]),l.replaceWith(s.contents()),n.removeClass(o+" _"+a+"_"+i.idx+" "+d[6]+" "+d[7]+" "+d[5]+" "+d[3]).addClass(d[4])}})}},f=function(){return"object"!=typeof e(this)||e(this).length<1?n:this},h=function(t){var o=["rounded","rounded-dark","rounded-dots","rounded-dots-dark"],a=["rounded-dots","rounded-dots-dark","3d","3d-dark","3d-thick","3d-thick-dark","inset","inset-dark","inset-2","inset-2-dark","inset-3","inset-3-dark"],n=["minimal","minimal-dark"],i=["minimal","minimal-dark"],r=["minimal","minimal-dark"];t.autoDraggerLength=e.inArray(t.theme,o)>-1?!1:t.autoDraggerLength,t.autoExpandScrollbar=e.inArray(t.theme,a)>-1?!1:t.autoExpandScrollbar,t.scrollButtons.enable=e.inArray(t.theme,n)>-1?!1:t.scrollButtons.enable,t.autoHideScrollbar=e.inArray(t.theme,i)>-1?!0:t.autoHideScrollbar,t.scrollbarPosition=e.inArray(t.theme,r)>-1?"outside":t.scrollbarPosition},m=function(e){l[e]&&(clearTimeout(l[e]),Z(l,e))},p=function(e){return"yx"===e||"xy"===e||"auto"===e?"yx":"x"===e||"horizontal"===e?"x":"y"},g=function(e){return"stepped"===e||"pixels"===e||"step"===e||"click"===e?"stepped":"stepless"},v=function(){var t=e(this),n=t.data(a),i=n.opt,r=i.autoExpandScrollbar?" "+d[1]+"_expand":"",l=["<div id='mCSB_"+n.idx+"_scrollbar_vertical' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_vertical"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>","<div id='mCSB_"+n.idx+"_scrollbar_horizontal' class='mCSB_scrollTools mCSB_"+n.idx+"_scrollbar mCS-"+i.theme+" mCSB_scrollTools_horizontal"+r+"'><div class='"+d[12]+"'><div id='mCSB_"+n.idx+"_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>"],s="yx"===i.axis?"mCSB_vertical_horizontal":"x"===i.axis?"mCSB_horizontal":"mCSB_vertical",c="yx"===i.axis?l[0]+l[1]:"x"===i.axis?l[1]:l[0],u="yx"===i.axis?"<div id='mCSB_"+n.idx+"_container_wrapper' class='mCSB_container_wrapper' />":"",f=i.autoHideScrollbar?" "+d[6]:"",h="x"!==i.axis&&"rtl"===n.langDir?" "+d[7]:"";i.setWidth&&t.css("width",i.setWidth),i.setHeight&&t.css("height",i.setHeight),i.setLeft="y"!==i.axis&&"rtl"===n.langDir?"989999px":i.setLeft,t.addClass(o+" _"+a+"_"+n.idx+f+h).wrapInner("<div id='mCSB_"+n.idx+"' class='mCustomScrollBox mCS-"+i.theme+" "+s+"'><div id='mCSB_"+n.idx+"_container' class='mCSB_container' style='position:relative; top:"+i.setTop+"; left:"+i.setLeft+";' dir="+n.langDir+" /></div>");var m=e("#mCSB_"+n.idx),p=e("#mCSB_"+n.idx+"_container");"y"===i.axis||i.advanced.autoExpandHorizontalScroll||p.css("width",x(p.children())),"outside"===i.scrollbarPosition?("static"===t.css("position")&&t.css("position","relative"),t.css("overflow","visible"),m.addClass("mCSB_outside").after(c)):(m.addClass("mCSB_inside").append(c),p.wrap(u)),w.call(this);var g=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")];g[0].css("min-height",g[0].height()),g[1].css("min-width",g[1].width())},x=function(t){return Math.max.apply(Math,t.map(function(){return e(this).outerWidth(!0)}).get())},_=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx+"_container");n.advanced.autoExpandHorizontalScroll&&"y"!==n.axis&&i.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:Math.ceil(i[0].getBoundingClientRect().right+.4)-Math.floor(i[0].getBoundingClientRect().left),position:"relative"}).unwrap()},w=function(){var t=e(this),o=t.data(a),n=o.opt,i=e(".mCSB_"+o.idx+"_scrollbar:first"),r=te(n.scrollButtons.tabindex)?"tabindex='"+n.scrollButtons.tabindex+"'":"",l=["<a href='#' class='"+d[13]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[14]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[15]+"' oncontextmenu='return false;' "+r+" />","<a href='#' class='"+d[16]+"' oncontextmenu='return false;' "+r+" />"],s=["x"===n.axis?l[2]:l[0],"x"===n.axis?l[3]:l[1],l[2],l[3]];n.scrollButtons.enable&&i.prepend(s[0]).append(s[1]).next(".mCSB_scrollTools").prepend(s[2]).append(s[3])},S=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=t.css("max-height")||"none",r=-1!==i.indexOf("%"),l=t.css("box-sizing");if("none"!==i){var s=r?t.parent().height()*parseInt(i)/100:parseInt(i);"border-box"===l&&(s-=t.innerHeight()-t.height()+(t.outerHeight()-t.innerHeight())),n.css("max-height",Math.round(s))}},b=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[n.height()/i.outerHeight(!1),n.width()/i.outerWidth(!1)],c=[parseInt(r[0].css("min-height")),Math.round(l[0]*r[0].parent().height()),parseInt(r[1].css("min-width")),Math.round(l[1]*r[1].parent().width())],d=s&&c[1]<c[0]?c[0]:c[1],u=s&&c[3]<c[2]?c[2]:c[3];r[0].css({height:d,"max-height":r[0].parent().height()-10}).find(".mCSB_dragger_bar").css({"line-height":c[0]+"px"}),r[1].css({width:u,"max-width":r[1].parent().width()-10})},C=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")],l=[i.outerHeight(!1)-n.height(),i.outerWidth(!1)-n.width()],s=[l[0]/(r[0].parent().height()-r[0].height()),l[1]/(r[1].parent().width()-r[1].width())];o.scrollRatio={y:s[0],x:s[1]}},y=function(e,t,o){var a=o?d[0]+"_expanded":"",n=e.closest(".mCSB_scrollTools");"active"===t?(e.toggleClass(d[0]+" "+a),n.toggleClass(d[1]),e[0]._draggable=e[0]._draggable?0:1):e[0]._draggable||("hide"===t?(e.removeClass(d[0]),n.removeClass(d[1])):(e.addClass(d[0]),n.addClass(d[1])))},B=function(){var t=e(this),o=t.data(a),n=e("#mCSB_"+o.idx),i=e("#mCSB_"+o.idx+"_container"),r=null==o.overflowed?i.height():i.outerHeight(!1),l=null==o.overflowed?i.width():i.outerWidth(!1);return[r>n.height(),l>n.width()]},T=function(){var t=e(this),o=t.data(a),n=o.opt,i=e("#mCSB_"+o.idx),r=e("#mCSB_"+o.idx+"_container"),l=[e("#mCSB_"+o.idx+"_dragger_vertical"),e("#mCSB_"+o.idx+"_dragger_horizontal")];if(V(t),("x"!==n.axis&&!o.overflowed[0]||"y"===n.axis&&o.overflowed[0])&&(l[0].add(r).css("top",0),Q(t,"_resetY")),"y"!==n.axis&&!o.overflowed[1]||"x"===n.axis&&o.overflowed[1]){var s=dx=0;"rtl"===o.langDir&&(s=i.width()-r.outerWidth(!1),dx=Math.abs(s/o.scrollRatio.x)),r.css("left",s),l[1].css("left",dx),Q(t,"_resetX")}},k=function(){function t(){r=setTimeout(function(){e.event.special.mousewheel?(clearTimeout(r),W.call(o[0])):t()},100)}var o=e(this),n=o.data(a),i=n.opt;if(!n.bindEvents){if(R.call(this),i.contentTouchScroll&&D.call(this),E.call(this),i.mouseWheel.enable){var r;t()}P.call(this),H.call(this),i.advanced.autoScrollOnFocus&&z.call(this),i.scrollButtons.enable&&U.call(this),i.keyboard.enable&&F.call(this),n.bindEvents=!0}},M=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=".mCSB_"+o.idx+"_scrollbar",l=e("#mCSB_"+o.idx+",#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,"+r+" ."+d[12]+",#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal,"+r+">a"),s=e("#mCSB_"+o.idx+"_container");n.advanced.releaseDraggableSelectors&&l.add(e(n.advanced.releaseDraggableSelectors)),o.bindEvents&&(e(document).unbind("."+i),l.each(function(){e(this).unbind("."+i)}),clearTimeout(t[0]._focusTimeout),Z(t[0],"_focusTimeout"),clearTimeout(o.sequential.step),Z(o.sequential,"step"),clearTimeout(s[0].onCompleteTimeout),Z(s[0],"onCompleteTimeout"),o.bindEvents=!1)},O=function(t){var o=e(this),n=o.data(a),i=n.opt,r=e("#mCSB_"+n.idx+"_container_wrapper"),l=r.length?r:e("#mCSB_"+n.idx+"_container"),s=[e("#mCSB_"+n.idx+"_scrollbar_vertical"),e("#mCSB_"+n.idx+"_scrollbar_horizontal")],c=[s[0].find(".mCSB_dragger"),s[1].find(".mCSB_dragger")];"x"!==i.axis&&(n.overflowed[0]&&!t?(s[0].add(c[0]).add(s[0].children("a")).css("display","block"),l.removeClass(d[8]+" "+d[10])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[0].css("display","none"),l.removeClass(d[10])):(s[0].css("display","none"),l.addClass(d[10])),l.addClass(d[8]))),"y"!==i.axis&&(n.overflowed[1]&&!t?(s[1].add(c[1]).add(s[1].children("a")).css("display","block"),l.removeClass(d[9]+" "+d[11])):(i.alwaysShowScrollbar?(2!==i.alwaysShowScrollbar&&c[1].css("display","none"),l.removeClass(d[11])):(s[1].css("display","none"),l.addClass(d[11])),l.addClass(d[9]))),n.overflowed[0]||n.overflowed[1]?o.removeClass(d[5]):o.addClass(d[5])},I=function(e){var t=e.type;switch(t){case"pointerdown":case"MSPointerDown":case"pointermove":case"MSPointerMove":case"pointerup":case"MSPointerUp":return e.target.ownerDocument!==document?[e.originalEvent.screenY,e.originalEvent.screenX,!1]:[e.originalEvent.pageY,e.originalEvent.pageX,!1];case"touchstart":case"touchmove":case"touchend":var o=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],a=e.originalEvent.touches.length||e.originalEvent.changedTouches.length;return e.target.ownerDocument!==document?[o.screenY,o.screenX,a>1]:[o.pageY,o.pageX,a>1];default:return[e.pageY,e.pageX,!1]}},R=function(){function t(e){var t=m.find("iframe");if(t.length){var o=e?"auto":"none";t.css("pointer-events",o)}}function o(e,t,o,a){if(m[0].idleTimer=u.scrollInertia<233?250:0,n.attr("id")===h[1])var i="x",r=(n[0].offsetLeft-t+a)*d.scrollRatio.x;else var i="y",r=(n[0].offsetTop-e+o)*d.scrollRatio.y;Q(l,r.toString(),{dir:i,drag:!0})}var n,i,r,l=e(this),d=l.data(a),u=d.opt,f=a+"_"+d.idx,h=["mCSB_"+d.idx+"_dragger_vertical","mCSB_"+d.idx+"_dragger_horizontal"],m=e("#mCSB_"+d.idx+"_container"),p=e("#"+h[0]+",#"+h[1]),g=u.advanced.releaseDraggableSelectors?p.add(e(u.advanced.releaseDraggableSelectors)):p;p.bind("mousedown."+f+" touchstart."+f+" pointerdown."+f+" MSPointerDown."+f,function(o){if(o.stopImmediatePropagation(),o.preventDefault(),$(o)){c=!0,s&&(document.onselectstart=function(){return!1}),t(!1),V(l),n=e(this);var a=n.offset(),d=I(o)[0]-a.top,f=I(o)[1]-a.left,h=n.height()+a.top,m=n.width()+a.left;h>d&&d>0&&m>f&&f>0&&(i=d,r=f),y(n,"active",u.autoExpandScrollbar)}}).bind("touchmove."+f,function(e){e.stopImmediatePropagation(),e.preventDefault();var t=n.offset(),a=I(e)[0]-t.top,l=I(e)[1]-t.left;o(i,r,a,l)}),e(document).bind("mousemove."+f+" pointermove."+f+" MSPointerMove."+f,function(e){if(n){var t=n.offset(),a=I(e)[0]-t.top,l=I(e)[1]-t.left;if(i===a)return;o(i,r,a,l)}}).add(g).bind("mouseup."+f+" touchend."+f+" pointerup."+f+" MSPointerUp."+f,function(e){n&&(y(n,"active",u.autoExpandScrollbar),n=null),c=!1,s&&(document.onselectstart=null),t(!0)})},D=function(){function o(e){if(!ee(e)||c||I(e)[2])return void(t=0);t=1,S=0,b=0,C.removeClass("mCS_touch_action");var o=M.offset();d=I(e)[0]-o.top,u=I(e)[1]-o.left,A=[I(e)[0],I(e)[1]]}function n(e){if(ee(e)&&!c&&!I(e)[2]&&(e.stopImmediatePropagation(),!b||S)){p=J();var t=k.offset(),o=I(e)[0]-t.top,a=I(e)[1]-t.left,n="mcsLinearOut";if(R.push(o),D.push(a),A[2]=Math.abs(I(e)[0]-A[0]),A[3]=Math.abs(I(e)[1]-A[1]),y.overflowed[0])var i=O[0].parent().height()-O[0].height(),r=d-o>0&&o-d>-(i*y.scrollRatio.y)&&(2*A[3]<A[2]||"yx"===B.axis);if(y.overflowed[1])var l=O[1].parent().width()-O[1].width(),f=u-a>0&&a-u>-(l*y.scrollRatio.x)&&(2*A[2]<A[3]||"yx"===B.axis);r||f?(e.preventDefault(),S=1):(b=1,C.addClass("mCS_touch_action")),_="yx"===B.axis?[d-o,u-a]:"x"===B.axis?[null,u-a]:[d-o,null],M[0].idleTimer=250,y.overflowed[0]&&s(_[0],E,n,"y","all",!0),y.overflowed[1]&&s(_[1],E,n,"x",W,!0)}}function i(e){if(!ee(e)||c||I(e)[2])return void(t=0);t=1,e.stopImmediatePropagation(),V(C),m=J();var o=k.offset();f=I(e)[0]-o.top,h=I(e)[1]-o.left,R=[],D=[]}function r(e){if(ee(e)&&!c&&!I(e)[2]){e.stopImmediatePropagation(),S=0,b=0,g=J();var t=k.offset(),o=I(e)[0]-t.top,a=I(e)[1]-t.left;if(!(g-p>30)){x=1e3/(g-m);var n="mcsEaseOut",i=2.5>x,r=i?[R[R.length-2],D[D.length-2]]:[0,0];v=i?[o-r[0],a-r[1]]:[o-f,a-h];var d=[Math.abs(v[0]),Math.abs(v[1])];x=i?[Math.abs(v[0]/4),Math.abs(v[1]/4)]:[x,x];var u=[Math.abs(M[0].offsetTop)-v[0]*l(d[0]/x[0],x[0]),Math.abs(M[0].offsetLeft)-v[1]*l(d[1]/x[1],x[1])];_="yx"===B.axis?[u[0],u[1]]:"x"===B.axis?[null,u[1]]:[u[0],null],w=[4*d[0]+B.scrollInertia,4*d[1]+B.scrollInertia];var C=parseInt(B.contentTouchScroll)||0;_[0]=d[0]>C?_[0]:0,_[1]=d[1]>C?_[1]:0,y.overflowed[0]&&s(_[0],w[0],n,"y",W,!1),y.overflowed[1]&&s(_[1],w[1],n,"x",W,!1)}}}function l(e,t){var o=[1.5*t,2*t,t/1.5,t/2];return e>90?t>4?o[0]:o[3]:e>60?t>3?o[3]:o[2]:e>30?t>8?o[1]:t>6?o[0]:t>4?t:o[2]:t>8?t:o[3]}function s(e,t,o,a,n,i){e&&Q(C,e.toString(),{dur:t,scrollEasing:o,dir:a,overwrite:n,drag:i})}var d,u,f,h,m,p,g,v,x,_,w,S,b,C=e(this),y=C.data(a),B=y.opt,T=a+"_"+y.idx,k=e("#mCSB_"+y.idx),M=e("#mCSB_"+y.idx+"_container"),O=[e("#mCSB_"+y.idx+"_dragger_vertical"),e("#mCSB_"+y.idx+"_dragger_horizontal")],R=[],D=[],E=0,W="yx"===B.axis?"none":"all",A=[],P=M.find("iframe"),z=["touchstart."+T+" pointerdown."+T+" MSPointerDown."+T,"touchmove."+T+" pointermove."+T+" MSPointerMove."+T,"touchend."+T+" pointerup."+T+" MSPointerUp."+T];M.bind(z[0],function(e){o(e)}).bind(z[1],function(e){n(e)}),k.bind(z[0],function(e){i(e)}).bind(z[2],function(e){r(e)}),P.length&&P.each(function(){e(this).load(function(){L(this)&&e(this.contentDocument||this.contentWindow.document).bind(z[0],function(e){o(e),i(e)}).bind(z[1],function(e){n(e)}).bind(z[2],function(e){r(e)})})})},E=function(){function o(){return window.getSelection?window.getSelection().toString():document.selection&&"Control"!=document.selection.type?document.selection.createRange().text:0}function n(e,t,o){d.type=o&&i?"stepped":"stepless",d.scrollAmount=10,q(r,e,t,"mcsLinearOut",o?60:null)}var i,r=e(this),l=r.data(a),s=l.opt,d=l.sequential,u=a+"_"+l.idx,f=e("#mCSB_"+l.idx+"_container"),h=f.parent();f.bind("mousedown."+u,function(e){t||i||(i=1,c=!0)}).add(document).bind("mousemove."+u,function(e){if(!t&&i&&o()){var a=f.offset(),r=I(e)[0]-a.top+f[0].offsetTop,c=I(e)[1]-a.left+f[0].offsetLeft;r>0&&r<h.height()&&c>0&&c<h.width()?d.step&&n("off",null,"stepped"):("x"!==s.axis&&l.overflowed[0]&&(0>r?n("on",38):r>h.height()&&n("on",40)),"y"!==s.axis&&l.overflowed[1]&&(0>c?n("on",37):c>h.width()&&n("on",39)))}}).bind("mouseup."+u,function(e){t||(i&&(i=0,n("off",null)),c=!1)})},W=function(){function t(t,a){if(V(o),!A(o,t.target)){var r="auto"!==i.mouseWheel.deltaFactor?parseInt(i.mouseWheel.deltaFactor):s&&t.deltaFactor<100?100:t.deltaFactor||100;if("x"===i.axis||"x"===i.mouseWheel.axis)var d="x",u=[Math.round(r*n.scrollRatio.x),parseInt(i.mouseWheel.scrollAmount)],f="auto"!==i.mouseWheel.scrollAmount?u[1]:u[0]>=l.width()?.9*l.width():u[0],h=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetLeft),m=c[1][0].offsetLeft,p=c[1].parent().width()-c[1].width(),g=t.deltaX||t.deltaY||a;else var d="y",u=[Math.round(r*n.scrollRatio.y),parseInt(i.mouseWheel.scrollAmount)],f="auto"!==i.mouseWheel.scrollAmount?u[1]:u[0]>=l.height()?.9*l.height():u[0],h=Math.abs(e("#mCSB_"+n.idx+"_container")[0].offsetTop),m=c[0][0].offsetTop,p=c[0].parent().height()-c[0].height(),g=t.deltaY||a;"y"===d&&!n.overflowed[0]||"x"===d&&!n.overflowed[1]||((i.mouseWheel.invert||t.webkitDirectionInvertedFromDevice)&&(g=-g),i.mouseWheel.normalizeDelta&&(g=0>g?-1:1),(g>0&&0!==m||0>g&&m!==p||i.mouseWheel.preventDefault)&&(t.stopImmediatePropagation(),t.preventDefault()),Q(o,(h-g*f).toString(),{dir:d}))}}if(e(this).data(a)){var o=e(this),n=o.data(a),i=n.opt,r=a+"_"+n.idx,l=e("#mCSB_"+n.idx),c=[e("#mCSB_"+n.idx+"_dragger_vertical"),e("#mCSB_"+n.idx+"_dragger_horizontal")],d=e("#mCSB_"+n.idx+"_container").find("iframe");d.length&&d.each(function(){e(this).load(function(){L(this)&&e(this.contentDocument||this.contentWindow.document).bind("mousewheel."+r,function(e,o){t(e,o)})})}),l.bind("mousewheel."+r,function(e,o){t(e,o)})}},L=function(e){var t=null;try{var o=e.contentDocument||e.contentWindow.document;t=o.body.innerHTML}catch(a){}return null!==t},A=function(t,o){var n=o.nodeName.toLowerCase(),i=t.data(a).opt.mouseWheel.disableOver,r=["select","textarea"];return e.inArray(n,i)>-1&&!(e.inArray(n,r)>-1&&!e(o).is(":focus"))},P=function(){var t=e(this),o=t.data(a),n=a+"_"+o.idx,i=e("#mCSB_"+o.idx+"_container"),r=i.parent(),l=e(".mCSB_"+o.idx+"_scrollbar ."+d[12]);l.bind("touchstart."+n+" pointerdown."+n+" MSPointerDown."+n,function(e){c=!0}).bind("touchend."+n+" pointerup."+n+" MSPointerUp."+n,function(e){c=!1}).bind("click."+n,function(a){if(e(a.target).hasClass(d[12])||e(a.target).hasClass("mCSB_draggerRail")){V(t);var n=e(this),l=n.find(".mCSB_dragger");if(n.parent(".mCSB_scrollTools_horizontal").length>0){if(!o.overflowed[1])return;var s="x",c=a.pageX>l.offset().left?-1:1,u=Math.abs(i[0].offsetLeft)-.9*c*r.width()}else{if(!o.overflowed[0])return;var s="y",c=a.pageY>l.offset().top?-1:1,u=Math.abs(i[0].offsetTop)-.9*c*r.height()}Q(t,u.toString(),{dir:s,scrollEasing:"mcsEaseInOut"})}})},z=function(){var t=e(this),o=t.data(a),n=o.opt,i=a+"_"+o.idx,r=e("#mCSB_"+o.idx+"_container"),l=r.parent();r.bind("focusin."+i,function(o){var a=e(document.activeElement),i=r.find(".mCustomScrollBox").length,s=0;a.is(n.advanced.autoScrollOnFocus)&&(V(t),clearTimeout(t[0]._focusTimeout),t[0]._focusTimer=i?(s+17)*i:0,t[0]._focusTimeout=setTimeout(function(){var e=[oe(a)[0],oe(a)[1]],o=[r[0].offsetTop,r[0].offsetLeft],i=[o[0]+e[0]>=0&&o[0]+e[0]<l.height()-a.outerHeight(!1),o[1]+e[1]>=0&&o[0]+e[1]<l.width()-a.outerWidth(!1)],c="yx"!==n.axis||i[0]||i[1]?"all":"none";"x"===n.axis||i[0]||Q(t,e[0].toString(),{dir:"y",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s}),"y"===n.axis||i[1]||Q(t,e[1].toString(),{dir:"x",scrollEasing:"mcsEaseInOut",overwrite:c,dur:s})},t[0]._focusTimer))})},H=function(){var t=e(this),o=t.data(a),n=a+"_"+o.idx,i=e("#mCSB_"+o.idx+"_container").parent();i.bind("scroll."+n,function(t){(0!==i.scrollTop()||0!==i.scrollLeft())&&e(".mCSB_"+o.idx+"_scrollbar").css("visibility","hidden")})},U=function(){var t=e(this),o=t.data(a),n=o.opt,i=o.sequential,r=a+"_"+o.idx,l=".mCSB_"+o.idx+"_scrollbar",s=e(l+">a");s.bind("mousedown."+r+" touchstart."+r+" pointerdown."+r+" MSPointerDown."+r+" mouseup."+r+" touchend."+r+" pointerup."+r+" MSPointerUp."+r+" mouseout."+r+" pointerout."+r+" MSPointerOut."+r+" click."+r,function(a){function r(e,o){i.scrollAmount=n.snapAmount||n.scrollButtons.scrollAmount,q(t,e,o)}if(a.preventDefault(),$(a)){var l=e(this).attr("class");switch(i.type=n.scrollButtons.scrollType,a.type){case"mousedown":case"touchstart":case"pointerdown":case"MSPointerDown":if("stepped"===i.type)return;c=!0,o.tweenRunning=!1,r("on",l);break;case"mouseup":case"touchend":case"pointerup":case"MSPointerUp":case"mouseout":case"pointerout":case"MSPointerOut":if("stepped"===i.type)return;c=!1,i.dir&&r("off",l);break;case"click":if("stepped"!==i.type||o.tweenRunning)return;r("on",l)}}})},F=function(){function t(t){function a(e,t){r.type=i.keyboard.scrollType,r.scrollAmount=i.snapAmount||i.keyboard.scrollAmount,"stepped"===r.type&&n.tweenRunning||q(o,e,t)}switch(t.type){case"blur":n.tweenRunning&&r.dir&&a("off",null);break;case"keydown":case"keyup":var l=t.keyCode?t.keyCode:t.which,s="on";if("x"!==i.axis&&(38===l||40===l)||"y"!==i.axis&&(37===l||39===l)){if((38===l||40===l)&&!n.overflowed[0]||(37===l||39===l)&&!n.overflowed[1])return;"keyup"===t.type&&(s="off"),e(document.activeElement).is(u)||(t.preventDefault(),t.stopImmediatePropagation(),a(s,l))}else if(33===l||34===l){if((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type){V(o);var f=34===l?-1:1;if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=Math.abs(c[0].offsetLeft)-.9*f*d.width();else var h="y",m=Math.abs(c[0].offsetTop)-.9*f*d.height();Q(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}else if((35===l||36===l)&&!e(document.activeElement).is(u)&&((n.overflowed[0]||n.overflowed[1])&&(t.preventDefault(),t.stopImmediatePropagation()),"keyup"===t.type)){if("x"===i.axis||"yx"===i.axis&&n.overflowed[1]&&!n.overflowed[0])var h="x",m=35===l?Math.abs(d.width()-c.outerWidth(!1)):0;else var h="y",m=35===l?Math.abs(d.height()-c.outerHeight(!1)):0;Q(o,m.toString(),{dir:h,scrollEasing:"mcsEaseInOut"})}}}var o=e(this),n=o.data(a),i=n.opt,r=n.sequential,l=a+"_"+n.idx,s=e("#mCSB_"+n.idx),c=e("#mCSB_"+n.idx+"_container"),d=c.parent(),u="input,textarea,select,datalist,keygen,[contenteditable='true']",f=c.find("iframe"),h=["blur."+l+" keydown."+l+" keyup."+l];f.length&&f.each(function(){e(this).load(function(){L(this)&&e(this.contentDocument||this.contentWindow.document).bind(h[0],function(e){t(e)})})}),s.attr("tabindex","0").bind(h[0],function(e){t(e)})},q=function(t,o,n,i,r){function l(e){var o="stepped"!==f.type,a=r?r:e?o?p/1.5:g:1e3/60,n=e?o?7.5:40:2.5,s=[Math.abs(h[0].offsetTop),Math.abs(h[0].offsetLeft)],d=[c.scrollRatio.y>10?10:c.scrollRatio.y,c.scrollRatio.x>10?10:c.scrollRatio.x],u="x"===f.dir[0]?s[1]+f.dir[1]*d[1]*n:s[0]+f.dir[1]*d[0]*n,m="x"===f.dir[0]?s[1]+f.dir[1]*parseInt(f.scrollAmount):s[0]+f.dir[1]*parseInt(f.scrollAmount),v="auto"!==f.scrollAmount?m:u,x=i?i:e?o?"mcsLinearOut":"mcsEaseInOut":"mcsLinear",_=e?!0:!1;return e&&17>a&&(v="x"===f.dir[0]?s[1]:s[0]),Q(t,v.toString(),{dir:f.dir[0],scrollEasing:x,dur:a,onComplete:_}),e?void(f.dir=!1):(clearTimeout(f.step),void(f.step=setTimeout(function(){l()},a)))}function s(){clearTimeout(f.step),Z(f,"step"),V(t)}var c=t.data(a),u=c.opt,f=c.sequential,h=e("#mCSB_"+c.idx+"_container"),m="stepped"===f.type?!0:!1,p=u.scrollInertia<26?26:u.scrollInertia,g=u.scrollInertia<1?17:u.scrollInertia;switch(o){case"on":if(f.dir=[n===d[16]||n===d[15]||39===n||37===n?"x":"y",n===d[13]||n===d[15]||38===n||37===n?-1:1],V(t),te(n)&&"stepped"===f.type)return;l(m);break;case"off":s(),(m||c.tweenRunning&&f.dir)&&l(!0)}},Y=function(t){var o=e(this).data(a).opt,n=[];return"function"==typeof t&&(t=t()),t instanceof Array?n=t.length>1?[t[0],t[1]]:"x"===o.axis?[null,t[0]]:[t[0],null]:(n[0]=t.y?t.y:t.x||"x"===o.axis?null:t,n[1]=t.x?t.x:t.y||"y"===o.axis?null:t),"function"==typeof n[0]&&(n[0]=n[0]()),"function"==typeof n[1]&&(n[1]=n[1]()),n},j=function(t,o){if(null!=t&&"undefined"!=typeof t){var n=e(this),i=n.data(a),r=i.opt,l=e("#mCSB_"+i.idx+"_container"),s=l.parent(),c=typeof t;o||(o="x"===r.axis?"x":"y");var d="x"===o?l.outerWidth(!1):l.outerHeight(!1),f="x"===o?l[0].offsetLeft:l[0].offsetTop,h="x"===o?"left":"top";switch(c){case"function":return t();case"object":var m=t.jquery?t:e(t);if(!m.length)return;return"x"===o?oe(m)[1]:oe(m)[0];case"string":case"number":if(te(t))return Math.abs(t);if(-1!==t.indexOf("%"))return Math.abs(d*parseInt(t)/100);if(-1!==t.indexOf("-="))return Math.abs(f-parseInt(t.split("-=")[1]));if(-1!==t.indexOf("+=")){var p=f+parseInt(t.split("+=")[1]);return p>=0?0:Math.abs(p)}if(-1!==t.indexOf("px")&&te(t.split("px")[0]))return Math.abs(t.split("px")[0]);if("top"===t||"left"===t)return 0;if("bottom"===t)return Math.abs(s.height()-l.outerHeight(!1));if("right"===t)return Math.abs(s.width()-l.outerWidth(!1));if("first"===t||"last"===t){var m=l.find(":"+t);return"x"===o?oe(m)[1]:oe(m)[0]}return e(t).length?"x"===o?oe(e(t))[1]:oe(e(t))[0]:(l.css(h,t),void u.update.call(null,n[0]))}}},X=function(t){function o(){return clearTimeout(h[0].autoUpdate),0===s.parents("html").length?void(s=null):void(h[0].autoUpdate=setTimeout(function(){return f.advanced.updateOnSelectorChange&&(m=r(),m!==w)?(l(3),void(w=m)):(f.advanced.updateOnContentResize&&(p=[h.outerHeight(!1),h.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],(p[0]!==S[0]||p[1]!==S[1]||p[2]!==S[2]||p[3]!==S[3]||p[4]!==S[4]||p[5]!==S[5])&&(l(p[0]!==S[0]||p[1]!==S[1]),S=p)),f.advanced.updateOnImageLoad&&(g=n(),g!==b&&(h.find("img").each(function(){i(this)}),b=g)),void((f.advanced.updateOnSelectorChange||f.advanced.updateOnContentResize||f.advanced.updateOnImageLoad)&&o()))},f.advanced.autoUpdateTimeout))}function n(){var e=0;return f.advanced.updateOnImageLoad&&(e=h.find("img").length),e}function i(t){function o(e,t){return function(){return t.apply(e,arguments)}}function a(){this.onload=null,e(t).addClass(d[2]),l(2)}if(e(t).hasClass(d[2]))return void l();var n=new Image;n.onload=o(n,a),n.src=t.src}function r(){f.advanced.updateOnSelectorChange===!0&&(f.advanced.updateOnSelectorChange="*");var t=0,o=h.find(f.advanced.updateOnSelectorChange);return f.advanced.updateOnSelectorChange&&o.length>0&&o.each(function(){t+=e(this).height()+e(this).width()}),t}function l(e){clearTimeout(h[0].autoUpdate),u.update.call(null,s[0],e)}var s=e(this),c=s.data(a),f=c.opt,h=e("#mCSB_"+c.idx+"_container");if(t)return clearTimeout(h[0].autoUpdate),void Z(h[0],"autoUpdate");var m,p,g,v=h.parent(),x=[e("#mCSB_"+c.idx+"_scrollbar_vertical"),e("#mCSB_"+c.idx+"_scrollbar_horizontal")],_=function(){return[x[0].is(":visible")?x[0].outerHeight(!0):0,x[1].is(":visible")?x[1].outerWidth(!0):0]},w=r(),S=[h.outerHeight(!1),h.outerWidth(!1),v.height(),v.width(),_()[0],_()[1]],b=n();o()},N=function(e,t,o){return Math.round(e/t)*t-o},V=function(t){var o=t.data(a),n=e("#mCSB_"+o.idx+"_container,#mCSB_"+o.idx+"_container_wrapper,#mCSB_"+o.idx+"_dragger_vertical,#mCSB_"+o.idx+"_dragger_horizontal");n.each(function(){K.call(this)})},Q=function(t,o,n){function i(e){return s&&c.callbacks[e]&&"function"==typeof c.callbacks[e]}function r(){return[c.callbacks.alwaysTriggerOffsets||_>=w[0]+b,c.callbacks.alwaysTriggerOffsets||-C>=_]}function l(){var e=[h[0].offsetTop,h[0].offsetLeft],o=[v[0].offsetTop,v[0].offsetLeft],a=[h.outerHeight(!1),h.outerWidth(!1)],i=[f.height(),f.width()];t[0].mcs={content:h,top:e[0],left:e[1],draggerTop:o[0],draggerLeft:o[1],topPct:Math.round(100*Math.abs(e[0])/(Math.abs(a[0])-i[0])),leftPct:Math.round(100*Math.abs(e[1])/(Math.abs(a[1])-i[1])),direction:n.dir}}var s=t.data(a),c=s.opt,d={trigger:"internal",dir:"y",scrollEasing:"mcsEaseOut",drag:!1,dur:c.scrollInertia,overwrite:"all",
callbacks:!0,onStart:!0,onUpdate:!0,onComplete:!0},n=e.extend(d,n),u=[n.dur,n.drag?0:n.dur],f=e("#mCSB_"+s.idx),h=e("#mCSB_"+s.idx+"_container"),m=h.parent(),p=c.callbacks.onTotalScrollOffset?Y.call(t,c.callbacks.onTotalScrollOffset):[0,0],g=c.callbacks.onTotalScrollBackOffset?Y.call(t,c.callbacks.onTotalScrollBackOffset):[0,0];if(s.trigger=n.trigger,(0!==m.scrollTop()||0!==m.scrollLeft())&&(e(".mCSB_"+s.idx+"_scrollbar").css("visibility","visible"),m.scrollTop(0).scrollLeft(0)),"_resetY"!==o||s.contentReset.y||(i("onOverflowYNone")&&c.callbacks.onOverflowYNone.call(t[0]),s.contentReset.y=1),"_resetX"!==o||s.contentReset.x||(i("onOverflowXNone")&&c.callbacks.onOverflowXNone.call(t[0]),s.contentReset.x=1),"_resetY"!==o&&"_resetX"!==o){switch(!s.contentReset.y&&t[0].mcs||!s.overflowed[0]||(i("onOverflowY")&&c.callbacks.onOverflowY.call(t[0]),s.contentReset.x=null),!s.contentReset.x&&t[0].mcs||!s.overflowed[1]||(i("onOverflowX")&&c.callbacks.onOverflowX.call(t[0]),s.contentReset.x=null),c.snapAmount&&(o=N(o,c.snapAmount,c.snapOffset)),n.dir){case"x":var v=e("#mCSB_"+s.idx+"_dragger_horizontal"),x="left",_=h[0].offsetLeft,w=[f.width()-h.outerWidth(!1),v.parent().width()-v.width()],S=[o,0===o?0:o/s.scrollRatio.x],b=p[1],C=g[1],B=b>0?b/s.scrollRatio.x:0,T=C>0?C/s.scrollRatio.x:0;break;case"y":var v=e("#mCSB_"+s.idx+"_dragger_vertical"),x="top",_=h[0].offsetTop,w=[f.height()-h.outerHeight(!1),v.parent().height()-v.height()],S=[o,0===o?0:o/s.scrollRatio.y],b=p[0],C=g[0],B=b>0?b/s.scrollRatio.y:0,T=C>0?C/s.scrollRatio.y:0}S[1]<0||0===S[0]&&0===S[1]?S=[0,0]:S[1]>=w[1]?S=[w[0],w[1]]:S[0]=-S[0],t[0].mcs||(l(),i("onInit")&&c.callbacks.onInit.call(t[0])),clearTimeout(h[0].onCompleteTimeout),(s.tweenRunning||!(0===_&&S[0]>=0||_===w[0]&&S[0]<=w[0]))&&(G(v[0],x,Math.round(S[1]),u[1],n.scrollEasing),G(h[0],x,Math.round(S[0]),u[0],n.scrollEasing,n.overwrite,{onStart:function(){n.callbacks&&n.onStart&&!s.tweenRunning&&(i("onScrollStart")&&(l(),c.callbacks.onScrollStart.call(t[0])),s.tweenRunning=!0,y(v),s.cbOffsets=r())},onUpdate:function(){n.callbacks&&n.onUpdate&&i("whileScrolling")&&(l(),c.callbacks.whileScrolling.call(t[0]))},onComplete:function(){if(n.callbacks&&n.onComplete){"yx"===c.axis&&clearTimeout(h[0].onCompleteTimeout);var e=h[0].idleTimer||0;h[0].onCompleteTimeout=setTimeout(function(){i("onScroll")&&(l(),c.callbacks.onScroll.call(t[0])),i("onTotalScroll")&&S[1]>=w[1]-B&&s.cbOffsets[0]&&(l(),c.callbacks.onTotalScroll.call(t[0])),i("onTotalScrollBack")&&S[1]<=T&&s.cbOffsets[1]&&(l(),c.callbacks.onTotalScrollBack.call(t[0])),s.tweenRunning=!1,h[0].idleTimer=0,y(v,"hide")},e)}}}))}},G=function(e,t,o,a,n,i,r){function l(){S.stop||(x||m.call(),x=J()-v,s(),x>=S.time&&(S.time=x>S.time?x+f-(x-S.time):x+f-1,S.time<x+1&&(S.time=x+1)),S.time<a?S.id=h(l):g.call())}function s(){a>0?(S.currVal=u(S.time,_,b,a,n),w[t]=Math.round(S.currVal)+"px"):w[t]=o+"px",p.call()}function c(){f=1e3/60,S.time=x+f,h=window.requestAnimationFrame?window.requestAnimationFrame:function(e){return s(),setTimeout(e,.01)},S.id=h(l)}function d(){null!=S.id&&(window.requestAnimationFrame?window.cancelAnimationFrame(S.id):clearTimeout(S.id),S.id=null)}function u(e,t,o,a,n){switch(n){case"linear":case"mcsLinear":return o*e/a+t;case"mcsLinearOut":return e/=a,e--,o*Math.sqrt(1-e*e)+t;case"easeInOutSmooth":return e/=a/2,1>e?o/2*e*e+t:(e--,-o/2*(e*(e-2)-1)+t);case"easeInOutStrong":return e/=a/2,1>e?o/2*Math.pow(2,10*(e-1))+t:(e--,o/2*(-Math.pow(2,-10*e)+2)+t);case"easeInOut":case"mcsEaseInOut":return e/=a/2,1>e?o/2*e*e*e+t:(e-=2,o/2*(e*e*e+2)+t);case"easeOutSmooth":return e/=a,e--,-o*(e*e*e*e-1)+t;case"easeOutStrong":return o*(-Math.pow(2,-10*e/a)+1)+t;case"easeOut":case"mcsEaseOut":default:var i=(e/=a)*e,r=i*e;return t+o*(.499999999999997*r*i+-2.5*i*i+5.5*r+-6.5*i+4*e)}}e._mTween||(e._mTween={top:{},left:{}});var f,h,r=r||{},m=r.onStart||function(){},p=r.onUpdate||function(){},g=r.onComplete||function(){},v=J(),x=0,_=e.offsetTop,w=e.style,S=e._mTween[t];"left"===t&&(_=e.offsetLeft);var b=o-_;S.stop=0,"none"!==i&&d(),c()},J=function(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()},K=function(){var e=this;e._mTween||(e._mTween={top:{},left:{}});for(var t=["top","left"],o=0;o<t.length;o++){var a=t[o];e._mTween[a].id&&(window.requestAnimationFrame?window.cancelAnimationFrame(e._mTween[a].id):clearTimeout(e._mTween[a].id),e._mTween[a].id=null,e._mTween[a].stop=1)}},Z=function(e,t){try{delete e[t]}catch(o){e[t]=null}},$=function(e){return!(e.which&&1!==e.which)},ee=function(e){var t=e.originalEvent.pointerType;return!(t&&"touch"!==t&&2!==t)},te=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},oe=function(e){var t=e.parents(".mCSB_container");return[e.offset().top-t.offset().top,e.offset().left-t.offset().left]};e.fn[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o]=function(t){return u[t]?u[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist"):u.init.apply(this,arguments)},e[o].defaults=i,window[o]=!0,e(window).load(function(){e(n)[o](),e.extend(e.expr[":"],{mcsInView:e.expr[":"].mcsInView||function(t){var o,a,n=e(t),i=n.parents(".mCSB_container");if(i.length)return o=i.parent(),a=[i[0].offsetTop,i[0].offsetLeft],a[0]+oe(n)[0]>=0&&a[0]+oe(n)[0]<o.height()-n.outerHeight(!1)&&a[1]+oe(n)[1]>=0&&a[1]+oe(n)[1]<o.width()-n.outerWidth(!1)},mcsOverflow:e.expr[":"].mcsOverflow||function(t){var o=e(t).data(a);if(o)return o.overflowed[0]||o.overflowed[1]}})})})});
(function() {
    /**
     * Успешно разрешает Promise, если браузер поддерживает формат webP,
     * в противном случает отклоняет его
     *
     * @return Promise
     */
    function supportsWebp() {
        return new Promise(function(resolve, reject) {
            if (!self.createImageBitmap) {
                reject();
            } else {
                var webpData = 'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=';

                fetch(webpData)
                    .then(function(response) {
                        return response.blob();
                    })
                    .then(function(blobData) {
                        return createImageBitmap(blobData).then(function() {
                            resolve();
                        }, function() {
                            reject();
                        });
                    }, function() {
                            reject();
                });
            }
        });
    }

    /**
     * Загружает скрипт и вызывает callback, по окончании загрузки
     *
     * @param url
     * @param callback
     * @return void
     */
    function loadScript(url, callback)
    {
        // Добавляем тег сценария в head
        var head = document.getElementsByTagName('head')[0];
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = url;

        // Затем связываем событие и функцию обратного вызова.
        // Для поддержки большинства обозревателей используется несколько событий.
        script.onreadystatechange = callback;
        script.onload = callback;

        // Начинаем загрузку
        head.appendChild(script);
    }

    /**
     * Проверяет поддержку webP и в случае необходимости начинает загрузку polyfills для webP
     *
     * @return void
     */
    function start()
    {
        supportsWebp().catch(function() {

            var script = document.createElement('script');
            script.src = global.folder + '/resource/js/webpjs/polyfills.js';
            document.head.appendChild(script);

            var loadWebpJS = function() {
                document.addEventListener('DOMContentLoaded', function(){
                    var script = document.createElement('script');
                    script.src = global.folder + '/resource/js/webpjs/webp-init.js';
                    script.defer = true;
                    document.body.appendChild(script);
                });
            };
            loadScript(global.folder + "/resource/js/webpjs/webp-hero.bundle.js", loadWebpJS);
        });
    }

    /**
     * Проверяет, поддерживаются ли Promise в браузере, если нет, то загружает
     * сперва Polyfill для Promise и только потом запускает этап проверки webP
     *
     * @return void
     */
    function init()
    {
        if(/MSIE \d|Trident.*rv:/.test(navigator.userAgent)) {
            //Если это IE, то загружаем polyfill для Promise
            loadScript(global.folder + "/resource/js/webpjs/bluebird.core.min.js", function() {
                start();
            });
        } else {
            start();
        }
    }

    init(); //Запускаем процесс
})();
/**
 * Обеспечивает корректную работу всплывающих окон телефонии
 *
 * @author ReadyScript lab.
 */
var telephony = {};

/**
 * Менеджер табов всплывающих окон для телефонии. Если одновременно всплывают
 * несколько окон, то они должны упаковываться в разные табы
 */
telephony.tabManager = {
    list: [],
    container: null,
    tabContainer: null,
    paneContainer: null,

    init: function() {
        var _this = this;
        this.container = $('<div class="tel-contnainer" id="tel-win-container">' +
                                '<a class="icon-circle tel-expand-button" title="' + lang.t('Развернуть') + '">' +
                                '    <i class="zmdi zmdi-phone-setting rubberBand animated infinite"></i>' +
                                '</a>' +
                            '</div>'
                           ).appendTo('body');

        if (global.telephonyOffsetBottom) {
            this.container.css('margin-bottom', global.telephonyOffsetBottom + 'px');
        }

        this.tabContainer = $('<ul class="tab-nav tel-tabs" role="tablist" data-tab-color="green"></ul>');
        this.paneContainer = $('<div class="tab-content tel-panes"></div>');

        this.tabContainer.on('click', 'a', function() {
            //Сохраняем активный таб
            $.cookie('crm-tel-active-tab', $(this).closest('[data-id]').data('id'), {
                expires:5000,
                path:'/'
            });
        });

        this.container
                .append(this.tabContainer, this.paneContainer)
                .on('click', '.tel-expand-button', function() {
                    _this.expand();
                });

        if ($.cookie('crm-tel-collapse-window')) {
            this.collapse();
        }

        this.paneContainer
                .on('click', '.tel-view-toggler', function() {
                    _this.collapse();
                })
                .on('click', '.close', function() {
                    var callId = $(this).closest('[data-id]').data('id');
                    _this.close(callId);
                })
                .on('click', '.tel-action', function() {
                    var callId = $(this).closest('[data-id]').data('id');
                    _this.doAction(callId, $(this).data('url'));
                });
    },

    /**
     * Восстанавливает активную вкладку
     */
    setActiveTab: function() {
        var tab = this.tabContainer.find('[data-id="' + $.cookie('crm-tel-active-tab') + '"] a');
        if (tab.length) {
            tab.click();
        } else {
            this.tabContainer.find(' > li:first > a').click();
        }
    },

    /**
     * Выполняет одно действие со звонком
     *
     * @param callId
     * @param url
     */
    doAction: function(callId, url) {
        var _this = this;

        $.ajaxQuery({
            loadingProgress: false,
            url: url,
            success:function(response) {
                if (!response.success) {
                    _this.showError(callId, response.error);
                }
            },
            error:function() {
                _this.showError(callId, lang.t('Не удалось выполнить запрос'));
            }
        })
    },

    /**
     * Отображает ошибку
     *
     * @param callId
     * @param error
     */
    showError: function(callId, error) {
        var errorContainer = this.paneContainer.find('[data-id="' + callId + '"] .tel-error');
        if (errorContainer.length) {
            errorContainer.text(error);
        }
        errorContainer.toggleClass('hidden', error == '');
    },

    /**
     * Добавляет новый таб со звонящим
     *
     * @param callerWin
     * @param noExpand
     */
    addTab: function(callerWin, noExpand, noSelectTab) {

        var existPane = this.paneContainer.find('[data-id="'+callerWin.id+'"]');
        var tab = this.tabContainer.find('[data-id="'+callerWin.id+'"]');
        var pane = this._renderTabContent(callerWin);

        if (existPane.length) {
            var isActive = existPane.hasClass('active');
            pane.toggleClass('active', isActive);
            existPane.replaceWith(pane);

        } else {
            pane.appendTo(this.paneContainer);

            var tab = this._renderTab(callerWin);
            tab.appendTo(this.tabContainer);

            this.list.push(callerWin);
            pane.trigger('new-content');
        }

        if (!noSelectTab) {
            tab.find('a').click(); //Активируем таб
        }

        this.updateActive();
        if (!noExpand) {
            this.expand();
        }
    },

    /**
     * Закрывает вкладку со звонком с пометкой
     *
     * @param id
     */
    close: function(id) {
        var url = this.paneContainer.find('[data-id="'+id+'"] .close').data('url');
        this.removeTab(id);
        $.get(url);
    },

    /**
     * Разворачивает окно с телефонией
     */
    expand: function() {
        this.container.removeClass('tel-collapsed');
        $.cookie('crm-tel-collapse-window', null, {
            path:'/'
        });
    },

    /**
     * Сворачивает окно с телефонией
     */
    collapse: function() {
        this.container.addClass('tel-collapsed');
        $.cookie('crm-tel-collapse-window', 1, {
            expires:5000,
            path:'/'
        });
    },

    /**
     * Закрывает вкладку. Переключает активную вкладку на другую
     *
     * @param id
     */
    removeTab: function(id) {
        var tab = this.tabContainer.find('[data-id="'+id+'"]');
        if (tab.is('.active')) {
            var nextActiveTab = tab.prev().length ? tab.prev() : tab.next();
            if (nextActiveTab.length) {
                nextActiveTab.find('> a').click(); //Меняем активный таб
            }
        }

        tab.remove();
        this.paneContainer.find('[data-id="'+id+'"]').remove();

        this.updateActive();
    },

    /**
     * Возвращает объект окна по ID
     *
     * @param id
     * @returns {boolean}
     */
    getCallerWinById: function(id) {
        this.list.forEach(function (callWin) {
            if (callWin.id == id) return callWin;
        });

        return false;
    },

    /**
     * Изменяет видимость блока телефонии, в зависимости от наличия активных табов
     * Скрывает табы, если звонков меньше 2х
     */
    updateActive: function() {
        var active = this.paneContainer.children().length > 0;
        this.container.toggleClass('active', active);

        var tabVisible = this.paneContainer.children().length > 1;
        this.tabContainer.toggleClass('hidden', !tabVisible);
    },

    /**
     * Возвращает jquery объект подготовленной вкладки (Таб)
     *
     * @param callerWin
     * @returns {jQuery|HTMLElement}
     */
    _renderTab: function(callerWin) {
        var n = this.list.length + 1;
        var li = $('<li>').attr('data-id', callerWin.id);
        var link = $('<a>').attr({
            href:'#tab-'+callerWin.id,
            role:'tab'
        }).attr('data-toggle', 'tab');

        link.text(callerWin.getTitle()).appendTo(li);

        return li;
    },

    /**
     * Возвращает jQuery объект подготовленного содержимого вкладки
     *
     * @param callerWin
     * @returns {jQuery|HTMLElement}
     */
    _renderTabContent: function(callerWin) {
        var pane = $('<div class="tab-pane tel-pane"/>');
        pane
            .attr('data-id', callerWin.id)
            .attr('id', 'tab-' + callerWin.id)
            .html(callerWin.getContentHtml());
        return pane;
    }
};

/**
 * Класс одного всплывающего окна
 */
telephony.callerWindow = function(id) {
    this.id = id;
    this.contentHtml = '';

    /**
     * Устанавливает HTML содержимого всплывающего окна
     *
     * @param html
     */
    this.setContentHtml = function(html) {
        this.contentHtml = html;
    };

    /**
     * Возвращает содержимое всплывающего окна
     *
     * @returns string
     */
    this.getContentHtml = function() {
        return this.contentHtml;
    };

    /**
     * Устанавливает заголовок вкладки окна
     *
     * @param title
     */
    this.setTitle = function(title) {
        this.title = title;
    };

    /**
     * Возвращает заголовок вкладки окна
     *
     * @returns string
     */
    this.getTitle = function() {
        return this.title;
    };
};

/**
 * Менеджер, управляющий отображением и обновлением
 * содержимого окон при наступлении различных событий
 */
telephony.eventManager = {

    init: function() {
        $('body').on('rs-event-crm.telephony.event', telephony.eventManager.onEvent);
        if (global.currentTelephonyMessages) {

            for(var key in global.currentTelephonyMessages) {
                this.onEvent(null, global.currentTelephonyMessages[key]); //Инициализируем текущие сообщения телефонии
            }

            telephony.tabManager.setActiveTab();
        }
    },

    onEvent: function(event, data) {
        var winId = data.id;
        if (winId) {
            if (data.closeCall) {

                telephony.tabManager.removeTab(winId);

            } else {

                var win = telephony.tabManager.getCallerWinById(winId);
                if (!win) {
                    win = new telephony.callerWindow(winId);
                }

                win.setContentHtml(data.html);
                win.setTitle(data.username);
                telephony.tabManager.addTab(win, event === null, event === null);
            }
        }
    }
};


/**
 * Инициализирует работу всплывающих окон телефонии
 */
$(function() {
    telephony.tabManager.init();
    telephony.eventManager.init();
});
//Инициализируем работу меню в админ. панели
$(window).load(function() {
    //Добавляем scrollbar'ы в меню
    $('.side-scroll').mCustomScrollbar({
        theme: 'minimal',
        scrollInertia: 0,
        mouseWheel:{ preventDefault: true }
    });

    $('.sm-body').mCustomScrollbar({
        theme: 'minimal-dark',
        autoHideScrollbar:true,
        scrollInertia: 0,
        mouseWheel:{ preventDefault: true }
    });

    $('body')
        .on($.rs.clickEventName, '#menu-trigger', function(e) {
            $(this).toggleClass('toggled');
            $('#sidebar').toggleClass('toggled');
            e.preventDefault();
        })
        .on($.rs.clickEventName, '.sm .sm-node > a', function(e) {
            $(this).parent().toggleClass('open');
            e.preventDefault();
        })
        .on($.rs.clickEventName, '.menu-close', function(e) {
            var self = this;
            $(this).closest('.sm-node').removeClass('open');
            $(this).closest('#sidebar').removeClass('sm-opened');
        });


        $('.side-menu > .sm-node > a')
            .on($.rs.clickEventName, function(e) {
                var parent = $(this).closest('.sm-node');
                var sidebar = $(this).closest('#sidebar');

                if (parent.is('.open')) {
                    parent.removeClass('open');
                    sidebar.removeClass('sm-opened');
                } else {
                    sidebar.find('.side-menu > .sm-node').removeClass('open');
                    parent.addClass('open');
                    sidebar.addClass('sm-opened');
                }
                e.preventDefault();
            })
            .on('dblclick', function() {
                if ($(this).data('url')) {
                    location.href = $(this).data('url');
                }
            });

        $('.side-menu-overlay').on($.rs.clickEventName, function() {
            $('.side-menu .sm-node').removeClass('open');
            $(this).closest('#sidebar').removeClass('sm-opened');
        });
});
/**
 * Класс позволяет выполнять запросы, которые возвращают результат в виде потока частиц
 */
class StreamFetcher
{
    constructor() {
        this.abortController = new AbortController;
    }

    /**
     * Возвращает контроллер, который может остановить выполнение запроса
     *
     * @returns {AbortController}
     */
    getAbortController()
    {
        return this.abortController;
    }

    /**
     * Устанавливает функцию, которая будет вызвана при получении каждой частицы ответа
     *
     * @param callback
     */
    setStreamCallback(callback)
    {
        this.streamCallback = callback;
        return this;
    }

    /**
     * Выполняет запрос на получение потога генеративных данных
     *
     * @param url
     * @param formData
     * @returns {Promise<any>}
     */
    async fetchStream(url, formData)
    {
        return new Promise(async (resolve, reject) => {
            let jsonData;
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    body: formData,
                    signal: this.abortController.signal
                });

                if (response.headers.get('Content-type') === 'application/stream+json') {
                    //Обрабатываем поток данных
                    const reader = response.body.getReader();

                    //Запоминаем предыдущее значение для отмены ввода через CTRL+Z
                    const textDecoder = new TextDecoder();
                    let buffer = '';
                    let fullText = '';
                    let iteration = 0;

                    while (true) {
                        const {done, value} = await reader.read();
                        if (done) break;

                        // Декодируем бинарные данные в текст
                        buffer += textDecoder.decode(value, {stream: true});

                        // Разделяем буфер по \n и обрабатываем каждый JSON
                        const lines = buffer.split('\n');
                        // Оставляем на следующую итерацию, то, что было после последнего \n
                        buffer = lines.pop();

                        for (const line of lines) {
                            if (line.trim() === '') continue; // Пропускаем пустые строки
                            try {
                                jsonData = JSON.parse(line);
                                if (jsonData.balance) {
                                    //Сообщаем другим модулям о новом балансе
                                    window.dispatchEvent(new CustomEvent('gptBalanceChange', {
                                        bubbles:true,
                                        detail: {
                                            balance: jsonData.balance,
                                            source: 'button'
                                        }
                                    }));
                                }
                                fullText = fullText + jsonData.text;
                                if (this.streamCallback) {
                                    this.streamCallback(fullText, jsonData, iteration);
                                }
                                iteration++;
                            } catch (error) {
                                console.log(error);
                            }
                        }
                    }
                    resolve({fullText, lastChunk: jsonData});
                } else {
                    //Обрабатываем обычный не потоковый ответ
                    return response.json().then(jsonData => {
                        $.rs.checkAuthorization(jsonData);
                        $.rs.checkWindowRedirect(jsonData);
                        $.rs.checkMessages(jsonData);
                        if (typeof(jsonData) == 'object' && jsonData.messages) {
                            reject(jsonData.messages[0].text);
                        } else {
                            resolve(jsonData);
                        }
                    });
                }
            } catch(error) {
                if (!(/^AbortError/.test(error))) {
                    $.messenger('show', {
                        theme: 'error',
                        text: error
                    });
                }
                reject(error);
            }
        });
    }
};
/**
 * Jquery плагин, отвечающий за ИИ-кнопки возле форм
 *
 * @author ReadyScript lab.
 */
(function( $ ){

    $.fn.aiButton = function( method ) {
        const defaults = {},
            args = arguments;

        return this.map(function() {
            let $this = $(this),
                data = $this.data('aiButtonInstance'),
                params = $this.data('aiButton');

            const methods = {
                init: function (initOptions) {
                    if (data) return;
                    data = {};
                    $this.data('aiButtonInstance', data);
                    data.opt = $.extend({}, defaults, initOptions);

                    createButton();
                    bindAutoStop();
                },

                /**
                 * Выполняет запрос на генерацию значения для поля
                 *
                 * @param promptId
                 * @param force - всегда запускать
                 */
                startGeneration: async function(promptId, force) {
                    if (data.$buttonGroup.hasClass('loading')) {
                        methods.stopGeneration();
                        if (!force) return;
                    }

                    return new Promise(async (resolve, reject) => {
                        let form = data.$buttonGroup.closest('form');

                        if (!promptId) {
                            promptId = data.$mainButton.data('promptId');
                        }

                        data.$buttonGroup.addClass('loading');
                        let url = global.ai.generateUrl + '&prompt_id=' + promptId;
                        let formData = new FormData(form[0]);

                        data.fetcher = new StreamFetcher();
                        data.fetcher.setStreamCallback((fulltext, jsonData, iteration) => {
                            if (iteration === 0) {
                                data.previousValue = $this[0].value;
                                $this[0].value = '';
                            }

                            $this[0].value += jsonData.text;
                        });

                        data.fetcher.fetchStream(url, formData)
                            .then(object => {
                                resolve(object);
                            })
                            .catch(error => {
                                reject(error);
                            })
                            .finally(() => {
                                data.$buttonGroup.removeClass('loading');
                            });
                    });
                },

                /**
                 * Прерывает генерацию значения
                 */
                stopGeneration: function() {
                    if (data.fetcher) {
                        data.fetcher.getAbortController().abort('AbortError');
                    }
                }
            };

            //private
            const
            /**
             * Создает кнопку генерации текста с выпадающим списком
             */
            createButton = function() {
                if (!params['prompts'].length) return;

                let isMultiedit = $this.closest('.multi_edit_rightcol');
                if (isMultiedit.length) return;

                data.$buttonGroup = $(`<div class="btn-group ai-btn-group"></div>`);
                data.$mainButton = $(`<button type="button" class="btn btn-default ai-gen"></button>`)
                    .attr('data-prompt-id', params['prompts'][0]['id'])
                    .attr('title', lang.t('Заполнить через ИИ'))
                    .appendTo(data.$buttonGroup);

                data.$dropDownButton = $(`<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"
                                            aria-haspopup="true" aria-expanded="false"><span class="caret"></span>
                                            </button>`).appendTo(data.$buttonGroup);

                data.$dropDown = $(`<ul class="dropdown-menu dropdown-menu-right"></ul>`).appendTo(data.$buttonGroup);

                params['prompts'].forEach((prompt) => {
                    $('<li/>').append(
                        $('<a/>')
                            .attr('data-prompt-id', prompt['id'])
                            .text(prompt['note'])
                            .on('click', event => {
                                methods.startGeneration($(event.currentTarget).data('prompt-id')).catch(() => {});
                            })
                    ).appendTo(data.$dropDown);
                });

                data.$buttonGroup.data('aiBaseField', $this);
                $this
                    .wrap('<span class="form-wrapper"></span>')
                    .parent()
                    .append(data.$buttonGroup);

                data.$buttonGroup.parent().trigger('new-content');

                data.$mainButton.on('click', event => {
                    methods.startGeneration($(event.currentTarget).data('prompt-id')).catch(() => {});
                });
                $this.on('keyup', checkUndo);
            },

            /**
             * Позволяет возвращать значение в поле до генерации при нажатии CTRL+Z
             *
             * @param event
             */
            checkUndo = function(event) {
                if (data.previousValue !== null && event.ctrlKey && event.keyCode === 90) {
                    $this[0].value = data.previousValue;
                    data.previousValue = null;

                    event.preventDefault();
                }
            },

            /**
             * Автоматически прерывает запрос, если закрылось окно, в котором находится поле
             */
            bindAutoStop = function() {
                $this.closest('.ui-dialog').on('dialogclose', methods.stopGeneration);
            };

            if (methods[method]) {
                return methods[method].apply(this, Array.prototype.slice.call(args, 1));
            } else if (typeof method === 'object' || !method) {
                methods.init.apply(this, args);
                return this;
            }
        });
    }

    //Инициализируем каждый раз, когда на странице появляется новый контент
    $.contentReady(function () {
        $('[data-ai-button]', this).aiButton();
    });

})(jQuery);
/**
 * Jquery плагин, отвечающий за генерацию контента для textarea, которые связаны с TinyMCE
 *
 * @author ReadyScript lab.
 */
(function( $ ){

    $.fn.aiRichText = function( method ) {
        const defaults = {},
            args = arguments;

        return this.map(function() {
            let $this = $(this),
                data = $this.data('aiRichTextInstance'),
                params = $this.data('aiRichtext');

            const methods = {
                init: function (initOptions) {
                    if (data) return;
                    data = {};
                    $this.data('aiRichTextInstance', data);
                    data.opt = $.extend({}, defaults, initOptions);
                    bindAutoStop();
                },

                /**
                 * Выполняет запрос на генерацию значения для поля
                 *
                 * @param promptId
                 * @param force - всегда запускать
                 */
                startGeneration: async function(promptId, force) {
                    if (data['aiLoading'] ===  true) {
                        methods.stopGeneration();
                        if (!force) return;
                    }

                    return new Promise(async (resolve, reject) => {
                        let form = $this.closest('form');

                        if (!promptId) {
                            promptId = params['prompts'][0]['id'];
                        }

                        //data.$buttonGroup.addClass('loading');
                        data['aiLoading'] = true;
                        $this.trigger('aiStartLoading');

                        let url = global.ai.generateUrl + '&prompt_id=' + promptId;
                        let formData = new FormData(form[0]);

                        data.fetcher = new StreamFetcher();
                        data.fetcher.setStreamCallback((fulltext, jsonData, iteration) => {
                                if (iteration === 0) {
                                    $this.trigger('aiBeforeFirstSetValue');
                                    $this[0].value = '';
                                }

                                $this[0].value += jsonData.text;
                                $this.trigger('aiSetValue', [$this[0].value]);
                            })

                        data.fetcher.fetchStream(url, formData)
                            .then(object => {
                                resolve(object);
                            })
                            .catch(error => {
                                reject(error);
                            })
                            .finally(() => {
                                data['aiLoading'] = null;
                                $this.trigger('aiEndLoading');
                            });
                    });
                },

                /**
                 * Прерывает генерацию значения
                 */
                stopGeneration: function() {
                    if (data.fetcher) {
                        data.fetcher.getAbortController().abort('AbortError');
                    }
                }
            };

            //private
            const

            /**
             * Автоматически прерывает запрос, если закрылось окно, в котором находится поле
             */
            bindAutoStop = function() {
                $this.closest('.ui-dialog').on('dialogclose', methods.stopGeneration);
            };

            if (methods[method]) {
                return methods[method].apply(this, Array.prototype.slice.call(args, 1));
            } else if (typeof method === 'object' || !method) {
                methods.init.apply(this, args);
                return this;
            }
        });
    }

    //Инициализируем каждый раз, когда на странице появляется новый контент
    $.contentReady(function () {
        $('[data-ai-richtext]', this).aiRichText();
    });

})(jQuery);
/**
 * Jquery плагин, отвечающий за ИИ-кнопки возле главной формы в админке
 *
 * @author ReadyScript lab.
 */
(function( $ ){

    $.fn.aiMainButton = function( method ) {
        const defaults = {},
            args = arguments;

        return this.each(function() {
            let $this = $(this),
                data = $this.data('aiMainButtonInstance'),
                params;

            const methods = {
                init: function (initOptions) {
                    if (data) return;
                    data = {};
                    $this.data('aiMainButtonInstance', data);
                    data.opt = $.extend({}, defaults, initOptions);
                    params = $this.data('aiMainButton');

                    createButton();
                },
                /**
                 * Выполняет запрос на генерацию значения для поля
                 *
                 * @param promptId
                 */
                startGeneration: async function() {
                    if (data.$buttonGroup.hasClass('loading')) {
                        return methods.stopGeneration();
                    }

                    if ($this.val() === '') {
                        $.messenger('show', {
                            theme: 'error',
                            text: lang.t('Заполните поле `%field`, чтобы на основе него можно было сгенерировать остальные поля', {
                                field: params.main_field_title
                            })
                        });
                        return;
                    }

                    data.$buttonGroup.addClass('loading');

                    //Получаем список форм, для которых доступна генерация
                    let formsByField = getFormsByField();

                    //Последовательно запускаем эти формы
                    for(let n in params['generate_fields']) {
                        let promises = [];
                        for(let i in params['generate_fields'][n]) {
                            let field = params['generate_fields'][n][i];
                            if (formsByField[field].val() === '')
                            {
                                let promise;
                                if (formsByField[field].is('[data-ai-button]')) {
                                    promise = formsByField[field].aiButton('startGeneration', null, true).get(0);
                                }
                                if (formsByField[field].is('[data-ai-richtext]')) {
                                    let tinymce = $(formsByField[field]).tinymce();
                                    if (tinymce) {
                                        promise = tinymce.rs.startGeneration(tinymce.rs.aiGenerateApi, null, true);
                                    } else {
                                        //Если мы здесь, значит tinymce находится на отдельной вкладке и он не инициализирован
                                        //В этом случае мы запускаем генерацию для обычного
                                        promise = formsByField[field].aiRichText('startGeneration', null, true).get(0);
                                    }
                                }

                                promise.catch(() => {});

                                if (promise) {
                                    promises.push(promise);
                                }
                            }
                        }

                        try {
                            await Promise.all(promises);
                        } catch(error) {
                            break;
                        }
                    }

                    data.$buttonGroup.removeClass('loading');
                },

                /**
                 * Прерывает генерацию значения
                 */
                stopGeneration: function() {
                    data.$buttonGroup.removeClass('loading');

                    let form = data.$buttonGroup.closest('form');

                    //Получаем список форм, для которых доступна генерация
                    let formsByField = {};
                    $('[data-ai-button]', form)
                        .add($('[data-ai-richtext]', form))
                        .each((n, element) => {
                            let $element = $(element);
                            if ($element.is('[data-ai-button]')) {
                                $element.aiButton('stopGeneration')
                            }
                            if ($element.is('[data-ai-richtext]')) {
                                let tinymce = $element.tinymce();
                                tinymce.rs.stopGeneration();
                            }
                        });
                }
            };

            //private
            const
                /**
                 * Создает кнопку генерации текста с выпадающим списком
                 */
                createButton = function() {
                    let isMultiedit = $this.closest('.multi_edit_rightcol');
                    if (isMultiedit.length) return;
                    if (!Object.keys(getFormsByField()).length) return;

                    data.$buttonGroup = $(`<div class="btn-group ai-btn-group"></div>`);
                    data.$mainButton = $(`<button type="button" class="btn btn-default ai-gen main"></button>`)
                        .attr('title', lang.t('Заполнить пустые поля'))
                        .appendTo(data.$buttonGroup);

                    data.$buttonGroup.data('aiBaseField', $this);
                    $this
                        .wrap('<span class="form-wrapper"></span>')
                        .parent()
                        .append(data.$buttonGroup);
                    data.$buttonGroup.parent().trigger('new-content');

                    data.$mainButton.on('click', event => methods.startGeneration());
                },

                /**
                 * Возвращает список элементов, для которых доступна генерация
                 *
                 * @returns {{}}
                 */
                getFormsByField = function() {
                    let formsByField = {};

                    let form = $this.closest('form');
                    $('[data-ai-button]', form)
                        .add($('[data-ai-richtext]', form))
                        .each((n, element) => {
                            let $element = $(element);
                            if ($element.is('[data-ai-button]') && $element.data('aiButton').prompts.length) {
                                formsByField[$element.data('aiButton').field_name] = $element;
                            }
                            if ($element.is('[data-ai-richtext]') && $element.data('aiRichtext').prompts.length) {
                                formsByField[$element.data('aiRichtext').field_name] = $element;
                            }
                        });

                    return formsByField;
                }

            if (methods[method]) {
                methods[method].apply(this, Array.prototype.slice.call(args, 1));
            } else if (typeof method === 'object' || !method) {
                return methods.init.apply(this, args);
            }
        });
    }

    //Инициализируем каждый раз, когда на странице появляется новый контент
    $.contentReady(function () {
        $('[data-ai-main-button]', this).aiMainButton();
    });

})(jQuery);
/**
 * AI Assistant ReadyScript v1.0.0
 * Author: ReadyScript lab.
 * License: https://readyscript.ru/licenseAgreement/
 */

function e(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}const t={},n=[],o=()=>{},i=()=>!1,s=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),r=e=>e.startsWith("onUpdate:"),l=Object.assign,a=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},c=Object.prototype.hasOwnProperty,u=(e,t)=>c.call(e,t),d=Array.isArray,p=e=>"[object Map]"===b(e),h=e=>"[object Set]"===b(e),f=e=>"function"==typeof e,g=e=>"string"==typeof e,m=e=>"symbol"==typeof e,v=e=>null!==e&&"object"==typeof e,y=e=>(v(e)||f(e))&&f(e.then)&&f(e.catch),w=Object.prototype.toString,b=e=>w.call(e),C=e=>"[object Object]"===b(e),x=e=>g(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,S=e(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),k=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},T=/-(\w)/g,L=k((e=>e.replace(T,((e,t)=>t?t.toUpperCase():"")))),P=/\B([A-Z])/g,O=k((e=>e.replace(P,"-$1").toLowerCase())),M=k((e=>e.charAt(0).toUpperCase()+e.slice(1))),A=k((e=>e?`on${M(e)}`:"")),E=(e,t)=>!Object.is(e,t),D=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},R=(e,t,n,o=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:o,value:n})},H=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let j;const z=()=>j||(j="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function B(e){if(d(e)){const t={};for(let n=0;n<e.length;n++){const o=e[n],i=g(o)?I(o):B(o);if(i)for(const e in i)t[e]=i[e]}return t}if(g(e)||v(e))return e}const N=/;(?![^(]*\))/g,F=/:([^]+)/,V=/\/\*[^]*?\*\//g;function I(e){const t={};return e.replace(V,"").split(N).forEach((e=>{if(e){const n=e.split(F);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function U(e){let t="";if(g(e))t=e;else if(d(e))for(let n=0;n<e.length;n++){const o=U(e[n]);o&&(t+=o+" ")}else if(v(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function W(e){if(!e)return null;let{class:t,style:n}=e;return t&&!g(t)&&(e.class=U(t)),n&&(e.style=B(n)),e}const Z=e("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function q(e){return!!e||""===e}const G=e=>!(!e||!0!==e.__v_isRef),Y=e=>g(e)?e:null==e?"":d(e)||v(e)&&(e.toString===w||!f(e.toString))?G(e)?Y(e.value):JSON.stringify(e,K,2):String(e),K=(e,t)=>G(t)?K(e,t.value):p(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n],o)=>(e[X(t,o)+" =>"]=n,e)),{})}:h(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>X(e)))}:m(t)?X(t):!v(t)||d(t)||C(t)?t:String(t),X=(e,t="")=>{var n;return m(e)?`Symbol(${null!=(n=e.description)?n:t})`:e};let Q,J;class ee{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Q,!e&&Q&&(this.index=(Q.scopes||(Q.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let e,t;if(this._isPaused=!0,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){let e,t;if(this._isPaused=!1,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Q;try{return Q=this,e()}finally{Q=t}}}on(){1===++this._on&&(this.prevScope=Q,Q=this)}off(){this._on>0&&0===--this._on&&(Q=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){let t,n;for(this._active=!1,t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}}const te=new WeakSet;class ne{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Q&&Q.active&&Q.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,te.has(this)&&(te.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||re(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,we(this),ce(this);const e=J,t=ge;J=this,ge=!0;try{return this.fn()}finally{ue(this),J=e,ge=t,this.flags&=-3}}stop(){if(1&this.flags){for(let e=this.deps;e;e=e.nextDep)he(e);this.deps=this.depsTail=void 0,we(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?te.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){de(this)&&this.run()}get dirty(){return de(this)}}let oe,ie,se=0;function re(e,t=!1){if(e.flags|=8,t)return e.next=ie,void(ie=e);e.next=oe,oe=e}function le(){se++}function ae(){if(--se>0)return;if(ie){let e=ie;for(ie=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;oe;){let n=oe;for(oe=void 0;n;){const o=n.next;if(n.next=void 0,n.flags&=-9,1&n.flags)try{n.trigger()}catch(t){e||(e=t)}n=o}}if(e)throw e}function ce(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function ue(e){let t,n=e.depsTail,o=n;for(;o;){const e=o.prevDep;-1===o.version?(o===n&&(n=e),he(o),fe(o)):t=o,o.dep.activeLink=o.prevActiveLink,o.prevActiveLink=void 0,o=e}e.deps=t,e.depsTail=n}function de(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(pe(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function pe(e){if(4&e.flags&&!(16&e.flags))return;if(e.flags&=-17,e.globalVersion===be)return;if(e.globalVersion=be,!e.isSSR&&128&e.flags&&(!e.deps&&!e._dirty||!de(e)))return;e.flags|=2;const t=e.dep,n=J,o=ge;J=e,ge=!0;try{ce(e);const n=e.fn(e._value);(0===t.version||E(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(i){throw t.version++,i}finally{J=n,ge=o,ue(e),e.flags&=-3}}function he(e,t=!1){const{dep:n,prevSub:o,nextSub:i}=e;if(o&&(o.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=o,e.nextSub=void 0),n.subs===e&&(n.subs=o,!o&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)he(e,!0)}t||--n.sc||!n.map||n.map.delete(n.key)}function fe(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let ge=!0;const me=[];function ve(){me.push(ge),ge=!1}function ye(){const e=me.pop();ge=void 0===e||e}function we(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const e=J;J=void 0;try{t()}finally{J=e}}}let be=0;class _e{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ce{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!J||!ge||J===this.computed)return;let t=this.activeLink;if(void 0===t||t.sub!==J)t=this.activeLink=new _e(J,this),J.deps?(t.prevDep=J.depsTail,J.depsTail.nextDep=t,J.depsTail=t):J.deps=J.depsTail=t,xe(t);else if(-1===t.version&&(t.version=this.version,t.nextDep)){const e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=J.depsTail,t.nextDep=void 0,J.depsTail.nextDep=t,J.depsTail=t,J.deps===t&&(J.deps=e)}return t}trigger(e){this.version++,be++,this.notify(e)}notify(e){le();try{0;for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{ae()}}}function xe(e){if(e.dep.sc++,4&e.sub.flags){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)xe(e)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Se=new WeakMap,ke=Symbol(""),Te=Symbol(""),$e=Symbol("");function Le(e,t,n){if(ge&&J){let t=Se.get(e);t||Se.set(e,t=new Map);let o=t.get(n);o||(t.set(n,o=new Ce),o.map=t,o.key=n),o.track()}}function Pe(e,t,n,o,i,s){const r=Se.get(e);if(!r)return void be++;const l=e=>{e&&e.trigger()};if(le(),"clear"===t)r.forEach(l);else{const i=d(e),s=i&&x(n);if(i&&"length"===n){const e=Number(o);r.forEach(((t,n)=>{("length"===n||n===$e||!m(n)&&n>=e)&&l(t)}))}else switch((void 0!==n||r.has(void 0))&&l(r.get(n)),s&&l(r.get($e)),t){case"add":i?s&&l(r.get("length")):(l(r.get(ke)),p(e)&&l(r.get(Te)));break;case"delete":i||(l(r.get(ke)),p(e)&&l(r.get(Te)));break;case"set":p(e)&&l(r.get(ke))}}ae()}function Oe(e){const t=ft(e);return t===e?t:(Le(t,0,$e),pt(e)?t:t.map(gt))}function Me(e){return Le(e=ft(e),0,$e),e}const Ae={__proto__:null,[Symbol.iterator](){return Ee(this,Symbol.iterator,gt)},concat(...e){return Oe(this).concat(...e.map((e=>d(e)?Oe(e):e)))},entries(){return Ee(this,"entries",(e=>(e[1]=gt(e[1]),e)))},every(e,t){return Re(this,"every",e,t,void 0,arguments)},filter(e,t){return Re(this,"filter",e,t,(e=>e.map(gt)),arguments)},find(e,t){return Re(this,"find",e,t,gt,arguments)},findIndex(e,t){return Re(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Re(this,"findLast",e,t,gt,arguments)},findLastIndex(e,t){return Re(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Re(this,"forEach",e,t,void 0,arguments)},includes(...e){return je(this,"includes",e)},indexOf(...e){return je(this,"indexOf",e)},join(e){return Oe(this).join(e)},lastIndexOf(...e){return je(this,"lastIndexOf",e)},map(e,t){return Re(this,"map",e,t,void 0,arguments)},pop(){return ze(this,"pop")},push(...e){return ze(this,"push",e)},reduce(e,...t){return He(this,"reduce",e,t)},reduceRight(e,...t){return He(this,"reduceRight",e,t)},shift(){return ze(this,"shift")},some(e,t){return Re(this,"some",e,t,void 0,arguments)},splice(...e){return ze(this,"splice",e)},toReversed(){return Oe(this).toReversed()},toSorted(e){return Oe(this).toSorted(e)},toSpliced(...e){return Oe(this).toSpliced(...e)},unshift(...e){return ze(this,"unshift",e)},values(){return Ee(this,"values",gt)}};function Ee(e,t,n){const o=Me(e),i=o[t]();return o===e||pt(e)||(i._next=i.next,i.next=()=>{const e=i._next();return e.value&&(e.value=n(e.value)),e}),i}const De=Array.prototype;function Re(e,t,n,o,i,s){const r=Me(e),l=r!==e&&!pt(e),a=r[t];if(a!==De[t]){const t=a.apply(e,s);return l?gt(t):t}let c=n;r!==e&&(l?c=function(t,o){return n.call(this,gt(t),o,e)}:n.length>2&&(c=function(t,o){return n.call(this,t,o,e)}));const u=a.call(r,c,o);return l&&i?i(u):u}function He(e,t,n,o){const i=Me(e);let s=n;return i!==e&&(pt(e)?n.length>3&&(s=function(t,o,i){return n.call(this,t,o,i,e)}):s=function(t,o,i){return n.call(this,t,gt(o),i,e)}),i[t](s,...o)}function je(e,t,n){const o=ft(e);Le(o,0,$e);const i=o[t](...n);return-1!==i&&!1!==i||!ht(n[0])?i:(n[0]=ft(n[0]),o[t](...n))}function ze(e,t,n=[]){ve(),le();const o=ft(e)[t].apply(e,n);return ae(),ye(),o}const Be=e("__proto__,__v_isRef,__isVue"),Ne=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(m));function Fe(e){m(e)||(e=String(e));const t=ft(this);return Le(t,0,e),t.hasOwnProperty(e)}class Ve{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if("__v_skip"===t)return e.__v_skip;const o=this._isReadonly,i=this._isShallow;if("__v_isReactive"===t)return!o;if("__v_isReadonly"===t)return o;if("__v_isShallow"===t)return i;if("__v_raw"===t)return n===(o?i?st:it:i?ot:nt).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const s=d(e);if(!o){let e;if(s&&(e=Ae[t]))return e;if("hasOwnProperty"===t)return Fe}const r=Reflect.get(e,t,vt(e)?e:n);return(m(t)?Ne.has(t):Be(t))?r:(o||Le(e,0,t),i?r:vt(r)?s&&x(t)?r:r.value:v(r)?o?at(r):lt(r):r)}}class Ie extends Ve{constructor(e=!1){super(!1,e)}set(e,t,n,o){let i=e[t];if(!this._isShallow){const t=dt(i);if(pt(n)||dt(n)||(i=ft(i),n=ft(n)),!d(e)&&vt(i)&&!vt(n))return!t&&(i.value=n,!0)}const s=d(e)&&x(t)?Number(t)<e.length:u(e,t),r=Reflect.set(e,t,n,vt(e)?e:o);return e===ft(o)&&(s?E(n,i)&&Pe(e,"set",t,n):Pe(e,"add",t,n)),r}deleteProperty(e,t){const n=u(e,t);e[t];const o=Reflect.deleteProperty(e,t);return o&&n&&Pe(e,"delete",t,void 0),o}has(e,t){const n=Reflect.has(e,t);return m(t)&&Ne.has(t)||Le(e,0,t),n}ownKeys(e){return Le(e,0,d(e)?"length":ke),Reflect.ownKeys(e)}}class Ue extends Ve{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const We=new Ie,Ze=new Ue,qe=new Ie(!0),Ge=e=>e,Ye=e=>Reflect.getPrototypeOf(e);function Ke(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function Xe(e,t){const n={get(n){const o=this.__v_raw,i=ft(o),s=ft(n);e||(E(n,s)&&Le(i,0,n),Le(i,0,s));const{has:r}=Ye(i),l=t?Ge:e?mt:gt;return r.call(i,n)?l(o.get(n)):r.call(i,s)?l(o.get(s)):void(o!==i&&o.get(n))},get size(){const t=this.__v_raw;return!e&&Le(ft(t),0,ke),Reflect.get(t,"size",t)},has(t){const n=this.__v_raw,o=ft(n),i=ft(t);return e||(E(t,i)&&Le(o,0,t),Le(o,0,i)),t===i?n.has(t):n.has(t)||n.has(i)},forEach(n,o){const i=this,s=i.__v_raw,r=ft(s),l=t?Ge:e?mt:gt;return!e&&Le(r,0,ke),s.forEach(((e,t)=>n.call(o,l(e),l(t),i)))}};l(n,e?{add:Ke("add"),set:Ke("set"),delete:Ke("delete"),clear:Ke("clear")}:{add(e){t||pt(e)||dt(e)||(e=ft(e));const n=ft(this);return Ye(n).has.call(n,e)||(n.add(e),Pe(n,"add",e,e)),this},set(e,n){t||pt(n)||dt(n)||(n=ft(n));const o=ft(this),{has:i,get:s}=Ye(o);let r=i.call(o,e);r||(e=ft(e),r=i.call(o,e));const l=s.call(o,e);return o.set(e,n),r?E(n,l)&&Pe(o,"set",e,n):Pe(o,"add",e,n),this},delete(e){const t=ft(this),{has:n,get:o}=Ye(t);let i=n.call(t,e);i||(e=ft(e),i=n.call(t,e)),o&&o.call(t,e);const s=t.delete(e);return i&&Pe(t,"delete",e,void 0),s},clear(){const e=ft(this),t=0!==e.size,n=e.clear();return t&&Pe(e,"clear",void 0,void 0),n}});return["keys","values","entries",Symbol.iterator].forEach((o=>{n[o]=function(e,t,n){return function(...o){const i=this.__v_raw,s=ft(i),r=p(s),l="entries"===e||e===Symbol.iterator&&r,a="keys"===e&&r,c=i[e](...o),u=n?Ge:t?mt:gt;return!t&&Le(s,0,a?Te:ke),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:l?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}(o,e,t)})),n}function Qe(e,t){const n=Xe(e,t);return(t,o,i)=>"__v_isReactive"===o?!e:"__v_isReadonly"===o?e:"__v_raw"===o?t:Reflect.get(u(n,o)&&o in t?n:t,o,i)}const Je={get:Qe(!1,!1)},et={get:Qe(!1,!0)},tt={get:Qe(!0,!1)},nt=new WeakMap,ot=new WeakMap,it=new WeakMap,st=new WeakMap;function rt(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((e=>b(e).slice(8,-1))(e))}function lt(e){return dt(e)?e:ct(e,!1,We,Je,nt)}function at(e){return ct(e,!0,Ze,tt,it)}function ct(e,t,n,o,i){if(!v(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const s=rt(e);if(0===s)return e;const r=i.get(e);if(r)return r;const l=new Proxy(e,2===s?o:n);return i.set(e,l),l}function ut(e){return dt(e)?ut(e.__v_raw):!(!e||!e.__v_isReactive)}function dt(e){return!(!e||!e.__v_isReadonly)}function pt(e){return!(!e||!e.__v_isShallow)}function ht(e){return!!e&&!!e.__v_raw}function ft(e){const t=e&&e.__v_raw;return t?ft(t):e}const gt=e=>v(e)?lt(e):e,mt=e=>v(e)?at(e):e;function vt(e){return!!e&&!0===e.__v_isRef}function yt(e){return function(e,t){if(vt(e))return e;return new wt(e,t)}(e,!1)}class wt{constructor(e,t){this.dep=new Ce,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:ft(e),this._value=t?e:gt(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||pt(e)||dt(e);e=n?e:ft(e),E(e,t)&&(this._rawValue=e,this._value=n?e:gt(e),this.dep.trigger())}}const bt={get:(e,t,n)=>{return"__v_raw"===t?e:vt(o=Reflect.get(e,t,n))?o.value:o;var o},set:(e,t,n,o)=>{const i=e[t];return vt(i)&&!vt(n)?(i.value=n,!0):Reflect.set(e,t,n,o)}};function _t(e){return ut(e)?e:new Proxy(e,bt)}class Ct{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Ce(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=be-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(8&this.flags)&&J!==this)return re(this,!0),!0}get value(){const e=this.dep.track();return pe(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}const xt={},St=new WeakMap;let kt;function Tt(e,n,i=t){const{immediate:s,deep:r,once:l,scheduler:c,augmentJob:u,call:p}=i,h=e=>r?e:pt(e)||!1===r||0===r?$t(e,1):$t(e);let g,m,v,y,w=!1,b=!1;if(vt(e)?(m=()=>e.value,w=pt(e)):ut(e)?(m=()=>h(e),w=!0):d(e)?(b=!0,w=e.some((e=>ut(e)||pt(e))),m=()=>e.map((e=>vt(e)?e.value:ut(e)?h(e):f(e)?p?p(e,2):e():void 0))):m=f(e)?n?p?()=>p(e,2):e:()=>{if(v){ve();try{v()}finally{ye()}}const t=kt;kt=g;try{return p?p(e,3,[y]):e(y)}finally{kt=t}}:o,n&&r){const e=m,t=!0===r?1/0:r;m=()=>$t(e(),t)}const C=Q,x=()=>{g.stop(),C&&C.active&&a(C.effects,g)};if(l&&n){const e=n;n=(...t)=>{e(...t),x()}}let S=b?new Array(e.length).fill(xt):xt;const k=e=>{if(1&g.flags&&(g.dirty||e))if(n){const e=g.run();if(r||w||(b?e.some(((e,t)=>E(e,S[t]))):E(e,S))){v&&v();const t=kt;kt=g;try{const t=[e,S===xt?void 0:b&&S[0]===xt?[]:S,y];p?p(n,3,t):n(...t),S=e}finally{kt=t}}}else g.run()};return u&&u(k),g=new ne(m),g.scheduler=c?()=>c(k,!1):k,y=e=>function(e,t=!1,n=kt){if(n){let t=St.get(n);t||St.set(n,t=[]),t.push(e)}}(e,!1,g),v=g.onStop=()=>{const e=St.get(g);if(e){if(p)p(e,4);else for(const t of e)t();St.delete(g)}},n?s?k(!0):S=g.run():c?c(k.bind(null,!0),!0):g.run(),x.pause=g.pause.bind(g),x.resume=g.resume.bind(g),x.stop=x,x}function $t(e,t=1/0,n){if(t<=0||!v(e)||e.__v_skip)return e;if((n=n||new Set).has(e))return e;if(n.add(e),t--,vt(e))$t(e.value,t,n);else if(d(e))for(let o=0;o<e.length;o++)$t(e[o],t,n);else if(h(e)||p(e))e.forEach((e=>{$t(e,t,n)}));else if(C(e)){for(const o in e)$t(e[o],t,n);for(const o of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,o)&&$t(e[o],t,n)}return e}function Lt(e,t,n,o){try{return o?e(...o):e()}catch(i){Ot(i,t,n)}}function Pt(e,t,n,o){if(f(e)){const i=Lt(e,t,n,o);return i&&y(i)&&i.catch((e=>{Ot(e,t,n)})),i}if(d(e)){const i=[];for(let s=0;s<e.length;s++)i.push(Pt(e[s],t,n,o));return i}}function Ot(e,n,o,i=!0){n&&n.vnode;const{errorHandler:s,throwUnhandledErrorInProduction:r}=n&&n.appContext.config||t;if(n){let t=n.parent;const i=n.proxy,r=`https://vuejs.org/error-reference/#runtime-${o}`;for(;t;){const n=t.ec;if(n)for(let t=0;t<n.length;t++)if(!1===n[t](e,i,r))return;t=t.parent}if(s)return ve(),Lt(s,null,10,[e,i,r]),void ye()}!function(e,t,n,o=!0,i=!1){if(i)throw e;console.error(e)}(e,0,0,i,r)}const Mt=[];let At=-1;const Et=[];let Dt=null,Rt=0;const Ht=Promise.resolve();let jt=null;function zt(e){const t=jt||Ht;return e?t.then(this?e.bind(this):e):t}function Bt(e){if(!(1&e.flags)){const t=It(e),n=Mt[Mt.length-1];!n||!(2&e.flags)&&t>=It(n)?Mt.push(e):Mt.splice(function(e){let t=At+1,n=Mt.length;for(;t<n;){const o=t+n>>>1,i=Mt[o],s=It(i);s<e||s===e&&2&i.flags?t=o+1:n=o}return t}(t),0,e),e.flags|=1,Nt()}}function Nt(){jt||(jt=Ht.then(Ut))}function Ft(e,t,n=At+1){for(;n<Mt.length;n++){const t=Mt[n];if(t&&2&t.flags){if(e&&t.id!==e.uid)continue;Mt.splice(n,1),n--,4&t.flags&&(t.flags&=-2),t(),4&t.flags||(t.flags&=-2)}}}function Vt(e){if(Et.length){const e=[...new Set(Et)].sort(((e,t)=>It(e)-It(t)));if(Et.length=0,Dt)return void Dt.push(...e);for(Dt=e,Rt=0;Rt<Dt.length;Rt++){const e=Dt[Rt];4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2}Dt=null,Rt=0}}const It=e=>null==e.id?2&e.flags?-1:1/0:e.id;function Ut(e){try{for(At=0;At<Mt.length;At++){const e=Mt[At];!e||8&e.flags||(4&e.flags&&(e.flags&=-2),Lt(e,e.i,e.i?15:14),4&e.flags||(e.flags&=-2))}}finally{for(;At<Mt.length;At++){const e=Mt[At];e&&(e.flags&=-2)}At=-1,Mt.length=0,Vt(),jt=null,(Mt.length||Et.length)&&Ut()}}let Wt=null,Zt=null;function qt(e){const t=Wt;return Wt=e,Zt=e&&e.type.__scopeId||null,t}const Gt=e=>Yt;function Yt(e,t=Wt,n){if(!t)return e;if(e._n)return e;const o=(...n)=>{o._d&&Wo(-1);const i=qt(t);let s;try{s=e(...n)}finally{qt(i),o._d&&Wo(1)}return s};return o._n=!0,o._c=!0,o._d=!0,o}function Kt(e,n){if(null===Wt)return e;const o=xi(Wt),i=e.dirs||(e.dirs=[]);for(let s=0;s<n.length;s++){let[e,r,l,a=t]=n[s];e&&(f(e)&&(e={mounted:e,updated:e}),e.deep&&$t(r),i.push({dir:e,instance:o,value:r,oldValue:void 0,arg:l,modifiers:a}))}return e}function Xt(e,t,n,o){const i=e.dirs,s=t&&t.dirs;for(let r=0;r<i.length;r++){const l=i[r];s&&(l.oldValue=s[r].value);let a=l.dir[o];a&&(ve(),Pt(a,n,8,[e.el,l,e,t]),ye())}}const Qt=Symbol("_vte");function Jt(e,t){6&e.shapeFlag&&e.component?(e.transition=t,Jt(e.component.subTree,t)):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function en(e,t){return f(e)?(()=>l({name:e.name},t,{setup:e}))():e}function tn(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function nn(e,n,o,i,s=!1){if(d(e))return void e.forEach(((e,t)=>nn(e,n&&(d(n)?n[t]:n),o,i,s)));if(on(i)&&!s)return void(512&i.shapeFlag&&i.type.__asyncResolved&&i.component.subTree.component&&nn(e,n,o,i.component.subTree));const r=4&i.shapeFlag?xi(i.component):i.el,l=s?null:r,{i:c,r:p}=e,h=n&&n.r,m=c.refs===t?c.refs={}:c.refs,v=c.setupState,y=ft(v),w=v===t?()=>!1:e=>u(y,e);if(null!=h&&h!==p&&(g(h)?(m[h]=null,w(h)&&(v[h]=null)):vt(h)&&(h.value=null)),f(p))Lt(p,c,12,[l,m]);else{const t=g(p),n=vt(p);if(t||n){const i=()=>{if(e.f){const n=t?w(p)?v[p]:m[p]:p.value;s?d(n)&&a(n,r):d(n)?n.includes(r)||n.push(r):t?(m[p]=[r],w(p)&&(v[p]=m[p])):(p.value=[r],e.k&&(m[e.k]=p.value))}else t?(m[p]=l,w(p)&&(v[p]=l)):n&&(p.value=l,e.k&&(m[e.k]=l))};l?(i.id=-1,go(i,o)):i()}}}z().requestIdleCallback,z().cancelIdleCallback;const on=e=>!!e.type.__asyncLoader,sn=e=>e.type.__isKeepAlive;function rn(e,t){an(e,"a",t)}function ln(e,t){an(e,"da",t)}function an(e,t,n=gi){const o=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(un(t,o,n),n){let e=n.parent;for(;e&&e.parent;)sn(e.parent.vnode)&&cn(o,t,n,e),e=e.parent}}function cn(e,t,n,o){const i=un(t,e,o,!0);vn((()=>{a(o[t],i)}),n)}function un(e,t,n=gi,o=!1){if(n){const i=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...o)=>{ve();const i=mi(n),s=Pt(t,n,e,o);return i(),ye(),s});return o?i.unshift(s):i.push(s),s}}const dn=e=>(t,n=gi)=>{wi&&"sp"!==e||un(e,((...e)=>t(...e)),n)},pn=dn("bm"),hn=dn("m"),fn=dn("bu"),gn=dn("u"),mn=dn("bum"),vn=dn("um"),yn=dn("sp"),wn=dn("rtg"),bn=dn("rtc");function _n(e,t=gi){un("ec",e,t)}const Cn="components";function xn(e,t){return Tn(Cn,e,!0,t)||e}const Sn=Symbol.for("v-ndc");function kn(e){return Tn("directives",e)}function Tn(e,t,n=!0,o=!1){const i=Wt||gi;if(i){const n=i.type;if(e===Cn){const e=Si(n,!1);if(e&&(e===t||e===L(t)||e===M(L(t))))return n}const s=$n(i[e]||n[e],t)||$n(i.appContext[e],t);return!s&&o?n:s}}function $n(e,t){return e&&(e[t]||e[L(t)]||e[M(L(t))])}function Ln(e,t,n,o){let i;const s=n,r=d(e);if(r||g(e)){let n=!1,o=!1;r&&ut(e)&&(n=!pt(e),o=dt(e),e=Me(e)),i=new Array(e.length);for(let r=0,l=e.length;r<l;r++)i[r]=t(n?o?mt(gt(e[r])):gt(e[r]):e[r],r,void 0,s)}else if("number"==typeof e){i=new Array(e);for(let n=0;n<e;n++)i[n]=t(n+1,n,void 0,s)}else if(v(e))if(e[Symbol.iterator])i=Array.from(e,((e,n)=>t(e,n,void 0,s)));else{const n=Object.keys(e);i=new Array(n.length);for(let o=0,r=n.length;o<r;o++){const r=n[o];i[o]=t(e[r],r,o,s)}}else i=[];return i}function Pn(e,t,n={},o,i){if(Wt.ce||Wt.parent&&on(Wt.parent)&&Wt.parent.ce)return"default"!==t&&(n.name=t),Io(),Go(jo,null,[ei("slot",n,o)],64);let s=e[t];s&&s._c&&(s._d=!1),Io();const r=s&&On(s(n)),l=n.key||r&&r.key,a=Go(jo,{key:(l&&!m(l)?l:`_${t}`)+""},r||[],r&&1===e._?64:-2);return a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function On(e){return e.some((e=>!Yo(e)||e.type!==Bo&&!(e.type===jo&&!On(e.children))))?e:null}const Mn=e=>e?yi(e)?xi(e):Mn(e.parent):null,An=l(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Mn(e.parent),$root:e=>Mn(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Nn(e),$forceUpdate:e=>e.f||(e.f=()=>{Bt(e.update)}),$nextTick:e=>e.n||(e.n=zt.bind(e.proxy)),$watch:e=>To.bind(e)}),En=(e,n)=>e!==t&&!e.__isScriptSetup&&u(e,n),Dn={get({_:e},n){if("__v_skip"===n)return!0;const{ctx:o,setupState:i,data:s,props:r,accessCache:l,type:a,appContext:c}=e;let d;if("$"!==n[0]){const a=l[n];if(void 0!==a)switch(a){case 1:return i[n];case 2:return s[n];case 4:return o[n];case 3:return r[n]}else{if(En(i,n))return l[n]=1,i[n];if(s!==t&&u(s,n))return l[n]=2,s[n];if((d=e.propsOptions[0])&&u(d,n))return l[n]=3,r[n];if(o!==t&&u(o,n))return l[n]=4,o[n];Hn&&(l[n]=0)}}const p=An[n];let h,f;return p?("$attrs"===n&&Le(e.attrs,0,""),p(e)):(h=a.__cssModules)&&(h=h[n])?h:o!==t&&u(o,n)?(l[n]=4,o[n]):(f=c.config.globalProperties,u(f,n)?f[n]:void 0)},set({_:e},n,o){const{data:i,setupState:s,ctx:r}=e;return En(s,n)?(s[n]=o,!0):i!==t&&u(i,n)?(i[n]=o,!0):!u(e.props,n)&&(("$"!==n[0]||!(n.slice(1)in e))&&(r[n]=o,!0))},has({_:{data:e,setupState:n,accessCache:o,ctx:i,appContext:s,propsOptions:r}},l){let a;return!!o[l]||e!==t&&u(e,l)||En(n,l)||(a=r[0])&&u(a,l)||u(i,l)||u(An,l)||u(s.config.globalProperties,l)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:u(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function Rn(e){return d(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let Hn=!0;function jn(e){const t=Nn(e),n=e.proxy,i=e.ctx;Hn=!1,t.beforeCreate&&zn(t.beforeCreate,e,"bc");const{data:s,computed:r,methods:l,watch:a,provide:c,inject:u,created:p,beforeMount:h,mounted:g,beforeUpdate:m,updated:y,activated:w,deactivated:b,beforeDestroy:C,beforeUnmount:x,destroyed:S,unmounted:k,render:T,renderTracked:L,renderTriggered:P,errorCaptured:O,serverPrefetch:M,expose:A,inheritAttrs:E,components:D,directives:R,filters:H}=t;if(u&&function(e,t){d(e)&&(e=Un(e));for(const n in e){const o=e[n];let i;i=v(o)?"default"in o?Qn(o.from||n,o.default,!0):Qn(o.from||n):Qn(o),vt(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e}):t[n]=i}}(u,i,null),l)for(const o in l){const e=l[o];f(e)&&(i[o]=e.bind(n))}if(s){const t=s.call(n,n);v(t)&&(e.data=lt(t))}if(Hn=!0,r)for(const d in r){const e=r[d],t=f(e)?e.bind(n,n):f(e.get)?e.get.bind(n,n):o,s=!f(e)&&f(e.set)?e.set.bind(n):o,l=ki({get:t,set:s});Object.defineProperty(i,d,{enumerable:!0,configurable:!0,get:()=>l.value,set:e=>l.value=e})}if(a)for(const o in a)Bn(a[o],i,n,o);if(c){const e=f(c)?c.call(n):c;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(gi){let n=gi.provides;const o=gi.parent&&gi.parent.provides;o===n&&(n=gi.provides=Object.create(o)),n[e]=t}else;}(t,e[t])}))}function j(e,t){d(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(p&&zn(p,e,"c"),j(pn,h),j(hn,g),j(fn,m),j(gn,y),j(rn,w),j(ln,b),j(_n,O),j(bn,L),j(wn,P),j(mn,x),j(vn,k),j(yn,M),d(A))if(A.length){const t=e.exposed||(e.exposed={});A.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});T&&e.render===o&&(e.render=T),null!=E&&(e.inheritAttrs=E),D&&(e.components=D),R&&(e.directives=R),M&&tn(e)}function zn(e,t,n){Pt(d(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Bn(e,t,n,o){let i=o.includes(".")?$o(n,o):()=>n[o];if(g(e)){const n=t[e];f(n)&&So(i,n)}else if(f(e))So(i,e.bind(n));else if(v(e))if(d(e))e.forEach((e=>Bn(e,t,n,o)));else{const o=f(e.handler)?e.handler.bind(n):t[e.handler];f(o)&&So(i,o,e)}}function Nn(e){const t=e.type,{mixins:n,extends:o}=t,{mixins:i,optionsCache:s,config:{optionMergeStrategies:r}}=e.appContext,l=s.get(t);let a;return l?a=l:i.length||n||o?(a={},i.length&&i.forEach((e=>Fn(a,e,r,!0))),Fn(a,t,r)):a=t,v(t)&&s.set(t,a),a}function Fn(e,t,n,o=!1){const{mixins:i,extends:s}=t;s&&Fn(e,s,n,!0),i&&i.forEach((t=>Fn(e,t,n,!0)));for(const r in t)if(o&&"expose"===r);else{const o=Vn[r]||n&&n[r];e[r]=o?o(e[r],t[r]):t[r]}return e}const Vn={data:In,props:qn,emits:qn,methods:Zn,computed:Zn,beforeCreate:Wn,created:Wn,beforeMount:Wn,mounted:Wn,beforeUpdate:Wn,updated:Wn,beforeDestroy:Wn,beforeUnmount:Wn,destroyed:Wn,unmounted:Wn,activated:Wn,deactivated:Wn,errorCaptured:Wn,serverPrefetch:Wn,components:Zn,directives:Zn,watch:function(e,t){if(!e)return t;if(!t)return e;const n=l(Object.create(null),e);for(const o in t)n[o]=Wn(e[o],t[o]);return n},provide:In,inject:function(e,t){return Zn(Un(e),Un(t))}};function In(e,t){return t?e?function(){return l(f(e)?e.call(this,this):e,f(t)?t.call(this,this):t)}:t:e}function Un(e){if(d(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Wn(e,t){return e?[...new Set([].concat(e,t))]:t}function Zn(e,t){return e?l(Object.create(null),e,t):t}function qn(e,t){return e?d(e)&&d(t)?[...new Set([...e,...t])]:l(Object.create(null),Rn(e),Rn(null!=t?t:{})):t}function Gn(){return{app:null,config:{isNativeTag:i,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Yn=0;function Kn(e,t){return function(t,n=null){f(t)||(t=l({},t)),null==n||v(n)||(n=null);const o=Gn(),i=new WeakSet,s=[];let r=!1;const a=o.app={_uid:Yn++,_component:t,_props:n,_container:null,_context:o,_instance:null,version:Ti,get config(){return o.config},set config(e){},use:(e,...t)=>(i.has(e)||(e&&f(e.install)?(i.add(e),e.install(a,...t)):f(e)&&(i.add(e),e(a,...t))),a),mixin:e=>(o.mixins.includes(e)||o.mixins.push(e),a),component:(e,t)=>t?(o.components[e]=t,a):o.components[e],directive:(e,t)=>t?(o.directives[e]=t,a):o.directives[e],mount(i,s,l){if(!r){const s=a._ceVNode||ei(t,n);return s.appContext=o,!0===l?l="svg":!1===l&&(l=void 0),e(s,i,l),r=!0,a._container=i,i.__vue_app__=a,xi(s.component)}},onUnmount(e){s.push(e)},unmount(){r&&(Pt(s,a._instance,16),e(null,a._container),delete a._container.__vue_app__)},provide:(e,t)=>(o.provides[e]=t,a),runWithContext(e){const t=Xn;Xn=a;try{return e()}finally{Xn=t}}};return a}}let Xn=null;function Qn(e,t,n=!1){const o=gi||Wt;if(o||Xn){const i=Xn?Xn._context.provides:o?null==o.parent?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return n&&f(t)?t.call(o&&o.proxy):t}}const Jn={},eo=()=>Object.create(Jn),to=e=>Object.getPrototypeOf(e)===Jn;function no(e,t,n,o=!1){const i={},s=eo();e.propsDefaults=Object.create(null),oo(e,t,i,s);for(const r in e.propsOptions[0])r in i||(i[r]=void 0);n?e.props=o?i:ct(i,!1,qe,et,ot):e.type.props?e.props=i:e.props=s,e.attrs=s}function oo(e,n,o,i){const[s,r]=e.propsOptions;let l,a=!1;if(n)for(let t in n){if(S(t))continue;const c=n[t];let d;s&&u(s,d=L(t))?r&&r.includes(d)?(l||(l={}))[d]=c:o[d]=c:Mo(e.emitsOptions,t)||t in i&&c===i[t]||(i[t]=c,a=!0)}if(r){const n=ft(o),i=l||t;for(let t=0;t<r.length;t++){const l=r[t];o[l]=io(s,n,l,i[l],e,!u(i,l))}}return a}function io(e,t,n,o,i,s){const r=e[n];if(null!=r){const e=u(r,"default");if(e&&void 0===o){const e=r.default;if(r.type!==Function&&!r.skipFactory&&f(e)){const{propsDefaults:s}=i;if(n in s)o=s[n];else{const r=mi(i);o=s[n]=e.call(null,t),r()}}else o=e;i.ce&&i.ce._setProp(n,o)}r[0]&&(s&&!e?o=!1:!r[1]||""!==o&&o!==O(n)||(o=!0))}return o}const so=new WeakMap;function ro(e,o,i=!1){const s=i?so:o.propsCache,r=s.get(e);if(r)return r;const a=e.props,c={},p=[];let h=!1;if(!f(e)){const t=e=>{h=!0;const[t,n]=ro(e,o,!0);l(c,t),n&&p.push(...n)};!i&&o.mixins.length&&o.mixins.forEach(t),e.extends&&t(e.extends),e.mixins&&e.mixins.forEach(t)}if(!a&&!h)return v(e)&&s.set(e,n),n;if(d(a))for(let n=0;n<a.length;n++){const e=L(a[n]);lo(e)&&(c[e]=t)}else if(a)for(const t in a){const e=L(t);if(lo(e)){const n=a[t],o=c[e]=d(n)||f(n)?{type:n}:l({},n),i=o.type;let s=!1,r=!0;if(d(i))for(let e=0;e<i.length;++e){const t=i[e],n=f(t)&&t.name;if("Boolean"===n){s=!0;break}"String"===n&&(r=!1)}else s=f(i)&&"Boolean"===i.name;o[0]=s,o[1]=r,(s||u(o,"default"))&&p.push(e)}}const g=[c,p];return v(e)&&s.set(e,g),g}function lo(e){return"$"!==e[0]&&!S(e)}const ao=e=>"_"===e[0]||"$stable"===e,co=e=>d(e)?e.map(ri):[ri(e)],uo=(e,t,n)=>{if(t._n)return t;const o=Yt(((...e)=>co(t(...e))),n);return o._c=!1,o},po=(e,t,n)=>{const o=e._ctx;for(const i in e){if(ao(i))continue;const n=e[i];if(f(n))t[i]=uo(0,n,o);else if(null!=n){const e=co(n);t[i]=()=>e}}},ho=(e,t)=>{const n=co(t);e.slots.default=()=>n},fo=(e,t,n)=>{for(const o in t)!n&&ao(o)||(e[o]=t[o])},go=function(e,t){t&&t.pendingBranch?d(e)?t.effects.push(...e):t.effects.push(e):(d(n=e)?Et.push(...n):Dt&&-1===n.id?Dt.splice(Rt+1,0,n):1&n.flags||(Et.push(n),n.flags|=1),Nt());var n};function mo(e){return function(e){z().__VUE__=!0;const{insert:i,remove:s,patchProp:r,createElement:l,createText:a,createComment:c,setText:p,setElementText:h,parentNode:f,nextSibling:g,setScopeId:m=o,insertStaticContent:v}=e,w=(e,t,n,o=null,i=null,s=null,r=void 0,l=null,a=!!t.dynamicChildren)=>{if(e===t)return;e&&!Ko(e,t)&&(o=oe(e),K(e,i,s,!0),e=null),-2===t.patchFlag&&(a=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:d}=t;switch(c){case zo:b(e,t,n,o);break;case Bo:C(e,t,n,o);break;case No:null==e&&x(t,n,o,r);break;case jo:N(e,t,n,o,i,s,r,l,a);break;default:1&d?P(e,t,n,o,i,s,r,l,a):6&d?F(e,t,n,o,i,s,r,l,a):(64&d||128&d)&&c.process(e,t,n,o,i,s,r,l,a,re)}null!=u&&i&&nn(u,e&&e.ref,s,t||e,!t)},b=(e,t,n,o)=>{if(null==e)i(t.el=a(t.children),n,o);else{const n=t.el=e.el;t.children!==e.children&&p(n,t.children)}},C=(e,t,n,o)=>{null==e?i(t.el=c(t.children||""),n,o):t.el=e.el},x=(e,t,n,o)=>{[e.el,e.anchor]=v(e.children,t,n,o,e.el,e.anchor)},k=({el:e,anchor:t},n,o)=>{let s;for(;e&&e!==t;)s=g(e),i(e,n,o),e=s;i(t,n,o)},T=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=g(e),s(e),e=n;s(t)},P=(e,t,n,o,i,s,r,l,a)=>{"svg"===t.type?r="svg":"math"===t.type&&(r="mathml"),null==e?M(t,n,o,i,s,r,l,a):H(e,t,i,s,r,l,a)},M=(e,t,n,o,s,a,c,u)=>{let d,p;const{props:f,shapeFlag:g,transition:m,dirs:v}=e;if(d=e.el=l(e.type,a,f&&f.is,f),8&g?h(d,e.children):16&g&&E(e.children,d,null,o,s,vo(e,a),c,u),v&&Xt(e,null,o,"created"),A(d,e,e.scopeId,c,o),f){for(const e in f)"value"===e||S(e)||r(d,e,null,f[e],a,o);"value"in f&&r(d,"value",null,f.value,a),(p=f.onVnodeBeforeMount)&&ui(p,o,e)}v&&Xt(e,null,o,"beforeMount");const y=function(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}(s,m);y&&m.beforeEnter(d),i(d,t,n),((p=f&&f.onVnodeMounted)||y||v)&&go((()=>{p&&ui(p,o,e),y&&m.enter(d),v&&Xt(e,null,o,"mounted")}),s)},A=(e,t,n,o,i)=>{if(n&&m(e,n),o)for(let s=0;s<o.length;s++)m(e,o[s]);if(i){let n=i.subTree;if(t===n||Ho(n.type)&&(n.ssContent===t||n.ssFallback===t)){const t=i.vnode;A(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},E=(e,t,n,o,i,s,r,l,a=0)=>{for(let c=a;c<e.length;c++){const a=e[c]=l?li(e[c]):ri(e[c]);w(null,a,t,n,o,i,s,r,l)}},H=(e,n,o,i,s,l,a)=>{const c=n.el=e.el;let{patchFlag:u,dynamicChildren:d,dirs:p}=n;u|=16&e.patchFlag;const f=e.props||t,g=n.props||t;let m;if(o&&yo(o,!1),(m=g.onVnodeBeforeUpdate)&&ui(m,o,n,e),p&&Xt(n,e,o,"beforeUpdate"),o&&yo(o,!0),(f.innerHTML&&null==g.innerHTML||f.textContent&&null==g.textContent)&&h(c,""),d?j(e.dynamicChildren,d,c,o,i,vo(n,s),l):a||Z(e,n,c,null,o,i,vo(n,s),l,!1),u>0){if(16&u)B(c,f,g,o,s);else if(2&u&&f.class!==g.class&&r(c,"class",null,g.class,s),4&u&&r(c,"style",f.style,g.style,s),8&u){const e=n.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t],i=f[n],l=g[n];l===i&&"value"!==n||r(c,n,i,l,s,o)}}1&u&&e.children!==n.children&&h(c,n.children)}else a||null!=d||B(c,f,g,o,s);((m=g.onVnodeUpdated)||p)&&go((()=>{m&&ui(m,o,n,e),p&&Xt(n,e,o,"updated")}),i)},j=(e,t,n,o,i,s,r)=>{for(let l=0;l<t.length;l++){const a=e[l],c=t[l],u=a.el&&(a.type===jo||!Ko(a,c)||70&a.shapeFlag)?f(a.el):n;w(a,c,u,null,o,i,s,r,!0)}},B=(e,n,o,i,s)=>{if(n!==o){if(n!==t)for(const t in n)S(t)||t in o||r(e,t,n[t],null,s,i);for(const t in o){if(S(t))continue;const l=o[t],a=n[t];l!==a&&"value"!==t&&r(e,t,a,l,s,i)}"value"in o&&r(e,"value",n.value,o.value,s)}},N=(e,t,n,o,s,r,l,c,u)=>{const d=t.el=e?e.el:a(""),p=t.anchor=e?e.anchor:a("");let{patchFlag:h,dynamicChildren:f,slotScopeIds:g}=t;g&&(c=c?c.concat(g):g),null==e?(i(d,n,o),i(p,n,o),E(t.children||[],n,p,s,r,l,c,u)):h>0&&64&h&&f&&e.dynamicChildren?(j(e.dynamicChildren,f,n,s,r,l,c),(null!=t.key||s&&t===s.subTree)&&wo(e,t,!0)):Z(e,t,n,p,s,r,l,c,u)},F=(e,t,n,o,i,s,r,l,a)=>{t.slotScopeIds=l,null==e?512&t.shapeFlag?i.ctx.activate(t,n,o,r,a):V(t,n,o,i,s,r,a):I(e,t,a)},V=(e,n,o,i,s,r,l)=>{const a=e.component=function(e,n,o){const i=e.type,s=(n?n.appContext:e.appContext)||di,r={uid:pi++,vnode:e,type:i,parent:n,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ee(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(s.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ro(i,s),emitsOptions:Oo(i,s),emit:null,emitted:null,propsDefaults:t,inheritAttrs:i.inheritAttrs,ctx:t,data:t,props:t,attrs:t,slots:t,refs:t,setupState:t,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};r.ctx={_:r},r.root=n?n.root:r,r.emit=Po.bind(null,r),e.ce&&e.ce(r);return r}(e,i,s);if(sn(e)&&(a.ctx.renderer=re),function(e,t=!1,n=!1){t&&fi(t);const{props:o,children:i}=e.vnode,s=yi(e);no(e,o,s,t),((e,t,n)=>{const o=e.slots=eo();if(32&e.vnode.shapeFlag){const e=t._;e?(fo(o,t,n),n&&R(o,"_",e,!0)):po(t,o)}else t&&ho(e,t)})(e,i,n||t);const r=s?function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Dn);const{setup:o}=n;if(o){ve();const n=e.setupContext=o.length>1?function(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,Ci),slots:e.slots,emit:e.emit,expose:t}}(e):null,i=mi(e),s=Lt(o,e,0,[e.props,n]),r=y(s);if(ye(),i(),!r&&!e.sp||on(e)||tn(e),r){if(s.then(vi,vi),t)return s.then((t=>{bi(e,t)})).catch((t=>{Ot(t,e,0)}));e.asyncDep=s}else bi(e,s)}else _i(e)}(e,t):void 0;t&&fi(!1)}(a,!1,l),a.asyncDep){if(s&&s.registerDep(a,U,l),!e.el){const e=a.subTree=ei(Bo);C(null,e,n,o)}}else U(a,e,n,o,s,r,l)},I=(e,t,n)=>{const o=t.component=e.component;if(function(e,t,n){const{props:o,children:i,component:s}=e,{props:r,children:l,patchFlag:a}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&a>=0))return!(!i&&!l||l&&l.$stable)||o!==r&&(o?!r||Ro(o,r,c):!!r);if(1024&a)return!0;if(16&a)return o?Ro(o,r,c):!!r;if(8&a){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(r[n]!==o[n]&&!Mo(c,n))return!0}}return!1}(e,t,n)){if(o.asyncDep&&!o.asyncResolved)return void W(o,t,n);o.next=t,o.update()}else t.el=e.el,o.vnode=t},U=(e,t,n,o,i,s,r)=>{const l=()=>{if(e.isMounted){let{next:t,bu:n,u:o,parent:a,vnode:c}=e;{const n=bo(e);if(n)return t&&(t.el=c.el,W(e,t,r)),void n.asyncDep.then((()=>{e.isUnmounted||l()}))}let u,d=t;yo(e,!1),t?(t.el=c.el,W(e,t,r)):t=c,n&&D(n),(u=t.props&&t.props.onVnodeBeforeUpdate)&&ui(u,a,t,c),yo(e,!0);const p=Ao(e),h=e.subTree;e.subTree=p,w(h,p,f(h.el),oe(h),e,i,s),t.el=p.el,null===d&&function({vnode:e,parent:t},n){for(;t;){const o=t.subTree;if(o.suspense&&o.suspense.activeBranch===e&&(o.el=e.el),o!==e)break;(e=t.vnode).el=n,t=t.parent}}(e,p.el),o&&go(o,i),(u=t.props&&t.props.onVnodeUpdated)&&go((()=>ui(u,a,t,c)),i)}else{let r;const{el:l,props:a}=t,{bm:c,m:u,parent:d,root:p,type:h}=e,f=on(t);yo(e,!1),c&&D(c),!f&&(r=a&&a.onVnodeBeforeMount)&&ui(r,d,t),yo(e,!0);{p.ce&&p.ce._injectChildStyle(h);const r=e.subTree=Ao(e);w(null,r,n,o,e,i,s),t.el=r.el}if(u&&go(u,i),!f&&(r=a&&a.onVnodeMounted)){const e=t;go((()=>ui(r,d,e)),i)}(256&t.shapeFlag||d&&on(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&go(e.a,i),e.isMounted=!0,t=n=o=null}};e.scope.on();const a=e.effect=new ne(l);e.scope.off();const c=e.update=a.run.bind(a),u=e.job=a.runIfDirty.bind(a);u.i=e,u.id=e.uid,a.scheduler=()=>Bt(u),yo(e,!0),c()},W=(e,n,o)=>{n.component=e;const i=e.vnode.props;e.vnode=n,e.next=null,function(e,t,n,o){const{props:i,attrs:s,vnode:{patchFlag:r}}=e,l=ft(i),[a]=e.propsOptions;let c=!1;if(!(o||r>0)||16&r){let o;oo(e,t,i,s)&&(c=!0);for(const s in l)t&&(u(t,s)||(o=O(s))!==s&&u(t,o))||(a?!n||void 0===n[s]&&void 0===n[o]||(i[s]=io(a,l,s,void 0,e,!0)):delete i[s]);if(s!==l)for(const e in s)t&&u(t,e)||(delete s[e],c=!0)}else if(8&r){const n=e.vnode.dynamicProps;for(let o=0;o<n.length;o++){let r=n[o];if(Mo(e.emitsOptions,r))continue;const d=t[r];if(a)if(u(s,r))d!==s[r]&&(s[r]=d,c=!0);else{const t=L(r);i[t]=io(a,l,t,d,e,!1)}else d!==s[r]&&(s[r]=d,c=!0)}}c&&Pe(e.attrs,"set","")}(e,n.props,i,o),((e,n,o)=>{const{vnode:i,slots:s}=e;let r=!0,l=t;if(32&i.shapeFlag){const e=n._;e?o&&1===e?r=!1:fo(s,n,o):(r=!n.$stable,po(n,s)),l=n}else n&&(ho(e,n),l={default:1});if(r)for(const t in s)ao(t)||null!=l[t]||delete s[t]})(e,n.children,o),ve(),Ft(e),ye()},Z=(e,t,n,o,i,s,r,l,a=!1)=>{const c=e&&e.children,u=e?e.shapeFlag:0,d=t.children,{patchFlag:p,shapeFlag:f}=t;if(p>0){if(128&p)return void G(c,d,n,o,i,s,r,l,a);if(256&p)return void q(c,d,n,o,i,s,r,l,a)}8&f?(16&u&&te(c,i,s),d!==c&&h(n,d)):16&u?16&f?G(c,d,n,o,i,s,r,l,a):te(c,i,s,!0):(8&u&&h(n,""),16&f&&E(d,n,o,i,s,r,l,a))},q=(e,t,o,i,s,r,l,a,c)=>{t=t||n;const u=(e=e||n).length,d=t.length,p=Math.min(u,d);let h;for(h=0;h<p;h++){const n=t[h]=c?li(t[h]):ri(t[h]);w(e[h],n,o,null,s,r,l,a,c)}u>d?te(e,s,r,!0,!1,p):E(t,o,i,s,r,l,a,c,p)},G=(e,t,o,i,s,r,l,a,c)=>{let u=0;const d=t.length;let p=e.length-1,h=d-1;for(;u<=p&&u<=h;){const n=e[u],i=t[u]=c?li(t[u]):ri(t[u]);if(!Ko(n,i))break;w(n,i,o,null,s,r,l,a,c),u++}for(;u<=p&&u<=h;){const n=e[p],i=t[h]=c?li(t[h]):ri(t[h]);if(!Ko(n,i))break;w(n,i,o,null,s,r,l,a,c),p--,h--}if(u>p){if(u<=h){const e=h+1,n=e<d?t[e].el:i;for(;u<=h;)w(null,t[u]=c?li(t[u]):ri(t[u]),o,n,s,r,l,a,c),u++}}else if(u>h)for(;u<=p;)K(e[u],s,r,!0),u++;else{const f=u,g=u,m=new Map;for(u=g;u<=h;u++){const e=t[u]=c?li(t[u]):ri(t[u]);null!=e.key&&m.set(e.key,u)}let v,y=0;const b=h-g+1;let C=!1,x=0;const S=new Array(b);for(u=0;u<b;u++)S[u]=0;for(u=f;u<=p;u++){const n=e[u];if(y>=b){K(n,s,r,!0);continue}let i;if(null!=n.key)i=m.get(n.key);else for(v=g;v<=h;v++)if(0===S[v-g]&&Ko(n,t[v])){i=v;break}void 0===i?K(n,s,r,!0):(S[i-g]=u+1,i>=x?x=i:C=!0,w(n,t[i],o,null,s,r,l,a,c),y++)}const k=C?function(e){const t=e.slice(),n=[0];let o,i,s,r,l;const a=e.length;for(o=0;o<a;o++){const a=e[o];if(0!==a){if(i=n[n.length-1],e[i]<a){t[o]=i,n.push(o);continue}for(s=0,r=n.length-1;s<r;)l=s+r>>1,e[n[l]]<a?s=l+1:r=l;a<e[n[s]]&&(s>0&&(t[o]=n[s-1]),n[s]=o)}}s=n.length,r=n[s-1];for(;s-- >0;)n[s]=r,r=t[r];return n}(S):n;for(v=k.length-1,u=b-1;u>=0;u--){const e=g+u,n=t[e],p=e+1<d?t[e+1].el:i;0===S[u]?w(null,n,o,p,s,r,l,a,c):C&&(v<0||u!==k[v]?Y(n,o,p,2):v--)}}},Y=(e,t,n,o,r=null)=>{const{el:l,type:a,transition:c,children:u,shapeFlag:d}=e;if(6&d)return void Y(e.component.subTree,t,n,o);if(128&d)return void e.suspense.move(t,n,o);if(64&d)return void a.move(e,t,n,re);if(a===jo){i(l,t,n);for(let e=0;e<u.length;e++)Y(u[e],t,n,o);return void i(e.anchor,t,n)}if(a===No)return void k(e,t,n);if(2!==o&&1&d&&c)if(0===o)c.beforeEnter(l),i(l,t,n),go((()=>c.enter(l)),r);else{const{leave:o,delayLeave:r,afterLeave:a}=c,u=()=>{e.ctx.isUnmounted?s(l):i(l,t,n)},d=()=>{o(l,(()=>{u(),a&&a()}))};r?r(l,u,d):d()}else i(l,t,n)},K=(e,t,n,o=!1,i=!1)=>{const{type:s,props:r,ref:l,children:a,dynamicChildren:c,shapeFlag:u,patchFlag:d,dirs:p,cacheIndex:h}=e;if(-2===d&&(i=!1),null!=l&&(ve(),nn(l,null,n,e,!0),ye()),null!=h&&(t.renderCache[h]=void 0),256&u)return void t.ctx.deactivate(e);const f=1&u&&p,g=!on(e);let m;if(g&&(m=r&&r.onVnodeBeforeUnmount)&&ui(m,t,e),6&u)J(e.component,n,o);else{if(128&u)return void e.suspense.unmount(n,o);f&&Xt(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,re,o):c&&!c.hasOnce&&(s!==jo||d>0&&64&d)?te(c,t,n,!1,!0):(s===jo&&384&d||!i&&16&u)&&te(a,t,n),o&&X(e)}(g&&(m=r&&r.onVnodeUnmounted)||f)&&go((()=>{m&&ui(m,t,e),f&&Xt(e,null,t,"unmounted")}),n)},X=e=>{const{type:t,el:n,anchor:o,transition:i}=e;if(t===jo)return void Q(n,o);if(t===No)return void T(e);const r=()=>{s(n),i&&!i.persisted&&i.afterLeave&&i.afterLeave()};if(1&e.shapeFlag&&i&&!i.persisted){const{leave:t,delayLeave:o}=i,s=()=>t(n,r);o?o(e.el,r,s):s()}else r()},Q=(e,t)=>{let n;for(;e!==t;)n=g(e),s(e),e=n;s(t)},J=(e,t,n)=>{const{bum:o,scope:i,job:s,subTree:r,um:l,m:a,a:c,parent:u,slots:{__:p}}=e;_o(a),_o(c),o&&D(o),u&&d(p)&&p.forEach((e=>{u.renderCache[e]=void 0})),i.stop(),s&&(s.flags|=8,K(r,e,t,n)),l&&go(l,t),go((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},te=(e,t,n,o=!1,i=!1,s=0)=>{for(let r=s;r<e.length;r++)K(e[r],t,n,o,i)},oe=e=>{if(6&e.shapeFlag)return oe(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=g(e.anchor||e.el),n=t&&t[Qt];return n?g(n):t};let ie=!1;const se=(e,t,n)=>{null==e?t._vnode&&K(t._vnode,null,null,!0):w(t._vnode||null,e,t,null,null,null,n),t._vnode=e,ie||(ie=!0,Ft(),Vt(),ie=!1)},re={p:w,um:K,m:Y,r:X,mt:V,mc:E,pc:Z,pbc:j,n:oe,o:e};let le;return{render:se,hydrate:le,createApp:Kn(se)}}(e)}function vo({type:e,props:t},n){return"svg"===n&&"foreignObject"===e||"mathml"===n&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function yo({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function wo(e,t,n=!1){const o=e.children,i=t.children;if(d(o)&&d(i))for(let s=0;s<o.length;s++){const e=o[s];let t=i[s];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=i[s]=li(i[s]),t.el=e.el),n||-2===t.patchFlag||wo(e,t)),t.type===zo&&(t.el=e.el),t.type!==Bo||t.el||(t.el=e.el)}}function bo(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:bo(t)}function _o(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const Co=Symbol.for("v-scx"),xo=()=>Qn(Co);function So(e,t,n){return ko(e,t,n)}function ko(e,n,i=t){const{immediate:s,deep:r,flush:a,once:c}=i,u=l({},i),d=n&&s||!n&&"post"!==a;let p;if(wi)if("sync"===a){const e=xo();p=e.__watcherHandles||(e.__watcherHandles=[])}else if(!d){const e=()=>{};return e.stop=o,e.resume=o,e.pause=o,e}const h=gi;u.call=(e,t,n)=>Pt(e,h,t,n);let f=!1;"post"===a?u.scheduler=e=>{go(e,h&&h.suspense)}:"sync"!==a&&(f=!0,u.scheduler=(e,t)=>{t?e():Bt(e)}),u.augmentJob=e=>{n&&(e.flags|=4),f&&(e.flags|=2,h&&(e.id=h.uid,e.i=h))};const g=Tt(e,n,u);return wi&&(p?p.push(g):d&&g()),g}function To(e,t,n){const o=this.proxy,i=g(e)?e.includes(".")?$o(o,e):()=>o[e]:e.bind(o,o);let s;f(t)?s=t:(s=t.handler,n=t);const r=mi(this),l=ko(i,s.bind(o),n);return r(),l}function $o(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}const Lo=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${L(t)}Modifiers`]||e[`${O(t)}Modifiers`];function Po(e,n,...o){if(e.isUnmounted)return;const i=e.vnode.props||t;let s=o;const r=n.startsWith("update:"),l=r&&Lo(i,n.slice(7));let a;l&&(l.trim&&(s=o.map((e=>g(e)?e.trim():e))),l.number&&(s=o.map(H)));let c=i[a=A(n)]||i[a=A(L(n))];!c&&r&&(c=i[a=A(O(n))]),c&&Pt(c,e,6,s);const u=i[a+"Once"];if(u){if(e.emitted){if(e.emitted[a])return}else e.emitted={};e.emitted[a]=!0,Pt(u,e,6,s)}}function Oo(e,t,n=!1){const o=t.emitsCache,i=o.get(e);if(void 0!==i)return i;const s=e.emits;let r={},a=!1;if(!f(e)){const o=e=>{const n=Oo(e,t,!0);n&&(a=!0,l(r,n))};!n&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return s||a?(d(s)?s.forEach((e=>r[e]=null)):l(r,s),v(e)&&o.set(e,r),r):(v(e)&&o.set(e,null),null)}function Mo(e,t){return!(!e||!s(t))&&(t=t.slice(2).replace(/Once$/,""),u(e,t[0].toLowerCase()+t.slice(1))||u(e,O(t))||u(e,t))}function Ao(e){const{type:t,vnode:n,proxy:o,withProxy:i,propsOptions:[s],slots:l,attrs:a,emit:c,render:u,renderCache:d,props:p,data:h,setupState:f,ctx:g,inheritAttrs:m}=e,v=qt(e);let y,w;try{if(4&n.shapeFlag){const e=i||o,t=e;y=ri(u.call(t,e,d,p,f,h,g)),w=a}else{const e=t;0,y=ri(e.length>1?e(p,{attrs:a,slots:l,emit:c}):e(p,null)),w=t.props?a:Eo(a)}}catch(C){Fo.length=0,Ot(C,e,1),y=ei(Bo)}let b=y;if(w&&!1!==m){const e=Object.keys(w),{shapeFlag:t}=b;e.length&&7&t&&(s&&e.some(r)&&(w=Do(w,s)),b=ni(b,w,!1,!0))}return n.dirs&&(b=ni(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&Jt(b,n.transition),y=b,qt(v),y}const Eo=e=>{let t;for(const n in e)("class"===n||"style"===n||s(n))&&((t||(t={}))[n]=e[n]);return t},Do=(e,t)=>{const n={};for(const o in e)r(o)&&o.slice(9)in t||(n[o]=e[o]);return n};function Ro(e,t,n){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let i=0;i<o.length;i++){const s=o[i];if(t[s]!==e[s]&&!Mo(n,s))return!0}return!1}const Ho=e=>e.__isSuspense;const jo=Symbol.for("v-fgt"),zo=Symbol.for("v-txt"),Bo=Symbol.for("v-cmt"),No=Symbol.for("v-stc"),Fo=[];let Vo=null;function Io(e=!1){Fo.push(Vo=e?null:[])}let Uo=1;function Wo(e,t=!1){Uo+=e,e<0&&Vo&&t&&(Vo.hasOnce=!0)}function Zo(e){return e.dynamicChildren=Uo>0?Vo||n:null,Fo.pop(),Vo=Fo[Fo.length-1]||null,Uo>0&&Vo&&Vo.push(e),e}function qo(e,t,n,o,i,s){return Zo(Jo(e,t,n,o,i,s,!0))}function Go(e,t,n,o,i){return Zo(ei(e,t,n,o,i,!0))}function Yo(e){return!!e&&!0===e.__v_isVNode}function Ko(e,t){return e.type===t.type&&e.key===t.key}const Xo=({key:e})=>null!=e?e:null,Qo=({ref:e,ref_key:t,ref_for:n})=>("number"==typeof e&&(e=""+e),null!=e?g(e)||vt(e)||f(e)?{i:Wt,r:e,k:t,f:!!n}:e:null);function Jo(e,t=null,n=null,o=0,i=null,s=(e===jo?0:1),r=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Xo(t),ref:t&&Qo(t),scopeId:Zt,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:o,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Wt};return l?(ai(a,n),128&s&&e.normalize(a)):n&&(a.shapeFlag|=g(n)?8:16),Uo>0&&!r&&Vo&&(a.patchFlag>0||6&s)&&32!==a.patchFlag&&Vo.push(a),a}const ei=function(e,t=null,n=null,o=0,i=null,s=!1){e&&e!==Sn||(e=Bo);if(Yo(e)){const o=ni(e,t,!0);return n&&ai(o,n),Uo>0&&!s&&Vo&&(6&o.shapeFlag?Vo[Vo.indexOf(e)]=o:Vo.push(o)),o.patchFlag=-2,o}r=e,f(r)&&"__vccOpts"in r&&(e=e.__vccOpts);var r;if(t){t=ti(t);let{class:e,style:n}=t;e&&!g(e)&&(t.class=U(e)),v(n)&&(ht(n)&&!d(n)&&(n=l({},n)),t.style=B(n))}const a=g(e)?1:Ho(e)?128:(e=>e.__isTeleport)(e)?64:v(e)?4:f(e)?2:0;return Jo(e,t,n,o,i,a,s,!0)};function ti(e){return e?ht(e)||to(e)?l({},e):e:null}function ni(e,t,n=!1,o=!1){const{props:i,ref:s,patchFlag:r,children:l,transition:a}=e,c=t?ci(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&Xo(c),ref:t&&t.ref?n&&s?d(s)?s.concat(Qo(t)):[s,Qo(t)]:Qo(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:l,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==jo?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:a,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ni(e.ssContent),ssFallback:e.ssFallback&&ni(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return a&&o&&Jt(u,a.clone(u)),u}function oi(e=" ",t=0){return ei(zo,null,e,t)}function ii(e,t){const n=ei(No,null,e);return n.staticCount=t,n}function si(e="",t=!1){return t?(Io(),Go(Bo,null,e)):ei(Bo,null,e)}function ri(e){return null==e||"boolean"==typeof e?ei(Bo):d(e)?ei(jo,null,e.slice()):Yo(e)?li(e):ei(zo,null,String(e))}function li(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:ni(e)}function ai(e,t){let n=0;const{shapeFlag:o}=e;if(null==t)t=null;else if(d(t))n=16;else if("object"==typeof t){if(65&o){const n=t.default;return void(n&&(n._c&&(n._d=!1),ai(e,n()),n._c&&(n._d=!0)))}{n=32;const o=t._;o||to(t)?3===o&&Wt&&(1===Wt.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Wt}}else f(t)?(t={default:t,_ctx:Wt},n=32):(t=String(t),64&o?(n=16,t=[oi(t)]):n=8);e.children=t,e.shapeFlag|=n}function ci(...e){const t={};for(let n=0;n<e.length;n++){const o=e[n];for(const e in o)if("class"===e)t.class!==o.class&&(t.class=U([t.class,o.class]));else if("style"===e)t.style=B([t.style,o.style]);else if(s(e)){const n=t[e],i=o[e];!i||n===i||d(n)&&n.includes(i)||(t[e]=n?[].concat(n,i):i)}else""!==e&&(t[e]=o[e])}return t}function ui(e,t,n,o=null){Pt(e,t,7,[n,o])}const di=Gn();let pi=0;let hi,fi,gi=null;{const e=z(),t=(t,n)=>{let o;return(o=e[t])||(o=e[t]=[]),o.push(n),e=>{o.length>1?o.forEach((t=>t(e))):o[0](e)}};hi=t("__VUE_INSTANCE_SETTERS__",(e=>gi=e)),fi=t("__VUE_SSR_SETTERS__",(e=>wi=e))}const mi=e=>{const t=gi;return hi(e),e.scope.on(),()=>{e.scope.off(),hi(t)}},vi=()=>{gi&&gi.scope.off(),hi(null)};function yi(e){return 4&e.vnode.shapeFlag}let wi=!1;function bi(e,t,n){f(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:v(t)&&(e.setupState=_t(t)),_i(e)}function _i(e,t,n){const i=e.type;e.render||(e.render=i.render||o);{const t=mi(e);ve();try{jn(e)}finally{ye(),t()}}}const Ci={get:(e,t)=>(Le(e,0,""),e[t])};function xi(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(_t((t=e.exposed,!u(t,"__v_skip")&&Object.isExtensible(t)&&R(t,"__v_skip",!0),t)),{get:(t,n)=>n in t?t[n]:n in An?An[n](e):void 0,has:(e,t)=>t in e||t in An})):e.proxy;var t}function Si(e,t=!0){return f(e)?e.displayName||e.name:e.name||t&&e.__name}const ki=(e,t)=>{const n=function(e,t,n=!1){let o,i;return f(e)?o=e:(o=e.get,i=e.set),new Ct(o,i,n)}(e,0,wi);return n};const Ti="3.5.14";let $i;const Li="undefined"!=typeof window&&window.trustedTypes;if(Li)try{$i=Li.createPolicy("vue",{createHTML:e=>e})}catch(fd){}const Pi=$i?e=>$i.createHTML(e):e=>e,Oi="undefined"!=typeof document?document:null,Mi=Oi&&Oi.createElement("template"),Ai={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,o)=>{const i="svg"===t?Oi.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?Oi.createElementNS("http://www.w3.org/1998/Math/MathML",e):n?Oi.createElement(e,{is:n}):Oi.createElement(e);return"select"===e&&o&&null!=o.multiple&&i.setAttribute("multiple",o.multiple),i},createText:e=>Oi.createTextNode(e),createComment:e=>Oi.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Oi.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,o,i,s){const r=n?n.previousSibling:t.lastChild;if(i&&(i===s||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),i!==s&&(i=i.nextSibling););else{Mi.innerHTML=Pi("svg"===o?`<svg>${e}</svg>`:"mathml"===o?`<math>${e}</math>`:e);const i=Mi.content;if("svg"===o||"mathml"===o){const e=i.firstChild;for(;e.firstChild;)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Ei=Symbol("_vtc");const Di=Symbol("_vod"),Ri=Symbol("_vsh"),Hi=Symbol(""),ji=/(^|;)\s*display\s*:/;const zi=/\s*!important$/;function Bi(e,t,n){if(d(n))n.forEach((n=>Bi(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const o=function(e,t){const n=Fi[t];if(n)return n;let o=L(t);if("filter"!==o&&o in e)return Fi[t]=o;o=M(o);for(let i=0;i<Ni.length;i++){const n=Ni[i]+o;if(n in e)return Fi[t]=n}return t}(e,t);zi.test(n)?e.setProperty(O(o),n.replace(zi,""),"important"):e[o]=n}}const Ni=["Webkit","Moz","ms"],Fi={};const Vi="http://www.w3.org/1999/xlink";function Ii(e,t,n,o,i,s=Z(t)){o&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(Vi,t.slice(6,t.length)):e.setAttributeNS(Vi,t,n):null==n||s&&!q(n)?e.removeAttribute(t):e.setAttribute(t,s?"":m(n)?String(n):n)}function Ui(e,t,n,o,i){if("innerHTML"===t||"textContent"===t)return void(null!=n&&(e[t]="innerHTML"===t?Pi(n):n));const s=e.tagName;if("value"===t&&"PROGRESS"!==s&&!s.includes("-")){const o="OPTION"===s?e.getAttribute("value")||"":e.value,i=null==n?"checkbox"===e.type?"on":"":String(n);return o===i&&"_value"in e||(e.value=i),null==n&&e.removeAttribute(t),void(e._value=n)}let r=!1;if(""===n||null==n){const o=typeof e[t];"boolean"===o?n=q(n):null==n&&"string"===o?(n="",r=!0):"number"===o&&(n=0,r=!0)}try{e[t]=n}catch(fd){}r&&e.removeAttribute(i||t)}function Wi(e,t,n,o){e.addEventListener(t,n,o)}const Zi=Symbol("_vei");function qi(e,t,n,o,i=null){const s=e[Zi]||(e[Zi]={}),r=s[t];if(o&&r)r.value=o;else{const[n,l]=function(e){let t;if(Gi.test(e)){let n;for(t={};n=e.match(Gi);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}const n=":"===e[2]?e.slice(3):O(e.slice(2));return[n,t]}(t);if(o){const r=s[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();Pt(function(e,t){if(d(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=Xi(),n}(o,i);Wi(e,n,r,l)}else r&&(!function(e,t,n,o){e.removeEventListener(t,n,o)}(e,n,r,l),s[t]=void 0)}}const Gi=/(?:Once|Passive|Capture)$/;let Yi=0;const Ki=Promise.resolve(),Xi=()=>Yi||(Ki.then((()=>Yi=0)),Yi=Date.now());const Qi=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123;const Ji=e=>{const t=e.props["onUpdate:modelValue"]||!1;return d(t)?e=>D(t,e):t};function es(e){e.target.composing=!0}function ts(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ns=Symbol("_assign"),os={created(e,{modifiers:{lazy:t,trim:n,number:o}},i){e[ns]=Ji(i);const s=o||i.props&&"number"===i.props.type;Wi(e,t?"change":"input",(t=>{if(t.target.composing)return;let o=e.value;n&&(o=o.trim()),s&&(o=H(o)),e[ns](o)})),n&&Wi(e,"change",(()=>{e.value=e.value.trim()})),t||(Wi(e,"compositionstart",es),Wi(e,"compositionend",ts),Wi(e,"change",ts))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:o,trim:i,number:s}},r){if(e[ns]=Ji(r),e.composing)return;const l=null==t?"":t;if((!s&&"number"!==e.type||/^0\d/.test(e.value)?e.value:H(e.value))!==l){if(document.activeElement===e&&"range"!==e.type){if(o&&t===n)return;if(i&&e.value.trim()===l)return}e.value=l}}},is=["ctrl","shift","alt","meta"],ss={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>is.some((n=>e[`${n}Key`]&&!t.includes(n)))},rs=(e,t)=>{const n=e._withMods||(e._withMods={}),o=t.join(".");return n[o]||(n[o]=(n,...o)=>{for(let e=0;e<t.length;e++){const o=ss[t[e]];if(o&&o(n,t))return}return e(n,...o)})},ls={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},as=(e,t)=>{const n=e._withKeys||(e._withKeys={}),o=t.join(".");return n[o]||(n[o]=n=>{if(!("key"in n))return;const o=O(n.key);return t.some((e=>e===o||ls[e]===o))?e(n):void 0})},cs=l({patchProp:(e,t,n,o,i,l)=>{const a="svg"===i;"class"===t?function(e,t,n){const o=e[Ei];o&&(t=(t?[t,...o]:[...o]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,o,a):"style"===t?function(e,t,n){const o=e.style,i=g(n);let s=!1;if(n&&!i){if(t)if(g(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&Bi(o,t,"")}else for(const e in t)null==n[e]&&Bi(o,e,"");for(const e in n)"display"===e&&(s=!0),Bi(o,e,n[e])}else if(i){if(t!==n){const e=o[Hi];e&&(n+=";"+e),o.cssText=n,s=ji.test(n)}}else t&&e.removeAttribute("style");Di in e&&(e[Di]=s?o.display:"",e[Ri]&&(o.display="none"))}(e,n,o):s(t)?r(t)||qi(e,t,0,o,l):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,o){if(o)return"innerHTML"===t||"textContent"===t||!!(t in e&&Qi(t)&&f(n));if("spellcheck"===t||"draggable"===t||"translate"===t||"autocorrect"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}if(Qi(t)&&g(n))return!1;return t in e}(e,t,o,a))?(Ui(e,t,o),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||Ii(e,t,o,a,0,"value"!==t)):!e._isVueCE||!/[A-Z]/.test(t)&&g(o)?("true-value"===t?e._trueValue=o:"false-value"===t&&(e._falseValue=o),Ii(e,t,o,a)):Ui(e,L(t),o,0,t)}},Ai);let us;const ds=(...e)=>{const t=(us||(us=mo(cs))).createApp(...e),{mount:n}=t;return t.mount=e=>{const o=function(e){if(g(e)){return document.querySelector(e)}return e}(e);if(!o)return;const i=t._component;f(i)||i.render||i.template||(i.template=o.innerHTML),1===o.nodeType&&(o.textContent="");const s=n(o,!1,function(e){if(e instanceof SVGElement)return"svg";if("function"==typeof MathMLElement&&e instanceof MathMLElement)return"mathml"}(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),s},t};function ps(e){throw`facing-metadata: ${e}`}var hs,fs,gs=function(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)};hs=new WeakSet,fs=function(e,t){let n=e;do{const o=this.getOwn(n);if(void 0!==o&&!t(e,o))break;n=Object.getPrototypeOf(n)}while(null!==n)};const ms=Symbol("vue-facing-decorator-slot");class vs{constructor(e){Object.defineProperty(this,"master",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"names",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"inComponent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"cachedVueComponent",{enumerable:!0,configurable:!0,writable:!0,value:null}),this.master=e}obtainMap(e){let t=this.getMap(e);return t||(t=new Map,this.names.set(e,t)),t}getMap(e){return this.names.get(e)}}const ys=new class{constructor(e=Symbol("faple-metadata")){hs.add(this),this.symbol=e}create(e,t){Object.getOwnPropertyDescriptor(e,this.symbol)&&ps("Target had metadata"),Object.defineProperty(e,this.symbol,{enumerable:!1,configurable:!1,writable:!1,value:t})}getOwn(e){const t=Object.getOwnPropertyDescriptor(e,this.symbol);if(t)return t.value}get(e){let t;return gs(this,hs,"m",fs).call(this,e,((e,n)=>(t=n,!1))),t}getAll(e){let t=[];return gs(this,hs,"m",fs).call(this,e,((e,n)=>(t.push(n),!0))),t}setValueOwn(e,t,n){const o=this.getOwn(e);o||ps("Target has not metadata"),o[t]=n}setValue(e,t,n){const o=this.get(e);o||ps("Target has not metadata"),o[t]=n}getValueOwn(e,t){const n=this.getOwn(e);return void 0===n&&ps("Target has not metadata"),n[t]}getValue(e,t){let n,o=!1;return gs(this,hs,"m",fs).call(this,e,((e,i)=>(o=!0,!(t in i)||void 0===i[t]||(n=i[t],!1)))),o||ps("Target has not metadata"),n}}(ms);function ws(e){return ys.getOwn(e)}function bs(e,t){const n=ws(e);return n||function(e,t){if(ws(e))throw"";t&&(t.master=e);const n=null!=t?t:new vs(e);return ys.create(e,n),n}(e,t)}const _s={};function Cs(e){return function(t,n){var o;if(n){if("class"!==n.kind)throw"deco stage 3 class";const i=bs(null!==(o=_s.fakePrototype)&&void 0!==o?o:_s.fakePrototype={});delete _s.fakePrototype,bs(t.prototype,i);return e(t)}return e(t)}}function xs(e){return function(t,n){var o;if("object"==typeof n){const i=n,s=t,r=null!==(o=_s.fakePrototype)&&void 0!==o?o:_s.fakePrototype={};return r[i.name]=s,e(r,i.name)}return e(t,n)}}const Ss=class{};function ks(e){const t=Object.getPrototypeOf(e);return t instanceof Ss?t:null}function Ts(e){const t=[];let n=e;do{t.unshift(n),n=ks(n)}while(null!==n&&!ws(n));return t}function $s(e){let t=ks(e);for(;null!==t;){const e=ws(t);if(e)return e;t=ks(t)}return null}function Ls(e,t,n){return e.filter((e=>{let o=t;for(;null!=o;){for(const t of o.names.keys()){if("customDecorator"===t){const t=o.obtainMap("customDecorator");if(t.has(e)&&t.get(e).every((e=>!e.preserve)))return!1}if(n&&n.includes(t))continue;if(o.names.get(t).has(e))return!1}o=$s(o.master)}return!0}))}function Ps(e,t){const n=Object.getOwnPropertyDescriptors(e);return Object.keys(n).filter((e=>t(n[e],e)))}function Os(e){return"function"==typeof e?e:function(){return e||{}}}function Ms(e){return function(t,n){if(!n){const n=t;return xs((function(t,o){e(t,o,n)}))}{const o=t;xs((function(t,n){e(t,n)}))(o,n)}}}const As=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","activated","deactivated","beforeDestroy","beforeUnmount","destroyed","unmounted","renderTracked","renderTriggered","errorCaptured","serverPrefetch","render"];function Es(e,t){var n;null!==(n=e.beforeCreateCallbacks)&&void 0!==n||(e.beforeCreateCallbacks=[]),e.beforeCreateCallbacks.push((function(){const e=this;t(e).forEach(((t,n)=>{Object.defineProperty(e,n,t)}))}))}const Ds=Ms((function(e,t,n){bs(e).obtainMap("ref").set(t,void 0===n?null:n)}));const Rs=Ms((function(e,t,n){const o=bs(e).obtainMap("props"),i=Object.assign({},null!=n?n:{});o.set(t,i)}));var Hs=function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{a(o.next(e))}catch(fd){s(fd)}}function l(e){try{a(o.throw(e))}catch(fd){s(fd)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}a((o=o.apply(e,t||[])).next())}))};function js(e,t){const n={};!function(e,t){const n=bs(e.prototype).getMap("setup");if(!n||0===n.size)return;t.setup=function(e,t){const o={};let i=null;for(const s of n.keys()){const r=n.get(s).setupFunction(e,t);r instanceof Promise?(null!=i||(i=[]),i.push(r.then((e=>{o[s]=e})))):o[s]=r}return Array.isArray(i)?Promise.all(i).then((()=>o)):o}}(e,n),function(e,t){var n;null!==(n=t.computed)&&void 0!==n||(t.computed={});const o=bs(e.prototype),i=o.getMap("v-model");if(!i||0===i.size)return;const s=o.obtainMap("emits");i.forEach(((e,n)=>{var o;const i=null!==(o=e&&e.name)&&void 0!==o?o:"modelValue",r=`update:${i}`;t.computed[n]={get:function(){return this[i]},set:function(e){this.$emit(r,e)}},s.set(r,!0)}))}(e,n),function(e,t){var n;null!==(n=t.computed)&&void 0!==n||(t.computed={});const o=bs(e.prototype),i=o.obtainMap("computed"),s=o.obtainMap("vanilla");Ts(e.prototype).forEach((e=>{Ps(e,((e,t)=>("function"==typeof e.get||"function"==typeof e.set)&&!s.has(t))).forEach((n=>{i.set(n,!0);const o=Object.getOwnPropertyDescriptor(e,n);t.computed[n]={get:"function"==typeof o.get?o.get:void 0,set:"function"==typeof o.set?o.set:void 0}}))}))}(e,n),function(e,t){var n;null!==(n=t.watch)&&void 0!==n||(t.watch={});const o=bs(e.prototype).getMap("watch");o&&0!==o.size&&o.forEach(((e,n)=>{(Array.isArray(e)?e:[e]).forEach((e=>{if(t.watch[e.key]){const n=t.watch[e.key];Array.isArray(n)?n.push(e):t.watch[e.key]=[n,e]}else t.watch[e.key]=e}))}))}(e,n),function(e,t){var n;null!==(n=t.props)&&void 0!==n||(t.props={});const o=bs(e.prototype).getMap("props");o&&0!==o.size&&o.forEach(((e,n)=>{t.props[n]=e}))}(e,n),function(e,t){var n;null!==(n=t.inject)&&void 0!==n||(t.inject={});const o=bs(e.prototype).getMap("inject");o&&0!==o.size&&o.forEach(((e,n)=>{t.inject[n]=e}))}(e,n),function(e,t){var n;null!==(n=t.methods)&&void 0!==n||(t.methods={});const o=e.prototype,i=bs(o),s=i.getMap("emit");if(!s||0===s.size)return;const r=i.obtainMap("emits");s.forEach(((e,n)=>{const i=null===e?n:e;r.set(i,!0),t.methods[n]=function(){return Hs(this,arguments,void 0,(function*(){const e=o[n].apply(this,arguments);if(e instanceof Promise){const t=yield e;this.$emit(i,t)}else void 0===e?this.$emit(i):this.$emit(i,e)}))}}))}(e,n),function(e,t){const n=bs(e.prototype).getMap("ref");n&&0!==n.size&&Es(t,(e=>{const t=new Map;return n.forEach(((n,o)=>{const i=null===n?o:n;t.set(o,{get:function(){return e.$refs[i]},set:void 0})})),t}))}(e,n),function(e,t){const n=bs(e.prototype).getMap("vanilla");if(!n||0===n.size)return;const o=Ts(e.prototype),i=new Map;Es(t,(e=>(o.forEach((t=>{const o=Object.getOwnPropertyDescriptors(t);for(const s in o){const t=o[s];t&&n.has(s)&&("function"!=typeof t.get&&"function"!=typeof t.set||i.set(s,{set:"function"==typeof t.set?t.set.bind(e):void 0,get:"function"==typeof t.get?t.get.bind(e):void 0}))}})),i)))}(e,n),function(e,t){var n,o,i;const s=bs(e.prototype),r=Ts(e.prototype),l=s.obtainMap("hooks");null!==(n=t.hooks)&&void 0!==n||(t.hooks={}),null!==(o=t.methods)&&void 0!==o||(t.methods={});const a={},c={};r.forEach((e=>{let t=Ps(e,((e,t)=>"function"==typeof e.value&&"constructor"!==t));t=Ls(t,s,["watch","hooks","emits","provide","customDecorator"]),t.forEach((t=>{As.includes(t)||l.has(t)?a[t]=e[t]:c[t]=e[t]}))})),Object.assign(t.methods,c);const u=[...null!==(i=t.beforeCreateCallbacks)&&void 0!==i?i:[]];if(u&&u.length>0){const e=a.beforeCreate;a.beforeCreate=function(){u.forEach((e=>e.apply(this,arguments))),e&&e.apply(this,arguments)}}Object.assign(t.hooks,a)}(e,n);const o=Object.assign(Object.assign({name:e.name,setup:n.setup,data(){var t;return delete n.data,function(e,t){var n;null!==(n=t.data)&&void 0!==n||(t.data={});const o=new e;let i=Ps(o,((e,n)=>{var o,i;return!!e.enumerable&&!(null===(o=t.methods)||void 0===o?void 0:o[n])&&!(null===(i=t.props)||void 0===i?void 0:i[n])}));i=Ls(i,bs(e.prototype),["provide","customDecorator"]),Object.assign(t.data,i.reduce(((e,t)=>(e[t]=o[t],e)),{}))}(e,n),null!==(t=n.data)&&void 0!==t?t:{}},methods:n.methods,computed:n.computed,watch:n.watch,props:n.props,inject:n.inject,provide(){var t;return function(e,t,n){var o;null!==(o=t.provide)&&void 0!==o||(t.provide={});const i=bs(e.prototype).obtainMap("provide");if(!i)return null;i.forEach(((e,o)=>{const i=null===e?o:e;t.provide[i]=ki((()=>n[o]))}))}(e,n,this),null!==(t=n.provide)&&void 0!==t?t:{}}},n.hooks),{extends:t});return o}function zs(e,t){const n=bs(e.prototype);n.inComponent=!0;const o=$s(e.prototype);if(o){if(!o.inComponent)throw"Class should be decorated by Component or ComponentBase: "+n.master;if(null===o.cachedVueComponent)throw"Component decorator 1"}const i=function(e,t,n){var o,i;const s=js(e,n),r=bs(e.prototype);Object.keys(t).reduce(((e,n)=>(["options","modifier","methods","emits","setup","provide"].includes(n)||(e[n]=t[n]),e)),s);let l=Array.from(r.obtainMap("emits").keys());if(Array.isArray(t.emits)&&(l=Array.from(new Set([...l,...t.emits]))),s.emits=l,"object"!=typeof t.methods||Array.isArray(t.methods)||null===t.methods||(null!==(o=s.methods)&&void 0!==o||(s.methods={}),Object.assign(s.methods,t.methods)),s.setup){const e=s.setup,n=null!==(i=t.setup)&&void 0!==i?i:function(){return{}},o=function(t,o){const i=n(t,o),s=e(t,o);return s instanceof Promise||i instanceof Promise?Promise.all([i,s]).then((e=>Object.assign({},e[0],e[1]))):Object.assign({},i,s)};s.setup=o}else s.setup=t.setup;const a=Os(s.provide),c=Os(t.provide);s.provide=function(){return Object.assign({},a.call(this),c.call(this))};const u=r.getMap("customDecorator");return u&&u.size>0&&u.forEach((e=>{e.forEach((e=>e.creator.apply({},[s,e.key])))})),t.options&&Object.assign(s,t.options),t.modifier&&t.modifier(s),en(s)}(e,t,null===o?void 0:o.cachedVueComponent);i.__vfdConstructor=e,n.cachedVueComponent=i,e.__vccOpts=i}const Bs=(Ns=(e,t)=>{zs(e,null!=t?t:{})},function(e,t){if("function"!=typeof e){const t=e;return Cs((function(e){Ns(e,t)}))}{const n=e;Cs((function(e){Ns(e)}))(n,t)}});var Ns;function Fs(e){const t=bs(e.prototype);if(!t.inComponent)throw"to native 1";const n=t.cachedVueComponent;if(!n)throw"to native 2";return n}var Vs;const Is=lt({isActive:!1,emitter:{all:Vs=Vs||new Map,on:function(e,t){var n=Vs.get(e);n?n.push(t):Vs.set(e,[t])},off:function(e,t){var n=Vs.get(e);n&&(t?n.splice(n.indexOf(t)>>>0,1):Vs.set(e,[]))},emit:function(e,t){var n=Vs.get(e);n&&n.slice().map((function(e){e(t)})),(n=Vs.get("*"))&&n.slice().map((function(n){n(e,t)}))}},show(){this.isActive=!0,this.emitter.emit("show")},hide(){this.isActive=!1,this.emitter.emit("hide")}}),Us={mounted(e,t){if("object"!=typeof t.value)return void console.warn("v-drag expects a object with keys params, handleDrag as the directive value");let n,o,i;const s=t=>{e.setPointerCapture(t.pointerId),e.offsetLeft,e.offsetTop,o=t.clientX,i=t.clientY,n=!1,document.addEventListener("pointermove",r),document.addEventListener("pointerup",l),document.addEventListener("pointercancel",l),t.preventDefault()},r=e=>{const s=e.clientX-o,r=e.clientY-i;o=e.clientX,i=e.clientY,n=!0,t.value.handleDrag({x:s,y:r},t.value.params)},l=t=>{e.releasePointerCapture(t.pointerId),document.removeEventListener("pointermove",r),document.removeEventListener("pointerup",l),document.removeEventListener("pointercancel",l),n&&e.dispatchEvent(new CustomEvent("dragend",{bubbles:!0}))},a=e=>{n&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation())};e.addEventListener("pointerdown",s),e.addEventListener("click",a),e._dragHandlers={onMouseDown:s,onMouseMove:r,onMouseUp:l,onClick:a}},unmounted(e){if(e._dragHandlers){const{onMouseDown:t,onMouseMove:n,onMouseUp:o,onClick:i}=e._dragHandlers;e.removeEventListener("pointerdown",t),e.removeEventListener("click",i),document.removeEventListener("pointermove",n),document.removeEventListener("pointerup",o),document.removeEventListener("pointercancel",o)}}};class Ws{constructor(){this.abortController=new AbortController}setStreamCallback(e){this.streamCallback=e}getAbortController(){return this.abortController}send(e,t={}){let n=window.global.ai.chatUrl+"?do="+e;return new Promise(((e,o)=>{try{return fetch(n,{method:"POST",signal:this.abortController.signal,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8","X-Requested-With":"XMLHttpRequest"},body:new URLSearchParams(t)}).then((t=>{if(!t.ok)throw new Error("Network response was not ok");e(this.fetchResponse(t))})).catch((e=>{o(e)}))}catch(i){o(i)}}))}async fetchResponse(e){if("application/stream+json"===e.headers.get("Content-type")){const n=e.body.getReader(),o=new TextDecoder;let i,s="",r="";for(;;){const{done:e,value:l}=await n.read();if(e)break;s+=o.decode(l,{stream:!0});const a=s.split("\n");s=a.pop();for(const n of a)if(""!==n.trim())try{i=JSON.parse(n),r+=i.text,this.streamCallback(r,i)}catch(t){console.log(t)}}return new Promise((e=>{e({fullText:r,lastChunk:i})}))}return e.json().then((e=>(window.$.rs.checkAuthorization(e),window.$.rs.checkWindowRedirect(e),window.$.rs.checkMessages(e),e)))}}const Zs=(e,t)=>{const n=e.__vccOpts||e;for(const[o,i]of t)n[o]=i;return n},qs={class:"ai-trigger-icon",height:"24",viewBox:"0 0 846.66 846.66",width:"24","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg"};const Gs=Zs({},[["render",function(e,t){return Io(),qo("svg",qs,t[0]||(t[0]=[Jo("path",{fill:"currentColor",d:"M652.73 649.32l0 166.42c0,18.73 -22.85,27.54 -35.55,14.29l-196.15 -180.71 -165.38 0c-51.56,0 -93.66,-42.1 -93.66,-93.66l0 -360.47c0,-51.55 42.1,-93.65 93.66,-93.65l469.97 0c51.56,0 93.66,42.09 93.66,93.65l0 360.47c0,51.56 -42.1,93.66 -93.66,93.66l-72.89 0zm-334.34 -322.96c19.53,0 35.36,15.83 35.36,35.36 0,19.53 -15.83,35.36 -35.36,35.36 -19.53,0 -35.36,-15.83 -35.36,-35.36 0,-19.53 15.83,-35.36 35.36,-35.36zm344.49 0c19.53,0 35.36,15.83 35.36,35.36 0,19.53 -15.83,35.36 -35.36,35.36 -19.53,0 -35.36,-15.83 -35.36,-35.36 0,-19.53 15.83,-35.36 35.36,-35.36zm-114.83 0c19.53,0 35.36,15.83 35.36,35.36 0,19.53 -15.83,35.36 -35.36,35.36 -19.53,0 -35.36,-15.83 -35.36,-35.36 0,-19.53 15.83,-35.36 35.36,-35.36zm-114.83 0c19.53,0 35.36,15.83 35.36,35.36 0,19.53 -15.83,35.36 -35.36,35.36 -19.53,0 -35.36,-15.83 -35.36,-35.36 0,-19.53 15.83,-35.36 35.36,-35.36zm-312.18 190.39c27.16,0 27.16,41.31 0,41.31 -51.56,0 -93.66,-42.1 -93.66,-93.66l0 -360.47c0,-51.55 42.1,-93.65 93.66,-93.65l469.98 0c27.16,0 27.16,41.3 0,41.3l-469.98 0c-28.75,0 -52.35,23.6 -52.35,52.35l0 360.47c0,28.75 23.6,52.35 52.35,52.35zm490.39 251.94l0 -140.03c0,-11.4 9.25,-20.65 20.65,-20.65l93.54 0c28.75,0 52.36,-23.6 52.36,-52.35l0 -360.47c0,-28.75 -23.61,-52.35 -52.36,-52.35l-469.97 0c-28.76,0 -52.36,23.6 -52.36,52.35l0 360.47c0,28.75 23.6,52.35 52.36,52.35l173.38 0.05c4.99,0 10,1.79 13.96,5.44l168.44 155.19z"},null,-1)]))}]]),Ys={class:"ai-trigger-back",width:"36",height:"99",viewBox:"0 0 36 99",fill:"none",xmlns:"http://www.w3.org/2000/svg"};const Ks=Zs({},[["render",function(e,t){return Io(),qo("svg",Ys,t[0]||(t[0]=[Jo("path",{d:"M16 24.75C32.4999 14 35.9993 0 35.9993 0V49.5V99C35.9993 99 32.9999 83.8186 16 74.25C-1.00001 64.6814 0.99979 49.5 0.99979 49.5C0.99979 49.5 -0.500009 35.5 16 24.75Z",fill:"url(#paint0_linear_473_78)"},null,-1),Jo("defs",null,[Jo("linearGradient",{id:"paint0_linear_473_78",x1:"1.24435e-06",y1:"97.8195",x2:"35.29",y2:"0.921951",gradientUnits:"userSpaceOnUse"},[Jo("stop",{"stop-color":"#64B2DB"}),Jo("stop",{offset:"1","stop-color":"#DFEAFF"})])],-1)]))}]]),Xs=["start","end"],Qs=["top","right","bottom","left"].reduce(((e,t)=>e.concat(t,t+"-"+Xs[0],t+"-"+Xs[1])),[]),Js=Math.min,er=Math.max,tr={left:"right",right:"left",bottom:"top",top:"bottom"},nr={start:"end",end:"start"};function or(e,t,n){return er(e,Js(t,n))}function ir(e,t){return"function"==typeof e?e(t):e}function sr(e){return e.split("-")[0]}function rr(e){return e.split("-")[1]}function lr(e){return"x"===e?"y":"x"}function ar(e){return"y"===e?"height":"width"}function cr(e){return["top","bottom"].includes(sr(e))?"y":"x"}function ur(e){return lr(cr(e))}function dr(e,t,n){void 0===n&&(n=!1);const o=rr(e),i=ur(e),s=ar(i);let r="x"===i?o===(n?"end":"start")?"right":"left":"start"===o?"bottom":"top";return t.reference[s]>t.floating[s]&&(r=hr(r)),[r,hr(r)]}function pr(e){return e.replace(/start|end/g,(e=>nr[e]))}function hr(e){return e.replace(/left|right|bottom|top/g,(e=>tr[e]))}function fr(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function gr(e){const{x:t,y:n,width:o,height:i}=e;return{width:o,height:i,top:n,left:t,right:t+o,bottom:n+i,x:t,y:n}}function mr(e,t,n){let{reference:o,floating:i}=e;const s=cr(t),r=ur(t),l=ar(r),a=sr(t),c="y"===s,u=o.x+o.width/2-i.width/2,d=o.y+o.height/2-i.height/2,p=o[l]/2-i[l]/2;let h;switch(a){case"top":h={x:u,y:o.y-i.height};break;case"bottom":h={x:u,y:o.y+o.height};break;case"right":h={x:o.x+o.width,y:d};break;case"left":h={x:o.x-i.width,y:d};break;default:h={x:o.x,y:o.y}}switch(rr(t)){case"start":h[r]-=p*(n&&c?-1:1);break;case"end":h[r]+=p*(n&&c?-1:1)}return h}async function vr(e,t){var n;void 0===t&&(t={});const{x:o,y:i,platform:s,rects:r,elements:l,strategy:a}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:p=!1,padding:h=0}=ir(t,e),f=fr(h),g=l[p?"floating"===d?"reference":"floating":d],m=gr(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(g)))||n?g:g.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(l.floating)),boundary:c,rootBoundary:u,strategy:a})),v="floating"===d?{x:o,y:i,width:r.floating.width,height:r.floating.height}:r.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(l.floating)),w=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},b=gr(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:v,offsetParent:y,strategy:a}):v);return{top:(m.top-b.top+f.top)/w.y,bottom:(b.bottom-m.bottom+f.bottom)/w.y,left:(m.left-b.left+f.left)/w.x,right:(b.right-m.right+f.right)/w.x}}const yr=function(e){return void 0===e&&(e={}),{name:"autoPlacement",options:e,async fn(t){var n,o,i;const{rects:s,middlewareData:r,placement:l,platform:a,elements:c}=t,{crossAxis:u=!1,alignment:d,allowedPlacements:p=Qs,autoAlignment:h=!0,...f}=ir(e,t),g=void 0!==d||p===Qs?function(e,t,n){return(e?[...n.filter((t=>rr(t)===e)),...n.filter((t=>rr(t)!==e))]:n.filter((e=>sr(e)===e))).filter((n=>!e||rr(n)===e||!!t&&pr(n)!==n))}(d||null,h,p):p,m=await vr(t,f),v=(null==(n=r.autoPlacement)?void 0:n.index)||0,y=g[v];if(null==y)return{};const w=dr(y,s,await(null==a.isRTL?void 0:a.isRTL(c.floating)));if(l!==y)return{reset:{placement:g[0]}};const b=[m[sr(y)],m[w[0]],m[w[1]]],C=[...(null==(o=r.autoPlacement)?void 0:o.overflows)||[],{placement:y,overflows:b}],x=g[v+1];if(x)return{data:{index:v+1,overflows:C},reset:{placement:x}};const S=C.map((e=>{const t=rr(e.placement);return[e.placement,t&&u?e.overflows.slice(0,2).reduce(((e,t)=>e+t),0):e.overflows[0],e.overflows]})).sort(((e,t)=>e[1]-t[1])),k=(null==(i=S.filter((e=>e[2].slice(0,rr(e[0])?2:3).every((e=>e<=0))))[0])?void 0:i[0])||S[0][0];return k!==l?{data:{index:v+1,overflows:C},reset:{placement:k}}:{}}}},wr=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,o;const{placement:i,middlewareData:s,rects:r,initialPlacement:l,platform:a,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:g=!0,...m}=ir(e,t);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const v=sr(i),y=cr(l),w=sr(l)===l,b=await(null==a.isRTL?void 0:a.isRTL(c.floating)),C=p||(w||!g?[hr(l)]:function(e){const t=hr(e);return[pr(e),t,pr(t)]}(l)),x="none"!==f;!p&&x&&C.push(...function(e,t,n,o){const i=rr(e);let s=function(e,t,n){const o=["left","right"],i=["right","left"],s=["top","bottom"],r=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:o:t?o:i;case"left":case"right":return t?s:r;default:return[]}}(sr(e),"start"===n,o);return i&&(s=s.map((e=>e+"-"+i)),t&&(s=s.concat(s.map(pr)))),s}(l,g,f,b));const S=[l,...C],k=await vr(t,m),T=[];let L=(null==(o=s.flip)?void 0:o.overflows)||[];if(u&&T.push(k[v]),d){const e=dr(i,r,b);T.push(k[e[0]],k[e[1]])}if(L=[...L,{placement:i,overflows:T}],!T.every((e=>e<=0))){var P,O;const e=((null==(P=s.flip)?void 0:P.index)||0)+1,t=S[e];if(t){var M;const n="alignment"===d&&y!==cr(t),o=(null==(M=L[0])?void 0:M.overflows[0])>0;if(!n||o)return{data:{index:e,overflows:L},reset:{placement:t}}}let n=null==(O=L.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:O.placement;if(!n)switch(h){case"bestFit":{var A;const e=null==(A=L.filter((e=>{if(x){const t=cr(e.placement);return t===y||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:A[0];e&&(n=e);break}case"initialPlacement":n=l}if(i!==n)return{reset:{placement:n}}}return{}}}};const br=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,o;const{x:i,y:s,placement:r,middlewareData:l}=t,a=await async function(e,t){const{placement:n,platform:o,elements:i}=e,s=await(null==o.isRTL?void 0:o.isRTL(i.floating)),r=sr(n),l=rr(n),a="y"===cr(n),c=["left","top"].includes(r)?-1:1,u=s&&a?-1:1,d=ir(t,e);let{mainAxis:p,crossAxis:h,alignmentAxis:f}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return l&&"number"==typeof f&&(h="end"===l?-1*f:f),a?{x:h*u,y:p*c}:{x:p*c,y:h*u}}(t,e);return r===(null==(n=l.offset)?void 0:n.placement)&&null!=(o=l.arrow)&&o.alignmentOffset?{}:{x:i+a.x,y:s+a.y,data:{...a,placement:r}}}}};function _r(e){var t;return(null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Cr(e){return _r(e).getComputedStyle(e)}const xr=Math.min,Sr=Math.max,kr=Math.round;function Tr(e){const t=Cr(e);let n=parseFloat(t.width),o=parseFloat(t.height);const i=e.offsetWidth,s=e.offsetHeight,r=kr(n)!==i||kr(o)!==s;return r&&(n=i,o=s),{width:n,height:o,fallback:r}}function $r(e){return Ar(e)?(e.nodeName||"").toLowerCase():""}let Lr;function Pr(){if(Lr)return Lr;const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?(Lr=e.brands.map((e=>e.brand+"/"+e.version)).join(" "),Lr):navigator.userAgent}function Or(e){return e instanceof _r(e).HTMLElement}function Mr(e){return e instanceof _r(e).Element}function Ar(e){return e instanceof _r(e).Node}function Er(e){return"undefined"!=typeof ShadowRoot&&(e instanceof _r(e).ShadowRoot||e instanceof ShadowRoot)}function Dr(e){const{overflow:t,overflowX:n,overflowY:o,display:i}=Cr(e);return/auto|scroll|overlay|hidden|clip/.test(t+o+n)&&!["inline","contents"].includes(i)}function Rr(e){return["table","td","th"].includes($r(e))}function Hr(e){const t=/firefox/i.test(Pr()),n=Cr(e),o=n.backdropFilter||n.WebkitBackdropFilter;return"none"!==n.transform||"none"!==n.perspective||!!o&&"none"!==o||t&&"filter"===n.willChange||t&&!!n.filter&&"none"!==n.filter||["transform","perspective"].some((e=>n.willChange.includes(e)))||["paint","layout","strict","content"].some((e=>{const t=n.contain;return null!=t&&t.includes(e)}))}function jr(){return!/^((?!chrome|android).)*safari/i.test(Pr())}function zr(e){return["html","body","#document"].includes($r(e))}function Br(e){return Mr(e)?e:e.contextElement}const Nr={x:1,y:1};function Fr(e){const t=Br(e);if(!Or(t))return Nr;const n=t.getBoundingClientRect(),{width:o,height:i,fallback:s}=Tr(t);let r=(s?kr(n.width):n.width)/o,l=(s?kr(n.height):n.height)/i;return r&&Number.isFinite(r)||(r=1),l&&Number.isFinite(l)||(l=1),{x:r,y:l}}function Vr(e,t,n,o){var i,s;void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),l=Br(e);let a=Nr;t&&(o?Mr(o)&&(a=Fr(o)):a=Fr(e));const c=l?_r(l):window,u=!jr()&&n;let d=(r.left+(u&&(null==(i=c.visualViewport)?void 0:i.offsetLeft)||0))/a.x,p=(r.top+(u&&(null==(s=c.visualViewport)?void 0:s.offsetTop)||0))/a.y,h=r.width/a.x,f=r.height/a.y;if(l){const e=_r(l),t=o&&Mr(o)?_r(o):o;let n=e.frameElement;for(;n&&o&&t!==e;){const e=Fr(n),t=n.getBoundingClientRect(),o=getComputedStyle(n);t.x+=(n.clientLeft+parseFloat(o.paddingLeft))*e.x,t.y+=(n.clientTop+parseFloat(o.paddingTop))*e.y,d*=e.x,p*=e.y,h*=e.x,f*=e.y,d+=t.x,p+=t.y,n=_r(n).frameElement}}return{width:h,height:f,top:p,right:d+h,bottom:p+f,left:d,x:d,y:p}}function Ir(e){return((Ar(e)?e.ownerDocument:e.document)||window.document).documentElement}function Ur(e){return Mr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function Wr(e){return Vr(Ir(e)).left+Ur(e).scrollLeft}function Zr(e){if("html"===$r(e))return e;const t=e.assignedSlot||e.parentNode||Er(e)&&e.host||Ir(e);return Er(t)?t.host:t}function qr(e){const t=Zr(e);return zr(t)?t.ownerDocument.body:Or(t)&&Dr(t)?t:qr(t)}function Gr(e,t){var n;void 0===t&&(t=[]);const o=qr(e),i=o===(null==(n=e.ownerDocument)?void 0:n.body),s=_r(o);return i?t.concat(s,s.visualViewport||[],Dr(o)?o:[]):t.concat(o,Gr(o))}function Yr(e,t,n){return"viewport"===t?gr(function(e,t){const n=_r(e),o=Ir(e),i=n.visualViewport;let s=o.clientWidth,r=o.clientHeight,l=0,a=0;if(i){s=i.width,r=i.height;const e=jr();(e||!e&&"fixed"===t)&&(l=i.offsetLeft,a=i.offsetTop)}return{width:s,height:r,x:l,y:a}}(e,n)):Mr(t)?gr(function(e,t){const n=Vr(e,!0,"fixed"===t),o=n.top+e.clientTop,i=n.left+e.clientLeft,s=Or(e)?Fr(e):{x:1,y:1};return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:i*s.x,y:o*s.y}}(t,n)):gr(function(e){const t=Ir(e),n=Ur(e),o=e.ownerDocument.body,i=Sr(t.scrollWidth,t.clientWidth,o.scrollWidth,o.clientWidth),s=Sr(t.scrollHeight,t.clientHeight,o.scrollHeight,o.clientHeight);let r=-n.scrollLeft+Wr(e);const l=-n.scrollTop;return"rtl"===Cr(o).direction&&(r+=Sr(t.clientWidth,o.clientWidth)-i),{width:i,height:s,x:r,y:l}}(Ir(e)))}function Kr(e){return Or(e)&&"fixed"!==Cr(e).position?e.offsetParent:null}function Xr(e){const t=_r(e);let n=Kr(e);for(;n&&Rr(n)&&"static"===Cr(n).position;)n=Kr(n);return n&&("html"===$r(n)||"body"===$r(n)&&"static"===Cr(n).position&&!Hr(n))?t:n||function(e){let t=Zr(e);for(;Or(t)&&!zr(t);){if(Hr(t))return t;t=Zr(t)}return null}(e)||t}function Qr(e,t,n){const o=Or(t),i=Ir(t),s=Vr(e,!0,"fixed"===n,t);let r={scrollLeft:0,scrollTop:0};const l={x:0,y:0};if(o||!o&&"fixed"!==n)if(("body"!==$r(t)||Dr(i))&&(r=Ur(t)),Or(t)){const e=Vr(t,!0);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else i&&(l.x=Wr(i));return{x:s.left+r.scrollLeft-l.x,y:s.top+r.scrollTop-l.y,width:s.width,height:s.height}}const Jr={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:o,strategy:i}=e;const s=[..."clippingAncestors"===n?function(e,t){const n=t.get(e);if(n)return n;let o=Gr(e).filter((e=>Mr(e)&&"body"!==$r(e))),i=null;const s="fixed"===Cr(e).position;let r=s?Zr(e):e;for(;Mr(r)&&!zr(r);){const e=Cr(r),t=Hr(r);(s?t||i:t||"static"!==e.position||!i||!["absolute","fixed"].includes(i.position))?i=e:o=o.filter((e=>e!==r)),r=Zr(r)}return t.set(e,o),o}(t,this._c):[].concat(n),o],r=s[0],l=s.reduce(((e,n)=>{const o=Yr(t,n,i);return e.top=Sr(o.top,e.top),e.right=xr(o.right,e.right),e.bottom=xr(o.bottom,e.bottom),e.left=Sr(o.left,e.left),e}),Yr(t,r,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:o}=e;const i=Or(n),s=Ir(n);if(n===s)return t;let r={scrollLeft:0,scrollTop:0},l={x:1,y:1};const a={x:0,y:0};if((i||!i&&"fixed"!==o)&&(("body"!==$r(n)||Dr(s))&&(r=Ur(n)),Or(n))){const e=Vr(n);l=Fr(n),a.x=e.x+n.clientLeft,a.y=e.y+n.clientTop}return{width:t.width*l.x,height:t.height*l.y,x:t.x*l.x-r.scrollLeft*l.x+a.x,y:t.y*l.y-r.scrollTop*l.y+a.y}},isElement:Mr,getDimensions:function(e){return Or(e)?Tr(e):e.getBoundingClientRect()},getOffsetParent:Xr,getDocumentElement:Ir,getScale:Fr,async getElementRects(e){let{reference:t,floating:n,strategy:o}=e;const i=this.getOffsetParent||Xr,s=this.getDimensions;return{reference:Qr(t,await i(n),o),floating:{x:0,y:0,...await s(n)}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>"rtl"===Cr(e).direction},el=(e,t,n)=>{const o=new Map,i={platform:Jr,...n},s={...i.platform,_c:o};return(async(e,t,n)=>{const{placement:o="bottom",strategy:i="absolute",middleware:s=[],platform:r}=n,l=s.filter(Boolean),a=await(null==r.isRTL?void 0:r.isRTL(t));let c=await r.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=mr(c,o,a),p=o,h={},f=0;for(let g=0;g<l.length;g++){const{name:n,fn:s}=l[g],{x:m,y:v,data:y,reset:w}=await s({x:u,y:d,initialPlacement:o,placement:p,strategy:i,middlewareData:h,rects:c,platform:r,elements:{reference:e,floating:t}});u=null!=m?m:u,d=null!=v?v:d,h={...h,[n]:{...h[n],...y}},w&&f<=50&&(f++,"object"==typeof w&&(w.placement&&(p=w.placement),w.rects&&(c=!0===w.rects?await r.getElementRects({reference:e,floating:t,strategy:i}):w.rects),({x:u,y:d}=mr(c,p,a))),g=-1)}return{x:u,y:d,placement:p,strategy:i,middlewareData:h}})(e,t,{...i,platform:s})};function tl(e,t){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&("object"==typeof t[n]&&e[n]?tl(e[n],t[n]):e[n]=t[n])}const nl={disabled:!1,distance:5,skidding:0,container:"body",boundary:void 0,instantMove:!1,disposeTimeout:150,popperTriggers:[],strategy:"absolute",preventOverflow:!0,flip:!0,shift:!0,overflowPadding:0,arrowPadding:0,arrowOverflow:!0,autoHideOnMousedown:!1,themes:{tooltip:{placement:"top",triggers:["hover","focus","touch"],hideTriggers:e=>[...e,"click"],delay:{show:200,hide:0},handleResize:!1,html:!1,loadingContent:"..."},dropdown:{placement:"bottom",triggers:["click"],delay:0,handleResize:!0,autoHide:!0},menu:{$extend:"dropdown",triggers:["hover","focus"],popperTriggers:["hover"],delay:{show:0,hide:400}}}};function ol(e,t){let n,o=nl.themes[e]||{};do{n=o[t],typeof n>"u"?o.$extend?o=nl.themes[o.$extend]||{}:(o=null,n=nl[t]):o=null}while(o);return n}function il(e){const t=[e];let n=nl.themes[e]||{};do{n.$extend?(t.push(n.$extend),n=nl.themes[n.$extend]||{}):n=null}while(n);return t}let sl=!1;if(typeof window<"u"){sl=!1;try{const e=Object.defineProperty({},"passive",{get(){sl=!0}});window.addEventListener("test",null,e)}catch{}}let rl=!1;typeof window<"u"&&typeof navigator<"u"&&(rl=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream);const ll=["auto","top","bottom","left","right"].reduce(((e,t)=>e.concat([t,`${t}-start`,`${t}-end`])),[]),al={hover:"mouseenter",focus:"focus",click:"click",touch:"touchstart",pointer:"pointerdown"},cl={hover:"mouseleave",focus:"blur",click:"click",touch:"touchend",pointer:"pointerup"};function ul(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function dl(){return new Promise((e=>requestAnimationFrame((()=>{requestAnimationFrame(e)}))))}const pl=[];let hl=null;const fl={};function gl(e){let t=fl[e];return t||(t=fl[e]=[]),t}let ml=function(){};function vl(e){return function(t){return ol(t.theme,e)}}typeof window<"u"&&(ml=window.Element);const yl="__floating-vue__popper",wl=()=>en({name:"VPopper",provide(){return{[yl]:{parentPopper:this}}},inject:{[yl]:{default:null}},props:{theme:{type:String,required:!0},targetNodes:{type:Function,required:!0},referenceNode:{type:Function,default:null},popperNode:{type:Function,required:!0},shown:{type:Boolean,default:!1},showGroup:{type:String,default:null},ariaId:{default:null},disabled:{type:Boolean,default:vl("disabled")},positioningDisabled:{type:Boolean,default:vl("positioningDisabled")},placement:{type:String,default:vl("placement"),validator:e=>ll.includes(e)},delay:{type:[String,Number,Object],default:vl("delay")},distance:{type:[Number,String],default:vl("distance")},skidding:{type:[Number,String],default:vl("skidding")},triggers:{type:Array,default:vl("triggers")},showTriggers:{type:[Array,Function],default:vl("showTriggers")},hideTriggers:{type:[Array,Function],default:vl("hideTriggers")},popperTriggers:{type:Array,default:vl("popperTriggers")},popperShowTriggers:{type:[Array,Function],default:vl("popperShowTriggers")},popperHideTriggers:{type:[Array,Function],default:vl("popperHideTriggers")},container:{type:[String,Object,ml,Boolean],default:vl("container")},boundary:{type:[String,ml],default:vl("boundary")},strategy:{type:String,validator:e=>["absolute","fixed"].includes(e),default:vl("strategy")},autoHide:{type:[Boolean,Function],default:vl("autoHide")},handleResize:{type:Boolean,default:vl("handleResize")},instantMove:{type:Boolean,default:vl("instantMove")},eagerMount:{type:Boolean,default:vl("eagerMount")},popperClass:{type:[String,Array,Object],default:vl("popperClass")},computeTransformOrigin:{type:Boolean,default:vl("computeTransformOrigin")},autoMinSize:{type:Boolean,default:vl("autoMinSize")},autoSize:{type:[Boolean,String],default:vl("autoSize")},autoMaxSize:{type:Boolean,default:vl("autoMaxSize")},autoBoundaryMaxSize:{type:Boolean,default:vl("autoBoundaryMaxSize")},preventOverflow:{type:Boolean,default:vl("preventOverflow")},overflowPadding:{type:[Number,String],default:vl("overflowPadding")},arrowPadding:{type:[Number,String],default:vl("arrowPadding")},arrowOverflow:{type:Boolean,default:vl("arrowOverflow")},flip:{type:Boolean,default:vl("flip")},shift:{type:Boolean,default:vl("shift")},shiftCrossAxis:{type:Boolean,default:vl("shiftCrossAxis")},noAutoFocus:{type:Boolean,default:vl("noAutoFocus")},disposeTimeout:{type:Number,default:vl("disposeTimeout")}},emits:{show:()=>!0,hide:()=>!0,"update:shown":e=>!0,"apply-show":()=>!0,"apply-hide":()=>!0,"close-group":()=>!0,"close-directive":()=>!0,"auto-hide":()=>!0,resize:()=>!0},data(){return{isShown:!1,isMounted:!1,skipTransition:!1,classes:{showFrom:!1,showTo:!1,hideFrom:!1,hideTo:!0},result:{x:0,y:0,placement:"",strategy:this.strategy,arrow:{x:0,y:0,centerOffset:0},transformOrigin:null},randomId:`popper_${[Math.random(),Date.now()].map((e=>e.toString(36).substring(2,10))).join("_")}`,shownChildren:new Set,lastAutoHide:!0,pendingHide:!1,containsGlobalTarget:!1,isDisposed:!0,mouseDownContains:!1}},computed:{popperId(){return null!=this.ariaId?this.ariaId:this.randomId},shouldMountContent(){return this.eagerMount||this.isMounted},slotData(){return{popperId:this.popperId,isShown:this.isShown,shouldMountContent:this.shouldMountContent,skipTransition:this.skipTransition,autoHide:"function"==typeof this.autoHide?this.lastAutoHide:this.autoHide,show:this.show,hide:this.hide,handleResize:this.handleResize,onResize:this.onResize,classes:{...this.classes,popperClass:this.popperClass},result:this.positioningDisabled?null:this.result,attrs:this.$attrs}},parentPopper(){var e;return null==(e=this[yl])?void 0:e.parentPopper},hasPopperShowTriggerHover(){var e,t;return(null==(e=this.popperTriggers)?void 0:e.includes("hover"))||(null==(t=this.popperShowTriggers)?void 0:t.includes("hover"))}},watch:{shown:"$_autoShowHide",disabled(e){e?this.dispose():this.init()},async container(){this.isShown&&(this.$_ensureTeleport(),await this.$_computePosition())},triggers:{handler:"$_refreshListeners",deep:!0},positioningDisabled:"$_refreshListeners",...["placement","distance","skidding","boundary","strategy","overflowPadding","arrowPadding","preventOverflow","shift","shiftCrossAxis","flip"].reduce(((e,t)=>(e[t]="$_computePosition",e)),{})},created(){this.autoMinSize&&console.warn('[floating-vue] `autoMinSize` option is deprecated. Use `autoSize="min"` instead.'),this.autoMaxSize&&console.warn("[floating-vue] `autoMaxSize` option is deprecated. Use `autoBoundaryMaxSize` instead.")},mounted(){this.init(),this.$_detachPopperNode()},activated(){this.$_autoShowHide()},deactivated(){this.hide()},beforeUnmount(){this.dispose()},methods:{show({event:e=null,skipDelay:t=!1,force:n=!1}={}){var o,i;null!=(o=this.parentPopper)&&o.lockedChild&&this.parentPopper.lockedChild!==this||(this.pendingHide=!1,(n||!this.disabled)&&((null==(i=this.parentPopper)?void 0:i.lockedChild)===this&&(this.parentPopper.lockedChild=null),this.$_scheduleShow(e,t),this.$emit("show"),this.$_showFrameLocked=!0,requestAnimationFrame((()=>{this.$_showFrameLocked=!1}))),this.$emit("update:shown",!0))},hide({event:e=null,skipDelay:t=!1}={}){var n;if(!this.$_hideInProgress){if(this.shownChildren.size>0)return void(this.pendingHide=!0);if(this.hasPopperShowTriggerHover&&this.$_isAimingPopper())return void(this.parentPopper&&(this.parentPopper.lockedChild=this,clearTimeout(this.parentPopper.lockedChildTimer),this.parentPopper.lockedChildTimer=setTimeout((()=>{this.parentPopper.lockedChild===this&&(this.parentPopper.lockedChild.hide({skipDelay:t}),this.parentPopper.lockedChild=null)}),1e3)));(null==(n=this.parentPopper)?void 0:n.lockedChild)===this&&(this.parentPopper.lockedChild=null),this.pendingHide=!1,this.$_scheduleHide(e,t),this.$emit("hide"),this.$emit("update:shown",!1)}},init(){var e;this.isDisposed&&(this.isDisposed=!1,this.isMounted=!1,this.$_events=[],this.$_preventShow=!1,this.$_referenceNode=(null==(e=this.referenceNode)?void 0:e.call(this))??this.$el,this.$_targetNodes=this.targetNodes().filter((e=>e.nodeType===e.ELEMENT_NODE)),this.$_popperNode=this.popperNode(),this.$_innerNode=this.$_popperNode.querySelector(".v-popper__inner"),this.$_arrowNode=this.$_popperNode.querySelector(".v-popper__arrow-container"),this.$_swapTargetAttrs("title","data-original-title"),this.$_detachPopperNode(),this.triggers.length&&this.$_addEventListeners(),this.shown&&this.show())},dispose(){this.isDisposed||(this.isDisposed=!0,this.$_removeEventListeners(),this.hide({skipDelay:!0}),this.$_detachPopperNode(),this.isMounted=!1,this.isShown=!1,this.$_updateParentShownChildren(!1),this.$_swapTargetAttrs("data-original-title","title"))},async onResize(){this.isShown&&(await this.$_computePosition(),this.$emit("resize"))},async $_computePosition(){if(this.isDisposed||this.positioningDisabled)return;const e={strategy:this.strategy,middleware:[]};(this.distance||this.skidding)&&e.middleware.push(br({mainAxis:this.distance,crossAxis:this.skidding}));const t=this.placement.startsWith("auto");if(t?e.middleware.push(yr({alignment:this.placement.split("-")[1]??""})):e.placement=this.placement,this.preventOverflow&&(this.shift&&e.middleware.push((void 0===(n={padding:this.overflowPadding,boundary:this.boundary,crossAxis:this.shiftCrossAxis})&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:o,placement:i}=e,{mainAxis:s=!0,crossAxis:r=!1,limiter:l={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...a}=ir(n,e),c={x:t,y:o},u=await vr(e,a),d=cr(sr(i)),p=lr(d);let h=c[p],f=c[d];if(s){const e="y"===p?"bottom":"right";h=or(h+u["y"===p?"top":"left"],h,h-u[e])}if(r){const e="y"===d?"bottom":"right";f=or(f+u["y"===d?"top":"left"],f,f-u[e])}const g=l.fn({...e,[p]:h,[d]:f});return{...g,data:{x:g.x-t,y:g.y-o,enabled:{[p]:s,[d]:r}}}}})),!t&&this.flip&&e.middleware.push(wr({padding:this.overflowPadding,boundary:this.boundary}))),e.middleware.push((e=>({name:"arrow",options:e,async fn(t){const{x:n,y:o,placement:i,rects:s,platform:r,elements:l,middlewareData:a}=t,{element:c,padding:u=0}=ir(e,t)||{};if(null==c)return{};const d=fr(u),p={x:n,y:o},h=ur(i),f=ar(h),g=await r.getDimensions(c),m="y"===h,v=m?"top":"left",y=m?"bottom":"right",w=m?"clientHeight":"clientWidth",b=s.reference[f]+s.reference[h]-p[h]-s.floating[f],C=p[h]-s.reference[h],x=await(null==r.getOffsetParent?void 0:r.getOffsetParent(c));let S=x?x[w]:0;S&&await(null==r.isElement?void 0:r.isElement(x))||(S=l.floating[w]||s.floating[f]);const k=b/2-C/2,T=S/2-g[f]/2-1,L=Js(d[v],T),P=Js(d[y],T),O=L,M=S-g[f]-P,A=S/2-g[f]/2+k,E=or(O,A,M),D=!a.arrow&&null!=rr(i)&&A!==E&&s.reference[f]/2-(A<O?L:P)-g[f]/2<0,R=D?A<O?A-O:A-M:0;return{[h]:p[h]+R,data:{[h]:E,centerOffset:A-E-R,...D&&{alignmentOffset:R}},reset:D}}}))({element:this.$_arrowNode,padding:this.arrowPadding})),this.arrowOverflow&&e.middleware.push({name:"arrowOverflow",fn:({placement:e,rects:t,middlewareData:n})=>{let o;const{centerOffset:i}=n.arrow;return o=e.startsWith("top")||e.startsWith("bottom")?Math.abs(i)>t.reference.width/2:Math.abs(i)>t.reference.height/2,{data:{overflow:o}}}}),this.autoMinSize||this.autoSize){const t=this.autoSize?this.autoSize:this.autoMinSize?"min":null;e.middleware.push({name:"autoSize",fn:({rects:e,placement:n,middlewareData:o})=>{var i;if(null!=(i=o.autoSize)&&i.skip)return{};let s,r;return n.startsWith("top")||n.startsWith("bottom")?s=e.reference.width:r=e.reference.height,this.$_innerNode.style["min"===t?"minWidth":"max"===t?"maxWidth":"width"]=null!=s?`${s}px`:null,this.$_innerNode.style["min"===t?"minHeight":"max"===t?"maxHeight":"height"]=null!=r?`${r}px`:null,{data:{skip:!0},reset:{rects:!0}}}})}var n;(this.autoMaxSize||this.autoBoundaryMaxSize)&&(this.$_innerNode.style.maxWidth=null,this.$_innerNode.style.maxHeight=null,e.middleware.push(function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var n,o;const{placement:i,rects:s,platform:r,elements:l}=t,{apply:a=()=>{},...c}=ir(e,t),u=await vr(t,c),d=sr(i),p=rr(i),h="y"===cr(i),{width:f,height:g}=s.floating;let m,v;"top"===d||"bottom"===d?(m=d,v=p===(await(null==r.isRTL?void 0:r.isRTL(l.floating))?"start":"end")?"left":"right"):(v=d,m="end"===p?"top":"bottom");const y=g-u.top-u.bottom,w=f-u.left-u.right,b=Js(g-u[m],y),C=Js(f-u[v],w),x=!t.middlewareData.shift;let S=b,k=C;if(null!=(n=t.middlewareData.shift)&&n.enabled.x&&(k=w),null!=(o=t.middlewareData.shift)&&o.enabled.y&&(S=y),x&&!p){const e=er(u.left,0),t=er(u.right,0),n=er(u.top,0),o=er(u.bottom,0);h?k=f-2*(0!==e||0!==t?e+t:er(u.left,u.right)):S=g-2*(0!==n||0!==o?n+o:er(u.top,u.bottom))}await a({...t,availableWidth:k,availableHeight:S});const T=await r.getDimensions(l.floating);return f!==T.width||g!==T.height?{reset:{rects:!0}}:{}}}}({boundary:this.boundary,padding:this.overflowPadding,apply:({availableWidth:e,availableHeight:t})=>{this.$_innerNode.style.maxWidth=null!=e?`${e}px`:null,this.$_innerNode.style.maxHeight=null!=t?`${t}px`:null}})));const o=await el(this.$_referenceNode,this.$_popperNode,e);Object.assign(this.result,{x:o.x,y:o.y,placement:o.placement,strategy:o.strategy,arrow:{...o.middlewareData.arrow,...o.middlewareData.arrowOverflow}})},$_scheduleShow(e,t=!1){if(this.$_updateParentShownChildren(!0),this.$_hideInProgress=!1,clearTimeout(this.$_scheduleTimer),hl&&this.instantMove&&hl.instantMove&&hl!==this.parentPopper)return hl.$_applyHide(!0),void this.$_applyShow(!0);t?this.$_applyShow():this.$_scheduleTimer=setTimeout(this.$_applyShow.bind(this),this.$_computeDelay("show"))},$_scheduleHide(e,t=!1){this.shownChildren.size>0?this.pendingHide=!0:(this.$_updateParentShownChildren(!1),this.$_hideInProgress=!0,clearTimeout(this.$_scheduleTimer),this.isShown&&(hl=this),t?this.$_applyHide():this.$_scheduleTimer=setTimeout(this.$_applyHide.bind(this),this.$_computeDelay("hide")))},$_computeDelay(e){const t=this.delay;return parseInt(t&&t[e]||t||0)},async $_applyShow(e=!1){clearTimeout(this.$_disposeTimer),clearTimeout(this.$_scheduleTimer),this.skipTransition=e,!this.isShown&&(this.$_ensureTeleport(),await dl(),await this.$_computePosition(),await this.$_applyShowEffect(),this.positioningDisabled||this.$_registerEventListeners([...Gr(this.$_referenceNode),...Gr(this.$_popperNode)],"scroll",(()=>{this.$_computePosition()})))},async $_applyShowEffect(){if(this.$_hideInProgress)return;if(this.computeTransformOrigin){const e=this.$_referenceNode.getBoundingClientRect(),t=this.$_popperNode.querySelector(".v-popper__wrapper"),n=t.parentNode.getBoundingClientRect(),o=e.x+e.width/2-(n.left+t.offsetLeft),i=e.y+e.height/2-(n.top+t.offsetTop);this.result.transformOrigin=`${o}px ${i}px`}this.isShown=!0,this.$_applyAttrsToTarget({"aria-describedby":this.popperId,"data-popper-shown":""});const e=this.showGroup;if(e){let t;for(let n=0;n<pl.length;n++)t=pl[n],t.showGroup!==e&&(t.hide(),t.$emit("close-group"))}pl.push(this),document.body.classList.add("v-popper--some-open");for(const t of il(this.theme))gl(t).push(this),document.body.classList.add(`v-popper--some-open--${t}`);this.$emit("apply-show"),this.classes.showFrom=!0,this.classes.showTo=!1,this.classes.hideFrom=!1,this.classes.hideTo=!1,await dl(),this.classes.showFrom=!1,this.classes.showTo=!0,this.noAutoFocus||this.$_popperNode.focus()},async $_applyHide(e=!1){if(this.shownChildren.size>0)return this.pendingHide=!0,void(this.$_hideInProgress=!1);if(clearTimeout(this.$_scheduleTimer),!this.isShown)return;this.skipTransition=e,ul(pl,this),0===pl.length&&document.body.classList.remove("v-popper--some-open");for(const n of il(this.theme)){const e=gl(n);ul(e,this),0===e.length&&document.body.classList.remove(`v-popper--some-open--${n}`)}hl===this&&(hl=null),this.isShown=!1,this.$_applyAttrsToTarget({"aria-describedby":void 0,"data-popper-shown":void 0}),clearTimeout(this.$_disposeTimer);const t=this.disposeTimeout;null!==t&&(this.$_disposeTimer=setTimeout((()=>{this.$_popperNode&&(this.$_detachPopperNode(),this.isMounted=!1)}),t)),this.$_removeEventListeners("scroll"),this.$emit("apply-hide"),this.classes.showFrom=!1,this.classes.showTo=!1,this.classes.hideFrom=!0,this.classes.hideTo=!1,await dl(),this.classes.hideFrom=!1,this.classes.hideTo=!0},$_autoShowHide(){this.shown?this.show():this.hide()},$_ensureTeleport(){if(this.isDisposed)return;let e=this.container;if("string"==typeof e?e=window.document.querySelector(e):!1===e&&(e=this.$_targetNodes[0].parentNode),!e)throw new Error("No container for popover: "+this.container);e.appendChild(this.$_popperNode),this.isMounted=!0},$_addEventListeners(){const e=e=>{this.isShown&&!this.$_hideInProgress||(e.usedByTooltip=!0,!this.$_preventShow&&this.show({event:e}))};this.$_registerTriggerListeners(this.$_targetNodes,al,this.triggers,this.showTriggers,e),this.$_registerTriggerListeners([this.$_popperNode],al,this.popperTriggers,this.popperShowTriggers,e);const t=e=>{e.usedByTooltip||this.hide({event:e})};this.$_registerTriggerListeners(this.$_targetNodes,cl,this.triggers,this.hideTriggers,t),this.$_registerTriggerListeners([this.$_popperNode],cl,this.popperTriggers,this.popperHideTriggers,t)},$_registerEventListeners(e,t,n){this.$_events.push({targetNodes:e,eventType:t,handler:n}),e.forEach((e=>e.addEventListener(t,n,sl?{passive:!0}:void 0)))},$_registerTriggerListeners(e,t,n,o,i){let s=n;null!=o&&(s="function"==typeof o?o(s):o),s.forEach((n=>{const o=t[n];o&&this.$_registerEventListeners(e,o,i)}))},$_removeEventListeners(e){const t=[];this.$_events.forEach((n=>{const{targetNodes:o,eventType:i,handler:s}=n;e&&e!==i?t.push(n):o.forEach((e=>e.removeEventListener(i,s)))})),this.$_events=t},$_refreshListeners(){this.isDisposed||(this.$_removeEventListeners(),this.$_addEventListeners())},$_handleGlobalClose(e,t=!1){this.$_showFrameLocked||(this.hide({event:e}),e.closePopover?this.$emit("close-directive"):this.$emit("auto-hide"),t&&(this.$_preventShow=!0,setTimeout((()=>{this.$_preventShow=!1}),300)))},$_detachPopperNode(){this.$_popperNode.parentNode&&this.$_popperNode.parentNode.removeChild(this.$_popperNode)},$_swapTargetAttrs(e,t){for(const n of this.$_targetNodes){const o=n.getAttribute(e);o&&(n.removeAttribute(e),n.setAttribute(t,o))}},$_applyAttrsToTarget(e){for(const t of this.$_targetNodes)for(const n in e){const o=e[n];null==o?t.removeAttribute(n):t.setAttribute(n,o)}},$_updateParentShownChildren(e){let t=this.parentPopper;for(;t;)e?t.shownChildren.add(this.randomId):(t.shownChildren.delete(this.randomId),t.pendingHide&&t.hide()),t=t.parentPopper},$_isAimingPopper(){const e=this.$_referenceNode.getBoundingClientRect();if(Tl>=e.left&&Tl<=e.right&&_>=e.top&&_<=e.bottom){const e=this.$_popperNode.getBoundingClientRect(),t=Tl-Sl,n=_-kl,o=e.left+e.width/2-Sl+(e.top+e.height/2)-kl+e.width+e.height,i=Sl+t*o,s=kl+n*o;return $l(Sl,kl,i,s,e.left,e.top,e.left,e.bottom)||$l(Sl,kl,i,s,e.left,e.top,e.right,e.top)||$l(Sl,kl,i,s,e.right,e.top,e.right,e.bottom)||$l(Sl,kl,i,s,e.left,e.bottom,e.right,e.bottom)}return!1}},render(){return this.$slots.default(this.slotData)}});if(typeof document<"u"&&typeof window<"u"){if(rl){const e=!sl||{passive:!0,capture:!0};document.addEventListener("touchstart",(e=>bl(e,!0)),e),document.addEventListener("touchend",(e=>_l(e,!0)),e)}else window.addEventListener("mousedown",(e=>bl(e,!1)),!0),window.addEventListener("click",(e=>_l(e,!1)),!0);window.addEventListener("resize",(function(){for(let e=0;e<pl.length;e++)pl[e].$_computePosition()}))}function bl(e,t){if(nl.autoHideOnMousedown)Cl(e,t);else for(let n=0;n<pl.length;n++){const t=pl[n];try{t.mouseDownContains=t.popperNode().contains(e.target)}catch{}}}function _l(e,t){nl.autoHideOnMousedown||Cl(e,t)}function Cl(e,t){const n={};for(let o=pl.length-1;o>=0;o--){const i=pl[o];try{const o=i.containsGlobalTarget=i.mouseDownContains||i.popperNode().contains(e.target);i.pendingHide=!1,requestAnimationFrame((()=>{if(i.pendingHide=!1,!n[i.randomId]&&xl(i,o,e)){if(i.$_handleGlobalClose(e,t),!e.closeAllPopover&&e.closePopover&&o){let e=i.parentPopper;for(;e;)n[e.randomId]=!0,e=e.parentPopper;return}let s=i.parentPopper;for(;s&&xl(s,s.containsGlobalTarget,e);)s.$_handleGlobalClose(e,t),s=s.parentPopper}}))}catch{}}}function xl(e,t,n){return n.closeAllPopover||n.closePopover&&t||function(e,t){if("function"==typeof e.autoHide){const n=e.autoHide(t);return e.lastAutoHide=n,n}return e.autoHide}(e,n)&&!t}let Sl=0,kl=0,Tl=0,_=0;function $l(e,t,n,o,i,s,r,l){const a=((r-i)*(t-s)-(l-s)*(e-i))/((l-s)*(n-e)-(r-i)*(o-t)),c=((n-e)*(t-s)-(o-t)*(e-i))/((l-s)*(n-e)-(r-i)*(o-t));return a>=0&&a<=1&&c>=0&&c<=1}typeof window<"u"&&window.addEventListener("mousemove",(e=>{Sl=Tl,kl=_,Tl=e.clientX,_=e.clientY}),sl?{passive:!0}:void 0);const Ll=(e,t)=>{const n=e.__vccOpts||e;for(const[o,i]of t)n[o]=i;return n};const Pl=Ll({extends:wl()},[["render",function(e,t,n,o,i,s){return Io(),qo("div",{ref:"reference",class:U(["v-popper",{"v-popper--shown":e.slotData.isShown}])},[Pn(e.$slots,"default",W(ti(e.slotData)))],2)}]]);let Ol;function Ml(){Ml.init||(Ml.init=!0,Ol=-1!==function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var o=e.indexOf("Edge/");return o>0?parseInt(e.substring(o+5,e.indexOf(".",o)),10):-1}())}var Al={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){Ml(),zt((()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()}));const e=document.createElement("object");this._resizeObject=e,e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex",-1),e.onload=this.addResizeHandlers,e.type="text/html",Ol&&this.$el.appendChild(e),e.data="about:blank",Ol||this.$el.appendChild(e)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!Ol&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};Zt="data-v-b329ee4c";const El={class:"resize-observer",tabindex:"-1"};Zt=null;const Dl=Gt()(((e,t,n,o,i,s)=>(Io(),Go("div",El))));Al.render=Dl,Al.__scopeId="data-v-b329ee4c",Al.__file="src/components/ResizeObserver.vue";const Rl=(e="theme")=>({computed:{themeClass(){return function(e){const t=[e];let n=nl.themes[e]||{};do{n.$extend&&!n.$resetCss?(t.push(n.$extend),n=nl.themes[n.$extend]||{}):n=null}while(n);return t.map((e=>`v-popper--theme-${e}`))}(this[e])}}}),Hl=en({name:"VPopperContent",components:{ResizeObserver:Al},mixins:[Rl()],props:{popperId:String,theme:String,shown:Boolean,mounted:Boolean,skipTransition:Boolean,autoHide:Boolean,handleResize:Boolean,classes:Object,result:Object},emits:["hide","resize"],methods:{toPx:e=>null==e||isNaN(e)?null:`${e}px`}}),jl=["id","aria-hidden","tabindex","data-popper-placement"],zl={ref:"inner",class:"v-popper__inner"},Bl=[Jo("div",{class:"v-popper__arrow-outer"},null,-1),Jo("div",{class:"v-popper__arrow-inner"},null,-1)];const Nl=Ll(Hl,[["render",function(e,t,n,o,i,s){const r=xn("ResizeObserver");return Io(),qo("div",{id:e.popperId,ref:"popover",class:U(["v-popper__popper",[e.themeClass,e.classes.popperClass,{"v-popper__popper--shown":e.shown,"v-popper__popper--hidden":!e.shown,"v-popper__popper--show-from":e.classes.showFrom,"v-popper__popper--show-to":e.classes.showTo,"v-popper__popper--hide-from":e.classes.hideFrom,"v-popper__popper--hide-to":e.classes.hideTo,"v-popper__popper--skip-transition":e.skipTransition,"v-popper__popper--arrow-overflow":e.result&&e.result.arrow.overflow,"v-popper__popper--no-positioning":!e.result}]]),style:B(e.result?{position:e.result.strategy,transform:`translate3d(${Math.round(e.result.x)}px,${Math.round(e.result.y)}px,0)`}:void 0),"aria-hidden":e.shown?"false":"true",tabindex:e.autoHide?0:void 0,"data-popper-placement":e.result?e.result.placement:void 0,onKeyup:t[2]||(t[2]=as((t=>e.autoHide&&e.$emit("hide")),["esc"]))},[Jo("div",{class:"v-popper__backdrop",onClick:t[0]||(t[0]=t=>e.autoHide&&e.$emit("hide"))}),Jo("div",{class:"v-popper__wrapper",style:B(e.result?{transformOrigin:e.result.transformOrigin}:void 0)},[Jo("div",zl,[e.mounted?(Io(),qo(jo,{key:0},[Jo("div",null,[Pn(e.$slots,"default")]),e.handleResize?(Io(),Go(r,{key:0,onNotify:t[1]||(t[1]=t=>e.$emit("resize",t))})):si("",!0)],64)):si("",!0)],512),Jo("div",{ref:"arrow",class:"v-popper__arrow-container",style:B(e.result?{left:e.toPx(e.result.arrow.x),top:e.toPx(e.result.arrow.y)}:void 0)},Bl,4)],4)],46,jl)}]]),Fl={methods:{show(...e){return this.$refs.popper.show(...e)},hide(...e){return this.$refs.popper.hide(...e)},dispose(...e){return this.$refs.popper.dispose(...e)},onResize(...e){return this.$refs.popper.onResize(...e)}}};let Vl=function(){};typeof window<"u"&&(Vl=window.Element);const Il=Ll(en({name:"VPopperWrapper",components:{Popper:Pl,PopperContent:Nl},mixins:[Fl,Rl("finalTheme")],props:{theme:{type:String,default:null},referenceNode:{type:Function,default:null},shown:{type:Boolean,default:!1},showGroup:{type:String,default:null},ariaId:{default:null},disabled:{type:Boolean,default:void 0},positioningDisabled:{type:Boolean,default:void 0},placement:{type:String,default:void 0},delay:{type:[String,Number,Object],default:void 0},distance:{type:[Number,String],default:void 0},skidding:{type:[Number,String],default:void 0},triggers:{type:Array,default:void 0},showTriggers:{type:[Array,Function],default:void 0},hideTriggers:{type:[Array,Function],default:void 0},popperTriggers:{type:Array,default:void 0},popperShowTriggers:{type:[Array,Function],default:void 0},popperHideTriggers:{type:[Array,Function],default:void 0},container:{type:[String,Object,Vl,Boolean],default:void 0},boundary:{type:[String,Vl],default:void 0},strategy:{type:String,default:void 0},autoHide:{type:[Boolean,Function],default:void 0},handleResize:{type:Boolean,default:void 0},instantMove:{type:Boolean,default:void 0},eagerMount:{type:Boolean,default:void 0},popperClass:{type:[String,Array,Object],default:void 0},computeTransformOrigin:{type:Boolean,default:void 0},autoMinSize:{type:Boolean,default:void 0},autoSize:{type:[Boolean,String],default:void 0},autoMaxSize:{type:Boolean,default:void 0},autoBoundaryMaxSize:{type:Boolean,default:void 0},preventOverflow:{type:Boolean,default:void 0},overflowPadding:{type:[Number,String],default:void 0},arrowPadding:{type:[Number,String],default:void 0},arrowOverflow:{type:Boolean,default:void 0},flip:{type:Boolean,default:void 0},shift:{type:Boolean,default:void 0},shiftCrossAxis:{type:Boolean,default:void 0},noAutoFocus:{type:Boolean,default:void 0},disposeTimeout:{type:Number,default:void 0}},emits:{show:()=>!0,hide:()=>!0,"update:shown":e=>!0,"apply-show":()=>!0,"apply-hide":()=>!0,"close-group":()=>!0,"close-directive":()=>!0,"auto-hide":()=>!0,resize:()=>!0},computed:{finalTheme(){return this.theme??this.$options.vPopperTheme}},methods:{getTargetNodes(){return Array.from(this.$el.children).filter((e=>e!==this.$refs.popperContent.$el))}}}),[["render",function(e,t,n,o,i,s){const r=xn("PopperContent"),l=xn("Popper");return Io(),Go(l,ci({ref:"popper"},e.$props,{theme:e.finalTheme,"target-nodes":e.getTargetNodes,"popper-node":()=>e.$refs.popperContent.$el,class:[e.themeClass],onShow:t[0]||(t[0]=()=>e.$emit("show")),onHide:t[1]||(t[1]=()=>e.$emit("hide")),"onUpdate:shown":t[2]||(t[2]=t=>e.$emit("update:shown",t)),onApplyShow:t[3]||(t[3]=()=>e.$emit("apply-show")),onApplyHide:t[4]||(t[4]=()=>e.$emit("apply-hide")),onCloseGroup:t[5]||(t[5]=()=>e.$emit("close-group")),onCloseDirective:t[6]||(t[6]=()=>e.$emit("close-directive")),onAutoHide:t[7]||(t[7]=()=>e.$emit("auto-hide")),onResize:t[8]||(t[8]=()=>e.$emit("resize"))}),{default:Yt((({popperId:t,isShown:n,shouldMountContent:o,skipTransition:i,autoHide:s,show:l,hide:a,handleResize:c,onResize:u,classes:d,result:p})=>[Pn(e.$slots,"default",{shown:n,show:l,hide:a}),ei(r,{ref:"popperContent","popper-id":t,theme:e.finalTheme,shown:n,mounted:o,"skip-transition":i,"auto-hide":s,"handle-resize":c,classes:d,result:p,onHide:a,onResize:u},{default:Yt((()=>[Pn(e.$slots,"popper",{shown:n,hide:a})])),_:2},1032,["popper-id","theme","shown","mounted","skip-transition","auto-hide","handle-resize","classes","result","onHide","onResize"])])),_:3},16,["theme","target-nodes","popper-node","class"])}]]),Ul={...Il,name:"VDropdown",vPopperTheme:"dropdown"},Wl={...Il,name:"VMenu",vPopperTheme:"menu"},Zl={...Il,name:"VTooltip",vPopperTheme:"tooltip"},ql=en({name:"VTooltipDirective",components:{Popper:wl(),PopperContent:Nl},mixins:[Fl],inheritAttrs:!1,props:{theme:{type:String,default:"tooltip"},html:{type:Boolean,default:e=>ol(e.theme,"html")},content:{type:[String,Number,Function],default:null},loadingContent:{type:String,default:e=>ol(e.theme,"loadingContent")},targetNodes:{type:Function,required:!0}},data:()=>({asyncContent:null}),computed:{isContentAsync(){return"function"==typeof this.content},loading(){return this.isContentAsync&&null==this.asyncContent},finalContent(){return this.isContentAsync?this.loading?this.loadingContent:this.asyncContent:this.content}},watch:{content:{handler(){this.fetchContent(!0)},immediate:!0},async finalContent(){await this.$nextTick(),this.$refs.popper.onResize()}},created(){this.$_fetchId=0},methods:{fetchContent(e){if("function"==typeof this.content&&this.$_isShown&&(e||!this.$_loading&&null==this.asyncContent)){this.asyncContent=null,this.$_loading=!0;const e=++this.$_fetchId,t=this.content(this);t.then?t.then((t=>this.onResult(e,t))):this.onResult(e,t)}},onResult(e,t){e===this.$_fetchId&&(this.$_loading=!1,this.asyncContent=t)},onShow(){this.$_isShown=!0,this.fetchContent()},onHide(){this.$_isShown=!1}}}),Gl=["innerHTML"],Yl=["textContent"];const Kl=Ll(ql,[["render",function(e,t,n,o,i,s){const r=xn("PopperContent"),l=xn("Popper");return Io(),Go(l,ci({ref:"popper"},e.$attrs,{theme:e.theme,"target-nodes":e.targetNodes,"popper-node":()=>e.$refs.popperContent.$el,onApplyShow:e.onShow,onApplyHide:e.onHide}),{default:Yt((({popperId:t,isShown:n,shouldMountContent:o,skipTransition:i,autoHide:s,hide:l,handleResize:a,onResize:c,classes:u,result:d})=>[ei(r,{ref:"popperContent",class:U({"v-popper--tooltip-loading":e.loading}),"popper-id":t,theme:e.theme,shown:n,mounted:o,"skip-transition":i,"auto-hide":s,"handle-resize":a,classes:u,result:d,onHide:l,onResize:c},{default:Yt((()=>[e.html?(Io(),qo("div",{key:0,innerHTML:e.finalContent},null,8,Gl)):(Io(),qo("div",{key:1,textContent:Y(e.finalContent)},null,8,Yl))])),_:2},1032,["class","popper-id","theme","shown","mounted","skip-transition","auto-hide","handle-resize","classes","result","onHide","onResize"])])),_:1},16,["theme","target-nodes","popper-node","onApplyShow","onApplyHide"])}]]),Xl="v-popper--has-tooltip";function Ql(e,t,n){let o;const i=typeof t;return o="string"===i?{content:t}:t&&"object"===i?t:{content:!1},o.placement=function(e,t){let n=e.placement;if(!n&&t)for(const o of ll)t[o]&&(n=o);return n||(n=ol(e.theme||"tooltip","placement")),n}(o,n),o.targetNodes=()=>[e],o.referenceNode=()=>e,o}let Jl,ea,ta=0;function na(){if(Jl)return;ea=yt([]),Jl=ds({name:"VTooltipDirectiveApp",setup:()=>({directives:ea}),render(){return this.directives.map((e=>function(e,t,n){const o=arguments.length;return 2===o?v(t)&&!d(t)?Yo(t)?ei(e,null,[t]):ei(e,t):ei(e,null,t):(o>3?n=Array.prototype.slice.call(arguments,2):3===o&&Yo(n)&&(n=[n]),ei(e,t,n))}(Kl,{...e.options,shown:e.shown||e.options.shown,key:e.id})))},devtools:{hide:!0}});const e=document.createElement("div");document.body.appendChild(e),Jl.mount(e)}function oa(e){if(e.$_popper){const t=ea.value.indexOf(e.$_popper.item);-1!==t&&ea.value.splice(t,1),delete e.$_popper,delete e.$_popperOldShown,delete e.$_popperMountTarget}e.classList&&e.classList.remove(Xl)}function ia(e,{value:t,modifiers:n}){const o=Ql(e,t,n);if(!o.content||ol(o.theme||"tooltip","disabled"))oa(e);else{let i;e.$_popper?(i=e.$_popper,i.options.value=o):i=function(e,t,n){na();const o=yt(Ql(e,t,n)),i=yt(!1),s={id:ta++,options:o,shown:i};return ea.value.push(s),e.classList&&e.classList.add(Xl),e.$_popper={options:o,item:s,show(){i.value=!0},hide(){i.value=!1}}}(e,t,n),typeof t.shown<"u"&&t.shown!==e.$_popperOldShown&&(e.$_popperOldShown=t.shown,t.shown?i.show():i.hide())}}const sa={beforeMount:ia,updated:ia,beforeUnmount(e){oa(e)}};function ra(e){e.addEventListener("mousedown",aa),e.addEventListener("click",aa),e.addEventListener("touchstart",ca,!!sl&&{passive:!0})}function la(e){e.removeEventListener("mousedown",aa),e.removeEventListener("click",aa),e.removeEventListener("touchstart",ca),e.removeEventListener("touchend",ua),e.removeEventListener("touchcancel",da)}function aa(e){const t=e.currentTarget;e.closePopover=!t.$_vclosepopover_touch,e.closeAllPopover=t.$_closePopoverModifiers&&!!t.$_closePopoverModifiers.all}function ca(e){if(1===e.changedTouches.length){const t=e.currentTarget;t.$_vclosepopover_touch=!0;const n=e.changedTouches[0];t.$_vclosepopover_touchPoint=n,t.addEventListener("touchend",ua),t.addEventListener("touchcancel",da)}}function ua(e){const t=e.currentTarget;if(t.$_vclosepopover_touch=!1,1===e.changedTouches.length){const n=e.changedTouches[0],o=t.$_vclosepopover_touchPoint;e.closePopover=Math.abs(n.screenY-o.screenY)<20&&Math.abs(n.screenX-o.screenX)<20,e.closeAllPopover=t.$_closePopoverModifiers&&!!t.$_closePopoverModifiers.all}}function da(e){e.currentTarget.$_vclosepopover_touch=!1}const pa={beforeMount(e,{value:t,modifiers:n}){e.$_closePopoverModifiers=n,(typeof t>"u"||t)&&ra(e)},updated(e,{value:t,oldValue:n,modifiers:o}){e.$_closePopoverModifiers=o,t!==n&&(typeof t>"u"||t?ra(e):la(e))},beforeUnmount(e){la(e)}};const ha={version:"5.2.2",install:function(e,t={}){e.$_vTooltipInstalled||(e.$_vTooltipInstalled=!0,tl(nl,t),e.directive("tooltip",sa),e.directive("close-popper",pa),e.component("VTooltip",Zl),e.component("VDropdown",Ul),e.component("VMenu",Wl))},options:nl};var fa,ga,ma,va,ya=Object.create,wa=Object.defineProperty,ba=Object.getOwnPropertyDescriptor,_a=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Ca=e=>{throw TypeError(e)},xa=(e,t)=>wa(e,"name",{value:t,configurable:!0}),Sa=["class","method","getter","setter","accessor","field","value","get","set"],ka=e=>void 0!==e&&"function"!=typeof e?Ca("Function expected"):e,Ta=(e,t,n,o,i)=>({kind:Sa[e],name:t,metadata:o,addInitializer:e=>n._?Ca("Already initialized"):i.push(ka(e||null))}),$a=(e,t)=>{return n=t,o=_a("metadata"),i=e[3],o in n?wa(n,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[o]=i;var n,o,i},La=(e,t,n,o)=>{for(var i=0,s=e[t>>1],r=s&&s.length;i<r;i++)1&t?s[i].call(n):o=s[i].call(n,o);return o},Pa=(e,t,n,o,i,s)=>{var r,l,a,c,u,d=7&t,p=!!(8&t),h=!!(16&t),f=d>3?e.length+1:d?p?1:2:0,g=Sa[d+5],m=d>3&&(e[f-1]=[]),v=e[f]||(e[f]=[]),y=d&&(!h&&!p&&(i=i.prototype),d<5&&(d>3||!h)&&ba(d<4?i:{get[n](){return Aa(this,s)},set[n](e){return Ea(this,s,e)}},n));d?h&&d<4&&xa(s,(d>2?"set ":d>1?"get ":"")+n):xa(i,n);for(var w=o.length-1;w>=0;w--)c=Ta(d,n,a={},e[3],v),d&&(c.static=p,c.private=h,u=c.access={has:h?e=>Ma(i,e):e=>n in e},3^d&&(u.get=h?e=>(1^d?Aa:Da)(e,i,4^d?s:y.get):e=>e[n]),d>2&&(u.set=h?(e,t)=>Ea(e,i,t,4^d?s:y.set):(e,t)=>e[n]=t)),l=(0,o[w])(d?d<4?h?s:y[g]:d>4?void 0:{get:y.get,set:y.set}:i,c),a._=1,4^d||void 0===l?ka(l)&&(d>4?m.unshift(l):d?h?s=l:y[g]=l:i=l):"object"!=typeof l||null===l?Ca("Object expected"):(ka(r=l.get)&&(y.get=r),ka(r=l.set)&&(y.set=r),ka(r=l.init)&&m.unshift(r));return d||$a(e,i),y&&wa(i,n,y),h?4^d?s:y:i},Oa=(e,t,n)=>t.has(e)||Ca("Cannot "+n),Ma=(e,t)=>Object(t)!==t?Ca('Cannot use the "in" operator on this value'):e.has(t),Aa=(e,t,n)=>(Oa(e,t,"read from private field"),n?n.call(e):t.get(e)),Ea=(e,t,n,o)=>(Oa(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n),Da=(e,t,n)=>(Oa(e,t,"access private method"),n);ma=[Bs({components:{IconLamp:Gs,IconTriggerBack:Ks},directives:{drag:Us}})];let Ra=class extends(ga=Ss,fa=[Ds("triggerDiv")],ga){constructor(){super(...arguments),this.triggerDiv=La(va,8,this),La(va,11,this),this.headerHeightPx=62,this.initialized=!1,this.triggerStyle=void 0,this.triggerStyleCorrect=void 0,this.handleResize=void 0}t(e){return window.lang.t(e)}onChangePosition(){(new Ws).send("saveButtonPosition",this.triggerStyle)}getComputedTriggerStyle(){let e={};for(let t in this.triggerStyleCorrect)e[t]=this.triggerStyleCorrect[t]+"px";return e}handleDrag(e,t){!function(){for(let e=0;e<pl.length;e++)pl[e].hide()}(),this.triggerStyle=this.triggerStyleCorrect,this.triggerStyle.bottom=this.triggerStyle.bottom-e.y,this.calculateStyleCorrect()}toggleChat(){Is.isActive?Is.hide():Is.show()}mounted(){this.initialized||this.initialize(),this.handleResize=()=>this.calculateStyleCorrect(),this.handleResize(),window.addEventListener("resize",this.handleResize),this.triggerDiv.addEventListener("click",(()=>{this.toggleChat()})),$(this.triggerDiv).trigger("new-content")}calculateStyleCorrect(){let e={...this.triggerStyle},t=document.documentElement.clientHeight-this.headerHeightPx,n=this.triggerDiv.clientHeight;e.bottom+n>t&&(e.bottom=t-n),e.bottom<0&&(e.bottom=0),this.triggerStyleCorrect=e}initialize(){Object.keys(window.global.ai.chatSettings).length&&null!==window.global.ai.chatSettings.trigger_bottom?this.triggerStyle={bottom:window.global.ai.chatSettings.trigger_bottom}:this.triggerStyle={bottom:100},this.calculateStyleCorrect(),this.initialized=!0}};var Ha;Pa(va=[,,,ya((null==(Ha=ga)?void 0:Ha[_a("metadata")])??null)],5,"triggerDiv",fa,Ra),Ra=Pa(va,0,"TriggerButton",ma,Ra),La(va,1,Ra);const ja=Zs(Fs(Ra),[["render",function(e,t,n,o,i,s){const r=xn("icon-trigger-back"),l=xn("icon-lamp"),a=kn("drag"),c=kn("tooltip");return Kt((Io(),qo("div",{class:"ai-trigger",style:B(e.getComputedTriggerStyle()),ref:"triggerDiv",onDragend:t[0]||(t[0]=(...t)=>e.onChangePosition&&e.onChangePosition(...t))},[ei(r),ei(l)],36)),[[a,{params:{},handleDrag:e.handleDrag}],[c,"Чат с ИИ",void 0,{left:!0}]])}],["__scopeId","data-v-c1a429e9"]]);class za{constructor(e,t,n,o=new Date){this.text=e,this.role=t,this.status=n,this.datetime=o,this.viewMode="text"}formattedDate(){return this.datetime.toLocaleDateString("ru-RU")}getTextByBlocks(){const e=[],t=/```(\w+)?([\s\S]*?)```/g;let n,o=0,i=this.text;for(;null!==(n=t.exec(i));)n.index>o&&e.push({type:"text",lang:"",content:i.substring(o,n.index)}),void 0===n[1]&&n[2].indexOf("<html")>-1&&(n[1]="html"),e.push({type:"code",lang:n[1],content:n[2]}),o=t.lastIndex;return o<i.length&&e.push({type:"text",lang:"",content:i.substring(o)}),0===e.length&&i.length>0&&e.push({type:"text",lang:"",content:i}),e}hasHtml(){return null!==this.text.match(/```(html)\s*([\s\S]*?)(```|$)/g)}import(e){this.text=e.message,this.role=e.role,this.datetime=new Date(e.date_of_create)}}const Ba={baseProfile:"tiny",height:"24px",version:"1.2",viewBox:"0 0 24 24",width:"24px","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};const Na=Zs({},[["render",function(e,t){return Io(),qo("svg",Ba,t[0]||(t[0]=[Jo("g",{id:"Layer_1"},[Jo("path",{d:"M13,5.586l-4.707,4.707c-0.391,0.391-0.391,1.023,0,1.414s1.023,0.391,1.414,0L12,9.414V17c0,0.552,0.447,1,1,1   s1-0.448,1-1V9.414l2.293,2.293C16.488,11.902,16.744,12,17,12s0.512-0.098,0.707-0.293c0.391-0.391,0.391-1.023,0-1.414L13,5.586z",fill:"CurrentColor"})],-1)]))}]]),Fa={viewBox:"0 0 256 256",xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px"};const Va=Zs({},[["render",function(e,t){return Io(),qo("svg",Fa,t[0]||(t[0]=[Jo("rect",{fill:"none",height:"256",width:"256"},null,-1),Jo("rect",{height:"168",rx:"14.9",width:"168",x:"44",y:"44",fill:"CurrentColor"},null,-1)]))}]]),Ia={fill:"none",height:"15",viewBox:"0 0 15 15",width:"15",xmlns:"http://www.w3.org/2000/svg"};const Ua=Zs({},[["render",function(e,t){return Io(),qo("svg",Ia,t[0]||(t[0]=[Jo("path",{"clip-rule":"evenodd",d:"M4.49999 2.5C4.49999 1.94772 4.9477 1.5 5.49999 1.5C6.05227 1.5 6.49999 1.94772 6.49999 2.5C6.49999 3.05228 6.05227 3.5 5.49999 3.5C4.9477 3.5 4.49999 3.05228 4.49999 2.5ZM8.49999 2.5C8.49999 1.94772 8.9477 1.5 9.49999 1.5C10.0523 1.5 10.5 1.94772 10.5 2.5C10.5 3.05228 10.0523 3.5 9.49999 3.5C8.9477 3.5 8.49999 3.05229 8.49999 2.5ZM4.49998 7.5C4.49998 6.94772 4.9477 6.5 5.49998 6.5C6.05227 6.5 6.49998 6.94772 6.49998 7.5C6.49998 8.05228 6.05227 8.5 5.49998 8.5C4.9477 8.5 4.49998 8.05228 4.49998 7.5ZM8.49998 7.5C8.49998 6.94771 8.9477 6.5 9.49999 6.5C10.0523 6.5 10.5 6.94772 10.5 7.5C10.5 8.05228 10.0523 8.5 9.49998 8.5C8.9477 8.5 8.49998 8.05228 8.49998 7.5ZM4.49998 12.5C4.49998 11.9477 4.9477 11.5 5.49998 11.5C6.05227 11.5 6.49998 11.9477 6.49998 12.5C6.49998 13.0523 6.05227 13.5 5.49998 13.5C4.9477 13.5 4.49998 13.0523 4.49998 12.5ZM8.49998 12.5C8.49998 11.9477 8.9477 11.5 9.49998 11.5C10.0523 11.5 10.5 11.9477 10.5 12.5C10.5 13.0523 10.0523 13.5 9.49998 13.5C8.9477 13.5 8.49998 13.0523 8.49998 12.5Z",fill:"black","fill-rule":"evenodd"},null,-1)]))}]]),Wa={fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"};const Za=Zs({},[["render",function(e,t){return Io(),qo("svg",Wa,t[0]||(t[0]=[Jo("path",{d:"M4.2097 4.3871L4.29289 4.29289C4.65338 3.93241 5.22061 3.90468 5.6129 4.2097L5.70711 4.29289L12 10.585L18.2929 4.29289C18.6834 3.90237 19.3166 3.90237 19.7071 4.29289C20.0976 4.68342 20.0976 5.31658 19.7071 5.70711L13.415 12L19.7071 18.2929C20.0676 18.6534 20.0953 19.2206 19.7903 19.6129L19.7071 19.7071C19.3466 20.0676 18.7794 20.0953 18.3871 19.7903L18.2929 19.7071L12 13.415L5.70711 19.7071C5.31658 20.0976 4.68342 20.0976 4.29289 19.7071C3.90237 19.3166 3.90237 18.6834 4.29289 18.2929L10.585 12L4.29289 5.70711C3.93241 5.34662 3.90468 4.77939 4.2097 4.3871L4.29289 4.29289L4.2097 4.3871Z",fill:"currentColor"},null,-1)]))}]]),qa={fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"};const Ga=Zs({},[["render",function(e,t){return Io(),qo("svg",qa,t[0]||(t[0]=[Jo("path",{d:"M19.25 4C20.7688 4 22 5.23122 22 6.75V17.25C22 18.7688 20.7688 20 19.25 20H4.75C3.23122 20 2 18.7688 2 17.25V6.75C2 5.23122 3.23122 4 4.75 4H19.25ZM15 18.5V5.5H4.75C4.05964 5.5 3.5 6.05964 3.5 6.75V17.25C3.5 17.9404 4.05964 18.5 4.75 18.5H15Z",fill:"currentColor"},null,-1)]))}]]),Ya={fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"};const Ka=Zs({},[["render",function(e,t){return Io(),qo("svg",Ya,t[0]||(t[0]=[Jo("path",{d:"M6.75 3.93457C5.23122 3.93457 4 5.16579 4 6.68457V16.2502C4 16.6645 4.33579 17.0002 4.75 17.0002C5.16421 17.0002 5.5 16.6645 5.5 16.2502V6.68457C5.5 5.99421 6.05964 5.43457 6.75 5.43457H16.25C16.9404 5.43457 17.5 5.99421 17.5 6.68457V11.2776C17.9734 11.069 18.4893 10.9778 19 11.0052V6.68457C19 5.16579 17.7688 3.93457 16.25 3.93457H6.75Z",fill:"currentColor"},null,-1),Jo("path",{d:"M20.3063 12.5575L20.1773 12.4517L20.1742 12.4494C19.2943 11.7823 18.0073 11.8628 17.2228 12.6611L13.4197 16.5305C13.1842 16.7701 13.0116 17.0599 12.9166 17.3759L12.3303 19.3283C11.764 19.4144 11.261 19.4066 10.7256 19.3216C10.7015 19.3178 10.6879 19.2919 10.6983 19.2699L10.7325 19.1976L10.7355 19.1912C10.8006 19.053 10.9155 18.8092 10.9528 18.5583C10.9736 18.4184 10.9795 18.2242 10.904 18.0175C10.8229 17.7952 10.6707 17.622 10.4818 17.5059C10.1584 17.307 9.75504 17.2918 9.40872 17.3118C9.13449 17.3276 8.79514 17.3742 8.37789 17.4556C7.91595 17.5456 7.47693 17.7523 7.03945 17.9583C6.46264 18.23 5.88848 18.5003 5.26798 18.5003C5.04503 18.5003 4.8306 18.4639 4.63034 18.3965C4.50723 18.3552 4.37174 18.455 4.40299 18.581C4.45965 18.8096 4.56469 19.1185 4.79525 19.3564C4.92127 19.4864 5.09027 19.6003 5.30333 19.6551C5.51538 19.7095 5.72083 19.6925 5.90086 19.6396C7.35473 19.2128 8.3205 18.9809 8.94874 18.8759C9.08062 18.8539 9.17967 18.9871 9.13919 19.1146C9.07578 19.3142 8.98619 19.6924 9.17263 20.0751C9.37486 20.4902 9.77319 20.664 10.1174 20.7349C11.2602 20.97 12.2462 20.9394 13.4527 20.6227C13.5054 20.6142 13.5581 20.6016 13.6102 20.5847L13.7274 20.5468C13.8985 20.4973 14.0743 20.4423 14.2558 20.3818C14.2831 20.3727 14.3095 20.3621 14.3351 20.3503L15.7228 19.9015C16.0608 19.7922 16.3658 19.6049 16.6105 19.356L20.4049 15.4956C21.1911 14.6948 21.1877 13.4614 20.4233 12.6701L20.3063 12.5575Z",fill:"currentColor"},null,-1)]))}]]);const Xa=Zs({},[["render",function(e,t){return t[0]||(t[0]=ii('<svg class="ai-icon" fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M6.50244 3.00293C4.56944 3.00293 3.00244 4.56993 3.00244 6.50293V12.5029C3.00244 14.4359 4.56944 16.0029 6.50244 16.0029H6.99853V14.0029H6.50244C5.67401 14.0029 5.00244 13.3314 5.00244 12.5029V6.50293C5.00244 5.6745 5.67401 5.00293 6.50244 5.00293H12.5024C13.3309 5.00293 14.0024 5.6745 14.0024 6.50293V12.5029C14.0024 13.3314 13.3309 14.0029 12.5024 14.0029H10.9957V16.0029H12.5024C14.4354 16.0029 16.0024 14.4359 16.0024 12.5029V6.50293C16.0024 4.56993 14.4354 3.00293 12.5024 3.00293H6.50244Z" fill="currentColor"></path><path d="M10 11.5004C10 10.672 10.6716 10.0004 11.5 10.0004H12.9988V8.00043H11.5C9.567 8.00043 8 9.56743 8 11.5004V17.5004C8 19.4334 9.567 21.0004 11.5 21.0004H17.5C19.433 21.0004 21 19.4334 21 17.5004V11.5004C21 9.56743 19.433 8.00043 17.5 8.00043H17.0049V10.0004H17.5C18.3284 10.0004 19 10.672 19 11.5004V17.5004C19 18.3289 18.3284 19.0004 17.5 19.0004H11.5C10.6716 19.0004 10 18.3289 10 17.5004V11.5004Z" fill="currentColor"></path></svg><svg class="ai-success-icon" fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 16.5858L4.70711 12.7929C4.31658 12.4024 3.68342 12.4024 3.29289 12.7929C2.90237 13.1834 2.90237 13.8166 3.29289 14.2071L7.79289 18.7071C8.18342 19.0976 8.81658 19.0976 9.20711 18.7071L20.2071 7.70711C20.5976 7.31658 20.5976 6.68342 20.2071 6.29289C19.8166 5.90237 19.1834 5.90237 18.7929 6.29289L8.5 16.5858Z" fill="currentColor"></path></svg>',2))}]]),Qa={fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"};const Ja=Zs({},[["render",function(e,t){return Io(),qo("svg",Qa,t[0]||(t[0]=[Jo("path",{d:"M20.0078 6.5C20.0078 5.11929 18.8885 4 17.5078 4H6.50781C5.1271 4 4.00781 5.11929 4.00781 6.5L4.00781 10.5C4.00781 11.0523 4.45553 11.5 5.00781 11.5C5.5601 11.5 6.00781 11.0523 6.00781 10.5L6.00781 6.5C6.00781 6.22386 6.23167 6 6.50781 6L17.5078 6C17.784 6 18.0078 6.22386 18.0078 6.5V10.5C18.0078 11.0523 18.4555 11.5 19.0078 11.5C19.5601 11.5 20.0078 11.0523 20.0078 10.5V6.5ZM18.2071 19.7071L20.7071 17.2071C21.0976 16.8166 21.0976 16.1834 20.7071 15.7929L18.2071 13.2929C17.8166 12.9024 17.1834 12.9024 16.7929 13.2929C16.4024 13.6834 16.4024 14.3166 16.7929 14.7071L18.5858 16.5L16.7929 18.2929C16.4024 18.6834 16.4024 19.3166 16.7929 19.7071C17.1834 20.0976 17.8166 20.0976 18.2071 19.7071ZM3.29289 15.7929C2.90237 16.1834 2.90237 16.8166 3.29289 17.2071L5.79289 19.7071C6.18342 20.0976 6.81658 20.0976 7.20711 19.7071C7.59763 19.3166 7.59763 18.6834 7.20711 18.2929L5.41421 16.5L7.20711 14.7071C7.59763 14.3166 7.59763 13.6834 7.20711 13.2929C6.81658 12.9024 6.18342 12.9024 5.79289 13.2929L3.29289 15.7929ZM13 16.5C13 15.9477 12.5523 15.5 12 15.5C11.4477 15.5 11 15.9477 11 16.5C11 17.0523 11.4477 17.5 12 17.5C12.5523 17.5 13 17.0523 13 16.5ZM9 15.5C9.55228 15.5 10 15.9477 10 16.5C10 17.0523 9.55228 17.5 9 17.5H8C7.44772 17.5 7 17.0523 7 16.5C7 15.9477 7.44772 15.5 8 15.5H9ZM17 16.5C17 15.9477 16.5523 15.5 16 15.5H15C14.4477 15.5 14 15.9477 14 16.5C14 17.0523 14.4477 17.5 15 17.5H16C16.5523 17.5 17 17.0523 17 16.5Z",fill:"currentColor"},null,-1)]))}]]);var ec,tc,nc,oc,ic,sc=Object.create,rc=Object.defineProperty,lc=Object.getOwnPropertyDescriptor,ac=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),cc=e=>{throw TypeError(e)},uc=(e,t)=>rc(e,"name",{value:t,configurable:!0}),dc=["class","method","getter","setter","accessor","field","value","get","set"],pc=e=>void 0!==e&&"function"!=typeof e?cc("Function expected"):e,hc=(e,t,n,o,i)=>({kind:dc[e],name:t,metadata:o,addInitializer:e=>n._?cc("Already initialized"):i.push(pc(e||null))}),fc=(e,t)=>{return n=t,o=ac("metadata"),i=e[3],o in n?rc(n,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[o]=i;var n,o,i},gc=(e,t,n,o)=>{for(var i=0,s=e[t>>1],r=s&&s.length;i<r;i++)1&t?s[i].call(n):o=s[i].call(n,o);return o},mc=(e,t,n,o,i,s)=>{var r,l,a,c,u,d=7&t,p=!!(8&t),h=!!(16&t),f=d>3?e.length+1:d?p?1:2:0,g=dc[d+5],m=d>3&&(e[f-1]=[]),v=e[f]||(e[f]=[]),y=d&&(!h&&!p&&(i=i.prototype),d<5&&(d>3||!h)&&lc(d<4?i:{get[n](){return wc(this,s)},set[n](e){return bc(this,s,e)}},n));d?h&&d<4&&uc(s,(d>2?"set ":d>1?"get ":"")+n):uc(i,n);for(var w=o.length-1;w>=0;w--)c=hc(d,n,a={},e[3],v),d&&(c.static=p,c.private=h,u=c.access={has:h?e=>yc(i,e):e=>n in e},3^d&&(u.get=h?e=>(1^d?wc:_c)(e,i,4^d?s:y.get):e=>e[n]),d>2&&(u.set=h?(e,t)=>bc(e,i,t,4^d?s:y.set):(e,t)=>e[n]=t)),l=(0,o[w])(d?d<4?h?s:y[g]:d>4?void 0:{get:y.get,set:y.set}:i,c),a._=1,4^d||void 0===l?pc(l)&&(d>4?m.unshift(l):d?h?s=l:y[g]=l:i=l):"object"!=typeof l||null===l?cc("Object expected"):(pc(r=l.get)&&(y.get=r),pc(r=l.set)&&(y.set=r),pc(r=l.init)&&m.unshift(r));return d||fc(e,i),y&&rc(i,n,y),h?4^d?s:y:i},vc=(e,t,n)=>t.has(e)||cc("Cannot "+n),yc=(e,t)=>Object(t)!==t?cc('Cannot use the "in" operator on this value'):e.has(t),wc=(e,t,n)=>(vc(e,t,"read from private field"),n?n.call(e):t.get(e)),bc=(e,t,n,o)=>(vc(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n),_c=(e,t,n)=>(vc(e,t,"access private method"),n);oc=[Bs];let Cc=class extends(nc=Ss,tc=[Rs],ec=[Rs],nc){constructor(){super(...arguments),this.message=gc(ic,8,this),gc(ic,11,this),this.textBlock=gc(ic,12,this),gc(ic,15,this)}getSafeContent(){return this.textBlock.content.trim()}};ic=(e=>[,,,sc((null==e?void 0:e[ac("metadata")])??null)])(nc),mc(ic,5,"message",tc,Cc),mc(ic,5,"textBlock",ec,Cc),Cc=mc(ic,0,"BlockText",oc,Cc),gc(ic,1,Cc);const xc=Fs(Cc),Sc={class:"ai-text ai-pre-wrap"};const kc=Zs(xc,[["render",function(e,t,n,o,i,s){return Io(),qo("div",Sc,Y(e.getSafeContent()),1)}]]);var Tc,$c,Lc,Pc,Oc,Mc,Ac=Object.create,Ec=Object.defineProperty,Dc=Object.getOwnPropertyDescriptor,Rc=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),Hc=e=>{throw TypeError(e)},jc=(e,t)=>Ec(e,"name",{value:t,configurable:!0}),zc=["class","method","getter","setter","accessor","field","value","get","set"],Bc=e=>void 0!==e&&"function"!=typeof e?Hc("Function expected"):e,Nc=(e,t,n,o,i)=>({kind:zc[e],name:t,metadata:o,addInitializer:e=>n._?Hc("Already initialized"):i.push(Bc(e||null))}),Fc=(e,t)=>{return n=t,o=Rc("metadata"),i=e[3],o in n?Ec(n,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[o]=i;var n,o,i},Vc=(e,t,n,o)=>{for(var i=0,s=e[t>>1],r=s&&s.length;i<r;i++)1&t?s[i].call(n):o=s[i].call(n,o);return o},Ic=(e,t,n,o,i,s)=>{var r,l,a,c,u,d=7&t,p=!!(8&t),h=!!(16&t),f=d>3?e.length+1:d?p?1:2:0,g=zc[d+5],m=d>3&&(e[f-1]=[]),v=e[f]||(e[f]=[]),y=d&&(!h&&!p&&(i=i.prototype),d<5&&(d>3||!h)&&Dc(d<4?i:{get[n](){return Zc(this,s)},set[n](e){return qc(this,s,e)}},n));d?h&&d<4&&jc(s,(d>2?"set ":d>1?"get ":"")+n):jc(i,n);for(var w=o.length-1;w>=0;w--)c=Nc(d,n,a={},e[3],v),d&&(c.static=p,c.private=h,u=c.access={has:h?e=>Wc(i,e):e=>n in e},3^d&&(u.get=h?e=>(1^d?Zc:Gc)(e,i,4^d?s:y.get):e=>e[n]),d>2&&(u.set=h?(e,t)=>qc(e,i,t,4^d?s:y.set):(e,t)=>e[n]=t)),l=(0,o[w])(d?d<4?h?s:y[g]:d>4?void 0:{get:y.get,set:y.set}:i,c),a._=1,4^d||void 0===l?Bc(l)&&(d>4?m.unshift(l):d?h?s=l:y[g]=l:i=l):"object"!=typeof l||null===l?Hc("Object expected"):(Bc(r=l.get)&&(y.get=r),Bc(r=l.set)&&(y.set=r),Bc(r=l.init)&&m.unshift(r));return d||Fc(e,i),y&&Ec(i,n,y),h?4^d?s:y:i},Uc=(e,t,n)=>t.has(e)||Hc("Cannot "+n),Wc=(e,t)=>Object(t)!==t?Hc('Cannot use the "in" operator on this value'):e.has(t),Zc=(e,t,n)=>(Uc(e,t,"read from private field"),n?n.call(e):t.get(e)),qc=(e,t,n,o)=>(Uc(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n),Gc=(e,t,n)=>(Uc(e,t,"access private method"),n);Oc=[Bs({components:{IconCopy:Xa}})];let Yc=class extends(Pc=Ss,Lc=[Rs],$c=[Rs],Tc=[Ds],Pc){constructor(){super(...arguments),this.message=Vc(Mc,8,this),Vc(Mc,11,this),this.textBlock=Vc(Mc,12,this),Vc(Mc,15,this),this.preview=Vc(Mc,16,this),Vc(Mc,19,this),this.viewAs="raw"}copy(e){if("raw"==this.viewAs)navigator.clipboard.writeText(this.textBlock.content);else{const e=this.preview.innerHTML,t=new Blob([e],{type:"text/html"}),n=e.replace(/<[^>]*>/g,""),o=new Blob([n],{type:"text/plain"});navigator.clipboard.write([new ClipboardItem({"text/html":t,"text/plain":o})])}const t=e.target.closest("button");t.classList.add("ai-success"),setTimeout((()=>{t.classList.remove("ai-success")}),1e3)}switchView(e){this.viewAs=e}getRawContent(){return function(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return e.replace(/[&<>"'`=/]/g,(e=>t[e]||e))}(this.textBlock.content).trim()}getPreviewContent(){return this.textBlock.content.trim()}};Mc=(e=>[,,,Ac((null==e?void 0:e[Rc("metadata")])??null)])(Pc),Ic(Mc,5,"message",Lc,Yc),Ic(Mc,5,"textBlock",$c,Yc),Ic(Mc,5,"preview",Tc,Yc),Yc=Ic(Mc,0,"BlockCode",Oc,Yc),Vc(Mc,1,Yc);const Kc=Fs(Yc),Xc=["data-lang"],Qc={class:"ai-code-actions"},Jc={key:0,class:"ai-switch-view"},eu={class:"ai-code-content"},tu={key:0,class:"ai-raw ai-pre-wrap"},nu={key:1,class:"ai-preview",ref:"preview"};const ou=Zs(Kc,[["render",function(e,t,n,o,i,s){const r=xn("icon-copy"),l=kn("tooltip"),a=kn("html-safe");return Io(),qo("div",{class:"ai-code","data-lang":e.textBlock.lang},[Jo("div",Qc,[t[3]||(t[3]=Jo("div",{class:"ai-code-caption"},"Код",-1)),"html"==e.textBlock.lang?(Io(),qo("div",Jc,[Jo("button",{onClick:t[0]||(t[0]=t=>e.switchView("raw")),class:U({active:"raw"==this.viewAs})},"Текст",2),"html"==e.textBlock.lang?(Io(),qo("button",{key:0,onClick:t[1]||(t[1]=t=>e.switchView("preview")),class:U({active:"preview"==this.viewAs})},"Html",2)):si("",!0)])):si("",!0),Kt((Io(),qo("button",{class:"ai-button-copy",onClick:t[2]||(t[2]=t=>e.copy(t))},[ei(r)])),[[l,"Копировать"]])]),Jo("div",eu,["raw"==e.viewAs?Kt((Io(),qo("div",tu,null,512)),[[a,e.getRawContent()]]):si("",!0),"preview"==e.viewAs?Kt((Io(),qo("div",nu,null,512)),[[a,e.getPreviewContent()]]):si("",!0)])],8,Xc)}],["__scopeId","data-v-dae805e8"]]),iu={width:"24",height:"19",viewBox:"0 0 24 19",xmlns:"http://www.w3.org/2000/svg"};const su=Zs({},[["render",function(e,t){const n=xn("svg:style");return Io(),qo("svg",iu,[ei(n,null,{default:Yt((()=>t[0]||(t[0]=[oi(" circle { fill: #888; opacity: 0.9; } .dot1 { animation: move-dots 1s infinite linear; } .dot2 { animation: move-dots 1s infinite linear 0.33s; } .dot3 { animation: move-dots 1s infinite linear 0.66s; } @keyframes move-dots { 0%, 100% { transform: translateY(0); } 20% { transform: translateY(-5px); } 40% { transform: translateY(5px); } 60% { transform: translateY(0); } 80% { transform: translateY(-5px); } } ")]))),_:1,__:[0]}),t[1]||(t[1]=Jo("circle",{class:"dot1",cx:"4",cy:"9.5",r:"3.5"},null,-1)),t[2]||(t[2]=Jo("circle",{class:"dot2",cx:"12",cy:"9.5",r:"3.5"},null,-1)),t[3]||(t[3]=Jo("circle",{class:"dot3",cx:"20",cy:"9.5",r:"3.5"},null,-1))])}]]);const ru=Zs({},[["render",function(e,t){return Io(),qo(jo,null,[t[0]||(t[0]=Jo("svg",{class:"ai-icon",fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},[Jo("path",{d:"M16.0518 5.0285C15.7169 5.46765 15.8013 6.09515 16.2405 6.43007C17.9675 7.74714 19 9.78703 19 12C19 15.4973 16.4352 18.3956 13.084 18.9166L13.7929 18.2071C14.1834 17.8166 14.1834 17.1834 13.7929 16.7929C13.4024 16.4024 12.7692 16.4024 12.3787 16.7929L9.87868 19.2929C9.48816 19.6834 9.48816 20.3166 9.87868 20.7071L12.3787 23.2071C12.7692 23.5976 13.4024 23.5976 13.7929 23.2071C14.1834 22.8166 14.1834 22.1834 13.7929 21.7929L12.9497 20.9505C17.4739 20.476 21 16.6498 21 12C21 9.15644 19.6712 6.53122 17.4533 4.83978C17.0142 4.50486 16.3867 4.58936 16.0518 5.0285ZM14.1213 3.29289L11.6213 0.792893C11.2308 0.402369 10.5976 0.402369 10.2071 0.792893C9.84662 1.15338 9.81889 1.72061 10.1239 2.1129L10.2071 2.20711L11.0503 3.04951C6.52615 3.52399 3 7.35021 3 12C3 14.7198 4.21515 17.2432 6.2716 18.9419C6.6974 19.2936 7.32771 19.2335 7.67943 18.8077C8.03116 18.3819 7.97111 17.7516 7.54531 17.3999C5.94404 16.0772 5 14.1168 5 12C5 8.50269 7.56475 5.60441 10.916 5.08343L10.2071 5.79289C9.81658 6.18342 9.81658 6.81658 10.2071 7.20711C10.5676 7.56759 11.1348 7.59532 11.5271 7.2903L11.6213 7.20711L14.1213 4.70711C14.4818 4.34662 14.5095 3.77939 14.2045 3.3871L14.1213 3.29289Z",fill:"currentColor"})],-1)),t[1]||(t[1]=Jo("svg",{class:"ai-success-icon",fill:"none",height:"24",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg"},[Jo("path",{d:"M8.5 16.5858L4.70711 12.7929C4.31658 12.4024 3.68342 12.4024 3.29289 12.7929C2.90237 13.1834 2.90237 13.8166 3.29289 14.2071L7.79289 18.7071C8.18342 19.0976 8.81658 19.0976 9.20711 18.7071L20.2071 7.70711C20.5976 7.31658 20.5976 6.68342 20.2071 6.29289C19.8166 5.90237 19.1834 5.90237 18.7929 6.29289L8.5 16.5858Z",fill:"currentColor"})],-1))],64)}]]),lu={class:"feather-alert-triangle",fill:"none",height:"18",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",width:"18",xmlns:"http://www.w3.org/2000/svg"};const au=Zs({},[["render",function(e,t){return Io(),qo("svg",lu,t[0]||(t[0]=[Jo("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"},null,-1),Jo("line",{x1:"12",x2:"12",y1:"9",y2:"13"},null,-1),Jo("line",{x1:"12",x2:"12.01",y1:"17",y2:"17"},null,-1)]))}]]),cu={"enable-background":"new 0 0 32 32",height:"18",id:"Stock_cut",version:"1.1",viewBox:"0 0 32 32","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};const uu=Zs({},[["render",function(e,t){return Io(),qo("svg",cu,t[0]||(t[0]=[ii('<desc></desc><g><path d="M23,12V3   c0-1.105-0.895-2-2-2H3C1.895,1,1,1.895,1,3v22c0,1.105,0.895,2,2,2h9" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2"></path><path d="M7,10H1v8h6   c2.209,0,4-1.791,4-4v0C11,11.791,9.209,10,7,10z" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2"></path><circle cx="7" cy="14" r="1"></circle><circle cx="23" cy="23" fill="none" r="8" stroke="currentColor" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2"></circle><line fill="none" stroke="currentColor" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" x1="18" x2="28" y1="23" y2="23"></line><line fill="none" stroke="currentColor" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" x1="23" x2="23" y1="18" y2="28"></line></g>',2)]))}]]);const du=Zs({},[["render",function(e,t){return Io(),qo(jo,null,[t[0]||(t[0]=Jo("svg",{class:"ai-icon",fill:"none",height:"18",viewBox:"0 0 24 24",width:"18",xmlns:"http://www.w3.org/2000/svg"},[Jo("path",{d:"M16.0518 5.0285C15.7169 5.46765 15.8013 6.09515 16.2405 6.43007C17.9675 7.74714 19 9.78703 19 12C19 15.4973 16.4352 18.3956 13.084 18.9166L13.7929 18.2071C14.1834 17.8166 14.1834 17.1834 13.7929 16.7929C13.4024 16.4024 12.7692 16.4024 12.3787 16.7929L9.87868 19.2929C9.48816 19.6834 9.48816 20.3166 9.87868 20.7071L12.3787 23.2071C12.7692 23.5976 13.4024 23.5976 13.7929 23.2071C14.1834 22.8166 14.1834 22.1834 13.7929 21.7929L12.9497 20.9505C17.4739 20.476 21 16.6498 21 12C21 9.15644 19.6712 6.53122 17.4533 4.83978C17.0142 4.50486 16.3867 4.58936 16.0518 5.0285ZM14.1213 3.29289L11.6213 0.792893C11.2308 0.402369 10.5976 0.402369 10.2071 0.792893C9.84662 1.15338 9.81889 1.72061 10.1239 2.1129L10.2071 2.20711L11.0503 3.04951C6.52615 3.52399 3 7.35021 3 12C3 14.7198 4.21515 17.2432 6.2716 18.9419C6.6974 19.2936 7.32771 19.2335 7.67943 18.8077C8.03116 18.3819 7.97111 17.7516 7.54531 17.3999C5.94404 16.0772 5 14.1168 5 12C5 8.50269 7.56475 5.60441 10.916 5.08343L10.2071 5.79289C9.81658 6.18342 9.81658 6.81658 10.2071 7.20711C10.5676 7.56759 11.1348 7.59532 11.5271 7.2903L11.6213 7.20711L14.1213 4.70711C14.4818 4.34662 14.5095 3.77939 14.2045 3.3871L14.1213 3.29289Z",fill:"currentColor"})],-1)),t[1]||(t[1]=Jo("svg",{class:"ai-success-icon",fill:"none",height:"18",viewBox:"0 0 24 24",width:"18",xmlns:"http://www.w3.org/2000/svg"},[Jo("path",{d:"M8.5 16.5858L4.70711 12.7929C4.31658 12.4024 3.68342 12.4024 3.29289 12.7929C2.90237 13.1834 2.90237 13.8166 3.29289 14.2071L7.79289 18.7071C8.18342 19.0976 8.81658 19.0976 9.20711 18.7071L20.2071 7.70711C20.5976 7.31658 20.5976 6.68342 20.2071 6.29289C19.8166 5.90237 19.1834 5.90237 18.7929 6.29289L8.5 16.5858Z",fill:"currentColor"})],-1))],64)}]]);var pu,hu,fu,gu,mu,vu=Object.create,yu=Object.defineProperty,wu=Object.getOwnPropertyDescriptor,bu=(e,t)=>(t=Symbol[e])?t:Symbol.for("Symbol."+e),_u=e=>{throw TypeError(e)},Cu=(e,t)=>yu(e,"name",{value:t,configurable:!0}),xu=["class","method","getter","setter","accessor","field","value","get","set"],Su=e=>void 0!==e&&"function"!=typeof e?_u("Function expected"):e,ku=(e,t,n,o,i)=>({kind:xu[e],name:t,metadata:o,addInitializer:e=>n._?_u("Already initialized"):i.push(Su(e||null))}),Tu=(e,t)=>{return n=t,o=bu("metadata"),i=e[3],o in n?yu(n,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[o]=i;var n,o,i},$u=(e,t,n,o)=>{for(var i=0,s=e[t>>1],r=s&&s.length;i<r;i++)1&t?s[i].call(n):o=s[i].call(n,o);return o},Lu=(e,t,n,o,i,s)=>{var r,l,a,c,u,d=7&t,p=!!(8&t),h=!!(16&t),f=d>3?e.length+1:d?p?1:2:0,g=xu[d+5],m=d>3&&(e[f-1]=[]),v=e[f]||(e[f]=[]),y=d&&(!h&&!p&&(i=i.prototype),d<5&&(d>3||!h)&&wu(d<4?i:{get[n](){return Mu(this,s)},set[n](e){return Au(this,s,e)}},n));d?h&&d<4&&Cu(s,(d>2?"set ":d>1?"get ":"")+n):Cu(i,n);for(var w=o.length-1;w>=0;w--)c=ku(d,n,a={},e[3],v),d&&(c.static=p,c.private=h,u=c.access={has:h?e=>Ou(i,e):e=>n in e},3^d&&(u.get=h?e=>(1^d?Mu:Eu)(e,i,4^d?s:y.get):e=>e[n]),d>2&&(u.set=h?(e,t)=>Au(e,i,t,4^d?s:y.set):(e,t)=>e[n]=t)),l=(0,o[w])(d?d<4?h?s:y[g]:d>4?void 0:{get:y.get,set:y.set}:i,c),a._=1,4^d||void 0===l?Su(l)&&(d>4?m.unshift(l):d?h?s=l:y[g]=l:i=l):"object"!=typeof l||null===l?_u("Object expected"):(Su(r=l.get)&&(y.get=r),Su(r=l.set)&&(y.set=r),Su(r=l.init)&&m.unshift(r));return d||Tu(e,i),y&&yu(i,n,y),h?4^d?s:y:i},Pu=(e,t,n)=>t.has(e)||_u("Cannot "+n),Ou=(e,t)=>Object(t)!==t?_u('Cannot use the "in" operator on this value'):e.has(t),Mu=(e,t,n)=>(Pu(e,t,"read from private field"),n?n.call(e):t.get(e)),Au=(e,t,n,o)=>(Pu(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n),Eu=(e,t,n)=>(Pu(e,t,"access private method"),n);gu=[Bs({components:{IconSubmit:Na,IconStop:Va,IconDrag:Ua,IconClose:Za,IconPlaceRight:Ga,IconClean:Ka,IconCopy:Xa,IconSwitch:Ja,IconLoader:su,IconRefresh:ru,IconAlert:au,IconRefill:uu,IconRefreshSmall:du,BlockText:kc,BlockCode:ou},directives:{drag:Us}})];let Du=class extends(fu=Ss,hu=[Ds("messages")],pu=[Ds("message-textarea")],fu){constructor(){super(...arguments),this.commonStore=Is,this.formState="blocked",this.question="",this.initialized=!1,this.messages=lt([]),this.balance=null,this.balanceRefillUrl=null,this.minWidth=400,this.minHeight=600,this.beforeChatStyle=void 0,this.chatStyle=void 0,this.chatStyleCorrect=void 0,this.handleResize=void 0,this.messagesRef=$u(mu,8,this),$u(mu,11,this),this.messageTextarea=$u(mu,12,this),$u(mu,15,this),this.abortController=void 0,this.balanceReloading=void 0}t(e){return window.lang.t(e)}switchView(e){e.viewMode="text"==e.viewMode?"html":"text"}onChangePosition(){(new Ws).send("savePosition",this.chatStyle)}cleanChat(){(new Ws).send("cleanChat",{}),this.messages=[]}repeat(e,t){this.messages.splice(t,1),this.getAnswer(!0)}sendQuestion(){let e=this.question;if("ok"!=this.formState||""==e.trim())return;this.question="",this.formState="loading";let t=lt(new za(e,"user","loading",new Date));this.messages.push(t),this.scrollToEnd();let n=new Ws;this.abortController=n.getAbortController(),n.send("saveQuestion",t).then((()=>{t.status="ok",this.getAnswer()})).catch((e=>{t.status="fail",this.formState="ok"}))}getAnswer(e){let t=lt(new za("","assistant","loading",new Date));this.messages.push(t),this.scrollToEnd();let n=new Ws;this.abortController=n.getAbortController(),n.setStreamCallback((e=>{t.text=e})),n.send("getAnswer",{repeat:+e}).then((e=>{e.error&&(t.role="system",t.text=e.error),e.lastChunk&&null!=e.lastChunk.balance&&(this.balance=e.lastChunk.balance,window.dispatchEvent(new CustomEvent("gptBalanceChange",{bubbles:!0,detail:{balance:this.balance,source:"chat"}}))),t.status="ok",this.abortController=null,this.formState="ok"})).catch((e=>{t.status="fail",this.abortController=null,this.formState="ok"}))}stopGeneration(){this.abortController&&this.abortController.abort("AbortError")}scrollToEnd(){setTimeout((()=>{this.messagesRef.scrollTo({top:this.messagesRef.scrollHeight,behavior:"smooth"})}),10)}placeRight(){"right"==this.chatStyle.stick&&this.beforeChatStyle?(this.chatStyle={...this.beforeChatStyle},this.beforeChatStyle=null):(this.beforeChatStyle={...this.chatStyle},this.chatStyle.width=450,this.chatStyle.height=document.documentElement.clientHeight,this.chatStyle.right=0,this.chatStyle.top=0,this.chatStyle.stick="right"),this.calculateStyleCorrect(),this.onChangePosition()}handleDrag(e,t){this.chatStyle=this.chatStyleCorrect,this.chatStyle.stick="none",t.x&&(t.x.increase&&(this.chatStyle[t.x.increase]=this.chatStyle[t.x.increase]+e.x),t.x.decrease&&(this.chatStyle[t.x.decrease]=this.chatStyle[t.x.decrease]-e.x)),t.y&&(t.y.increase&&(this.chatStyle[t.y.increase]=this.chatStyle[t.y.increase]+e.y),t.y.decrease&&(this.chatStyle[t.y.decrease]=this.chatStyle[t.y.decrease]-e.y)),this.chatStyle.width<this.minWidth&&(this.chatStyle.width=this.minWidth),this.chatStyle.height<this.minHeight&&(this.chatStyle.height=this.minHeight),this.calculateStyleCorrect()}getComputedChatStyle(){let e={};for(let t in this.chatStyleCorrect)e[t]=this.chatStyleCorrect[t]+"px";return e}calculateStyleCorrect(){let e={...this.chatStyle},t=document.documentElement.clientWidth,n=document.documentElement.clientHeight;e.right<0&&(e.right=0),e.width>t&&(e.width=t),e.right+e.width>t&&e.width<=t&&(e.right=t-e.width),e.top<0&&(e.top=0),"right"==e.stick&&(e.height=n),e.height>n&&(e.height=n),e.top+e.height>n&&e.height<=n&&(e.top=n-e.height),this.chatStyleCorrect=e}copy(e,t){navigator.clipboard.writeText(t.text);const n=e.target.closest("button");n.classList.add("ai-success"),setTimeout((()=>{n.classList.remove("ai-success")}),1e3)}created(){this.initialize()}mounted(){this.handleResize=()=>this.calculateStyleCorrect(),this.handleResize(),window.addEventListener("resize",this.handleResize),this.commonStore.emitter.on("show",(()=>{this.initialized||this.loadLastChat().then((()=>{this.initialized=!0}))})),this.messageTextarea.addEventListener("input",(e=>{e.target.style.height="auto";const t=Math.min(e.target.scrollHeight,200);e.target.style.height=t+"px",e.target.style.overflowY=e.target.scrollHeight>200?"auto":"hidden"})),this.messageTextarea.addEventListener("keypress",(e=>{e.ctrlKey&&"Enter"==e.code&&this.sendQuestion()}))}unmounted(){window.removeEventListener("resize",this.handleResize)}initialize(){Object.keys(window.global.ai.chatSettings).length&&null!==window.global.ai.chatSettings.chat_width?this.chatStyle={width:window.global.ai.chatSettings.chat_width,height:window.global.ai.chatSettings.chat_height,right:window.global.ai.chatSettings.chat_right,top:window.global.ai.chatSettings.chat_top,stick:window.global.ai.chatSettings.chat_stick}:this.chatStyle={width:400,height:document.documentElement.clientHeight,right:0,top:0,stick:"right"},this.calculateStyleCorrect()}refreshBalance(e){this.balanceReloading=!0,(new Ws).send("getBalance").then((e=>{this.balanceReloading=!1,e.success&&(this.balance=e.balance,this.balanceRefillUrl=e.balanceRefillUrl)})).catch((()=>{this.balanceReloading=!1}));let t=e.target.closest("button");t.classList.add("ai-success"),setTimeout((()=>{t.classList.remove("ai-success")}),500)}refillBalance(){window.open(this.balanceRefillUrl,"_blank")}loadLastChat(){return(new Ws).send("startChat").then((e=>{e.success&&(e.chat.messages.forEach((e=>{let t=new za;t.import(e),t.status="ok",this.messages.push(t)})),null!==e.chat.balance&&(this.balance=e.chat.balance,window.addEventListener("gptBalanceChange",(e=>{"chat"!=e.detail.source&&(this.balance=e.detail.balance)}))),null!==e.chat.balanceRefillUrl&&(this.balanceRefillUrl=e.chat.balanceRefillUrl),this.formState="ok")}))}};mu=(e=>[,,,vu((null==e?void 0:e[bu("metadata")])??null)])(fu),Lu(mu,5,"messagesRef",hu,Du),Lu(mu,5,"messageTextarea",pu,Du),Du=Lu(mu,0,"Chat",gu,Du),$u(mu,1,Du);const Ru=Fs(Du),Hu=["data-stick"],ju={class:"ai-resize ai-top"},zu={class:"ai-resize ai-right"},Bu={class:"ai-resize ai-bottom"},Nu={class:"ai-resize ai-left"},Fu={class:"ai-corner ai-left-top"},Vu={class:"ai-corner ai-right-top"},Iu={class:"ai-corner ai-right-bottom"},Uu={class:"ai-corner ai-left-bottom"},Wu={class:"ai-header"},Zu={class:"ai-draggable"},qu={class:"ai-header-buttons"},Gu={class:"ai-messages",ref:"messages"},Yu={class:"ai-message-body"},Ku={class:"ai-message-actions"},Xu={class:"ai-left"},Qu=["onClick"],Ju=["onClick"],ed={class:"ai-right"},td={key:0,class:"ai-message-stub"},nd={key:1,class:"ai-message-stub"},od={class:"ai-footer"},id=["placeholder"],sd={key:0,class:"ai-balance"},rd={class:"ai-balance-value"},ld=["disabled"];const ad=Zs(Ru,[["render",function(e,t,n,o,i,s){const r=xn("icon-drag"),l=xn("icon-clean"),a=xn("icon-place-right"),c=xn("icon-close"),u=xn("icon-loader"),d=xn("icon-alert"),p=xn("blockCode"),h=xn("blockText"),f=xn("icon-copy"),g=xn("icon-refresh"),m=xn("icon-refresh-small"),v=xn("icon-refill"),y=xn("icon-submit"),w=xn("icon-stop"),b=kn("drag"),C=kn("tooltip");return Io(),qo("div",{ref:"chat",class:U(["ai-chat no-block-focus",{active:e.commonStore.isActive}]),"data-stick":e.chatStyle.stick,style:B(e.getComputedChatStyle()),onDragend:t[8]||(t[8]=(...t)=>e.onChangePosition&&e.onChangePosition(...t))},[Kt(Jo("div",ju,null,512),[[b,{params:{y:{increase:"top",decrease:"height"}},handleDrag:e.handleDrag}]]),Kt(Jo("div",zu,null,512),[[b,{params:{x:{increase:"width",decrease:"right"}},handleDrag:e.handleDrag}]]),Kt(Jo("div",Bu,null,512),[[b,{params:{y:{increase:"height"}},handleDrag:e.handleDrag}]]),Kt(Jo("div",Nu,null,512),[[b,{params:{x:{decrease:"width"}},handleDrag:e.handleDrag}]]),Kt(Jo("div",Fu,null,512),[[b,{params:{x:{decrease:"width"},y:{increase:"top",decrease:"height"}},handleDrag:e.handleDrag}]]),Kt(Jo("div",Vu,null,512),[[b,{params:{x:{increase:"width",decrease:"right"},y:{increase:"top",decrease:"height"}},handleDrag:e.handleDrag}]]),Kt(Jo("div",Iu,null,512),[[b,{params:{x:{increase:"width",decrease:"right"},y:{increase:"height"}},handleDrag:e.handleDrag}]]),Kt(Jo("div",Uu,null,512),[[b,{params:{x:{decrease:"width"},y:{increase:"height"}},handleDrag:e.handleDrag}]]),Jo("div",Wu,[Kt((Io(),qo("div",Zu,[ei(r),t[9]||(t[9]=oi()),t[10]||(t[10]=Jo("span",null,"Чат с ИИ",-1))])),[[b,{params:{x:{decrease:"right"},y:{increase:"top"}},handleDrag:e.handleDrag}]]),Jo("div",qu,[Kt((Io(),qo("button",{onClick:t[0]||(t[0]=t=>e.cleanChat())},[ei(l)])),[[C,"Очистить чат"]]),Kt((Io(),qo("button",{onClick:t[1]||(t[1]=t=>e.placeRight())},[ei(a)])),[[C,"Прикрепить справа"]]),Kt((Io(),qo("button",{onClick:t[2]||(t[2]=t=>e.commonStore.hide()),class:"ai-button-close"},[ei(c)])),[[C,"Закрыть"]])])]),Jo("div",Gu,[e.initialized?(Io(),qo(jo,{key:0},[(Io(!0),qo(jo,null,Ln(e.messages,((t,n)=>(Io(),qo("div",{class:U(["ai-message",t.status,t.role])},[Jo("div",Yu,["loading"==t.status&&""==t.text?(Io(),Go(u,{key:0})):si("",!0),"system"==t.role?(Io(),Go(d,{key:1})):si("",!0),(Io(!0),qo(jo,null,Ln(t.getTextByBlocks(),(e=>(Io(),qo(jo,null,["code"==e.type?(Io(),Go(p,{key:0,message:t,textBlock:e},null,8,["message","textBlock"])):si("",!0),"text"==e.type?(Io(),Go(h,{key:1,message:t,textBlock:e},null,8,["message","textBlock"])):si("",!0)],64)))),256))]),Jo("div",Ku,[Jo("div",Xu,[Kt((Io(),qo("button",{onClick:n=>e.copy(n,t)},[ei(f)],8,Qu)),[[C,"Копировать"]]),n+1==e.messages.length&&"loading"!=t.status&&"assistant"==t.role?Kt((Io(),qo("button",{key:0,onClick:o=>e.repeat(t,n)},[ei(g)],8,Ju)),[[C,"Повторить"]]):si("",!0)]),Jo("div",ed,["loading"==t.status&&""!=t.text?(Io(),Go(u,{key:0})):si("",!0)])])],2)))),256)),e.messages.length?si("",!0):(Io(),qo("div",td,"Спросите что-нибудь..."))],64)):(Io(),qo("div",nd,"Загрузка..."))],512),Jo("div",od,[Jo("form",{onSubmit:t[7]||(t[7]=rs(((...t)=>e.sendQuestion&&e.sendQuestion(...t)),["prevent"])),class:"ai-message-form"},[Kt(Jo("textarea",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.question=t),placeholder:e.t("Ваш вопрос"),class:"ai-message-textarea",ref:"message-textarea"},null,8,id),[[os,e.question]]),null!==e.balance?(Io(),qo("div",sd,[Jo("span",rd,[t[12]||(t[12]=oi("Баланс: ")),Jo("span",{class:U({"ai-loading":e.balanceReloading})},[Jo("strong",null,Y(e.balance),1),t[11]||(t[11]=oi(" запросов"))],2)]),Kt((Io(),qo("button",{onClick:t[4]||(t[4]=t=>e.refreshBalance(t)),class:"ai-balance-refresh"},[ei(m)])),[[C,"Обновить"]]),e.balanceRefillUrl?Kt((Io(),qo("button",{key:0,onClick:t[5]||(t[5]=t=>e.refillBalance()),class:"ai-balance-refill"},[ei(v)])),[[C,"Пополнить"]]):si("",!0)])):si("",!0),"ok"==e.formState||"blocked"==e.formState?Kt((Io(),qo("button",{key:1,type:"submit",class:"ai-message-send",disabled:"blocked"==e.formState||""==e.question},[ei(y)],8,ld)),[[C,"Отправить (CTRL+Enter)",void 0,{left:!0}]]):si("",!0),"loading"==e.formState?(Io(),qo("button",{key:2,type:"button",class:"ai-message-stop",onClick:t[6]||(t[6]=(...t)=>e.stopGeneration&&e.stopGeneration(...t))},[ei(w)])):si("",!0)],32)])],46,Hu)}],["__scopeId","data-v-6b87abd2"]]),cd={__name:"App",setup:e=>(e,t)=>(Io(),qo(jo,null,[ei(ad),ei(ja)],64))};function ud(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dd,pd={exports:{}};const hd=ud(function(){if(dd)return pd.exports;dd=1;var e=document.implementation.createHTMLDocument("").createElement("div");function t(t){e.innerHTML=t;for(var n=e.querySelectorAll("*");n.length;)e.innerHTML=e.innerText,n=e.querySelectorAll("*");return e.innerText}function n(e){try{return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}catch(fd){return""}}function o(t){e.innerHTML=t;for(var n=e.querySelectorAll("*"),o=n.length-1;o>=0;o--){var i=n[o],s=i.localName;if("script"!=s&&"noscript"!=s&&"noembed"!=s&&i.attributes instanceof NamedNodeMap){if(i.hasAttributes())for(var r=i.attributes,l=r.length-1;l>=0;l--){var a=r[l],c=a.localName,u=a.value.replace(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,"").toLowerCase().trim();0==c.indexOf("on")?i.removeAttribute(c):("src"!=c&&"href"!=c||0!=u.indexOf("javascript:"))&&(-1!=["audio","image","img","source","video"].indexOf(s)||"src"!=c&&"data"!=c||0!=u.indexOf("data:"))||i.removeAttribute(c)}}else try{i.parentNode.removeChild(i)}catch(fd){i.outerHTML=""}}return e.innerHTML}return pd.exports={install:function(e,i){e.directive("html-remove",{inserted:function(e,n){e.innerHTML=t(n.value)},mounted:function(e,n){e.innerHTML=t(n.value)},update:function(e,n){n.value!==n.oldValue&&(e.innerHTML=t(n.value))},updated:function(e,n){n.value!==n.oldValue&&(e.innerHTML=t(n.value))}}),e.directive("html-escape",{inserted:function(e,t){e.innerHTML=n(t.value)},mounted:function(e,t){e.innerHTML=n(t.value)},update:function(e,t){t.value!==t.oldValue&&(e.innerHTML=n(t.value))},updated:function(e,t){t.value!==t.oldValue&&(e.innerHTML=n(t.value))}}),e.directive("html-safe",{inserted:function(e,t){e.innerHTML=o(t.value)},mounted:function(e,t){e.innerHTML=o(t.value)},update:function(e,t){t.value!==t.oldValue&&(e.innerHTML=o(t.value))},updated:function(e,t){t.value!==t.oldValue&&(e.innerHTML=o(t.value))}})}},pd.exports.removeHTML=t,pd.exports.escapeHTML=n,pd.exports.safeHTML=o,pd.exports}());document.addEventListener("DOMContentLoaded",(function(){document.body.insertAdjacentHTML("beforeend",'<div id="ai-assistant"></div>'),ds(cd).use(hd).use(ha,{autoHideOnMousedown:!0,themes:{tooltip:{triggers:["hover","touch"]}}}).mount("#ai-assistant")}));

/**
 * Plugin ReadyScript, активирует сканирование штрихкодов и QR-кодов через приложение ReadyScript
 * Плагин инициализируется автоматически на все элементы с атрибутом data-app-scan
 */
(function($){
    $.fn.appScan = function(method) {
        const defaults = {
                refreshInterval:2000,
                autoPressEnter: true,    //Нажимать Enter после ввода результатов сканирования в поле input
                autoPressEvent: 'keydown', //Событие для автоматического нажатия Enter (keydown или keypress)
                triggerEvent: false,     //Событие для генерации, после вставки. Например: 'click'. false - не генерировать событие
                triggerTarget: '',       //Селектор элемента для события. Например: '.apply-button',
                triggerTargetContext: '*' //Селектор родительского элемента, в котором находится triggerTarget. Например: '.apply-button-wrapper'
            },
            args = arguments;

        return this.each(function() {

            let $this = $(this),
                data = $this.data('appScanPlugin');

            const methods = {
                init: function (initoptions) {
                    if (data) return;
                    data = {};
                    $this.data('appScanPlugin', data);
                    data.opt = $.extend({}, defaults, initoptions, $this.data('appScanOptions'));

                    createButton();
                }
            };

            //private
            const
                /**
                 * Создает кнопку сканирования
                 */
                createButton = function() {
                    let button = $('<a>')
                        .attr('class', 'btn btn-default app-scan-button m-l-5 m-r-5')
                        .attr('title', lang.t('Сканировать в приложении ReadyScript'))
                        .append('<i class="zmdi zmdi-fullscreen"></i>');

                    button.click(startScan);
                    button.insertAfter($this);
                    button.parent().trigger('new-content');
                },
                /**
                 * Обрабатывает нажатие на кнопку сканирования
                 */
                startScan = function() {
                    if ($.rs.loading.inProgress) {
                        return;
                    }

                    const formats = $this.data('appScan');
                    const filter = $this.data('appScanFilter');

                    $.rs.openDialog({
                        url: global.scanUrl,
                        extraParams: {
                            formats: formats,
                            filter: filter
                        },
                        dialogOptions: {
                            width:400
                        },
                        afterOpen: function(dialog) {
                            initEvents(dialog);
                            dialog.on('click', '[data-resend-url]', (event) => reSend(event, dialog));
                        },
                        close: function(dialog) {
                            clearInterval(dialog.data('refreshInterval'));
                        }
                    });
                },
                /**
                 * Обновляет сведения о запросе на сканирование
                 */
                refresh = function(dialog, resend) {
                    let refreshBlock = dialog.find('[data-scan-root]');
                    $.ajaxQuery({
                        loadingProgress: resend === true,
                        url: refreshBlock.data('refreshUrl'),
                        data: {
                            status: refreshBlock.data('status'),
                            resend: (resend ? 1 : 0)
                        },
                        success: function(response) {
                            if (response.changed) {
                                if (response.status === 'success') {
                                    $this.val(response.result);
                                    dialog.dialog('close');

                                    if (data.opt.autoPressEnter) {
                                        const keyboardEvent = new KeyboardEvent(data.opt.autoPressEvent, {
                                            code: 'Enter',
                                            key: 'Enter',
                                            charCode: 13,
                                            keyCode: 13,
                                            view: window,
                                            bubbles: true
                                        });
                                        $this.get(0).dispatchEvent(keyboardEvent);
                                    }

                                    if (data.opt.triggerEvent) {
                                        const triggerElement = $this.parents('*').first()
                                            .find(data.opt.triggerTarget)
                                            .get(0);

                                        if (triggerElement) {
                                            triggerElement.dispatchEvent(
                                                new Event(data.opt.triggerEvent, {bubbles: true}));
                                        }
                                    }
                                } else {
                                    refreshBlock.replaceWith(response.html);
                                    initEvents(dialog);
                                }
                            }
                        }
                    });
                },

                /**
                 * Отправляет Push уведомление на мобильное устройство повторно
                 */
                reSend = function(event, dialog) {
                    clearInterval(dialog.data('refreshInterval'));

                    let button = $(event.currentTarget);
                        button.text(button.data('sendingText'))
                              .prop('disabled', true);

                    refresh(dialog, true);
                },

                /**
                 * Инициализирует автоматическое обновление данных
                 */
                initEvents = function(dialog) {
                    let refreshBlock = dialog.find('[data-scan-root]');

                    clearInterval(dialog.data('refreshInterval'));
                    if (refreshBlock.data('status') === 'waiting') {
                        dialog.data('refreshInterval', setInterval(() => refresh(dialog),
                            data.opt.refreshInterval));
                    }
                };


            if ( methods[method] ) {
                methods[ method ].apply( this, Array.prototype.slice.call( args, 1 ));
            } else if ( typeof method === 'object' || ! method ) {
                return methods.init.apply( this, args );
            }
        });
    }
})(jQuery);

$.contentReady(function() {
    $('input[data-app-scan]').appScan();
});
